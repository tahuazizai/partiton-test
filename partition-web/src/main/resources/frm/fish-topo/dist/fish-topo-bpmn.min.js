!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.fishTopoBpmn=e():t.fishTopoBpmn=e()}(this,function(){return function(t){function e(i){if(n[i])return n[i].exports;var r=n[i]={exports:{},id:i,loaded:!1};return t[i].call(r.exports,r,r.exports,e),r.loaded=!0,r.exports}var n={};return e.m=t,e.c=n,e.p="",e(0)}([function(t,e,n){t.exports=n(1)},function(t,e,n){t.exports=n(2),n(159)},function(t,e,n){function i(t,e){this.id,this.group,this._dom=t,this._zr=h.init(t,{renderer:e.renderer||"canvas",devicePixelRatio:e.devicePixelRatio}),this.allNodes=[],this.subProcessNode=[],this.domArray=[],this.overlapArray=[],this.selectedNode=null,this.isNode=!1,this.nowZoom=1,this.rect,this.operationNode,this.step=0,this.stepJson=[],this.opts=e,this.selectedNodes=[],this.lineOpt={},this._api=new o(this),this.conPointsGroup=new r.Group,this.forbidEdit=void 0!==e.forbidEdit&&e.forbidEdit,this.mouseMode="default",this.connectionManager=new y,this.lineOperationManager=new x(this.connectionManager,this._api),this.model=new f({}),this.model.set(P.RESOURCE_ID,p.getUUID()),this.model.set(P.BPMN_TYPE,P.TEMPLATE),a.call(this)}var r=n(3),o=n(63),s=n(64),a=n(11),h=n(65),l=n(4),c=n(26),u=n(76),p=n(77),f=n(82),d=n(79),g=n(110),v=n(111),y=n(114),_=n(105),m=n(25),x=n(117),b=n(118),w=n(119),P=n(104),C={ENTER:13,ESCAPE:27};n(158),u.registerBPMNNode();var S=i.prototype;S.getDom=function(){return this._dom},S.getZr=function(){return this._zr},S.getWidth=function(){return this._zr.getWidth()},S.getHeight=function(){return this._zr.getHeight()},S.isDisposed=function(){return this._disposed},S.dispose=function(){this._disposed=!0,this._zr.dispose(),E[this.id]=null},S.resize=function(t,e){this.getDom().style.width=t+"px",this.getDom().style.height=e+"px",this._zr.resize(),this._zr.remove(this.group),this.group=new r.Group,1!=this.opts.showGridLine&&"true"!=this.opts.showGridLine||(this.gridLine(.2),this._zr.add(this.group))},S.init=function(){this.group=new r.Group,1!=this.opts.showGridLine&&"true"!=this.opts.showGridLine||(this.gridLine(.2),this._zr.add(this.group)),this._zr.on("mouseup",function(t){this._removeOperationNode();var e=t.target;e&&e.connector instanceof _||(this.connectionManager.clearSelectCon(),e&&e._isLineOperationIcon&&1==e._isLineOperationIcon)}.bind(this)),this._zr.on("click",function(t){this.hideConnectorPoint(),this.lineOperationManager.hideAllLineOperation();var e=t.target;if(!(e&&e.parent&&e.parent.resourceId)){var n={};n.event=t,n.type="click",n.target=this,this._api.trigger(n.type,n)}}.bind(this)),this._zr.on("mousedown",function(t){"drag-select"===this.mouseMode&&(!t.target||t.target&&"grid-line"===t.target.type||t.target&&"subprocess-rect"===t.target.name)&&this._dragSelect(t.target,t.offsetX,t.offsetY)}.bind(this)),this.on("conPointsGroup:click",function(t){this.lineOperationManager.bindOperation(t.lineNode)}.bind(this))},S._releaseSelectNode=function(t){if(this.dragSelectRect){for(var e=this.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name}),n=this.dragSelectRect.position[0],i=this.dragSelectRect.position[1],r=0;r<e.length;r++){var o=e[r],s=P.isFlow(o)?0:o.getRect().x,a=P.isFlow(o)?0:o.getRect().y;this.dragSelectRect.remove(o),o.originParent&&!t?o.originParent.add(o):this._zr.add(o),P.isFlow(o)||(o.originParent&&!t?o.setPosition(s+n-u.parentX(o.originParent),a+i-u.parentY(o.originParent)):o.setPosition(s+n,a+i),this.connectionManager.refreshLineByNode(o)),o.originParent&&(o.originParent=null)}this.dragSelectRect.off("mousedown"),this._zr.remove(this.dragSelectRect)}},S._dragSelect=function(t,e,n){this._releaseSelectNode(),this.dragSelectRect=new g({shape:{width:0,height:0},position:[e,n],style:{lineDash:[2,2],fill:"rgba(239,222,221,0.7)",stroke:"rgba(0, 0, 0, 1)"}}),this.dragSelectRect.type="dragSelect",this._zr.add(this.dragSelectRect),this.dragSelectRect.on("mousedown",function(t){this.newDrag(this.dragSelectRect,t.event.clientX,t.event.clientY),t.cancelBubble=!0}.bind(this));var i=function(t){if(!(Math.abs(t.offsetX-e)<=1&&Math.abs(t.offsetY-n)<=1)){var i=e<=t.offsetX?e:t.offsetX,r=n<=t.offsetY?n:t.offsetY,o=Math.abs(t.offsetX-e),s=Math.abs(t.offsetY-n);this.dragSelectRect.setProperties({shape:{width:o,height:s},position:[i,r]})}}.bind(this);this._zr.on("mousemove",i);var r=function(o){if(this._zr.off("mousemove",i),this._zr.off("mouseup",r),this._zr.off("globalout",r),Math.abs(o.offsetX-e)<=1&&Math.abs(o.offsetY-n)<=1)return void(t&&t.parent&&P.isSubProcess(t.parent)&&(this.nodeClickHandler(t.parent),this._trigger("selectNode",{target:t.parent})));var s=this,a=this.dragSelectRect.position[0],h=this.dragSelectRect.position[1],c=this.dragSelectRect.options.shape.width,p=this.dragSelectRect.options.shape.height,f=0;this.allNodes.forEach(function(t){var e=t.getRect(),n=e.width,i=e.height,r=t.parent?e.x+u.parentX(t.parent):e.x,o=t.parent?e.y+u.parentY(t.parent):e.y;if((P.isEvent(t)||P.isGateway(t))&&r-n>=a&&o-n>=h&&r+n<=a+c&&o+n<=h+p||!P.isEvent(t)&&!P.isGateway(t)&&r-n/2>=a&&o-i/2>=h&&r+n/2<=a+c&&o+i/2<=h+p){if(t.slotEvent&&t.slotEvent.length>0)for(var d=0;d<t.slotEvent.length;d++){var g=[t.slotEvent[d].position[0]+(r-a)-l.clone(t.position[0])-t.getBoundingRect().width/2,t.slotEvent[d].position[1]+(o-h)-l.clone(t.position[1])-t.getBoundingRect().height/2];t.slotEvent[d].attr("position",g),that.connectionManager.refreshLineByNode(t.slotEvent[d])}t.parent?(t.originParent=t.parent,t.parent.remove(t)):s._zr.remove(t),s.dragSelectRect.add(t),s.selectedNodes.push(t),t.setPosition(r-a,o-h),f++}}),f?(this.dragSelectRect.childOfName("GROUP_RECT_NAME").attr("style",{fill:"rgba(0,0,0,0)"}),this.connectionManager.connectors.forEach(function(t){var e=s.dragSelectRect.children().find(function(e){return e.id===t.startNode.id}),n=s.dragSelectRect.children().find(function(e){return e.id===t.endNode.id});e&&n&&(s._zr.remove(t),s.dragSelectRect.add(t),s.connectionManager.refreshLineByNode(t.startNode))})):(this.dragSelectRect.off("mousedown"),this._zr.remove(this.dragSelectRect))}.bind(this);this._zr.on("mouseup",r),this._zr.on("globalout",r)},S.setShapeModel=function(t,e,n,i){this.forbidEdit!==!0&&(P.isTemplate(t)?(this.model.mergeOption(e),n>0&&i>0&&this.resize(n,i)):P.isFlow(t)?this.connectionManager.setModel(t,e):(t.bpmnInfo.name.indexOf("Task")!==-1&&(e.properties.position="center"),"Comment"===t.bpmnInfo.name&&(e.properties.position="left"),t.setModel(e)))},S._getParentZr=function(t){var e=null;return e=t&&t.parent?t.parent:this._zr},S.clear=function(t){this.allNodes=[],this.subProcessNode=[],this.domArray=[],this.overlapArray=[],this.hideConnectorPoint(),this.selectedNode=null,this.rect=null,this.connectionManager.connectors=[],this._zr.clear(),this._zr.add(this.group),1!=t&&this.stepCounter()},S.forbidGridLine=function(t){this.opts.showGridLine=!t,1==t?this._zr.remove(this.group):(this._zr.remove(this.group),this.group=new r.Group,this.gridLine(.2),this._zr.add(this.group))},S.toJson=function(){return u.toJson(this.model,this.allNodes,this.connectionManager.connectors)},S.fromJson=function(t){u.fromJson(this,t)},S.gridLine=function(t){for(var e=this.opts.gridLineSpacing,n=parseInt(this.getWidth()/e),i=0;i<=n;i++){var o=new r.Line({shape:{x1:i*e,y1:0,x2:i*e,y2:this.getHeight()},style:{lineDash:[1],opacity:t},z:-1,draggable:!1,cursor:"default"});o.type="grid-line",this.group.add(o)}for(var s=parseInt(this.getHeight()/e,e),a=0;a<=s;a++){var h=new r.Line({shape:{x1:0,y1:a*e,x2:this.getWidth(),y2:a*e},style:{lineDash:[1],opacity:t},z:-1,draggable:!1,cursor:"default"});h.type="grid-line",this.group.add(h)}},S._removeOperationNode=function(){this.operationNode&&(this._zr.remove(this.operationNode),this.operationNode.cleanup(),this.operationNode=null)},S.addNode=function(t,e,n,i){var r=this;if(e>=0&&n>=0){var o=new f({});o.set(P.BPMN_TYPE,t),o.set("bounds.upperLeft",{x:e,y:n}),i&&o.set("properties",i),this._triggerAsync("beforeCreateNode",{target:null},o).then(function(t){t&&r.asyncAddNodeByModel(o,!0)})}},S.addShapes=function(t,e,n){function i(t,e,n){if(t.length>0)for(var r=0;r<t.length;r++)if(e>u.parentX(t[r])&&e<u.parentX(t[r])+t[r].getRect().width&&n>u.parentY(t[r])&&n<u.parentY(t[r])+t[r].getRect().height){if(t[r].children()&&t[r].children().length>0)var o=t[r].children().filter(function(t){return t.bpmnInfo&&"SubProcess"===t.nodeType}),s=i(o,e,n);return s||t[r]}return null}if(!(e<0||n<0)){for(var r=JSON.parse(JSON.stringify(t)),o=this.toJson(),s=JSON.parse(JSON.stringify(o.childShapes)),a=[],h=[],l=[],c=[],p=0;p<r.length;p++){var f=r[p];f.stencil.type!==P.SEQUENCE_FLOW&&(a.push(f.bounds.upperLeft.x),h.push(f.bounds.upperLeft.y),l.push(f.bounds.lowerRight.x),c.push(f.bounds.lowerRight.y))}var d=Math.min.apply(Math,a),g=Math.min.apply(Math,h),v=Math.max.apply(Math,l),y=Math.max.apply(Math,c),_=v-d,m=y-g,x="canvas",b=i(this.subProcessNode,e,n);b&&(x=b.resourceId);var w=[];if("canvas"===x){for(var p=0;p<r.length;p++){var C=r[p];C.stencil.type!==P.SEQUENCE_FLOW?(C.bounds.upperLeft.x=C.bounds.upperLeft.x-d+e,C.bounds.lowerRight.x=C.bounds.lowerRight.x-d+e,C.bounds.upperLeft.y=C.bounds.upperLeft.y-g+n,C.bounds.lowerRight.y=C.bounds.lowerRight.y-g+n):C.dockers=[]}if(s.length>0)for(var S=0;S<s.length;S++){var f=s[S];f.stencil.type!==P.SEQUENCE_FLOW?f.bounds.lowerRight.x>=e&&f.bounds.lowerRight.y>=n&&(f.bounds.upperLeft.x<=e?(f.bounds.upperLeft.y=f.bounds.upperLeft.y+m,f.bounds.lowerRight.y=f.bounds.lowerRight.y+m):(f.bounds.upperLeft.x=f.bounds.upperLeft.x+_,f.bounds.lowerRight.x=f.bounds.lowerRight.x+_)):f.dockers=[]}w=s.concat(r),o.childShapes=w}else{for(var T=0;T<r.length;T++){var C=r[T];C.stencil.type!==P.SEQUENCE_FLOW?(C.bounds.upperLeft.x=C.bounds.upperLeft.x-d+(e-u.parentX(b)),C.bounds.lowerRight.x=C.bounds.lowerRight.x-d+(e-u.parentX(b)),C.bounds.upperLeft.y=C.bounds.upperLeft.y-g+(n-u.parentY(b)),C.bounds.lowerRight.y=C.bounds.lowerRight.y-g+(n-u.parentY(b))):C.dockers=[]}for(var E,R,k=0;k<s.length;k++){var f=s[k];f.resourceId===x&&(E=f.bounds.upperLeft.x,R=f.bounds.upperLeft.y,f.bounds.lowerRight.x-e<_&&(f.bounds.lowerRight.x=_+e+10),f.bounds.lowerRight.y-n<m&&(f.bounds.lowerRight.y=m+n+10),f.childShapes=[].concat(r))}for(var N=0;N<s.length;N++){var f=s[N];f.resourceId!==x&&(f.stencil.type!==P.SEQUENCE_FLOW?f.bounds.lowerRight.x>=E&&f.bounds.lowerRight.y>=R&&(f.bounds.upperLeft.x<=E?(f.bounds.upperLeft.y=f.bounds.upperLeft.y+m,f.bounds.lowerRight.y=f.bounds.lowerRight.y+m):(f.bounds.upperLeft.x=f.bounds.upperLeft.x+_,f.bounds.lowerRight.x=f.bounds.lowerRight.x+_)):f.dockers=[])}o.childShapes=s}this.fromJson(o),this.stepCounter()}},S._JudgeNodeInWhichSubProcess=function(t,e){if(t.length>0)for(var n=0;n<t.length;n++){var i=new c(u.parentX(t[n]),u.parentY(t[n]),t[n].getRect().width,t[n].getRect().height);if(i.contain(e.x,e.y)){var r;if(t[n].children()&&t[n].children().length>0){var o=t[n].children().filter(function(t){return t.bpmnInfo&&"SubProcess"===t.nodeType});r=this._JudgeNodeInWhichSubProcess(o,e)}return r||t[n]}}return null},S.addNodeByModel=function(t,e,n){var i=this,r=d.getClass(t.get(P.BPMN_TYPE));if(r){var o=new r(t,this._api),s=i._JudgeNodeInWhichSubProcess(i.subProcessNode,{x:o.getRect().x,y:o.getRect().y});return i.addNodeToShape(o,e,n,s),o}},S.asyncAddNodeByModel=function(t,e,n){var i=this,r=d.getClass(t.get(P.BPMN_TYPE));if(r){var o=new r(t,this._api),s=i._JudgeNodeInWhichSubProcess(i.subProcessNode,{x:o.getRect().x,y:o.getRect().y});this._triggerAsync("beforeAddNode",{target:s},o).then(function(t){t&&i.addNodeToShape(o,e,n,s)})}},S.addNodeToShape=function(t,e,n,i){var r,o=this;if(0==o.subProcessNode.length)o._zr.add(t),r={id:t.id,position:[t.getRect().x,t.getRect().y],width:t.getRect().width,height:t.getRect().height},P.isSlotEvent(t)||o.overlapArray.push(r);else if(o._zr.add(t),r={id:t.id,position:[t.getRect().x,t.getRect().y],width:t.getRect().width,height:t.getRect().height},P.isSlotEvent(t)||o.overlapArray.push(r),e){var s=0,a=0;if(i){i.parent&&P.isSubProcess(i.parent)&&(s=u.parentX(i.parent),a=u.parentY(i.parent));var h=i.getRect().width/2+(t.getRect().x-(i.getRect().x+s)),l=i.getRect().height/2+(t.getRect().y-(i.getRect().y+a));t.setPosition(h,l),i.add(t),o._zr.remove(t);for(var c=0;c<o.overlapArray.length;c++)t.id==o.overlapArray[c].id&&o.overlapArray.splice(c,1)}}P.isSubProcess(t)&&o.subProcessNode.push(t),o.allNodes.push(t),r.position=[t.getRect().x,t.getRect().y],o.domArray.push(r),t.on("mousedown",function(t){1==o.forbidEdit||this.parent&&"dragSelect"===this.parent.type||"drag-select"===o.mouseMode&&P.isSubProcess(this)||o.newDrag(this,t.event.clientX,t.event.clientY),P.isSlotEvent(this)&&o.bindEventNode(),"drag-select"!==o.mouseMode&&(t.cancelBubble=!0)}),t.on("click",function(e){o.nodeClickHandler(this),o._trigger("selectNode",{target:t}),e.cancelBubble=!0}),P.isActivity(t)&&o.creatTip(t),t.on("mouseover",function(){if(this.alarm&&1==this.alarm.isShow){this.alarm.show(),this.alarm.eachChild(function(t){t.show()});var e=this.alarm.childOfName("Text"),n=e.getBoundingRect().width+4,i=e.getBoundingRect().height+8,r=[[0,0],[n,0],[n,i],[n/2-3,i],[n/2,i+3],[n/2+3,i],[0,i],[0,0]],o=this.alarm.childOfName("Polyline");o.attr("shape",{points:r});var s=[u.parentX(t)+t.getBoundingRect().width-this.alarm.getBoundingRect().width/2,u.parentY(t)-this.alarm.getBoundingRect().height-3];this.alarm.attr("position",s)}}),t.on("mouseout",function(){this.alarm&&(this.alarm.hide(),this.alarm.eachChild(function(t){t.hide()}))}),1!=n&&o.stepCounter(),o._trigger("afterCreateNode",{target:t})},S.selectNode=function(t){t&&(this.nodeClickHandler(t),this._trigger("selectNode",{target:t}))},S.childOfName=function(t){for(var e=[],n=0;n<this.allNodes.length;n++)this.allNodes[n].model.get("properties.name")==t&&e.push(this.allNodes[n]);return e.length>1?e:e[0]},S.findElements=function(t,e){for(var n=this.allNodes,i=this.connectionManager.connectors,r=[],o=0;o<n.length;o++){var s=n[o];t.call(e,s,o)&&r.push(s)}for(var a=0;a<i.length;a++){var h=i[a];t.call(e,h,a)&&r.push(h)}return r},S.addConnectorByModel=function(t,e){var n=null,i=null;if(l.each(this.allNodes,function(e){var r=e.model.get("outgoing");r.indexOf(t.get("resourceId"))!==-1&&(n=e);var o=t.get("outgoing");o.indexOf(e.resourceId)!==-1&&(i=e)}),n&&i){var r=this.connectionManager.connectorCreateByOptions(n,i,{model:t,isFromModel:!0},this._api);e?e.add(r):this._zr.add(r),r.on("mousedown",function(t){this.connectionManager.connectorForbidEdit(this.forbidEdit),this.lineOperationManager.isEdit=!this.forbidEdit,this.showConnectorPoint(t.target.style.lineType),this.isNode=!1}.bind(this))}},S.addIcon=function(t,e){this.lineOperationManager.addIcon(t,e)},S.bindLineDelete=function(t,e){this.lineOperationManager.addDeleteIcon(t,e)},S.checkLineNode=function(t){for(var e=[],n=[],i=this.connectionManager.connectors,r=0,o=i.length;r<o;r++)i[r].startNode==t&&n.push(i[r].endNode);for(var s=0,a=i.length;s<a;s++)i[s].endNode==t&&e.push(i[s].startNode);return[e,n]},S.createConnectorPoint=function(t,e,n){var i=this,o=new r.Circle({shape:{cx:t.x,cy:t.y,r:4},style:{fill:"#FFFF33",stroke:"#000000"},z:4,draggable:!0,lineType:n});o.type="ConnectPoint",o.pos=e;var s=["dragstart","drag","dragend"];l.each(s,function(t){o.on(t,function(e){var n={};n.event=e,n.type="ConnectPoint:"+t,i.conPointsGroup.trigger(n.type,n)})}),this.conPointsGroup.add(o)},S.hideConnectorPoint=function(){this.conPointsGroup.removeAll(),this.conPointsGroup.off(),this._zr.remove(this.conPointsGroup)},S.showConnectorPoint=function(t,e){function n(t,e,n,r){var o,s=null;return i.allNodes.forEach(function(i){var a=i.getRect().boundingRect;i.parent&&P.isSubProcess(i.parent)&&(a.x+=u.parentX(i.parent),a.y+=u.parentY(i.parent));var h=p.getConnectorPoints(a);r?Math.abs(h[r].x-t)<=n&&Math.abs(h[r].y-e)<=n&&(o=i):Math.abs(h.left.x-t)<=n&&Math.abs(h.left.y-e)<=n?(s="left",o=i):Math.abs(h.top.x-t)<=n&&Math.abs(h.top.y-e)<=n?(s="top",o=i):Math.abs(h.right.x-t)<=n&&Math.abs(h.right.y-e)<=n?(s="right",o=i):Math.abs(h.bottom.x-t)<=n&&Math.abs(h.bottom.y-e)<=n&&(s="bottom",o=i)}),{node:o,endPos:s}}var i=this;this.hideConnectorPoint(),e&&(this.lineOpt=e),i.allNodes.forEach(function(e){var n=e.getRect().boundingRect;e.parent&&P.isSubProcess(e.parent)&&(n.x+=u.parentX(e.parent),n.y+=u.parentY(e.parent));var r=p.getConnectorPoints(n);i.createConnectorPoint(r.left,"left",t),i.createConnectorPoint(r.right,"right",t),i.createConnectorPoint(r.top,"top",t),i.createConnectorPoint(r.bottom,"bottom",t)}),this.conPointsGroup.on("ConnectPoint:dragstart",function(t){var e=t.event.offsetX,r=t.event.offsetY,o=t.event.target;i.startPos=o.pos,i.selectConnNode=n(o.shape.cx,o.shape.cy,0,i.startPos).node,o.hide(),i.lineOperationManager.hideAllLineOperation(),i.reverseConnect=!1,i.originNode=null;var a=new s(e,r);i.connectionManager.connectors.forEach(function(t){t.endNode.id===i.selectConnNode.id&&i.startPos===t.options.position.endPos?(i.connectionManager.removeLine(t,t.parent?t.parent:i._zr),i.selectConnNode=t.startNode,i.startPos=t.options.position.startPos,i.originNode=t.endNode,i.originPos=t.options.position.endPos):t.startNode.id===i.selectConnNode.id&&i.startPos===t.options.position.startPos&&(i.connectionManager.removeLine(t,t.parent?t.parent:i._zr),i.reverseConnect=!0,i.selectConnNode=t.endNode,i.endPos=t.options.position.endPos,i.originNode=t.startNode,i.originPos=t.options.position.startPos)}),i.selectConnNode.parent&&P.isSubProcess(i.selectConnNode.parent)&&(a=new s(e-u.parentX(i.selectConnNode.parent),r-u.parentY(i.selectConnNode.parent)));var h;h=i.reverseConnect?i.connectionManager.manageReverseTempConnector(a,i.selectConnNode,o.lineType,i.endPos):i.connectionManager.manageTempConnector(i.selectConnNode,a,o.lineType,i.startPos),i.selectConnNode.parent&&P.isSubProcess(i.selectConnNode.parent)?i.selectConnNode.parent.add(h):i._zr.add(h)}),this.conPointsGroup.on("ConnectPoint:drag",function(t){var e=t.event.offsetX,n=t.event.offsetY,r=new s(e,n),o=t.event.target;i.selectConnNode.parent&&P.isSubProcess(i.selectConnNode.parent)&&(r=new s(e-u.parentX(i.selectConnNode.parent),n-u.parentY(i.selectConnNode.parent))),i.reverseConnect?i.connectionManager.manageReverseTempConnector(r,i.selectConnNode,o.lineType,i.endPos):i.connectionManager.manageTempConnector(i.selectConnNode,r,o.lineType,i.startPos),i.conPointsGroup.children().forEach(function(t){t.attr("style",{fill:"#FFFF33"}),Math.abs(t.shape.cx-e)<=10&&Math.abs(t.shape.cy-n)<=10&&t.attr("style",{fill:"#ff0000"})})}),this.conPointsGroup.on("ConnectPoint:dragend",function(t){var e,r,o,s=t.event.offsetX,a=t.event.offsetY,h=n(s,a,10),l=h.node,c=h.endPos||"left",u=t.event.target,f=!1;if(i.selectConnNode.parent&&P.isSubProcess(i.selectConnNode.parent)?(i.connectionManager.removeTempConnector(i.selectConnNode.parent),l&&l.parent&&P.isSubProcess(l.parent)&&l.parent.id===i.selectConnNode.parent.id&&(f=!0)):(i.connectionManager.removeTempConnector(i._zr),l&&!l.parent&&(f=!0)),f&&i.selectConnNode.id!==l.id){var d={style:{lineType:u.lineType}},g=p.mergeOpt(d,i.lineOpt,!0);e=i.reverseConnect?l:i.selectConnNode,r=i.reverseConnect?i.selectConnNode:l,o=i.reverseConnect?c:i.startPos,c=i.reverseConnect?i.endPos:c,i._createConnectorByNodes(e,r,g,o,c),i.hideConnectorPoint()}else i.originNode?(e=i.reverseConnect?i.originNode:i.selectConnNode,r=i.reverseConnect?i.selectConnNode:i.originNode,o=i.reverseConnect?i.originPos:i.startPos,c=i.reverseConnect?i.endPos:i.originPos,i._createConnectorByNodes(e,r,u.lineType,o,c),i.hideConnectorPoint()):(u.show(),u.position=[0,0],i.conPointsGroup.children().forEach(function(t){t.attr("style",{fill:"#FFFF33"})}))}),this._zr.add(this.conPointsGroup)},S.createLineConnectorPoint=function(t,e,n){var i=new r.Circle({shape:{cx:t.x,cy:t.y,r:4},style:{fill:"#FFFF33",stroke:"#000000"},z:4,draggable:!0,lineType:n});i.type="ConnectPoint",i.pos=e,this.conPointsGroup.add(i)},S.initOperationNode=function(t){function e(t,e,i,r){var o,s=null;return n.allNodes.forEach(function(a){var h=!1;if(a!==n.selectedNode&&(n.selectedNode.parent&&P.isSubProcess(n.selectedNode.parent)?a.parent&&P.isSubProcess(a.parent)&&a.parent.id===n.selectedNode.parent.id&&(h=!0):a.parent&&P.isSubProcess(a.parent)||(h=!0)),h){var l=a.getRect().boundingRect;a.parent&&P.isSubProcess(a.parent)&&(l.x+=u.parentX(a.parent),l.y+=u.parentY(a.parent));var c=p.getConnectorPoints(l);r?Math.abs(c[r].x-t)<=i&&Math.abs(c[r].y-e)<=i&&(o=a):Math.abs(c.left.x-t)<=i&&Math.abs(c.left.y-e)<=i?(s="left",o=a):Math.abs(c.top.x-t)<=i&&Math.abs(c.top.y-e)<=i?(s="top",o=a):Math.abs(c.right.x-t)<=i&&Math.abs(c.right.y-e)<=i?(s="right",o=a):Math.abs(c.bottom.x-t)<=i&&Math.abs(c.bottom.y-e)<=i&&(s="bottom",o=a)}}),{node:o,endPos:s}}var n=this;this.operationNode=new v(t,this._zr,this._api,this.forbidEdit),this.operationNode.on(v.ARROW_DRAGSTART,function(t){n.hideConnectorPoint(),n.allNodes.forEach(function(e){var i=!1;if(e!==n.selectedNode&&(n.selectedNode.parent&&P.isSubProcess(n.selectedNode.parent)?e.parent&&P.isSubProcess(e.parent)&&e.parent.id===n.selectedNode.parent.id&&(i=!0):e.parent&&P.isSubProcess(e.parent)||(i=!0)),i){var r=e.getRect().boundingRect;e.parent&&P.isSubProcess(e.parent)&&(r.x+=u.parentX(e.parent),r.y+=u.parentY(e.parent));var o=p.getConnectorPoints(r);n.createLineConnectorPoint(o.left,"left",t.event.target.lineType),n.createLineConnectorPoint(o.right,"right",t.event.target.lineType),n.createLineConnectorPoint(o.top,"top",t.event.target.lineType),n.createLineConnectorPoint(o.bottom,"bottom",t.event.target.lineType)}}),n._zr.add(n.conPointsGroup);var e=t.event.offsetX,i=t.event.offsetY,r=t.event.target;t.data&&(n.lineOpt=t.data),r.hide();var o=new s(e,i);n.selectedNode.parent&&P.isSubProcess(n.selectedNode.parent)&&(o=new s(e-u.parentX(n.selectedNode.parent),i-u.parentY(n.selectedNode.parent)));var a=n.connectionManager.manageTempConnector(n.selectedNode,o,r.lineType);n.selectedNode.parent&&P.isSubProcess(n.selectedNode.parent)?n.selectedNode.parent.add(a):n._zr.add(a)}),this.operationNode.on(v.ARROW_DRAG,function(t){var e=t.event.offsetX,i=t.event.offsetY,r=new s(e,i),o=t.event.target;n.selectedNode.parent&&P.isSubProcess(n.selectedNode.parent)&&(r=new s(e-u.parentX(n.selectedNode.parent),i-u.parentY(n.selectedNode.parent))),n.connectionManager.manageTempConnector(n.selectedNode,r,o.lineType),n.conPointsGroup.children().forEach(function(t){t.attr("style",{fill:"#FFFF33"}),Math.abs(t.shape.cx-e)<=10&&Math.abs(t.shape.cy-i)<=10&&t.attr("style",{fill:"#ff0000"})})}),this.operationNode.on(v.ARROW_DRAGEND,function(t){var i=t.event.offsetX,r=t.event.offsetY,o=null,s=t.event.target;s.show();var a,h,l,c=e(i,r,10),o=c.node,u=c.endPos||"left",s=t.event.target,p=!1;if(n.selectedNode.parent&&P.isSubProcess(n.selectedNode.parent)?(n.connectionManager.removeTempConnector(n.selectedNode.parent),o&&o.parent&&P.isSubProcess(o.parent)&&o.parent.id===n.selectedNode.parent.id&&(p=!0)):(n.connectionManager.removeTempConnector(n._zr),o&&!o.parent&&(p=!0)),p&&n.selectedNode.id!==o.id){var f;a=n.selectedNode,h=o,l="right",f=t.data?t.data:{style:{lineType:s.lineType}},n._createConnectorByNodes(a,h,f,l,u)}n.hideConnectorPoint()}),this.operationNode.on("OperationNode:deleteClick",function(){n.removeNode(n.selectedNode)}),this.operationNode.on("OperationNode:commentClick",function(){var t=n.selectedNode;if(!t.hasComment){var e,i;t.bpmnInfo.name.indexOf("Event")!==-1||t.bpmnInfo.name.indexOf("Gateway")!==-1?(e=t.position[0]+40,i=t.position[1]-80):"SubProcess"===t.nodeType?(e=t.position[0]+200,i=t.position[1]-80):(e=t.position[0]+120,i=t.position[1]-80);var r=new f({});r.set(P.BPMN_TYPE,"Comment"),r.set("bounds.upperLeft",{x:e,y:i}),r.set("properties",{name:"comment",operationIcons:[{name:"DEL",callback:function(e){t.hasComment=!1,n.remove(o)}}]});var o=n.addNodeByModel(r,!0);r=new f({}),r.set("resourceId",p.getUUID()),r.set("style.lineType","straight"),r.set("style.lineDash",[3]),r.set("style.stroke","#000"),r.set("symbol.type","none"),r.set("stencil.type","SequenceFlow");var s=n.connectionManager.connectorCreateByOptions(t,o,{model:r},n._api);n._zr.add(s),t.hasComment=!0}}),this.operationNode.on("OperationNode:scaleDragLeft",function(t){this.virtualRect&&this.virtualRect.setShape({points:t.points});var e=t.points[1][0]-t.points[0][0]-1,i=t.points[2][1]-t.points[1][1]-1;n.selectedNode.refresh({shape:{width:e,height:i}})}),this.operationNode.on("OperationNode:scaleDragRight",function(t){this.virtualRect&&this.virtualRect.setShape({points:t.points});var e=t.points[1][0]-t.points[0][0]-1,i=t.points[2][1]-t.points[1][1]-1;n.selectedNode.refresh({shape:{width:e,height:i}})}),this.operationNode.on("OperationNode:scaleDragEnd",function(t){if(n.selectedNode.getRect().points||null!=n.selectedNode.getRect().points){var e,i=n.selectedNode.getBoundingRect().width,r=n.selectedNode.getBoundingRect().height;"left"==t.arrowName&&(e=[n.selectedNode.position[0]-(i+1-n.selectedNode.getRect().width),n.selectedNode.position[1]-(r+1-n.selectedNode.getRect().height)]),"right"==t.arrowName&&(e=[n.selectedNode.position[0],n.selectedNode.position[1]]),n.selectedNode.refresh({shape:{width:i,height:r}});var o=!0;1==o&&n.selectedNode.refresh({position:e});for(var s=0;s<n.domArray.length;s++)n.selectedNode.id==n.domArray[s].id&&(n.domArray[s].position=[u.parentX(n.selectedNode)+(i+1)/2,u.parentY(n.selectedNode)+(r+1)/2],n.domArray[s].width=n.selectedNode.getRect().width,n.domArray[s].height=n.selectedNode.getRect().height);n.nodeClickHandler(n.selectedNode);for(var a=0;a<n.overlapArray.length;a++)n.selectedNode.id==n.overlapArray[a].id&&(n.overlapArray[a]={id:n.selectedNode.id,position:[u.parentX(n.selectedNode)+(i+1)/2,u.parentY(n.selectedNode)+(r+1)/2],width:n.selectedNode.getRect().width,height:n.selectedNode.getRect().height})}n.connectionManager.refreshLineByNode(n.selectedNode);var h=p.getSoltPoints(n.selectedNode);if(n.selectedNode.slotEvent&&n.selectedNode.slotEvent.length>0)for(var l=0;l<n.selectedNode.slotEvent.length;l++)for(var c=0;c<t.startSlotPoints.length;c++)n.selectedNode.slotEvent[l].position[0]-t.startPosition[0]==t.startSlotPoints[c][0]&&n.selectedNode.slotEvent[l].position[1]-t.startPosition[1]==t.startSlotPoints[c][1]&&(n.selectedNode.slotEvent[l].attr("position",[h[c][0]+u.parentX(n.selectedNode),h[c][1]+u.parentY(n.selectedNode)]),n.connectionManager.refreshLineByNode(n.selectedNode.slotEvent[l]));n.stepCounter()}),this._zr.add(this.operationNode)},S.findNodeChildIds=function(t,e){e.push(t.id),t.children().filter(function(t){var e=this.allNodes.findIndex(function(e){return e.id===t.id});return e!==-1}.bind(this)).forEach(function(t){P.isSubProcess(t)?this.findNodeChildIds(t,e):e.push(t.id)}.bind(this))},S.remove=S.removeNode=function(t){var e=this._getParentZr(t),n=this;t instanceof _?this._triggerAsync("beforeDeleteLine",{target:t},t).then(function(i){i&&(l.each(t.icons,function(t){e.remove(t)}),n.connectionManager.deleteLine(e),n._trigger("afterDeleteLine",{target:t}),n.stepCounter())}):this._triggerAsync("beforeDeleteNode",{target:t},t).then(function(i){if(i){e.remove(t);var r=[];P.isSubProcess(t)?n.findNodeChildIds(t,r):r.push(t.id),n.allNodes=n.allNodes.filter(function(t){return r.indexOf(t.id)===-1}),n.domArray=n.domArray.filter(function(t){return r.indexOf(t.id)===-1});for(var o=0;o<n.overlapArray.length;o++)t.id==n.overlapArray[o].id&&n.overlapArray.splice(o,1);if(P.isSubProcess(t))for(var s=0;s<n.subProcessNode.length;s++)t.id==n.subProcessNode[s].id&&n.subProcessNode.splice(s,1);if(n._removeOperationNode(),n.connectionManager.deleteSelectCon(t,e),(P.isActivity(t)||P.isSubProcess(t))&&t.slotEvent&&t.slotEvent.length>0)for(var s=0;s<t.slotEvent.length;s++){t.slotEvent[s].parent?P.isSubProcess(t.slotEvent[s].parent)&&t.slotEvent[s].parent.remove(t.slotEvent[s]):n._zr.remove(t.slotEvent[s]);for(var a=0;a<n.allNodes.length;a++)t.slotEvent[s].id==n.allNodes[a].id&&n.allNodes.splice(a,1);for(var h=0;h<n.domArray.length;h++)t.slotEvent[s].id==n.domArray[h].id&&n.domArray.splice(h,1)}if(P.isSlotEvent(t))for(var l=0;l<n.allNodes.length;l++)if(n.allNodes[l].isCanSlot&&n.allNodes[l].slotEvent&&n.allNodes[l].slotEvent.length>0)for(var c=0;c<n.allNodes[l].slotEvent.length;c++)t.id==n.allNodes[l].slotEvent[c].id&&n.allNodes[l].slotEvent.splice(c,1);n._trigger("afterDeleteNode",{target:t}),n.stepCounter()}})},S.removeSelectedNodes=function(){var t=this;if(this.selectedNodes.length){var e=t.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&!P.isFlow(t)}),n=t.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&P.isFlow(t)});t.connectionManager.connectors.forEach(function(i){var r=e.find(function(t){return t.id===i.startNode.id}),o=e.find(function(t){return t.id===i.endNode.id}),s=n.findIndex(function(t){return t.id===i.id});(r||o)&&s===-1&&t.connectionManager.removeLine(i,i.parent?i.parent:t._zr)}),this.selectedNodes.forEach(function(e){t.removeNode(e)}),this.selectedNodes=[],this.dragSelectRect.off("mousedown"),this._zr.remove(this.dragSelectRect)}else t.removeNode(t.selectedNode)},S._createConnectorByNodes=function(t,e,n,i,r){var o=this;this._triggerAsync("beforeCreateLine",{target:t},[t,e]).then(function(s){if(s){var a=o.connectionManager.connectorCreate(t,e,n,o._api,i,r);return t.parent&&e.parent?e.parent.add(a):o._zr.add(a),a.on("mousedown",l.bind(function(t){this.connectionManager.connectorForbidEdit(),this.lineOperationManager.isEdit=!this.forbidEdit,this.isNode=!1,this.showConnectorPoint(t.target.style.lineType)},o)),o._trigger("afterCreateLine",{target:a}),o.stepCounter(),a}})},S._triggerAsync=function(t,e,n){return this._trigger(t,e,n,!0)},S._trigger=function(t,e,n,i){var r=this.opts[t];return void 0===n&&(n={}),null===e?e={type:t,target:this}:e.type=t,e.data=n,this._api.trigger(e.type,e),i?w.resolve(!l.isFunction(r)||r.apply(this,[e].concat(n))).then(function(t){return!(t===!1)})["catch"](function(t){console.log(t)}):!(l.isFunction(r)&&r.apply(this,[e].concat(n))===!1)},S.nodeClickHandler=function(t){if(this.hideConnectorPoint(),this._trigger("editOperationIcons",{target:t},t.operationIcons),this.forbidEdit!==!0){this.selectedNode=t;var e=t.getRect();this.operationNode||this.initOperationNode(t),this.rect&&this.rect.attr("style",{stroke:"rgba(0, 0, 0, 1)"}),this.operationNode.refreshPostion(t,e)}},S.initVirtualLine=function(t){b.createGuidelines(this._zr),this.rect=new r.Polyline({position:[t.x,t.y],shape:{points:t.points},style:{lineDash:[2]},z:3}),this._zr.add(this.rect)},S.bindEventNode=function(){for(var t=0;t<this.allNodes.length;t++)this.allNodes[t].isCanSlot&&this.creatSlot(this.allNodes[t]);this._zr.on("mouseup",function(){for(var t=0;t<this.allNodes.length;t++)if(this.allNodes[t].isCanSlot&&this.allNodes[t].slot&&this.allNodes[t].slot.length>0)for(var e=0;e<this.allNodes[t].slot.length;e++)this.allNodes[t].remove(this.allNodes[t].slot[e])}.bind(this))},S.creatSlot=function(t){t.slot=[];for(var e=p.getSoltPoints(t),n=0;n<8;n++){var i=new r.Circle({position:e[n],shape:{cx:0,cy:0,r:10},style:{lineWidth:1,stroke:"rgba(0,0,0,0.6)",fill:"transparent"}});t.slot.push(i),t.add(i)}},S._posInWhichSubprocess=function(t,e){if(t.length>0)for(var n=0;n<t.length;n++){var i=t[n],r=i.getRect(),o=r.width,s=r.height,a=u.parentX(i),h=u.parentY(i);if(e.x>=a&&e.y>=h&&e.x+e.width<=a+o&&e.y+e.height<=h+s){var l;if(i.children()&&i.children().length>0){var c=i.children().filter(function(t){return t.bpmnInfo&&"SubProcess"===t.nodeType});l=this._posInWhichSubprocess(c,e)}return l||i}}return null},S.getDragSelectContainer=function(){var t=[],e=[],n=[],i=[];return this.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&!P.isFlow(t)}).forEach(function(r){var o=r.getRect(),s=o.width,a=o.height,h=o.x,l=o.y;P.isEvent(r)||P.isGateway(r)?(t.push(h-s),e.push(l-a),n.push(h+s),i.push(l+a)):(t.push(h-s/2),e.push(l-a/2),n.push(h+s/2),i.push(l+a/2))}),{x:Math.min.apply(Math,t),y:Math.min.apply(Math,e),width:Math.max.apply(Math,n)-Math.min.apply(Math,t),height:newHeight=Math.max.apply(Math,i)-Math.min.apply(Math,e)
}},S.newDrag=function(t,e,n){function i(e){function n(){C=0,o.rect.attr("style",{stroke:"rgba(0, 0, 0, 1)"})}function i(){C=1,o.rect.attr("style",{stroke:"rgba(255, 0, 0, 1)"})}function r(t,e){return!!e.parent&&(e.parent.id===t.id||r(t,e.parent))}for(var l=[o.getWidth()-(o.rect.shape.points[1][0]-o.rect.shape.points[0][0])/2,o.getHeight()-(o.rect.shape.points[2][1]-o.rect.shape.points[1][1])/2],m=[(o.rect.shape.points[1][0]-o.rect.shape.points[0][0])/2,(o.rect.shape.points[2][1]-o.rect.shape.points[1][1])/2],T=0;T<Math.abs(parseInt((e.event.clientX-c)/s));T++)S=1,e.event.clientX-c<0?(w[0]=f-s*T,"dragSelect"===t.type&&(g[0]=v-s*T)):(w[0]=f+s*T,"dragSelect"===t.type&&(g[0]=v+s*T)),w[0]<m[0]&&(w[0]=m[0]),w[0]>l[0]&&(w[0]=l[0]);for(var E=0;E<Math.abs(parseInt((e.event.clientY-p)/s));E++)S=1,e.event.clientY-p<0?(w[1]=d-s*E,"dragSelect"===t.type&&(g[1]=y-s*E)):(w[1]=d+s*E,"dragSelect"===t.type&&(g[1]=y+s*E)),w[1]<m[1]&&(w[1]=m[1]),w[1]>l[1]&&(w[1]=l[1]);if(o.rect.attr("position",w),o.containerNode=null,"dragSelect"===t.type){var R=o._posInWhichSubprocess(o.subProcessNode,{x:g[0]-_.width/2,y:g[1]-_.height/2,width:_.width,height:_.height}),k=o._JudgeNodeInWhichSubProcess(o.subProcessNode,{x:e.event.offsetX,y:e.event.offsetY});return!x&&k?i():n(),o.resetBackground(),x&&!R?(o.containerNode="zr",o.setBackground("#b6e3f5")):o.allNodes.filter(function(t){return P.isSubProcess(t)}).forEach(function(t){R&&R.id===t.id?(n(),o.containerNode=t,(!x||x&&x.id!==t.id)&&t.children().forEach(function(t){if("subprocess-rect"===t.name){if(!t.initStyle){var e=t.style.fill;t.attr("initStyle",e)}t.attr("style",{fill:"#b6e3f5"})}})):t.children().forEach(function(t){if("subprocess-rect"===t.name)if(t.initStyle)t.attr("style",{fill:t.initStyle});else{var e=t.style.fill;t.attr("initStyle",e),t.attr("style",{fill:t.initStyle})}})}),!0}b.judgeAlignment(w,h,o.getWidth(),o.getHeight());for(var N=o._JudgeNodeInWhichSubProcess(o.subProcessNode,{x:w[0],y:w[1]}),M=0,L=o.allNodes.length;M<L;M++){var A,O,z=o.allNodes[M],F=z.getRect(),I=!0;if(n(),!(z.id===t.id||P.isSubProcess(t)&&r(t,z))&&(o.resetBackground(),P.isSubProcess(z)&&(z.children().forEach(function(t){if("subprocess-rect"===t.name)if(t.initStyle)t.attr("style",{fill:t.initStyle});else{var e=t.style.fill;t.attr("initStyle",e),t.attr("style",{fill:t.initStyle})}}),N&&N.id===z.id&&(o.containerNode=z,(!t.parent||t.parent&&N.id!==t.parent.id)&&z.children().forEach(function(t){if("subprocess-rect"===t.name){if(!t.initStyle){var e=t.style.fill;t.attr("initStyle",e)}t.attr("style",{fill:"#b6e3f5"})}})),I=!1),t.parent&&!N&&(o.containerNode="zr",o.setBackground("#b6e3f5")),z.parent&&P.isSubProcess(z.parent)?(A=F.x+u.parentX(z.parent),O=F.y+u.parentY(z.parent)):(A=F.x,O=F.y),I))if(a.width>F.width)if(a.height>F.height){if(Math.abs(w[0]-A)<(F.width+a.width)/2&&Math.abs(w[1]-O)<(F.height+a.height)/2){i();break}n()}else{if(Math.abs(w[0]-A)<(F.width+a.width)/2&&Math.abs(w[1]-O)<(F.height+a.height)/2){i();break}n()}else if(a.height>F.height){if(Math.abs(w[0]-A)<(F.width+a.width)/2&&Math.abs(w[1]-O)<(F.height+a.height)/2){i();break}n()}else{if(Math.abs(w[0]-A)<(F.width+a.width)/2&&Math.abs(w[1]-O)<(F.height+a.height)/2){i();break}n()}}if(P.isSlotEvent(t))for(var B=0;B<o.allNodes.length;B++)if(o.allNodes[B].isCanSlot&&o.allNodes[B].slot&&o.allNodes[B].slot.length>0)for(var j=0;j<o.allNodes[B].slot.length;j++){var D=[o.allNodes[B].slot[j].position[0]+o.allNodes[B].position[0],o.allNodes[B].slot[j].position[1]+o.allNodes[B].position[1]];if(w[0]==D[0]&&w[1]==D[1]){o.rect.attr("style",{stroke:"rgba(0, 255, 0, 1)"}),C=0;break}}}function r(){o._zr.off("mousemove",T),o._zr.off("mouseup",E),o._zr.off("globalout",E),t.parent&&t.parent.off("globalout",E),o.rect.hide(),b.virtualXLine.attr("shape",{x2:0}),b.virtualYLine.attr("shape",{y2:0}),!o.containerNode&&t.parent&&P.isSubProcess(t.parent)?o.containerNode=t.parent:"zr"===o.containerNode&&(o.containerNode=null);var e=!1,n=null,i=null;if(0==C){o.containerNode&&(n=w[0]-u.parentX(o.containerNode),i=w[1]-u.parentY(o.containerNode));var r=n?n:w[0],s=i?i:w[1];if(t.slotEvent&&t.slotEvent.length>0)for(var a=0;a<t.slotEvent.length;a++){var h=[t.slotEvent[a].position[0]+r-l.clone(t.position[0])-t.getBoundingRect().width/2,t.slotEvent[a].position[1]+s-l.clone(t.position[1])-t.getBoundingRect().height/2];t.slotEvent[a].attr("position",h),o.connectionManager.refreshLineByNode(t.slotEvent[a])}if(t.setPosition(r,s),o.containerNode){if(t.parent&&o.containerNode.id!==t.parent.id)t.parent.remove(t),o.containerNode.add(t),e=!0;else if(t.parent||"dragSelect"===t.type){if("dragSelect"===t.type){var c=o.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&!P.isFlow(t)}),p=o.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&P.isFlow(t)});o.connectionManager.connectors.forEach(function(t){var e=c.find(function(e){return e.id===t.startNode.id}),n=c.find(function(e){return e.id===t.endNode.id}),i=p.findIndex(function(e){return e.id===t.id});(e||n)&&i===-1&&o.connectionManager.removeLine(t,t.parent?t.parent:o._zr)}),p.forEach(function(t){o.dragSelectRect.remove(t),o.containerNode.add(t)});for(var f=x&&x.id===o.containerNode.id?m.width:_.width,d=x&&x.id===o.containerNode.id?m.height:_.height,v=0;v<c.length;v++){var y,R,k=c[v],N=k.getRect().x,M=k.getRect().y;x&&x.id===o.containerNode.id?(y=w[0],R=w[1]):(y=g[0],R=g[1]);var L=y-u.parentX(o.containerNode)-f/2,A=R-u.parentY(o.containerNode)-d/2,O=N+L,z=M+A;if(k.slotEvent&&k.slotEvent.length>0)for(var a=0;a<k.slotEvent.length;a++){var h=[k.slotEvent[a].position[0]+O-l.clone(k.position[0])-k.getBoundingRect().width/2,k.slotEvent[a].position[1]+z-l.clone(k.position[1])-k.getBoundingRect().height/2];k.slotEvent[a].attr("position",h),o.connectionManager.refreshLineByNode(k.slotEvent[a])}o.dragSelectRect.remove(k),o.containerNode.add(k),k.setPosition(O,z),k.originParent&&(k.originParent=null);for(var F=0;F<o.overlapArray.length;F++)k.id==o.overlapArray[F].id&&o.overlapArray.splice(F,1);for(var a=0;a<o.domArray.length;a++)k.id==o.domArray[a].id&&(o.domArray[a].position=[N+(g[0]-f/2),M+(g[1]-d/2)]);o.connectionManager.refreshLineByNode(k)}o.dragSelectRect.off("mousedown"),o._zr.remove(o.dragSelectRect)}}else{o._zr.remove(t),o.containerNode.add(t),e=!0;for(var I=0;I<o.overlapArray.length;I++)t.id==o.overlapArray[I].id&&o.overlapArray.splice(I,1)}o.containerNode.children().forEach(function(t){if("subprocess-rect"===t.name)if(t.initStyle)t.attr("style",{fill:t.initStyle});else{var e=t.style.fill;t.attr("initStyle",e),t.attr("style",{fill:t.initStyle})}})}else t.parent&&(t.parent.remove(t),o._zr.add(t),e=!0,P.isSlotEvent(t)||o.overlapArray.push({id:t.id,position:[w[0],w[1]],width:t.getRect().width,height:t.getRect().height}));if("dragSelect"!==t.type){for(var B=0;B<o.domArray.length;B++)t.id==o.domArray[B].id&&(o.domArray[B].position=[w[0],w[1]]);if(!o.containerNode&&!t.parent)for(var I=0;I<o.overlapArray.length;I++)t.id==o.overlapArray[I].id&&(o.overlapArray[I]={id:t.id,position:[w[0],w[1]],width:t.getRect().width,height:t.getRect().height})}else if(!o.containerNode){var j=o.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&!P.isFlow(t)}),p=o.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&P.isFlow(t)});o.connectionManager.connectors.forEach(function(t){var e=j.find(function(e){return e.id===t.startNode.id}),n=j.find(function(e){return e.id===t.endNode.id}),i=p.findIndex(function(e){return e.id===t.id});(e||n)&&i===-1&&o.connectionManager.removeLine(t,t.parent?t.parent:o._zr)});for(var D=o.dragSelectRect.options.shape.width,H=o.dragSelectRect.options.shape.height,v=0;v<j.length;v++){for(var V=j[v],G=V.getRect().x,U=V.getRect().y,Y=0;Y<o.domArray.length;Y++)V.id==o.domArray[Y].id&&(o.domArray[Y].position=[G+(w[0]-D/2),U+(w[1]-H/2)]);for(var W=0;W<o.overlapArray.length;W++)V.id==o.overlapArray[W].id&&(o.overlapArray[W].position=[G+(w[0]-D/2),U+(w[1]-H/2)])}x&&o._releaseSelectNode(!0)}}else o.containerNode&&o.containerNode.children().forEach(function(t){if("subprocess-rect"===t.name)if(t.initStyle)t.attr("style",{fill:t.initStyle});else{var e=t.style.fill;t.attr("initStyle",e),t.attr("style",{fill:t.initStyle})}});if(o.resetBackground(),o.containerNode=null,1==S&&(e?o.connectionManager.connectors.filter(function(e){return e.startNode.id===t.id||e.endNode.id===t.id}).forEach(function(t){o.connectionManager.removeLine(t,t.parent?t.parent:o._zr)}):o.connectionManager.refreshLineByNode(t),o.stepCounter()),P.isSlotEvent(t)&&0==C){var X=[];t.parent?P.isSubProcess(t.parent)&&(X[0]=w[0]-u.parentX(t.parent),X[1]=w[1]-u.parentY(t.parent)):X=w;for(var v=0;v<o.allNodes.length;v++)if(o.allNodes[v].isCanSlot&&o.allNodes[v].slot&&o.allNodes[v].slot.length>0){for(var q=!0,Q=!1,Z=0;Z<o.allNodes[v].slot.length;Z++){var $=[o.allNodes[v].slot[Z].position[0]+o.allNodes[v].position[0],o.allNodes[v].slot[Z].position[1]+o.allNodes[v].position[1]];if(X[0]==$[0]&&X[1]==$[1]){q=!1;break}}for(var J=0;J<o.allNodes[v].slotEvent.length;J++)t.id==o.allNodes[v].slotEvent[J].id&&(Q=!0,q&&o.allNodes[v].slotEvent.splice(J,1));Q||q||o.allNodes[v].slotEvent.push(t)}}}var o=this;o.selectedNode=t,o.isNode=!0;var s=this.opts.gridLineSpacing,a=t.getRect(),h=o.domArray;document.body.onkeydown=function(t){var e=t||window.event;if(46==e.keycode||46==e.charCode||46==e.which){if(1==o.isNode){o.selectedNode.off(),o.selectedNode.parent?P.isSubProcess(o.selectedNode.parent)&&o.selectedNode.parent.remove(o.selectedNode):o._zr.remove(o.selectedNode);for(var n=0;n<o.allNodes.length;n++)o.selectedNode.id==o.allNodes[n].id&&o.allNodes.splice(n,1);for(var i=0;i<h.length;i++)o.selectedNode.id==h[i].id&&h.splice(i,1);for(var r=0;r<o.overlapArray.length;r++)o.selectedNode.id==o.overlapArray[r].id&&o.overlapArray.splice(r,1);o.operationNode&&(o._zr.remove(o.operationNode),o.operationNode=null),o.connectionManager.deleteSelectCon(o.selectedNode,o._zr)}else o.connectionManager.deleteLine(o._zr);this.stepCounter()}};var c,p,f,d;c=e,p=n,t.parent&&P.isSubProcess(t.parent)?(f=a.x+u.parentX(t.parent),d=a.y+u.parentY(t.parent)):(f=a.x,d=a.y),o.rect?(o.rect.attr("position",[f,d]),o.rect.setShape({points:a.points}),o.rect.show()):(o.initVirtualLine(a),o.rect.attr("position",[f,d]));var g,v,y,_,m,x,w=[f,d];"dragSelect"===t.type&&(_=this.getDragSelectContainer(),v=_.x+_.width/2+this.dragSelectRect.position[0],y=_.y+_.height/2+this.dragSelectRect.position[1],g=[v,y],m=o.dragSelectRect.getRect(),x=o._posInWhichSubprocess(o.subProcessNode,{x:m.x-m.width/2,y:m.y-m.height/2,width:m.width,height:m.height}));var C=0,S=0,T=function(t){i(t)},E=function(t){r(t)};this._zr.on("mousemove",T),this._zr.on("mouseup",E),this._zr.on("globalout",E)},S.setBackground=function(t){this.zrBackground=new r.Rect({shape:{width:this._zr.getWidth(),height:this._zr.getHeight()},style:{fill:t},cursor:"default",z:-1}),this._zr.add(this.zrBackground)},S.resetBackground=function(){this.zrBackground&&this._zr.remove(this.zrBackground)},S.creatTip=function(t){var e=new r.Group;e.isShow=!1;var n,i=t.model.get("properties.name")||"";n=i.length>64?i.substr(0,64)+"..":i;var o=new r.Text({style:{text:n,textFont:"16px Microsoft YaHei",fill:"#000000",textBaseline:"top"},position:[2,0],z:2});o.name="Text",e.add(o);var s=new r.Polyline({style:{fill:"#f9f9f9",stroke:"#bbbbbb"},z:1});s.name="Polyline",e.add(s),this._zr.add(e),t.alarm=e,e.hide(),e.eachChild(function(t){t.hide()})},S.stepCounter=function(){this.stepJson.splice(this.step,this.stepJson.length-this.step),this.step+=1;var t=this.toJson();this.stepJson.push(JSON.stringify(t))},S.zrScale=function(t){if("narrowing"==t){var e=-.07;this.zoom(e,this._zr.getWidth()/2,this._zr.getHeight()/2)}if("enlarge"==t){var n=.07;this.zoom(n,this._zr.getWidth()/2,this._zr.getHeight()/2)}if(!isNaN(t)){var i=this.group;if(i){var r=t/this._zoom;this._zoom=t,this.nowZoom=t,this.setScale(this._zr.getWidth()/2,this._zr.getHeight()/2,r)}}},S.zoom=function(t,e,n){var i=this.group;if(i){var r=this._zoom=this._zoom||1;r+=t,r=Number(r.toFixed(2));var o=r/this._zoom;if(r>1.7||r<.3)return;this._zoom=r,this.nowZoom=r,this.setScale(e,n,o)}},S.setScale=function(t,e,n){var i=this.findElements(function(t){return!0}),r=this.group;i.push(r),i.forEach(function(t){var e=(t.position,t.scale);e[0]*=n,e[1]*=n,t.attr("scale",[e[0],e[1]])})},S.nodeEdit=function(t){var e=t.childOfName("lineText");if(this.forbidEdit!==!0){var n=!1,i=p.getRect(t),r=this.createTextArea(),o=l.clone(t.model.get("properties.name")),s=t instanceof _&&e?m.getBoundingRect(e.style.text,"12px"):m.getBoundingRect(o,"12px"),a=.6*i.width,h=(0==s.width?a:t instanceof _&&s.width>60?1.2*s.width:2*s.width)*this.nowZoom,c=(2*s.height||24)*this.nowZoom;r.style.width=h+"px",r.style.height=c+"px";var f=1.2*i.width*this.nowZoom;r.style.maxWidth=f+"px",r.style.lineHeight=(1.2*s.lineHeight||14.4)+"px",r.style.border="1px dashed #2e2e2e",r.innerHTML=t.model.get("properties.name"),this.setShapeModel(t,{properties:{name:""}}),this._dom.appendChild(r),this._dom.style.position="relative";var d=1,g=0,v=0,y=0;if(t instanceof _)if(t.parent&&P.isSubProcess(t.parent)&&(v=u.parentX(t.parent),y=u.parentY(t.parent)),e)r.style.top=(e.position[1]+y+s.height/2-c/2)*this.nowZoom+this.group.position[1]+"px",r.style.left=(e.position[0]+v-h/2)*this.nowZoom+this.group.position[0]+"px";else{var x=t.middle();r.style.top=(x[1]+y+s.height/2-c/2)*this.nowZoom+this.group.position[1]+"px",r.style.left=(x[0]+v-h/2)*this.nowZoom+this.group.position[0]+"px"}else t.parent&&P.isSubProcess(t.parent)?(v=i.x+u.parentX(t.parent),y=i.y+u.parentY(t.parent)):(v=i.x,y=i.y),r.style.top=(y-c/2+g*(i.height-s.height/2))*this.nowZoom+this.group.position[1]+"px",r.style.left=(v-d*(h<f?h:f)/2)*this.nowZoom+this.group.position[0]+"px";r.focus(),r.select(),r.onkeyup=function(){if(event.keyCode==C.ESCAPE)n=!0,r.blur();else{var t=m.getBoundingRect(r.value,"12px");this._textareaResize(t,r,r.style.maxWidth)}}.bind(this),r.onblur=function(){if(n)this.setShapeModel(t,{properties:{name:o}});else{var e=this.handleWrap(r.value,r.style.maxWidth);this.setShapeModel(t,{properties:{name:e}}),this._trigger("afterEditNode",{target:t})}r.remove()}.bind(this)}},S.createTextArea=function(){var t=document.createElement("textarea");return t.style.position="absolute",t.style.padding="6px",t.style.resize="none",t.style.whiteSpace="pre",t.style.lineHeight="125%",t.style.overflow="hidden",t.style.border="0",t.spellcheck=!1,t},S.handleWrap=function(t,e){var n=document.createElement("span");n.style.position="absolute",n.style.overflow="hidden",n.style.border="0",n.style.padding="0",n.style.left="0",n.style.top="0",this._dom.appendChild(n);var i=t.split("\n"),r="";return i.forEach(function(t,o){var s=t.length;if(0==s);else for(var a,h,l,c="",u=0;u<s;u++)a=t.charAt(u),n.innerHTML=n.innerHTML+a,h=n.clientWidth,l=Number(e.substring(0,e.length-2)),h>l?(r+=c,r+="\n",n.innerHTML=a,c=a):u==s-1?(r+=c+a,o<i.length-1&&(r+="\n"),n.innerHTML="",c=""):c+=a}),this._dom.removeChild(n),r},S._textareaResize=function(t,e,n){var i=0;e.style.width=0,e.style.width=1.1*t.width*this.nowZoom+"px",i=n<60?n:60,t.width<=i&&(e.style.width=i+"px"),e.style.height="0px",e.style.height=e.scrollHeight+"px",e.scrollHeight<=0&&(e.style.height="12px")},l.mixin(i,a);var T=new Date-0,E={},R="_fishTopoBpmn_instance_",k={version:"3.0.0",dependencies:{zrender:"3.0.4"}};k.init=function(t,e){if(!t)throw new Error("Initialize failed: invalid dom.");e=e||{},l.defaults(e,{type:"bpmn",showGridLine:!0,gridLineSpacing:10,beforeDeleteNode:null,beforeCreateNode:null,beforeDeleteLine:null,beforeCreateLine:null});var n=new i(t,e);return n.init(),n.id="ft_"+T++,E[n.id]=n,t.setAttribute&&t.setAttribute(R,n.id),n},k.getInstanceByDom=function(t){var e=t.getAttribute(R);return E[e]},k.dispose=function(t){var e;l.isDom(t)?e=k.getInstanceByDom(t):"string"==typeof t&&(e=E[t]),e instanceof k&&!e.isDisposed()&&e.dispose()},k.Bpmn=P,k.BPMNNode=d,k.graphic=r,k.BoundingRect=c,k.BPMNModel=f,k.util={},l.each(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend"],function(t){k.util[t]=l[t]}),t.exports=k},function(t,e,n){"use strict";function i(t){if(!t.__isHover){if(t.__hoverStlDirty){var e=t.style.stroke,n=t.style.fill,i=t.__hoverStl,r=y.lift;i.fill=i.fill||n&&(n instanceof x?n:r(n,-.1)),i.stroke=i.stroke||e&&(e instanceof x?e:r(e,-.1));var o={};for(var s in i)i.hasOwnProperty(s)&&(o[s]=t.style[s]);t.__normalStl=o,t.__hoverStlDirty=!1}t.setStyle(t.__hoverStl),t.z2+=1,t.__isHover=!0}}function r(t){if(t.__isHover){var e=t.__normalStl;e&&t.setStyle(e),t.z2-=1,t.__isHover=!1}}function o(t){"group"===t.type||"GroupNode"===t.type?t.traverse(function(t){"group"!==t.type&&i(t)}):i(t)}function s(t){"group"===t.type?t.traverse(function(t){"group"!==t.type&&r(t)}):r(t)}function a(t,e){t.__hoverStl=t.hoverStyle||e||{},t.__hoverStlDirty=!0}function h(){!this.__isEmphasis&&o(this)}function l(){!this.__isEmphasis&&s(this)}function c(){this.__isEmphasis=!0,o(this)}function u(){this.__isEmphasis=!1,s(this)}function p(t,e,n,i,r){var o=t?"Update":"",s=i&&i.getShallow("animationDuration"+o),a=i&&i.getShallow("animationEasing"+o);i&&i.getShallow("animation")?e.animateTo(n,s,a,r):(e.attr(n),r&&r())}var f=n(4),d=n(5),g=Math.round,v=n(6),y=n(19),_=n(13),m=n(14),x=n(41),b=n(42),w={};w.Util=f,w.Group=n(43),w.Image=n(44),w.Text=n(45),w.textContain=n(25),w.Circle=n(46),w.Sector=n(47),w.Ring=n(50),w.Polygon=n(51),w.Polyline=n(55),w.Rect=n(56),w.Line=n(57),w.BezierCurve=n(58),w.Arc=n(59),w.LinearGradient=n(60),w.RadialGradient=n(61),w.BoundingRect=n(26),w.States=n(62),w.extendShape=function(t){return v.extend(t)},w.extendPath=function(t,e){return d.extendFromString(t,e)},w.makePath=function(t,e,n,i){var r=d.createFromString(t,e);b.call(r);var o=r.getBoundingRect();if(n){var s=o.width/o.height;if("center"===i){var a,h=n.height*s;h<=n.width?a=n.height:(h=n.width,a=h/s);var l=n.x+n.width/2,c=n.y+n.height/2;n.x=l-h/2,n.y=c-a/2,n.width=h,n.height=a}this.resizePath(r,n)}return f.inherits(r,b),r},w.mergePath=d.mergePath,w.resizePath=function(t,e){if(t.applyTransform){var n=t.getBoundingRect(),i=n.calculateTransform(e);t.applyTransform(i)}},w.subPixelOptimizeLine=function(t){var e=w.subPixelOptimize,n=t.shape,i=t.style.lineWidth;return g(2*n.x1)===g(2*n.x2)&&(n.x1=n.x2=e(n.x1,i,!0)),g(2*n.y1)===g(2*n.y2)&&(n.y1=n.y2=e(n.y1,i,!0)),t},w.subPixelOptimizeRect=function(t){var e=w.subPixelOptimize,n=t.shape,i=t.style.lineWidth,r=n.x,o=n.y,s=n.width,a=n.height;return n.x=e(n.x,i,!0),n.y=e(n.y,i,!0),n.width=Math.max(e(r+s,i,!1)-n.x,0===s?0:1),n.height=Math.max(e(o+a,i,!1)-n.y,0===a?0:1),t},w.subPixelOptimize=function(t,e,n){var i=g(2*t);return(i+g(e))%2===0?i/2:(i+(n?1:-1))/2},w.doEnterHover=o,w.doLeaveHover=s,w.setElementHoverStl=a,w.setHoverStyle=function(t,e){"group"===t.type?t.traverse(function(t){"group"!==t.type&&a(t,e)}):a(t,e),t.on("mouseover",h).on("mouseout",l),t.on("emphasis",c).on("normal",u)},w.setNormalStyle=function(t,e){if(t.__normalStl)for(var n in e)t.__normalStl.hasOwnProperty(n)&&(t.__normalStl[n]=e[n])},w.setText=function(t,e,n){var i=e.getShallow("position")||"inside",r=i.indexOf("inside")>=0?"white":n,o=e.getModel("textStyle");f.extend(t,{textDistance:e.getShallow("distance")||5,textFont:o.getFont(),textPosition:i,textFill:o.getTextColor()||r})},w.updateProps=f.curry(p,!0),w.initProps=f.curry(p,!1),w.getTransform=function(t,e){for(var n=_.identity([]);t&&t!==e;)_.mul(n,t.getLocalTransform(),n),t=t.parent;return n},w.applyTransform=function(t,e,n){return n&&(e=_.invert([],e)),m.applyTransform([],t,e)},w.transformDirection=function(t,e,n){var i=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),r=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),o=["left"===t?-i:"right"===t?i:0,"top"===t?-r:"bottom"===t?r:0];return o=w.applyTransform(o,e,n),Math.abs(o[0])>Math.abs(o[1])?o[0]>0?"right":"left":o[1]>0?"bottom":"top"},t.exports=w},function(t,e){function n(t,e){X[t]=e}function i(t){if(null==t||"object"!=typeof t)return t;var e=t,n=D.call(t);if("[object Array]"===n){e=[];for(var r=0,o=t.length;r<o;r++)e[r]=i(t[r])}else if(j[n]){var s=t.constructor;if(t.constructor.from)e=s.from(t);else{e=new s(t.length);for(var r=0,o=t.length;r<o;r++)e[r]=i(t[r])}}else if(!B[n]&&!O(t)&&!S(t)){e={};for(var a in t)t.hasOwnProperty(a)&&(e[a]=i(t[a]))}return e}function r(t,e,n){if(!P(e)||!P(t))return n?i(e):t;for(var o in e)if(e.hasOwnProperty(o)){var s=t[o],a=e[o];!P(a)||!P(s)||x(a)||x(s)||S(a)||S(s)||C(a)||C(s)||O(a)||O(s)?!n&&o in t||(t[o]=i(e[o],!0)):r(s,a,n)}return t}function o(t,e){for(var n=t[0],i=1,o=t.length;i<o;i++)n=r(n,t[i],e);return n}function s(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}function a(t,e,n){for(var i in e)e.hasOwnProperty(i)&&(n?null!=e[i]:null==t[i])&&(t[i]=e[i]);return t}function h(){return Q||(Q=q().getContext("2d")),Q}function l(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var n=0,i=t.length;n<i;n++)if(t[n]===e)return n}return-1}function c(t,e){function n(){}var i=t.prototype;n.prototype=e.prototype,t.prototype=new n;for(var r in i)t.prototype[r]=i[r];t.prototype.constructor=t,t.superClass=e}function u(t,e,n){t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,a(t,e,n)}function p(t){if(t)return"string"!=typeof t&&"number"==typeof t.length}function f(t,e,n){if(t&&e)if(t.forEach&&t.forEach===V)t.forEach(e,n);else if(t.length===+t.length)for(var i=0,r=t.length;i<r;i++)e.call(n,t[i],i,t);else for(var o in t)t.hasOwnProperty(o)&&e.call(n,t[o],o,t)}function d(t,e,n){if(t&&e){if(t.map&&t.map===Y)return t.map(e,n);for(var i=[],r=0,o=t.length;r<o;r++)i.push(e.call(n,t[r],r,t));return i}}function g(t,e,n,i){if(t&&e){if(t.reduce&&t.reduce===W)return t.reduce(e,n,i);for(var r=0,o=t.length;r<o;r++)n=e.call(i,n,t[r],r,t);return n}}function v(t,e,n){if(t&&e){if(t.filter&&t.filter===G)return t.filter(e,n);for(var i=[],r=0,o=t.length;r<o;r++)e.call(n,t[r],r,t)&&i.push(t[r]);return i}}function y(t,e,n){if(t&&e)for(var i=0,r=t.length;i<r;i++)if(e.call(n,t[i],i,t))return t[i]}function _(t,e){var n=U.call(arguments,2);return function(){return t.apply(e,n.concat(U.call(arguments)))}}function m(t){var e=U.call(arguments,1);return function(){return t.apply(this,e.concat(U.call(arguments)))}}function x(t){return"[object Array]"===D.call(t)}function b(t){return"function"==typeof t}function w(t){return"[object String]"===D.call(t)}function P(t){var e=typeof t;return"function"===e||!!t&&"object"==e}function C(t){return!!B[D.call(t)]}function S(t){return"object"==typeof t&&"number"==typeof t.nodeType&&"object"==typeof t.ownerDocument}function T(t){return t!==t}function E(t){for(var e=0,n=arguments.length;e<n;e++)if(null!=arguments[e])return arguments[e]}function R(t,e){return null!=t?t:e}function k(t,e,n){return null!=t?t:null!=e?e:n}function N(){return Function.call.apply(U,arguments)}function M(t){if("number"==typeof t)return[t,t,t,t];var e=t.length;return 2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t}function L(t,e){if(!t)throw new Error(e)}function A(t){t[Z]=!0}function O(t){return t[Z]}function z(t){t&&f(t,function(t,e){this.set(e,t)},this)}function F(t){return new z(t)}function I(){}var B={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},j={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},D=Object.prototype.toString,H=Array.prototype,V=H.forEach,G=H.filter,U=H.slice,Y=H.map,W=H.reduce,X={},q=function(){return X.createCanvas()};X.createCanvas=function(){return document.createElement("canvas")};var Q,Z="__ec_primitive__",$="_ec_",J=4;z.prototype={constructor:z,get:function(t){return this[$+t]},set:function(t,e){return this[$+t]=e,e},each:function(t,e){void 0!==e&&(t=_(t,e));for(var n in this)this.hasOwnProperty(n)&&t(this[n],n.slice(J))},removeKey:function(t){delete this[$+t]}},e.$override=n,e.clone=i,e.merge=r,e.mergeAll=o,e.extend=s,e.defaults=a,e.createCanvas=q,e.getContext=h,e.indexOf=l,e.inherits=c,e.mixin=u,e.isArrayLike=p,e.each=f,e.map=d,e.reduce=g,e.filter=v,e.find=y,e.bind=_,e.curry=m,e.isArray=x,e.isFunction=b,e.isString=w,e.isObject=P,e.isBuiltInObject=C,e.isDom=S,e.eqNaN=T,e.retrieve=E,e.retrieve2=R,e.retrieve3=k,e.slice=N,e.normalizeCssArray=M,e.assert=L,e.setAsPrimitive=A,e.isPrimitive=O,e.createHashMap=F,e.noop=I},function(t,e,n){function i(t,e,n,i,r,o,s,a,h,l,c){var u=h*(v/180),p=g(u)*(t-n)/2+d(u)*(e-i)/2,y=-1*d(u)*(t-n)/2+g(u)*(e-i)/2,x=p*p/(s*s)+y*y/(a*a);x>1&&(s*=f(x),a*=f(x));var b=(r===o?-1:1)*f((s*s*(a*a)-s*s*(y*y)-a*a*(p*p))/(s*s*(y*y)+a*a*(p*p)))||0,w=b*s*y/a,P=b*-a*p/s,C=(t+n)/2+g(u)*w-d(u)*P,S=(e+i)/2+d(u)*w+g(u)*P,T=m([1,0],[(p-w)/s,(y-P)/a]),E=[(p-w)/s,(y-P)/a],R=[(-1*p-w)/s,(-1*y-P)/a],k=m(E,R);_(E,R)<=-1&&(k=v),_(E,R)>=1&&(k=0),0===o&&k>0&&(k-=2*v),1===o&&k<0&&(k+=2*v),c.addData(l,C,S,s,a,T,k,u,o)}function r(t){if(!t)return[];var e,n=t.replace(/-/g," -").replace(/  /g," ").replace(/ /g,",").replace(/,,/g,",");for(e=0;e<p.length;e++)n=n.replace(new RegExp(p[e],"g"),"|"+p[e]);var r,o=n.split("|"),s=0,a=0,h=new c,l=c.CMD;for(e=1;e<o.length;e++){var u,f=o[e],d=f.charAt(0),g=0,v=f.slice(1).replace(/e,-/g,"e-").split(",");v.length>0&&""===v[0]&&v.shift();for(var y=0;y<v.length;y++)v[y]=parseFloat(v[y]);for(;g<v.length&&!isNaN(v[g])&&!isNaN(v[0]);){var _,m,x,b,w,P,C,S=s,T=a;switch(d){case"l":s+=v[g++],a+=v[g++],u=l.L,h.addData(u,s,a);break;case"L":s=v[g++],a=v[g++],u=l.L,h.addData(u,s,a);break;case"m":s+=v[g++],a+=v[g++],u=l.M,h.addData(u,s,a),d="l";break;case"M":s=v[g++],a=v[g++],u=l.M,h.addData(u,s,a),d="L";break;case"h":s+=v[g++],u=l.L,h.addData(u,s,a);break;case"H":s=v[g++],u=l.L,h.addData(u,s,a);break;case"v":a+=v[g++],u=l.L,h.addData(u,s,a);break;case"V":a=v[g++],u=l.L,h.addData(u,s,a);break;case"C":u=l.C,h.addData(u,v[g++],v[g++],v[g++],v[g++],v[g++],v[g++]),s=v[g-2],a=v[g-1];break;case"c":u=l.C,h.addData(u,v[g++]+s,v[g++]+a,v[g++]+s,v[g++]+a,v[g++]+s,v[g++]+a),s+=v[g-2],a+=v[g-1];break;case"S":_=s,m=a;var E=h.len(),R=h.data;r===l.C&&(_+=s-R[E-4],m+=a-R[E-3]),u=l.C,S=v[g++],T=v[g++],s=v[g++],a=v[g++],h.addData(u,_,m,S,T,s,a);break;case"s":_=s,m=a;var E=h.len(),R=h.data;r===l.C&&(_+=s-R[E-4],m+=a-R[E-3]),u=l.C,S=s+v[g++],T=a+v[g++],s+=v[g++],a+=v[g++],h.addData(u,_,m,S,T,s,a);break;case"Q":S=v[g++],T=v[g++],s=v[g++],a=v[g++],u=l.Q,h.addData(u,S,T,s,a);break;case"q":S=v[g++]+s,T=v[g++]+a,s+=v[g++],a+=v[g++],u=l.Q,h.addData(u,S,T,s,a);break;case"T":_=s,m=a;var E=h.len(),R=h.data;r===l.Q&&(_+=s-R[E-4],m+=a-R[E-3]),s=v[g++],a=v[g++],u=l.Q,h.addData(u,_,m,s,a);break;case"t":_=s,m=a;var E=h.len(),R=h.data;r===l.Q&&(_+=s-R[E-4],m+=a-R[E-3]),s+=v[g++],a+=v[g++],u=l.Q,h.addData(u,_,m,s,a);break;case"A":x=v[g++],b=v[g++],w=v[g++],P=v[g++],C=v[g++],S=s,T=a,s=v[g++],a=v[g++],u=l.A,i(S,T,s,a,P,C,x,b,w,u,h);break;case"a":x=v[g++],b=v[g++],w=v[g++],P=v[g++],C=v[g++],S=s,T=a,s+=v[g++],a+=v[g++],u=l.A,i(S,T,s,a,P,C,x,b,w,u,h)}}"z"!==d&&"Z"!==d||(u=l.Z,h.addData(u)),r=u}return h.toStatic(),h}function o(t,e){var n=r(t);return e=e||{},e.buildPath=function(t){if(t.setData){t.setData(n.data);var e=t.getContext();e&&t.rebuildPath(e)}else{var e=t;n.rebuildPath(e)}},e.applyTransform=function(t){u(n,t),this.dirty(!0)},e}function s(t,e){return new l(o(t,e))}function a(t,e){return l.extend(o(t,e))}function h(t,e){for(var n=[],i=t.length,r=0;r<i;r++){var o=t[r];o.path||o.createPathProxy(),o.__dirtyPath&&o.buildPath(o.path,o.shape,!0),n.push(o.path)}var s=new l(e);return s.createPathProxy(),s.buildPath=function(t){t.appendPath(n);var e=t.getContext();e&&t.rebuildPath(e)},s}var l=n(6),c=n(29),u=n(40),p=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"],f=Math.sqrt,d=Math.sin,g=Math.cos,v=Math.PI,y=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},_=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(y(t)*y(e))},m=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(_(t,e))};e.createFromString=s,e.extendFromString=a,e.mergePath=h},function(t,e,n){function i(t){r.call(this,t),this.path=null}var r=n(7),o=n(4),s=n(29),a=n(32),h=n(39),l=h.prototype.getCanvasPattern,c=Math.abs,u=new s((!0));i.prototype={constructor:i,type:"path",__dirtyPath:!0,strokeContainThreshold:5,brush:function(t,e){var n=this.style,i=this.path||u,r=n.hasStroke(),o=n.hasFill(),s=n.fill,a=n.stroke,h=o&&!!s.colorStops,c=r&&!!a.colorStops,p=o&&!!s.image,f=r&&!!a.image;if(n.bind(t,this,e),this.setTransform(t),this.__dirty){var d;h&&(d=d||this.getBoundingRect(),this._fillGradient=n.getGradient(t,s,d)),c&&(d=d||this.getBoundingRect(),this._strokeGradient=n.getGradient(t,a,d))}h?t.fillStyle=this._fillGradient:p&&(t.fillStyle=l.call(s,t)),c?t.strokeStyle=this._strokeGradient:f&&(t.strokeStyle=l.call(a,t));var g=n.lineDash,v=n.lineDashOffset,y=!!t.setLineDash,_=this.getGlobalScale();i.setScale(_[0],_[1]),this.__dirtyPath||g&&!y&&r?(i.beginPath(t),g&&!y&&(i.setLineDash(g),i.setLineDashOffset(v)),this.buildPath(i,this.shape,!1),this.path&&(this.__dirtyPath=!1)):(t.beginPath(),this.path.rebuildPath(t)),o&&i.fill(t),g&&y&&(t.setLineDash(g),t.lineDashOffset=v),r&&i.stroke(t),g&&y&&t.setLineDash([]),this.restoreTransform(t),null!=n.text&&this.drawRectText(t,this.getBoundingRect())},buildPath:function(t,e,n){},createPathProxy:function(){this.path=new s},getBoundingRect:function(){var t=this._rect,e=this.style,n=!t;if(n){var i=this.path;i||(i=this.path=new s),this.__dirtyPath&&(i.beginPath(),this.buildPath(i,this.shape,!1)),t=i.getBoundingRect()}if(this._rect=t,e.hasStroke()){var r=this._rectWithStroke||(this._rectWithStroke=t.clone());if(this.__dirty||n){r.copy(t);var o=e.lineWidth,a=e.strokeNoScale?this.getLineScale():1;e.hasFill()||(o=Math.max(o,this.strokeContainThreshold||4)),a>1e-10&&(r.width+=o/a,r.height+=o/a,r.x-=o/a/2,r.y-=o/a/2)}return r}return t},contain:function(t,e){var n=this.transformCoordToLocal(t,e),i=this.getBoundingRect(),r=this.style;if(t=n[0],e=n[1],i.contain(t,e)){var o=this.path.data;if(r.hasStroke()){var s=r.lineWidth,h=r.strokeNoScale?this.getLineScale():1;if(h>1e-10&&(r.hasFill()||(s=Math.max(s,this.strokeContainThreshold)),a.containStroke(o,s/h,t,e)))return!0}if(r.hasFill())return a.contain(o,t,e)}return!1},dirty:function(t){null==t&&(t=!0),t&&(this.__dirtyPath=t,this._rect=null),this.__dirty=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty()},animateShape:function(t){return this.animate("shape",t)},attrKV:function(t,e){"shape"===t?(this.setShape(e),this.__dirtyPath=!0,this._rect=null):r.prototype.attrKV.call(this,t,e)},setShape:function(t,e){var n=this.shape;if(n){if(o.isObject(t))for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);else n[t]=e;this.dirty(!0)}return this},getLineScale:function(){var t=this.transform;return t&&c(t[0]-1)>1e-10&&c(t[3]-1)>1e-10?Math.sqrt(c(t[0]*t[3]-t[2]*t[1])):1}},i.extend=function(t){var e=function(e){i.call(this,e),t.style&&this.style.extendFrom(t.style,!1);var n=t.shape;if(n){this.shape=this.shape||{};var r=this.shape;for(var o in n)!r.hasOwnProperty(o)&&n.hasOwnProperty(o)&&(r[o]=n[o])}t.init&&t.init.call(this,e)};o.inherits(e,i);for(var n in t)"style"!==n&&"shape"!==n&&(e.prototype[n]=t[n]);return e},o.inherits(i,r);var p=i;t.exports=p},function(t,e,n){function i(t){t=t||{},s.call(this,t);for(var e in t)t.hasOwnProperty(e)&&"style"!==e&&(this[e]=t[e]);this.style=new o(t.style,this),this._rect=null,this.__clipPaths=[]}var r=n(4),o=n(8),s=n(9),a=n(23);i.prototype={constructor:i,type:"displayable",__dirty:!0,invisible:!1,z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:-1,beforeBrush:function(t){},afterBrush:function(t){},brush:function(t,e){},getBoundingRect:function(){},contain:function(t,e){return this.rectContain(t,e)},traverse:function(t,e){t.call(e,this)},rectContain:function(t,e){var n=this.transformCoordToLocal(t,e),i=this.getBoundingRect();
return i.contain(n[0],n[1])},dirty:function(){this.__dirty=!0,this._rect=null,this.__zr&&this.__zr.refresh()},animateStyle:function(t){return this.animate("style",t)},attrKV:function(t,e){"style"!==t?s.prototype.attrKV.call(this,t,e):this.style.set(e)},setStyle:function(t,e){return this.style.set(t,e),this.dirty(!1),this},useStyle:function(t){return this.style=new o(t,this),this.dirty(!1),this}},r.inherits(i,s),r.mixin(i,a);var h=i;t.exports=h},function(t,e){function n(t,e,n){var i=null==e.x?0:e.x,r=null==e.x2?1:e.x2,o=null==e.y?0:e.y,s=null==e.y2?0:e.y2;e.global||(i=i*n.width+n.x,r=r*n.width+n.x,o=o*n.height+n.y,s=s*n.height+n.y);var a=t.createLinearGradient(i,o,r,s);return a}function i(t,e,n){var i=n.width,r=n.height,o=Math.min(i,r),s=null==e.x?.5:e.x,a=null==e.y?.5:e.y,h=null==e.r?.5:e.r;e.global||(s=s*i+n.x,a=a*r+n.y,h*=o);var l=t.createRadialGradient(s,a,0,s,a,h);return l}var r=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]],o=function(t,e){this.extendFrom(t,!1),this.host=e};o.prototype={constructor:o,host:null,fill:"#000",stroke:null,opacity:1,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontSize:null,fontFamily:null,textTag:null,textFill:"#000",textStroke:null,textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:!1,textRotation:0,textOrigin:null,textBackgroundColor:null,textBorderColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function(t,e,n){for(var i=this,o=n&&n.style,s=!o,a=0;a<r.length;a++){var h=r[a],l=h[0];(s||i[l]!==o[l])&&(t[l]=i[l]||h[1])}if((s||i.fill!==o.fill)&&(t.fillStyle=i.fill),(s||i.stroke!==o.stroke)&&(t.strokeStyle=i.stroke),(s||i.opacity!==o.opacity)&&(t.globalAlpha=null==i.opacity?1:i.opacity),(s||i.blend!==o.blend)&&(t.globalCompositeOperation=i.blend||"source-over"),this.hasStroke()){var c=i.lineWidth;t.lineWidth=c/(this.strokeNoScale&&e&&e.getLineScale?e.getLineScale():1)}},hasFill:function(){var t=this.fill;return null!=t&&"none"!==t},hasStroke:function(){var t=this.stroke;return null!=t&&"none"!==t&&this.lineWidth>0},extendFrom:function(t,e){if(t)for(var n in t)!t.hasOwnProperty(n)||e!==!0&&(e===!1?this.hasOwnProperty(n):null==t[n])||(this[n]=t[n])},set:function(t,e){"string"==typeof t?this[t]=e:this.extendFrom(t,!0)},clone:function(){var t=new this.constructor;return t.extendFrom(this,!0),t},getGradient:function(t,e,r){for(var o="radial"===e.type?i:n,s=o(t,e,r),a=e.colorStops,h=0;h<a.length;h++)s.addColorStop(a[h].offset,a[h].color);return s}};for(var s=o.prototype,a=0;a<r.length;a++){var h=r[a];h[0]in s||(s[h[0]]=h[1])}o.getGradient=s.getGradient;var l=o;t.exports=l},function(t,e,n){var i=n(10),r=n(11),o=n(12),s=n(15),a=n(4),h=function(t){o.call(this,t),r.call(this,t),s.call(this,t),this.id=t.id||i()};h.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,drift:function(t,e){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0}var n=this.transform;n||(n=this.transform=[1,0,0,1,0,0]),n[4]+=t,n[5]+=e,this.decomposeTransform(),this.dirty(!1)},beforeUpdate:function(){},afterUpdate:function(){},update:function(){this.updateTransform()},traverse:function(t,e){},attrKV:function(t,e){if("position"===t||"scale"===t||"origin"===t){if(e){var n=this[t];n||(n=this[t]=[]),n[0]=e[0],n[1]=e[1]}}else this[t]=e},hide:function(){this.ignore=!0,this.__zr&&this.__zr.refresh()},show:function(){this.ignore=!1,this.__zr&&this.__zr.refresh()},attr:function(t,e){if("string"==typeof t)this.attrKV(t,e);else if(a.isObject(t))for(var n in t)t.hasOwnProperty(n)&&this.attrKV(n,t[n]);return this.dirty(!1),this},setClipPath:function(t){var e=this.__zr;e&&t.addSelfToZr(e),this.clipPath&&this.clipPath!==t&&this.removeClipPath(),this.clipPath=t,t.__zr=e,t.__clipTarget=this,this.dirty(!1)},removeClipPath:function(){var t=this.clipPath;t&&(t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__clipTarget=null,this.clipPath=null,this.dirty(!1))},addSelfToZr:function(t){this.__zr=t;var e=this.animators;if(e)for(var n=0;n<e.length;n++)t.animation.addAnimator(e[n]);this.clipPath&&this.clipPath.addSelfToZr(t)},removeSelfFromZr:function(t){this.__zr=null;var e=this.animators;if(e)for(var n=0;n<e.length;n++)t.animation.removeAnimator(e[n]);this.clipPath&&this.clipPath.removeSelfFromZr(t)}},a.mixin(h,s),a.mixin(h,o),a.mixin(h,r);var l=h;t.exports=l},function(t,e){function n(){return i++}var i=2311;t.exports=n},function(t,e){var n=Array.prototype.slice,i=function(){this._$handlers={}};i.prototype={constructor:i,one:function(t,e,n){var i=this._$handlers;if(!e||!t)return this;i[t]||(i[t]=[]);for(var r=0;r<i[t].length;r++)if(i[t][r].h===e)return this;return i[t].push({h:e,one:!0,ctx:n||this}),this},on:function(t,e,n){var i=this._$handlers;if(!e||!t)return this;i[t]||(i[t]=[]);for(var r=0;r<i[t].length;r++)if(i[t][r].h===e)return this;return i[t].push({h:e,one:!1,ctx:n||this}),this},isSilent:function(t){var e=this._$handlers;return e[t]&&e[t].length},off:function(t,e){var n=this._$handlers;if(!t)return this._$handlers={},this;if(e){if(n[t]){for(var i=[],r=0,o=n[t].length;r<o;r++)n[t][r].h!=e&&i.push(n[t][r]);n[t]=i}n[t]&&0===n[t].length&&delete n[t]}else delete n[t];return this},trigger:function(t){if(this._$handlers[t]){var e=arguments,i=e.length;i>3&&(e=n.call(e,1));for(var r=this._$handlers[t],o=r.length,s=0;s<o;){switch(i){case 1:r[s].h.call(r[s].ctx);break;case 2:r[s].h.call(r[s].ctx,e[1]);break;case 3:r[s].h.call(r[s].ctx,e[1],e[2]);break;default:r[s].h.apply(r[s].ctx,e)}r[s].one?(r.splice(s,1),o--):s++}}return this},triggerWithContext:function(t){if(this._$handlers[t]){var e=arguments,i=e.length;i>4&&(e=n.call(e,1,e.length-1));for(var r=e[e.length-1],o=this._$handlers[t],s=o.length,a=0;a<s;){switch(i){case 1:o[a].h.call(r);break;case 2:o[a].h.call(r,e[1]);break;case 3:o[a].h.call(r,e[1],e[2]);break;default:o[a].h.apply(r,e)}o[a].one?(o.splice(a,1),s--):a++}}return this}};var r=i;t.exports=r},function(t,e,n){function i(t){return t>a||t<-a}var r=n(13),o=n(14),s=r.identity,a=5e-5,h=function(t){t=t||{},t.position||(this.position=[0,0]),null==t.rotation&&(this.rotation=0),t.scale||(this.scale=[1,1]),this.origin=this.origin||null},l=h.prototype;l.transform=null,l.needLocalTransform=function(){return i(this.rotation)||i(this.position[0])||i(this.position[1])||i(this.scale[0]-1)||i(this.scale[1]-1)},l.updateTransform=function(){var t=this.parent,e=t&&t.transform,n=this.needLocalTransform(),i=this.transform;return n||e?(i=i||r.create(),n?this.getLocalTransform(i):s(i),e&&(n?r.mul(i,t.transform,i):r.copy(i,t.transform)),this.transform=i,this.invTransform=this.invTransform||r.create(),void r.invert(this.invTransform,i)):void(i&&s(i))},l.getLocalTransform=function(t){return h.getLocalTransform(this,t)},l.setTransform=function(t){var e=this.transform,n=t.dpr||1;e?t.setTransform(n*e[0],n*e[1],n*e[2],n*e[3],n*e[4],n*e[5]):t.setTransform(n,0,0,n,0,0)},l.restoreTransform=function(t){var e=t.dpr||1;t.setTransform(e,0,0,e,0,0)};var c=[];l.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&(r.mul(c,t.invTransform,e),e=c);var n=e[0]*e[0]+e[1]*e[1],o=e[2]*e[2]+e[3]*e[3],s=this.position,a=this.scale;i(n-1)&&(n=Math.sqrt(n)),i(o-1)&&(o=Math.sqrt(o)),e[0]<0&&(n=-n),e[3]<0&&(o=-o),s[0]=e[4],s[1]=e[5],a[0]=n,a[1]=o,this.rotation=Math.atan2(-e[1]/o,e[0]/n)}},l.getGlobalScale=function(){var t=this.transform;if(!t)return[1,1];var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]),n=Math.sqrt(t[2]*t[2]+t[3]*t[3]);return t[0]<0&&(e=-e),t[3]<0&&(n=-n),[e,n]},l.transformCoordToLocal=function(t,e){var n=[t,e],i=this.invTransform;return i&&o.applyTransform(n,n,i),n},l.transformCoordToGlobal=function(t,e){var n=[t,e],i=this.transform;return i&&o.applyTransform(n,n,i),n},h.getLocalTransform=function(t,e){e=e||[],s(e);var n=t.origin,i=t.scale||[1,1],o=t.rotation||0,a=t.position||[0,0];return n&&(e[4]-=n[0],e[5]-=n[1]),r.scale(e,e,i),o&&r.rotate(e,e,o),n&&(e[4]+=n[0],e[5]+=n[1]),e[4]+=a[0],e[5]+=a[1],e};var u=h;t.exports=u},function(t,e){function n(){var t=new c(6);return i(t),t}function i(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function r(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function o(t,e,n){var i=e[0]*n[0]+e[2]*n[1],r=e[1]*n[0]+e[3]*n[1],o=e[0]*n[2]+e[2]*n[3],s=e[1]*n[2]+e[3]*n[3],a=e[0]*n[4]+e[2]*n[5]+e[4],h=e[1]*n[4]+e[3]*n[5]+e[5];return t[0]=i,t[1]=r,t[2]=o,t[3]=s,t[4]=a,t[5]=h,t}function s(t,e,n){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+n[0],t[5]=e[5]+n[1],t}function a(t,e,n){var i=e[0],r=e[2],o=e[4],s=e[1],a=e[3],h=e[5],l=Math.sin(n),c=Math.cos(n);return t[0]=i*c+s*l,t[1]=-i*l+s*c,t[2]=r*c+a*l,t[3]=-r*l+c*a,t[4]=c*o+l*h,t[5]=c*h-l*o,t}function h(t,e,n){var i=n[0],r=n[1];return t[0]=e[0]*i,t[1]=e[1]*r,t[2]=e[2]*i,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*r,t}function l(t,e){var n=e[0],i=e[2],r=e[4],o=e[1],s=e[3],a=e[5],h=n*s-o*i;return h?(h=1/h,t[0]=s*h,t[1]=-o*h,t[2]=-i*h,t[3]=n*h,t[4]=(i*a-s*r)*h,t[5]=(o*r-n*a)*h,t):null}var c="undefined"==typeof Float32Array?Array:Float32Array;e.create=n,e.identity=i,e.copy=r,e.mul=o,e.translate=s,e.rotate=a,e.scale=h,e.invert=l},function(t,e){function n(t,e){var n=new P(2);return null==t&&(t=0),null==e&&(e=0),n[0]=t,n[1]=e,n}function i(t,e){return t[0]=e[0],t[1]=e[1],t}function r(t){var e=new P(2);return e[0]=t[0],e[1]=t[1],e}function o(t,e,n){return t[0]=e,t[1]=n,t}function s(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t}function a(t,e,n,i){return t[0]=e[0]+n[0]*i,t[1]=e[1]+n[1]*i,t}function h(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function l(t){return Math.sqrt(c(t))}function c(t){return t[0]*t[0]+t[1]*t[1]}function u(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function p(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function f(t,e){return t[0]*e[0]+t[1]*e[1]}function d(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t}function g(t,e){var n=l(e);return 0===n?(t[0]=0,t[1]=0):(t[0]=e[0]/n,t[1]=e[1]/n),t}function v(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function y(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function _(t,e){return t[0]=-e[0],t[1]=-e[1],t}function m(t,e,n,i){return t[0]=e[0]+i*(n[0]-e[0]),t[1]=e[1]+i*(n[1]-e[1]),t}function x(t,e,n){var i=e[0],r=e[1];return t[0]=n[0]*i+n[2]*r+n[4],t[1]=n[1]*i+n[3]*r+n[5],t}function b(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t}function w(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t}var P="undefined"==typeof Float32Array?Array:Float32Array,C=l,S=c,T=v,E=y;e.create=n,e.copy=i,e.clone=r,e.set=o,e.add=s,e.scaleAndAdd=a,e.sub=h,e.len=l,e.length=C,e.lenSquare=c,e.lengthSquare=S,e.mul=u,e.div=p,e.dot=f,e.scale=d,e.normalize=g,e.distance=v,e.dist=T,e.distanceSquare=y,e.distSquare=E,e.negate=_,e.lerp=m,e.applyTransform=x,e.min=b,e.max=w},function(t,e,n){var i=n(16),r=n(21),o=n(4),s=o.isString,a=o.isFunction,h=o.isObject,l=o.isArrayLike,c=o.indexOf,u=function(){this.animators=[]};u.prototype={constructor:u,animate:function(t,e){var n,o=!1,s=this,a=this.__zr;if(t){var h=t.split("."),l=s;o="shape"===h[0];for(var u=0,p=h.length;u<p;u++)l&&(l=l[h[u]]);l&&(n=l)}else n=s;if(!n)return void r('Property "'+t+'" is not existed in element '+s.id);var f=s.animators,d=new i(n,e);return d.during(function(t){s.dirty(o)}).done(function(){f.splice(c(f,d),1)}),f.push(d),a&&a.animation.addAnimator(d),d},stopAnimation:function(t){for(var e=this.animators,n=e.length,i=0;i<n;i++)e[i].stop(t);return e.length=0,this},animateTo:function(t,e,n,i,r,o){function h(){c--,c||r&&r()}s(n)?(r=i,i=n,n=0):a(i)?(r=i,i="linear",n=0):a(n)?(r=n,n=0):a(e)?(r=e,e=500):e||(e=500),this.stopAnimation(),this._animateToShallow("",this,t,e,n);var l=this.animators.slice(),c=l.length;c||r&&r();for(var u=0;u<l.length;u++)l[u].done(h).start(i,o)},_animateToShallow:function(t,e,n,i,r){var o={},s=0;for(var a in n)if(n.hasOwnProperty(a))if(null!=e[a])h(n[a])&&!l(n[a])?this._animateToShallow(t?t+"."+a:a,e[a],n[a],i,r):(o[a]=n[a],s++);else if(null!=n[a])if(t){var c={};c[t]={},c[t][a]=n[a],this.attr(c)}else this.attr(a,n[a]);return s>0&&this.animate(t,!1).when(null==i?500:i,o).delay(r||0),this}};var p=u;t.exports=p},function(t,e,n){function i(t,e){return t[e]}function r(t,e,n){t[e]=n}function o(t,e,n){return(e-t)*n+t}function s(t,e,n){return n>.5?e:t}function a(t,e,n,i,r){var s=t.length;if(1==r)for(var a=0;a<s;a++)i[a]=o(t[a],e[a],n);else for(var h=s&&t[0].length,a=0;a<s;a++)for(var l=0;l<h;l++)i[a][l]=o(t[a][l],e[a][l],n)}function h(t,e,n){var i=t.length,r=e.length;if(i!==r){var o=i>r;if(o)t.length=r;else for(var s=i;s<r;s++)t.push(1===n?e[s]:x.call(e[s]))}for(var a=t[0]&&t[0].length,s=0;s<t.length;s++)if(1===n)isNaN(t[s])&&(t[s]=e[s]);else for(var h=0;h<a;h++)isNaN(t[s][h])&&(t[s][h]=e[s][h])}function l(t,e,n){if(t===e)return!0;var i=t.length;if(i!==e.length)return!1;if(1===n){for(var r=0;r<i;r++)if(t[r]!==e[r])return!1}else for(var o=t[0].length,r=0;r<i;r++)for(var s=0;s<o;s++)if(t[r][s]!==e[r][s])return!1;return!0}function c(t,e,n,i,r,o,s,a,h){var l=t.length;if(1==h)for(var c=0;c<l;c++)a[c]=u(t[c],e[c],n[c],i[c],r,o,s);else for(var p=t[0].length,c=0;c<l;c++)for(var f=0;f<p;f++)a[c][f]=u(t[c][f],e[c][f],n[c][f],i[c][f],r,o,s)}function u(t,e,n,i,r,o,s){var a=.5*(n-t),h=.5*(i-e);return(2*(e-n)+a+h)*s+(-3*(e-n)-2*a-h)*o+a*r+e}function p(t){if(m(t)){var e=t.length;if(m(t[0])){for(var n=[],i=0;i<e;i++)n.push(x.call(t[i]));return n}return x.call(t)}return t}function f(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")"}function d(t){var e=t[t.length-1].value;return m(e&&e[0])?2:1}function g(t,e,n,i,r,p){var g=t._getter,_=t._setter,x="spline"===e,b=i.length;if(b){var w,P=i[0].value,C=m(P),S=!1,T=!1,E=C?d(i):0;i.sort(function(t,e){return t.time-e.time}),w=i[b-1].time;for(var R=[],k=[],N=i[0].value,M=!0,L=0;L<b;L++){R.push(i[L].time/w);var A=i[L].value;if(C&&l(A,N,E)||!C&&A===N||(M=!1),N=A,"string"==typeof A){var O=y.parse(A);O?(A=O,S=!0):T=!0}k.push(A)}if(p||!M){for(var z=k[b-1],L=0;L<b-1;L++)C?h(k[L],z,E):!isNaN(k[L])||isNaN(z)||T||S||(k[L]=z);C&&h(g(t._target,r),z,E);var F,I,B,j,D,H,V=0,G=0;if(S)var U=[0,0,0,0];var Y=function(t,e){var n;if(e<0)n=0;else if(e<G){for(F=Math.min(V+1,b-1),n=F;n>=0&&!(R[n]<=e);n--);n=Math.min(n,b-2)}else{for(n=V;n<b&&!(R[n]>e);n++);n=Math.min(n-1,b-2)}V=n,G=e;var i=R[n+1]-R[n];if(0!==i)if(I=(e-R[n])/i,x)if(j=k[n],B=k[0===n?n:n-1],D=k[n>b-2?b-1:n+1],H=k[n>b-3?b-1:n+2],C)c(B,j,D,H,I,I*I,I*I*I,g(t,r),E);else{var h;if(S)h=c(B,j,D,H,I,I*I,I*I*I,U,1),h=f(U);else{if(T)return s(j,D,I);h=u(B,j,D,H,I,I*I,I*I*I)}_(t,r,h)}else if(C)a(k[n],k[n+1],I,g(t,r),E);else{var h;if(S)a(k[n],k[n+1],I,U,1),h=f(U);else{if(T)return s(k[n],k[n+1],I);h=o(k[n],k[n+1],I)}_(t,r,h)}},W=new v({target:t._target,life:w,loop:t._loop,delay:t._delay,onframe:Y,ondestroy:n});return e&&"spline"!==e&&(W.easing=e),W}}}var v=n(17),y=n(19),_=n(4),m=_.isArrayLike,x=Array.prototype.slice,b=function(t,e,n,o){this._tracks={},this._target=t,this._loop=e||!1,this._getter=n||i,this._setter=o||r,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]};b.prototype={when:function(t,e){var n=this._tracks;for(var i in e)if(e.hasOwnProperty(i)){if(!n[i]){n[i]=[];var r=this._getter(this._target,i);if(null==r)continue;0!==t&&n[i].push({time:0,value:p(r)})}n[i].push({time:t,value:e[i]})}return this},during:function(t){return this._onframeList.push(t),this},pause:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].pause();this._paused=!0},resume:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var t=this._doneList,e=t.length,n=0;n<e;n++)t[n].call(this)},start:function(t,e){var n,i=this,r=0,o=function(){r--,r||i._doneCallback()};for(var s in this._tracks)if(this._tracks.hasOwnProperty(s)){var a=g(this,t,o,this._tracks[s],s,e);a&&(this._clipList.push(a),r++,this.animation&&this.animation.addClip(a),n=a)}if(n){var h=n.onframe;n.onframe=function(t,e){h(t,e);for(var n=0;n<i._onframeList.length;n++)i._onframeList[n](t,e)}}return r||this._doneCallback(),this},stop:function(t){for(var e=this._clipList,n=this.animation,i=0;i<e.length;i++){var r=e[i];t&&r.onframe(this._target,1),n&&n.removeClip(r)}e.length=0},delay:function(t){return this._delay=t,this},done:function(t){return t&&this._doneList.push(t),this},getClips:function(){return this._clipList}};var w=b;t.exports=w},function(t,e,n){function i(t){this._target=t.target,this._life=t.life||1e3,this._delay=t.delay||0,this._initialized=!1,this.loop=null!=t.loop&&t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart,this._pausedTime=0,this._paused=!1}var r=n(18);i.prototype={constructor:i,step:function(t,e){if(this._initialized||(this._startTime=t+this._delay,this._initialized=!0),this._paused)return void(this._pausedTime+=e);var n=(t-this._startTime-this._pausedTime)/this._life;if(!(n<0)){n=Math.min(n,1);var i=this.easing,o="string"==typeof i?r[i]:i,s="function"==typeof o?o(n):n;return this.fire("frame",s),1==n?this.loop?(this.restart(t),"restart"):(this._needsRemove=!0,"destroy"):null}},restart:function(t){var e=(t-this._startTime-this._pausedTime)%this._life;this._startTime=t-e+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(t,e){t="on"+t,this[t]&&this[t](this._target,e)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}};var o=i;t.exports=o},function(t,e){var n={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Math.PI/2)},sinusoidalOut:function(t){return Math.sin(t*Math.PI/2)},sinusoidalInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},exponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},exponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),-(n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)))},elasticOut:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),n*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/i)+1)},elasticInOut:function(t){var e,n=.1,i=.4;return 0===t?0:1===t?1:(!n||n<1?(n=1,e=i/4):e=i*Math.asin(1/n)/(2*Math.PI),(t*=2)<1?-.5*(n*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)):n*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/i)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)},bounceIn:function(t){return 1-n.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*n.bounceIn(2*t):.5*n.bounceOut(2*t-1)+.5}},i=n;t.exports=i},function(t,e,n){function i(t){return t=Math.round(t),t<0?0:t>255?255:t}function r(t){return t=Math.round(t),t<0?0:t>360?360:t}function o(t){return t<0?0:t>1?1:t}function s(t){return i(t.length&&"%"===t.charAt(t.length-1)?parseFloat(t)/100*255:parseInt(t,10))}function a(t){return o(t.length&&"%"===t.charAt(t.length-1)?parseFloat(t)/100:parseFloat(t))}function h(t,e,n){return n<0?n+=1:n>1&&(n-=1),6*n<1?t+(e-t)*n*6:2*n<1?e:3*n<2?t+(e-t)*(2/3-n)*6:t}function l(t,e,n){return t+(e-t)*n}function c(t,e,n,i,r){return t[0]=e,t[1]=n,t[2]=i,t[3]=r,t}function u(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function p(t,e){T&&u(T,e),T=S.put(t,T||e.slice())}function f(t,e){if(t){e=e||[];var n=S.get(t);if(n)return u(e,n);t+="";var i=t.replace(/ /g,"").toLowerCase();if(i in C)return u(e,C[i]),p(t,e),e;if("#"!==i.charAt(0)){var r=i.indexOf("("),o=i.indexOf(")");if(r!==-1&&o+1===i.length){var h=i.substr(0,r),l=i.substr(r+1,o-(r+1)).split(","),f=1;switch(h){case"rgba":if(4!==l.length)return void c(e,0,0,0,1);f=a(l.pop());case"rgb":return 3!==l.length?void c(e,0,0,0,1):(c(e,s(l[0]),s(l[1]),s(l[2]),f),p(t,e),e);case"hsla":return 4!==l.length?void c(e,0,0,0,1):(l[3]=a(l[3]),d(l,e),p(t,e),e);case"hsl":return 3!==l.length?void c(e,0,0,0,1):(d(l,e),p(t,e),e);default:return}}c(e,0,0,0,1)}else{if(4===i.length){var g=parseInt(i.substr(1),16);return g>=0&&g<=4095?(c(e,(3840&g)>>4|(3840&g)>>8,240&g|(240&g)>>4,15&g|(15&g)<<4,1),p(t,e),e):void c(e,0,0,0,1)}if(7===i.length){var g=parseInt(i.substr(1),16);return g>=0&&g<=16777215?(c(e,(16711680&g)>>16,(65280&g)>>8,255&g,1),p(t,e),e):void c(e,0,0,0,1)}}}}function d(t,e){var n=(parseFloat(t[0])%360+360)%360/360,r=a(t[1]),o=a(t[2]),s=o<=.5?o*(r+1):o+r-o*r,l=2*o-s;return e=e||[],c(e,i(255*h(l,s,n+1/3)),i(255*h(l,s,n)),i(255*h(l,s,n-1/3)),1),4===t.length&&(e[3]=t[3]),e}function g(t){if(t){var e,n,i=t[0]/255,r=t[1]/255,o=t[2]/255,s=Math.min(i,r,o),a=Math.max(i,r,o),h=a-s,l=(a+s)/2;if(0===h)e=0,n=0;else{n=l<.5?h/(a+s):h/(2-a-s);var c=((a-i)/6+h/2)/h,u=((a-r)/6+h/2)/h,p=((a-o)/6+h/2)/h;i===a?e=p-u:r===a?e=1/3+c-p:o===a&&(e=2/3+u-c),e<0&&(e+=1),e>1&&(e-=1)}var f=[360*e,n,l];return null!=t[3]&&f.push(t[3]),f}}function v(t,e){var n=f(t);if(n){for(var i=0;i<3;i++)e<0?n[i]=n[i]*(1-e)|0:n[i]=(255-n[i])*e+n[i]|0;return w(n,4===n.length?"rgba":"rgb")}}function y(t){var e=f(t);if(e)return((1<<24)+(e[0]<<16)+(e[1]<<8)+ +e[2]).toString(16).slice(1)}function _(t,e,n){if(e&&e.length&&t>=0&&t<=1){n=n||[];var r=t*(e.length-1),s=Math.floor(r),a=Math.ceil(r),h=e[s],c=e[a],u=r-s;return n[0]=i(l(h[0],c[0],u)),n[1]=i(l(h[1],c[1],u)),n[2]=i(l(h[2],c[2],u)),n[3]=o(l(h[3],c[3],u)),n}}function m(t,e,n){if(e&&e.length&&t>=0&&t<=1){var r=t*(e.length-1),s=Math.floor(r),a=Math.ceil(r),h=f(e[s]),c=f(e[a]),u=r-s,p=w([i(l(h[0],c[0],u)),i(l(h[1],c[1],u)),i(l(h[2],c[2],u)),o(l(h[3],c[3],u))],"rgba");return n?{color:p,leftIndex:s,rightIndex:a,value:r}:p}}function x(t,e,n,i){if(t=f(t))return t=g(t),null!=e&&(t[0]=r(e)),null!=n&&(t[1]=a(n)),null!=i&&(t[2]=a(i)),w(d(t),"rgba")}function b(t,e){if(t=f(t),t&&null!=e)return t[3]=o(e),w(t,"rgba")}function w(t,e){if(t&&t.length){var n=t[0]+","+t[1]+","+t[2];return"rgba"!==e&&"hsva"!==e&&"hsla"!==e||(n+=","+t[3]),e+"("+n+")"}}var P=n(20),C={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]},S=new P(20),T=null,E=_,R=m;e.parse=f,e.lift=v,e.toHex=y,e.fastLerp=_,e.fastMapToColor=E,e.lerp=m,e.mapToColor=R,e.modifyHSL=x,e.modifyAlpha=b,e.stringify=w},function(t,e){var n=function(){this.head=null,this.tail=null,this._len=0},i=n.prototype;i.insert=function(t){var e=new r(t);return this.insertEntry(e),e},i.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},i.remove=function(t){var e=t.prev,n=t.next;e?e.next=n:this.head=n,n?n.prev=e:this.tail=e,t.next=t.prev=null,this._len--},i.len=function(){return this._len},i.clear=function(){this.head=this.tail=null,this._len=0};var r=function(t){this.value=t,this.next,this.prev},o=function(t){this._list=new n,this._map={},this._maxSize=t||10,this._lastRemovedEntry=null},s=o.prototype;s.put=function(t,e){var n=this._list,i=this._map,o=null;if(null==i[t]){var s=n.len(),a=this._lastRemovedEntry;if(s>=this._maxSize&&s>0){var h=n.head;n.remove(h),delete i[h.key],o=h.value,this._lastRemovedEntry=h}a?a.value=e:a=new r(e),a.key=t,n.insertEntry(a),i[t]=a}return o},s.get=function(t){var e=this._map[t],n=this._list;if(null!=e)return e!==n.tail&&(n.remove(e),n.insertEntry(e)),e.value},s.clear=function(){this._list.clear(),this._map={}};var a=o;t.exports=a},function(t,e,n){var i=n(22),r=i.debugMode,o=function(){};1===r?o=function(){for(var t in arguments)throw new Error(arguments[t])}:r>1&&(o=function(){for(var t in arguments)console.log(arguments[t])});var s=o;t.exports=s},function(t,e){var n=1;"undefined"!=typeof window&&(n=Math.max(window.devicePixelRatio||1,1));var i=0,r=n;e.debugMode=i,e.devicePixelRatio=r},function(t,e,n){var i=n(24),r=n(26),o=new r,s=function(){};s.prototype={constructor:s,drawRectText:function(t,e){var n=this.style;e=n.textRect||e,this.__dirty&&i.normalizeTextStyle(n,!0);var r=n.text;if(null!=r&&(r+=""),i.needDrawText(r,n)){t.save();var s=this.transform;n.transformText?this.setTransform(t):s&&(o.copy(e),o.applyTransform(s),e=o),i.renderText(this,t,r,n,e),t.restore()}}};var a=s;t.exports=a},function(t,e,n){function i(t){return r(t),C(t.rich,r),t}function r(t){if(t){t.font=R.makeFont(t);var e=t.textAlign;"middle"===e&&(e="center"),t.textAlign=null==e||M[e]?e:"left";var n=t.textVerticalAlign||t.textBaseline;"center"===n&&(n="middle"),t.textVerticalAlign=null==n||L[n]?n:"top";var i=t.textPadding;i&&(t.textPadding=S(t.textPadding))}}function o(t,e,n,i,r){i.rich?a(t,e,n,i,r):s(t,e,n,i,r)}function s(t,e,n,i,r){var o=g(e,"font",i.font||R.DEFAULT_FONT),s=i.textPadding,a=t.__textCotentBlock;a&&!t.__dirty||(a=t.__textCotentBlock=R.parsePlainText(n,o,s,i.truncate));var h=a.outerHeight,c=a.lines,f=a.lineHeight,_=d(h,i,r),x=_.baseX,b=_.baseY,w=_.textAlign,P=_.textVerticalAlign;l(e,i,r,x,b);var C=R.adjustTextY(b,h,P),S=x,T=C,E=u(i);if(E||s){var k=R.getWidth(n,o),N=k;s&&(N+=s[1]+s[3]);var M=R.adjustTextX(x,N,w);E&&p(t,e,i,M,C,N,h),s&&(S=m(x,w,s),T+=s[0])}g(e,"textAlign",w||"left"),g(e,"textBaseline","middle"),g(e,"shadowBlur",i.textShadowBlur||0),g(e,"shadowColor",i.textShadowColor||"transparent"),g(e,"shadowOffsetX",i.textShadowOffsetX||0),g(e,"shadowOffsetY",i.textShadowOffsetY||0),T+=f/2;var L=i.textStrokeWidth,A=v(i.textStroke,L),O=y(i.textFill);A&&(g(e,"lineWidth",L),g(e,"strokeStyle",A)),O&&g(e,"fillStyle",O);for(var z=0;z<c.length;z++)A&&e.strokeText(c[z],S,T),O&&e.fillText(c[z],S,T),T+=f}function a(t,e,n,i,r){var o=t.__textCotentBlock;o&&!t.__dirty||(o=t.__textCotentBlock=R.parseRichText(n,i)),h(t,e,o,i,r)}function h(t,e,n,i,r){var o=n.width,s=n.outerWidth,a=n.outerHeight,h=i.textPadding,f=d(a,i,r),g=f.baseX,v=f.baseY,y=f.textAlign,_=f.textVerticalAlign;l(e,i,r,g,v);var m=R.adjustTextX(g,s,y),x=R.adjustTextY(v,a,_),b=m,w=x;h&&(b+=h[3],w+=h[0]);var P=b+o;u(i)&&p(t,e,i,m,x,s,a);for(var C=0;C<n.lines.length;C++){for(var S,T=n.lines[C],E=T.tokens,k=E.length,N=T.lineHeight,M=T.width,L=0,A=b,O=P,z=k-1;L<k&&(S=E[L],!S.textAlign||"left"===S.textAlign);)c(t,e,S,i,N,w,A,"left"),M-=S.width,A+=S.width,L++;for(;z>=0&&(S=E[z],"right"===S.textAlign);)c(t,e,S,i,N,w,O,"right"),M-=S.width,O-=S.width,z--;for(A+=(o-(A-b)-(P-O)-M)/2;L<=z;)S=E[L],c(t,e,S,i,N,w,A+S.width/2,"center"),A+=S.width,L++;w+=N}}function l(t,e,n,i,r){if(n&&e.textRotation){var o=e.textOrigin;"center"===o?(i=n.width/2+n.x,r=n.height/2+n.y):o&&(i=o[0]+n.x,r=o[1]+n.y),t.translate(i,r),t.rotate(-e.textRotation),t.translate(-i,-r)}}function c(t,e,n,i,r,o,s,a){var h=i.rich[n.styleName]||{},l=n.textVerticalAlign,c=o+r/2;"top"===l?c=o+n.height/2:"bottom"===l&&(c=o+r-n.height/2),!n.isLineHolder&&u(h)&&p(t,e,h,"right"===a?s-n.width:"center"===a?s-n.width/2:s,c-n.height/2,n.width,n.height);var f=n.textPadding;f&&(s=m(s,a,f),c-=n.height/2-f[2]-n.textHeight/2),
g(e,"shadowBlur",P(h.textShadowBlur,i.textShadowBlur,0)),g(e,"shadowColor",h.textShadowColor||i.textShadowColor||"transparent"),g(e,"shadowOffsetX",P(h.textShadowOffsetX,i.textShadowOffsetX,0)),g(e,"shadowOffsetY",P(h.textShadowOffsetY,i.textShadowOffsetY,0)),g(e,"textAlign",a),g(e,"textBaseline","middle"),g(e,"font",n.font||R.DEFAULT_FONT);var d=v(h.textStroke||i.textStroke,x),_=y(h.textFill||i.textFill),x=w(h.textStrokeWidth,i.textStrokeWidth);d&&(g(e,"lineWidth",x),g(e,"strokeStyle",d),e.strokeText(n.text,s,c)),_&&(g(e,"fillStyle",_),e.fillText(n.text,s,c))}function u(t){return t.textBackgroundColor||t.textBorderWidth&&t.textBorderColor}function p(t,e,n,i,r,o,s){var a=n.textBackgroundColor,h=n.textBorderWidth,l=n.textBorderColor,c=T(a);if(g(e,"shadowBlur",n.textBoxShadowBlur||0),g(e,"shadowColor",n.textBoxShadowColor||"transparent"),g(e,"shadowOffsetX",n.textBoxShadowOffsetX||0),g(e,"shadowOffsetY",n.textBoxShadowOffsetY||0),c||h&&l){e.beginPath();var u=n.textBorderRadius;u?k.buildPath(e,{x:i,y:r,width:o,height:s,r:u}):e.rect(i,r,o,s),e.closePath()}if(c)g(e,"fillStyle",a),e.fill();else if(E(a)){var p=a.image;p=N.createOrUpdateImage(p,null,t,f,a),p&&N.isImageReady(p)&&e.drawImage(p,i,r,o,s)}h&&l&&(g(e,"lineWidth",h),g(e,"strokeStyle",l),e.stroke())}function f(t,e){e.image=t}function d(t,e,n){var i=e.x||0,r=e.y||0,o=e.textAlign,s=e.textVerticalAlign;if(n){var a=e.textPosition;if(a instanceof Array)i=n.x+_(a[0],n.width),r=n.y+_(a[1],n.height);else{var h=R.adjustTextPositionOnRect(a,n,e.textDistance);i=h.x,r=h.y,o=o||h.textAlign,s=s||h.textVerticalAlign}var l=e.textOffset;l&&(i+=l[0],r+=l[1])}return{baseX:i,baseY:r,textAlign:o,textVerticalAlign:s}}function g(t,e,n){return t[e]=n,t[e]}function v(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t}function y(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t}function _(t,e){return"string"==typeof t?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t}function m(t,e,n){return"right"===e?t-n[1]:"center"===e?t+n[3]/2-n[1]/2:t+n[3]}function x(t,e){return null!=t&&(t||e.textBackgroundColor||e.textBorderWidth&&e.textBorderColor||e.textPadding)}var b=n(4),w=b.retrieve2,P=b.retrieve3,C=b.each,S=b.normalizeCssArray,T=b.isString,E=b.isObject,R=n(25),k=n(28),N=n(27),M={left:1,right:1,center:1},L={top:1,bottom:1,middle:1};e.normalizeTextStyle=i,e.renderText=o,e.getStroke=v,e.getFill=y,e.needDrawText=x},function(t,e,n){function i(t,e){A[t]=e}function r(t,e){e=e||L;var n=t+":"+e;if(R[n])return R[n];for(var i=(t+"").split("\n"),r=0,o=0,s=i.length;o<s;o++)r=Math.max(v(i[o],e).width,r);return k>N&&(k=0,R={}),k++,R[n]=r,r}function o(t,e,n,i,r,o,h){return o?a(t,e,n,i,r,o,h):s(t,e,n,i,r,h)}function s(t,e,n,i,o,s){var a=y(t,e,o,s),c=r(t,e);o&&(c+=o[1]+o[3]);var u=a.outerHeight,p=h(0,c,n),f=l(0,u,i),d=new b(p,f,c,u);return d.lineHeight=a.lineHeight,d}function a(t,e,n,i,r,o,s){var a=_(t,{rich:o,truncate:s,font:e,textAlign:n,textPadding:r}),c=a.outerWidth,u=a.outerHeight,p=h(0,c,n),f=l(0,u,i);return new b(p,f,c,u)}function h(t,e,n){return"right"===n?t-=e:"center"===n&&(t-=e/2),t}function l(t,e,n){return"middle"===n?t-=e/2:"bottom"===n&&(t-=e),t}function c(t,e,n){var i=e.x,r=e.y,o=e.height,s=e.width,a=o/2,h="left",l="top";switch(t){case"left":i-=n,r+=a,h="right",l="middle";break;case"right":i+=n+s,r+=a,l="middle";break;case"top":i+=s/2,r-=n,h="center",l="bottom";break;case"bottom":i+=s/2,r+=o+n,h="center";break;case"inside":i+=s/2,r+=a,h="center",l="middle";break;case"insideLeft":i+=n,r+=a,l="middle";break;case"insideRight":i+=s-n,r+=a,h="right",l="middle";break;case"insideTop":i+=s/2,r+=n,h="center";break;case"insideBottom":i+=s/2,r+=o-n,h="center",l="bottom";break;case"insideTopLeft":i+=n,r+=n;break;case"insideTopRight":i+=s-n,r+=n,h="right";break;case"insideBottomLeft":i+=n,r+=o-n,l="bottom";break;case"insideBottomRight":i+=s-n,r+=o-n,h="right",l="bottom"}return{x:i,y:r,textAlign:h,textVerticalAlign:l}}function u(t,e,n,i,r){if(!e)return"";var o=(t+"").split("\n");r=p(e,n,i,r);for(var s=0,a=o.length;s<a;s++)o[s]=f(o[s],r);return o.join("\n")}function p(t,e,n,i){i=S({},i),i.font=e;var n=T(n,"...");i.maxIterations=T(i.maxIterations,2);var o=i.minChar=T(i.minChar,0);i.cnCharWidth=r("",e);var s=i.ascCharWidth=r("a",e);i.placeholder=T(i.placeholder,"");for(var a=t=Math.max(0,t-1),h=0;h<o&&a>=s;h++)a-=s;var l=r(n);return l>a&&(n="",l=0),a=t-l,i.ellipsis=n,i.ellipsisWidth=l,i.contentWidth=a,i.containerWidth=t,i}function f(t,e){var n=e.containerWidth,i=e.font,o=e.contentWidth;if(!n)return"";var s=r(t,i);if(s<=n)return t;for(var a=0;;a++){if(s<=o||a>=e.maxIterations){t+=e.ellipsis;break}var h=0===a?d(t,o,e.ascCharWidth,e.cnCharWidth):s>0?Math.floor(t.length*o/s):0;t=t.substr(0,h),s=r(t,i)}return""===t&&(t=e.placeholder),t}function d(t,e,n,i){for(var r=0,o=0,s=t.length;o<s&&r<e;o++){var a=t.charCodeAt(o);r+=0<=a&&a<=127?n:i}return o}function g(t){return r("",t)}function v(t,e){return A.measureText(t,e)}function y(t,e,n,i){null!=t&&(t+="");var r=g(e),o=t?t.split("\n"):[],s=o.length*r,a=s;if(n&&(a+=n[0]+n[2]),t&&i){var h=i.outerHeight,l=i.outerWidth;if(null!=h&&a>h)t="",o=[];else if(null!=l)for(var c=p(l-(n?n[1]+n[3]:0),e,i.ellipsis,{minChar:i.minChar,placeholder:i.placeholder}),u=0,d=o.length;u<d;u++)o[u]=f(o[u],c)}return{lines:o,height:s,outerHeight:a,lineHeight:r}}function _(t,e){var n={lines:[],width:0,height:0};if(null!=t&&(t+=""),!t)return n;for(var i,o=M.lastIndex=0;null!=(i=M.exec(t));){var s=i.index;s>o&&m(n,t.substring(o,s)),m(n,i[2],i[1]),o=M.lastIndex}o<t.length&&m(n,t.substring(o,t.length));var a=n.lines,h=0,l=0,c=[],p=e.textPadding,f=e.truncate,d=f&&f.outerWidth,v=f&&f.outerHeight;p&&(null!=d&&(d-=p[1]+p[3]),null!=v&&(v-=p[0]+p[2]));for(var y=0;y<a.length;y++){for(var _=a[y],x=0,b=0,P=0;P<_.tokens.length;P++){var C=_.tokens[P],S=C.styleName&&e.rich[C.styleName]||{},R=C.textPadding=S.textPadding,k=C.font=S.font||e.font,N=C.textHeight=T(S.textHeight,g(k));if(R&&(N+=R[0]+R[2]),C.height=N,C.lineHeight=E(S.textLineHeight,e.textLineHeight,N),C.textAlign=S&&S.textAlign||e.textAlign,C.textVerticalAlign=S&&S.textVerticalAlign||"middle",null!=v&&h+C.lineHeight>v)return{lines:[],width:0,height:0};C.textWidth=r(C.text,k);var L=S.textWidth,A=null==L||"auto"===L;if("string"==typeof L&&"%"===L.charAt(L.length-1))C.percentWidth=L,c.push(C),L=0;else{if(A){L=C.textWidth;var O=S.textBackgroundColor,z=O&&O.image;z&&(z=w.findExistImage(z),w.isImageReady(z)&&(L=Math.max(L,z.width*N/z.height)))}var F=R?R[1]+R[3]:0;L+=F;var I=null!=d?d-b:null;null!=I&&I<L&&(!A||I<F?(C.text="",C.textWidth=L=0):(C.text=u(C.text,I-F,k,f.ellipsis,{minChar:f.minChar}),C.textWidth=r(C.text,k),L=C.textWidth+F))}b+=C.width=L,S&&(x=Math.max(x,C.lineHeight))}_.width=b,_.lineHeight=x,h+=x,l=Math.max(l,b)}n.outerWidth=n.width=T(e.textWidth,l),n.outerHeight=n.height=T(e.textHeight,h),p&&(n.outerWidth+=p[1]+p[3],n.outerHeight+=p[0]+p[2]);for(var y=0;y<c.length;y++){var C=c[y],B=C.percentWidth;C.width=parseInt(B,10)/100*l}return n}function m(t,e,n){for(var i=""===e,r=e.split("\n"),o=t.lines,s=0;s<r.length;s++){var a=r[s],h={styleName:n,text:a,isLineHolder:!a&&!i};if(s)o.push({tokens:[h]});else{var l=(o[o.length-1]||(o[0]={tokens:[]})).tokens,c=l.length;1===c&&l[0].isLineHolder?l[0]=h:(a||!c||i)&&l.push(h)}}}function x(t){return(t.fontSize||t.fontFamily)&&[t.fontStyle,t.fontWeight,(t.fontSize||12)+"px",t.fontFamily||"sans-serif"].join(" ")||t.textFont||t.font}var b=n(26),w=n(27),P=n(4),C=P.getContext,S=P.extend,T=P.retrieve2,E=P.retrieve3,R={},k=0,N=5e3,M=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,L="12px sans-serif",A={};A.measureText=function(t,e){var n=C();return n.font=e||L,n.measureText(t)},e.DEFAULT_FONT=L,e.$override=i,e.getWidth=r,e.getBoundingRect=o,e.adjustTextX=h,e.adjustTextY=l,e.adjustTextPositionOnRect=c,e.truncateText=u,e.getLineHeight=g,e.measureText=v,e.parsePlainText=y,e.parseRichText=_,e.makeFont=x},function(t,e,n){function i(t,e,n,i){n<0&&(t+=n,n=-n),i<0&&(e+=i,i=-i),this.x=t,this.y=e,this.width=n,this.height=i}var r=n(14),o=n(13),s=r.applyTransform,a=Math.min,h=Math.max;i.prototype={constructor:i,union:function(t){var e=a(t.x,this.x),n=a(t.y,this.y);this.width=h(t.x+t.width,this.x+this.width)-e,this.height=h(t.y+t.height,this.y+this.height)-n,this.x=e,this.y=n},applyTransform:function(){var t=[],e=[],n=[],i=[];return function(r){if(r){t[0]=n[0]=this.x,t[1]=i[1]=this.y,e[0]=i[0]=this.x+this.width,e[1]=n[1]=this.y+this.height,s(t,t,r),s(e,e,r),s(n,n,r),s(i,i,r),this.x=a(t[0],e[0],n[0],i[0]),this.y=a(t[1],e[1],n[1],i[1]);var o=h(t[0],e[0],n[0],i[0]),l=h(t[1],e[1],n[1],i[1]);this.width=o-this.x,this.height=l-this.y}}}(),calculateTransform:function(t){var e=this,n=t.width/e.width,i=t.height/e.height,r=o.create();return o.translate(r,r,[-e.x,-e.y]),o.scale(r,r,[n,i]),o.translate(r,r,[t.x,t.y]),r},intersect:function(t){if(!t)return!1;t instanceof i||(t=i.create(t));var e=this,n=e.x,r=e.x+e.width,o=e.y,s=e.y+e.height,a=t.x,h=t.x+t.width,l=t.y,c=t.y+t.height;return!(r<a||h<n||s<l||c<o)},contain:function(t,e){var n=this;return t>=n.x&&t<=n.x+n.width&&e>=n.y&&e<=n.y+n.height},clone:function(){return new i(this.x,this.y,this.width,this.height)},copy:function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},i.create=function(t){return new i(t.x,t.y,t.width,t.height)};var l=i;t.exports=l},function(t,e,n){function i(t){if("string"==typeof t){var e=h.get(t);return e&&e.image}return t}function r(t,e,n,i,r){if(t){if("string"==typeof t){if(e&&e.__zrImageSrc===t||!n)return e;var a=h.get(t),l={hostEl:n,cb:i,cbPayload:r};return a?(e=a.image,!s(e)&&a.pending.push(l)):(!e&&(e=new Image),e.onload=o,h.put(t,e.__cachedImgObj={image:e,pending:[l]}),e.src=e.__zrImageSrc=t),e}return t}return e}function o(){var t=this.__cachedImgObj;this.onload=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var n=t.pending[e],i=n.cb;i&&i(this,n.cbPayload),n.hostEl.dirty()}t.pending.length=0}function s(t){return t&&t.width&&t.height}var a=n(20),h=new a(50);e.findExistImage=i,e.createOrUpdateImage=r,e.isImageReady=s},function(t,e){function n(t,e){var n,i,r,o,s=e.x,a=e.y,h=e.width,l=e.height,c=e.r;h<0&&(s+=h,h=-h),l<0&&(a+=l,l=-l),"number"==typeof c?n=i=r=o=c:c instanceof Array?1===c.length?n=i=r=o=c[0]:2===c.length?(n=r=c[0],i=o=c[1]):3===c.length?(n=c[0],i=o=c[1],r=c[2]):(n=c[0],i=c[1],r=c[2],o=c[3]):n=i=r=o=0;var u;n+i>h&&(u=n+i,n*=h/u,i*=h/u),r+o>h&&(u=r+o,r*=h/u,o*=h/u),i+r>l&&(u=i+r,i*=l/u,r*=l/u),n+o>l&&(u=n+o,n*=l/u,o*=l/u),t.moveTo(s+n,a),t.lineTo(s+h-i,a),0!==i&&t.quadraticCurveTo(s+h,a,s+h,a+i),t.lineTo(s+h,a+l-r),0!==r&&t.quadraticCurveTo(s+h,a+l,s+h-r,a+l),t.lineTo(s+o,a+l),0!==o&&t.quadraticCurveTo(s,a+l,s,a+l-o),t.lineTo(s,a+n),0!==n&&t.quadraticCurveTo(s,a,s+n,a)}e.buildPath=n},function(t,e,n){var i=n(30),r=n(14),o=n(31),s=n(26),a=n(22),h=a.devicePixelRatio,l={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},c=[],u=[],p=[],f=[],d=Math.min,g=Math.max,v=Math.cos,y=Math.sin,_=Math.sqrt,m=Math.abs,x="undefined"!=typeof Float32Array,b=function(t){this._saveData=!t,this._saveData&&(this.data=[]),this._ctx=null};b.prototype={constructor:b,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function(t,e){this._ux=m(1/h/t)||0,this._uy=m(1/h/e)||0},getContext:function(){return this._ctx},beginPath:function(t){return this._ctx=t,t&&t.beginPath(),t&&(this.dpr=t.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(t,e){return this.addData(l.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},lineTo:function(t,e){var n=m(t-this._xi)>this._ux||m(e-this._yi)>this._uy||this._len<5;return this.addData(l.L,t,e),this._ctx&&n&&(this._needsDash()?this._dashedLineTo(t,e):this._ctx.lineTo(t,e)),n&&(this._xi=t,this._yi=e),this},bezierCurveTo:function(t,e,n,i,r,o){return this.addData(l.C,t,e,n,i,r,o),this._ctx&&(this._needsDash()?this._dashedBezierTo(t,e,n,i,r,o):this._ctx.bezierCurveTo(t,e,n,i,r,o)),this._xi=r,this._yi=o,this},quadraticCurveTo:function(t,e,n,i){return this.addData(l.Q,t,e,n,i),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(t,e,n,i):this._ctx.quadraticCurveTo(t,e,n,i)),this._xi=n,this._yi=i,this},arc:function(t,e,n,i,r,o){return this.addData(l.A,t,e,n,n,i,r-i,0,o?0:1),this._ctx&&this._ctx.arc(t,e,n,i,r,o),this._xi=v(r)*n+t,this._yi=y(r)*n+t,this},arcTo:function(t,e,n,i,r){return this._ctx&&this._ctx.arcTo(t,e,n,i,r),this},rect:function(t,e,n,i){return this._ctx&&this._ctx.rect(t,e,n,i),this.addData(l.R,t,e,n,i),this},closePath:function(){this.addData(l.Z);var t=this._ctx,e=this._x0,n=this._y0;return t&&(this._needsDash()&&this._dashedLineTo(e,n),t.closePath()),this._xi=e,this._yi=n,this},fill:function(t){t&&t.fill(),this.toStatic()},stroke:function(t){t&&t.stroke(),this.toStatic()},setLineDash:function(t){if(t instanceof Array){this._lineDash=t,this._dashIdx=0;for(var e=0,n=0;n<t.length;n++)e+=t[n];this._dashSum=e}return this},setLineDashOffset:function(t){return this._dashOffset=t,this},len:function(){return this._len},setData:function(t){var e=t.length;this.data&&this.data.length==e||!x||(this.data=new Float32Array(e));for(var n=0;n<e;n++)this.data[n]=t[n];this._len=e},appendPath:function(t){t instanceof Array||(t=[t]);for(var e=t.length,n=0,i=this._len,r=0;r<e;r++)n+=t[r].len();x&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n));for(var r=0;r<e;r++)for(var o=t[r].data,s=0;s<o.length;s++)this.data[i++]=o[s];this._len=i},addData:function(t){if(this._saveData){var e=this.data;this._len+arguments.length>e.length&&(this._expandData(),e=this.data);for(var n=0;n<arguments.length;n++)e[this._len++]=arguments[n];this._prevCmd=t}},_expandData:function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}},_needsDash:function(){return this._lineDash},_dashedLineTo:function(t,e){var n,i,r=this._dashSum,o=this._dashOffset,s=this._lineDash,a=this._ctx,h=this._xi,l=this._yi,c=t-h,u=e-l,p=_(c*c+u*u),f=h,v=l,y=s.length;for(c/=p,u/=p,o<0&&(o=r+o),o%=r,f-=o*c,v-=o*u;c>0&&f<=t||c<0&&f>=t||0==c&&(u>0&&v<=e||u<0&&v>=e);)i=this._dashIdx,n=s[i],f+=c*n,v+=u*n,this._dashIdx=(i+1)%y,c>0&&f<h||c<0&&f>h||u>0&&v<l||u<0&&v>l||a[i%2?"moveTo":"lineTo"](c>=0?d(f,t):g(f,t),u>=0?d(v,e):g(v,e));c=f-t,u=v-e,this._dashOffset=-_(c*c+u*u)},_dashedBezierTo:function(t,e,n,r,o,s){var a,h,l,c,u,p=this._dashSum,f=this._dashOffset,d=this._lineDash,g=this._ctx,v=this._xi,y=this._yi,m=i.cubicAt,x=0,b=this._dashIdx,w=d.length,P=0;for(f<0&&(f=p+f),f%=p,a=0;a<1;a+=.1)h=m(v,t,n,o,a+.1)-m(v,t,n,o,a),l=m(y,e,r,s,a+.1)-m(y,e,r,s,a),x+=_(h*h+l*l);for(;b<w&&(P+=d[b],!(P>f));b++);for(a=(P-f)/x;a<=1;)c=m(v,t,n,o,a),u=m(y,e,r,s,a),b%2?g.moveTo(c,u):g.lineTo(c,u),a+=d[b]/x,b=(b+1)%w;b%2!==0&&g.lineTo(o,s),h=o-c,l=s-u,this._dashOffset=-_(h*h+l*l)},_dashedQuadraticTo:function(t,e,n,i){var r=n,o=i;n=(n+2*t)/3,i=(i+2*e)/3,t=(this._xi+2*t)/3,e=(this._yi+2*e)/3,this._dashedBezierTo(t,e,n,i,r,o)},toStatic:function(){var t=this.data;t instanceof Array&&(t.length=this._len,x&&(this.data=new Float32Array(t)))},getBoundingRect:function(){c[0]=c[1]=p[0]=p[1]=Number.MAX_VALUE,u[0]=u[1]=f[0]=f[1]=-Number.MAX_VALUE;for(var t=this.data,e=0,n=0,i=0,a=0,h=0;h<t.length;){var d=t[h++];switch(1==h&&(e=t[h],n=t[h+1],i=e,a=n),d){case l.M:i=t[h++],a=t[h++],e=i,n=a,p[0]=i,p[1]=a,f[0]=i,f[1]=a;break;case l.L:o.fromLine(e,n,t[h],t[h+1],p,f),e=t[h++],n=t[h++];break;case l.C:o.fromCubic(e,n,t[h++],t[h++],t[h++],t[h++],t[h],t[h+1],p,f),e=t[h++],n=t[h++];break;case l.Q:o.fromQuadratic(e,n,t[h++],t[h++],t[h],t[h+1],p,f),e=t[h++],n=t[h++];break;case l.A:var g=t[h++],_=t[h++],m=t[h++],x=t[h++],b=t[h++],w=t[h++]+b,P=(t[h++],1-t[h++]);1==h&&(i=v(b)*m+g,a=y(b)*x+_),o.fromArc(g,_,m,x,b,w,P,p,f),e=v(w)*m+g,n=y(w)*x+_;break;case l.R:i=e=t[h++],a=n=t[h++];var C=t[h++],S=t[h++];o.fromLine(i,a,i+C,a+S,p,f);break;case l.Z:e=i,n=a}r.min(c,c,p),r.max(u,u,f)}return 0===h&&(c[0]=c[1]=u[0]=u[1]=0),new s(c[0],c[1],u[0]-c[0],u[1]-c[1])},rebuildPath:function(t){for(var e,n,i,r,o,s,a=this.data,h=this._ux,c=this._uy,u=this._len,p=0;p<u;){var f=a[p++];switch(1==p&&(i=a[p],r=a[p+1],e=i,n=r),f){case l.M:e=i=a[p++],n=r=a[p++],t.moveTo(i,r);break;case l.L:o=a[p++],s=a[p++],(m(o-i)>h||m(s-r)>c||p===u-1)&&(t.lineTo(o,s),i=o,r=s);break;case l.C:t.bezierCurveTo(a[p++],a[p++],a[p++],a[p++],a[p++],a[p++]),i=a[p-2],r=a[p-1];break;case l.Q:t.quadraticCurveTo(a[p++],a[p++],a[p++],a[p++]),i=a[p-2],r=a[p-1];break;case l.A:var d=a[p++],g=a[p++],_=a[p++],x=a[p++],b=a[p++],w=a[p++],P=a[p++],C=a[p++],S=_>x?_:x,T=_>x?1:_/x,E=_>x?x/_:1,R=Math.abs(_-x)>.001,k=b+w;R?(t.translate(d,g),t.rotate(P),t.scale(T,E),t.arc(0,0,S,b,k,1-C),t.scale(1/T,1/E),t.rotate(-P),t.translate(-d,-g)):t.arc(d,g,S,b,k,1-C),1==p&&(e=v(b)*_+d,n=y(b)*x+g),i=v(k)*_+d,r=y(k)*x+g;break;case l.R:e=i=a[p],n=r=a[p+1],t.rect(a[p++],a[p++],a[p++],a[p++]);break;case l.Z:t.closePath(),i=e,r=n}}}},b.CMD=l;var w=b;t.exports=w},function(t,e,n){function i(t){return t>-w&&t<w}function r(t){return t>w||t<-w}function o(t,e,n,i,r){var o=1-r;return o*o*(o*t+3*r*e)+r*r*(r*i+3*o*n)}function s(t,e,n,i,r){var o=1-r;return 3*(((e-t)*o+2*(n-e)*r)*o+(i-n)*r*r)}function a(t,e,n,r,o,s){var a=r+3*(e-n)-t,h=3*(n-2*e+t),l=3*(e-t),c=t-o,u=h*h-3*a*l,p=h*l-9*a*c,f=l*l-3*h*c,d=0;if(i(u)&&i(p))if(i(h))s[0]=0;else{var g=-l/h;g>=0&&g<=1&&(s[d++]=g)}else{var v=p*p-4*u*f;if(i(v)){var y=p/u,g=-h/a+y,_=-y/2;g>=0&&g<=1&&(s[d++]=g),_>=0&&_<=1&&(s[d++]=_)}else if(v>0){var m=b(v),w=u*h+1.5*a*(-p+m),P=u*h+1.5*a*(-p-m);w=w<0?-x(-w,S):x(w,S),P=P<0?-x(-P,S):x(P,S);var g=(-h-(w+P))/(3*a);g>=0&&g<=1&&(s[d++]=g)}else{var T=(2*u*h-3*a*p)/(2*b(u*u*u)),E=Math.acos(T)/3,R=b(u),k=Math.cos(E),g=(-h-2*R*k)/(3*a),_=(-h+R*(k+C*Math.sin(E)))/(3*a),N=(-h+R*(k-C*Math.sin(E)))/(3*a);g>=0&&g<=1&&(s[d++]=g),_>=0&&_<=1&&(s[d++]=_),N>=0&&N<=1&&(s[d++]=N)}}return d}function h(t,e,n,o,s){var a=6*n-12*e+6*t,h=9*e+3*o-3*t-9*n,l=3*e-3*t,c=0;if(i(h)){if(r(a)){var u=-l/a;u>=0&&u<=1&&(s[c++]=u)}}else{var p=a*a-4*h*l;if(i(p))s[0]=-a/(2*h);else if(p>0){var f=b(p),u=(-a+f)/(2*h),d=(-a-f)/(2*h);u>=0&&u<=1&&(s[c++]=u),d>=0&&d<=1&&(s[c++]=d)}}return c}function l(t,e,n,i,r,o){var s=(e-t)*r+t,a=(n-e)*r+e,h=(i-n)*r+n,l=(a-s)*r+s,c=(h-a)*r+a,u=(c-l)*r+l;o[0]=t,o[1]=s,o[2]=l,o[3]=u,o[4]=u,o[5]=c,o[6]=h,o[7]=i}function c(t,e,n,i,r,s,a,h,l,c,u){var p,f,d,g,v,y=.005,_=1/0;T[0]=l,T[1]=c;for(var x=0;x<1;x+=.05)E[0]=o(t,n,r,a,x),E[1]=o(e,i,s,h,x),g=m(T,E),g<_&&(p=x,_=g);_=1/0;for(var w=0;w<32&&!(y<P);w++)f=p-y,d=p+y,E[0]=o(t,n,r,a,f),E[1]=o(e,i,s,h,f),g=m(E,T),f>=0&&g<_?(p=f,_=g):(R[0]=o(t,n,r,a,d),R[1]=o(e,i,s,h,d),v=m(R,T),d<=1&&v<_?(p=d,_=v):y*=.5);return u&&(u[0]=o(t,n,r,a,p),u[1]=o(e,i,s,h,p)),b(_)}function u(t,e,n,i){var r=1-i;return r*(r*t+2*i*e)+i*i*n}function p(t,e,n,i){return 2*((1-i)*(e-t)+i*(n-e))}function f(t,e,n,o,s){var a=t-2*e+n,h=2*(e-t),l=t-o,c=0;if(i(a)){if(r(h)){var u=-l/h;u>=0&&u<=1&&(s[c++]=u)}}else{var p=h*h-4*a*l;if(i(p)){var u=-h/(2*a);u>=0&&u<=1&&(s[c++]=u)}else if(p>0){var f=b(p),u=(-h+f)/(2*a),d=(-h-f)/(2*a);u>=0&&u<=1&&(s[c++]=u),d>=0&&d<=1&&(s[c++]=d)}}return c}function d(t,e,n){var i=t+n-2*e;return 0===i?.5:(t-e)/i}function g(t,e,n,i,r){var o=(e-t)*i+t,s=(n-e)*i+e,a=(s-o)*i+o;r[0]=t,r[1]=o,r[2]=a,r[3]=a,r[4]=s,r[5]=n}function v(t,e,n,i,r,o,s,a,h){var l,c=.005,p=1/0;T[0]=s,T[1]=a;for(var f=0;f<1;f+=.05){E[0]=u(t,n,r,f),E[1]=u(e,i,o,f);var d=m(T,E);d<p&&(l=f,p=d)}p=1/0;for(var g=0;g<32&&!(c<P);g++){var v=l-c,y=l+c;E[0]=u(t,n,r,v),E[1]=u(e,i,o,v);var d=m(E,T);if(v>=0&&d<p)l=v,p=d;else{R[0]=u(t,n,r,y),R[1]=u(e,i,o,y);var _=m(R,T);y<=1&&_<p?(l=y,p=_):c*=.5}}return h&&(h[0]=u(t,n,r,l),h[1]=u(e,i,o,l)),b(p)}var y=n(14),_=y.create,m=y.distSquare,x=Math.pow,b=Math.sqrt,w=1e-8,P=1e-4,C=b(3),S=1/3,T=_(),E=_(),R=_();e.cubicAt=o,e.cubicDerivativeAt=s,e.cubicRootAt=a,e.cubicExtrema=h,e.cubicSubdivide=l,e.cubicProjectPoint=c,e.quadraticAt=u,e.quadraticDerivativeAt=p,e.quadraticRootAt=f,e.quadraticExtremum=d,e.quadraticSubdivide=g,e.quadraticProjectPoint=v},function(t,e,n){function i(t,e,n){if(0!==t.length){var i,r=t[0],o=r[0],s=r[0],a=r[1],h=r[1];for(i=1;i<t.length;i++)r=t[i],o=c(o,r[0]),s=u(s,r[0]),a=c(a,r[1]),h=u(h,r[1]);e[0]=o,e[1]=a,n[0]=s,n[1]=h}}function r(t,e,n,i,r,o){r[0]=c(t,n),r[1]=c(e,i),o[0]=u(t,n),o[1]=u(e,i)}function o(t,e,n,i,r,o,s,a,h,p){var f,d=l.cubicExtrema,g=l.cubicAt,v=d(t,n,r,s,_);for(h[0]=1/0,h[1]=1/0,p[0]=-(1/0),p[1]=-(1/0),f=0;f<v;f++){var y=g(t,n,r,s,_[f]);h[0]=c(y,h[0]),p[0]=u(y,p[0])}for(v=d(e,i,o,a,m),f=0;f<v;f++){var x=g(e,i,o,a,m[f]);h[1]=c(x,h[1]),p[1]=u(x,p[1])}h[0]=c(t,h[0]),p[0]=u(t,p[0]),h[0]=c(s,h[0]),p[0]=u(s,p[0]),h[1]=c(e,h[1]),p[1]=u(e,p[1]),h[1]=c(a,h[1]),p[1]=u(a,p[1])}function s(t,e,n,i,r,o,s,a){var h=l.quadraticExtremum,p=l.quadraticAt,f=u(c(h(t,n,r),1),0),d=u(c(h(e,i,o),1),0),g=p(t,n,r,f),v=p(e,i,o,d);s[0]=c(t,r,g),s[1]=c(e,o,v),a[0]=u(t,r,g),a[1]=u(e,o,v)}function a(t,e,n,i,r,o,s,a,l){var c=h.min,u=h.max,_=Math.abs(r-o);if(_%d<1e-4&&_>1e-4)return a[0]=t-n,a[1]=e-i,l[0]=t+n,void(l[1]=e+i);if(g[0]=f(r)*n+t,g[1]=p(r)*i+e,v[0]=f(o)*n+t,v[1]=p(o)*i+e,c(a,g,v),u(l,g,v),r%=d,r<0&&(r+=d),o%=d,o<0&&(o+=d),r>o&&!s?o+=d:r<o&&s&&(r+=d),s){var m=o;o=r,r=m}for(var x=0;x<o;x+=Math.PI/2)x>r&&(y[0]=f(x)*n+t,y[1]=p(x)*i+e,c(a,y,a),u(l,y,l))}var h=n(14),l=n(30),c=Math.min,u=Math.max,p=Math.sin,f=Math.cos,d=2*Math.PI,g=h.create(),v=h.create(),y=h.create(),_=[],m=[];e.fromPoints=i,e.fromLine=r,e.fromCubic=o,e.fromQuadratic=s,e.fromArc=a},function(t,e,n){function i(t,e){return Math.abs(t-e)<w}function r(){var t=C[0];C[0]=C[1],C[1]=t}function o(t,e,n,i,o,s,a,h,l,c){if(c>e&&c>i&&c>s&&c>h||c<e&&c<i&&c<s&&c<h)return 0;var u=_.cubicRootAt(e,i,s,h,c,P);if(0===u)return 0;for(var p,f,d=0,g=-1,v=0;v<u;v++){var y=P[v],m=0===y||1===y?.5:1,x=_.cubicAt(t,n,o,a,y);x<l||(g<0&&(g=_.cubicExtrema(e,i,s,h,C),C[1]<C[0]&&g>1&&r(),p=_.cubicAt(e,i,s,h,C[0]),g>1&&(f=_.cubicAt(e,i,s,h,C[1]))),d+=2==g?y<C[0]?p<e?m:-m:y<C[1]?f<p?m:-m:h<f?m:-m:y<C[0]?p<e?m:-m:h<p?m:-m)}return d}function s(t,e,n,i,r,o,s,a){if(a>e&&a>i&&a>o||a<e&&a<i&&a<o)return 0;var h=_.quadraticRootAt(e,i,o,a,P);if(0===h)return 0;var l=_.quadraticExtremum(e,i,o);if(l>=0&&l<=1){for(var c=0,u=_.quadraticAt(e,i,o,l),p=0;p<h;p++){var f=0===P[p]||1===P[p]?.5:1,d=_.quadraticAt(t,n,r,P[p]);d<s||(c+=P[p]<l?u<e?f:-f:o<u?f:-f)}return c}var f=0===P[0]||1===P[0]?.5:1,d=_.quadraticAt(t,n,r,P[0]);return d<s?0:o<e?f:-f}function a(t,e,n,i,r,o,s,a){if(a-=e,a>n||a<-n)return 0;var h=Math.sqrt(n*n-a*a);P[0]=-h,P[1]=h;var l=Math.abs(i-r);if(l<1e-4)return 0;if(l%b<1e-4){i=0,r=b;var c=o?1:-1;return s>=P[0]+t&&s<=P[1]+t?c:0}if(o){var h=i;i=y(r),r=y(h)}else i=y(i),r=y(r);i>r&&(r+=b);for(var u=0,p=0;p<2;p++){var f=P[p];if(f+t>s){var d=Math.atan2(a,f),c=o?1:-1;d<0&&(d=b+d),(d>=i&&d<=r||d+b>=i&&d+b<=r)&&(d>Math.PI/2&&d<1.5*Math.PI&&(c=-c),u+=c)}}return u}function h(t,e,n,r,h){for(var l=0,c=0,u=0,v=0,y=0,_=0;_<t.length;){var b=t[_++];switch(b===x.M&&_>1&&(n||(l+=m(c,u,v,y,r,h))),1==_&&(c=t[_],u=t[_+1],v=c,y=u),b){case x.M:v=t[_++],y=t[_++],c=v,u=y;break;case x.L:if(n){if(p.containStroke(c,u,t[_],t[_+1],e,r,h))return!0}else l+=m(c,u,t[_],t[_+1],r,h)||0;c=t[_++],u=t[_++];break;case x.C:if(n){if(f.containStroke(c,u,t[_++],t[_++],t[_++],t[_++],t[_],t[_+1],e,r,h))return!0}else l+=o(c,u,t[_++],t[_++],t[_++],t[_++],t[_],t[_+1],r,h)||0;c=t[_++],u=t[_++];break;case x.Q:if(n){if(d.containStroke(c,u,t[_++],t[_++],t[_],t[_+1],e,r,h))return!0}else l+=s(c,u,t[_++],t[_++],t[_],t[_+1],r,h)||0;c=t[_++],u=t[_++];break;case x.A:var w=t[_++],P=t[_++],C=t[_++],S=t[_++],T=t[_++],E=t[_++],R=(t[_++],1-t[_++]),k=Math.cos(T)*C+w,N=Math.sin(T)*S+P;_>1?l+=m(c,u,k,N,r,h):(v=k,y=N);var M=(r-w)*S/C+w;if(n){if(g.containStroke(w,P,S,T,T+E,R,e,M,h))return!0}else l+=a(w,P,S,T,T+E,R,M,h);c=Math.cos(T+E)*C+w,u=Math.sin(T+E)*S+P;break;case x.R:v=c=t[_++],y=u=t[_++];var L=t[_++],A=t[_++],k=v+L,N=y+A;if(n){if(p.containStroke(v,y,k,y,e,r,h)||p.containStroke(k,y,k,N,e,r,h)||p.containStroke(k,N,v,N,e,r,h)||p.containStroke(v,N,v,y,e,r,h))return!0}else l+=m(k,y,k,N,r,h),l+=m(v,N,v,y,r,h);break;case x.Z:if(n){if(p.containStroke(c,u,v,y,e,r,h))return!0}else l+=m(c,u,v,y,r,h);c=v,u=y}}return n||i(u,y)||(l+=m(c,u,v,y,r,h)||0),0!==l}function l(t,e,n){return h(t,0,!1,e,n)}function c(t,e,n,i){return h(t,e,!0,n,i)}var u=n(29),p=n(33),f=n(34),d=n(35),g=n(36),v=n(37),y=v.normalizeRadian,_=n(30),m=n(38),x=u.CMD,b=2*Math.PI,w=1e-4,P=[-1,-1,-1],C=[-1,-1];e.contain=l,e.containStroke=c},function(t,e){function n(t,e,n,i,r,o,s){if(0===r)return!1;var a=r,h=0,l=t;if(s>e+a&&s>i+a||s<e-a&&s<i-a||o>t+a&&o>n+a||o<t-a&&o<n-a)return!1;if(t===n)return Math.abs(o-t)<=a/2;h=(e-i)/(t-n),l=(t*i-n*e)/(t-n);var c=h*o-s+l,u=c*c/(h*h+1);return u<=a/2*a/2}e.containStroke=n},function(t,e,n){function i(t,e,n,i,o,s,a,h,l,c,u){if(0===l)return!1;var p=l;if(u>e+p&&u>i+p&&u>s+p&&u>h+p||u<e-p&&u<i-p&&u<s-p&&u<h-p||c>t+p&&c>n+p&&c>o+p&&c>a+p||c<t-p&&c<n-p&&c<o-p&&c<a-p)return!1;var f=r.cubicProjectPoint(t,e,n,i,o,s,a,h,c,u,null);return f<=p/2}var r=n(30);e.containStroke=i},function(t,e,n){function i(t,e,n,i,r,s,a,h,l){if(0===a)return!1;var c=a;if(l>e+c&&l>i+c&&l>s+c||l<e-c&&l<i-c&&l<s-c||h>t+c&&h>n+c&&h>r+c||h<t-c&&h<n-c&&h<r-c)return!1;var u=o(t,e,n,i,r,s,h,l,null);return u<=c/2}var r=n(30),o=r.quadraticProjectPoint;e.containStroke=i},function(t,e,n){function i(t,e,n,i,r,a,h,l,c){if(0===h)return!1;var u=h;l-=t,c-=e;var p=Math.sqrt(l*l+c*c);if(p-u>n||p+u<n)return!1;if(Math.abs(i-r)%s<1e-4)return!0;if(a){var f=i;i=o(r),r=o(f)}else i=o(i),r=o(r);i>r&&(r+=s);var d=Math.atan2(c,l);return d<0&&(d+=s),d>=i&&d<=r||d+s>=i&&d+s<=r}var r=n(37),o=r.normalizeRadian,s=2*Math.PI;e.containStroke=i},function(t,e){function n(t){return t%=i,t<0&&(t+=i),t}var i=2*Math.PI;e.normalizeRadian=n},function(t,e){function n(t,e,n,i,r,o){if(o>e&&o>i||o<e&&o<i)return 0;if(i===e)return 0;var s=i<e?1:-1,a=(o-e)/(i-e);1!==a&&0!==a||(s=i<e?.5:-.5);var h=a*(n-t)+t;return h>r?s:0}t.exports=n},function(t,e){var n=function(t,e){this.image=t,this.repeat=e,this.type="pattern"};n.prototype.getCanvasPattern=function(t){return t.createPattern(this.image,this.repeat||"repeat")};var i=n;t.exports=i},function(t,e,n){function i(t,e){var n,i,r,o,u,p,f=t.data,d=a.M,g=a.C,v=a.L,y=a.R,_=a.A,m=a.Q;for(r=0,o=0;r<f.length;){switch(n=f[r++],o=r,i=0,n){case d:i=1;break;case v:i=1;break;case g:i=3;break;case m:i=2;break;case _:var x=e[4],b=e[5],w=l(e[0]*e[0]+e[1]*e[1]),P=l(e[2]*e[2]+e[3]*e[3]),C=c(-e[1]/P,e[0]/w);f[r]*=w,f[r++]+=x,f[r]*=P,f[r++]+=b,f[r++]*=w,f[r++]*=P,f[r++]+=C,f[r++]+=C,r+=2,o=r;break;case y:p[0]=f[r++],p[1]=f[r++],s(p,p,e),f[o++]=p[0],f[o++]=p[1],p[0]+=f[r++],p[1]+=f[r++],s(p,p,e),f[o++]=p[0],f[o++]=p[1]}for(u=0;u<i;u++){var p=h[u];p[0]=f[r++],p[1]=f[r++],s(p,p,e),f[o++]=p[0],f[o++]=p[1]}}}var r=n(29),o=n(14),s=o.applyTransform,a=r.CMD,h=[[],[],[]],l=Math.sqrt,c=Math.atan2;t.exports=i},function(t,e){var n=function(t){this.colorStops=t||[]};n.prototype={constructor:n,addColorStop:function(t,e){this.colorStops.push({offset:t,color:e})}};var i=n;t.exports=i},function(t,e){function n(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this),this.on("globalout",this._dragEnd,this)}function i(t,e){return{target:t,topTarget:e&&e.topTarget}}n.prototype={constructor:n,_dragStart:function(t){var e=t.target;e&&e.draggable&&(this._draggingTarget=e,e.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.dispatchToElement(i(e,t),"dragstart",t.event))},_drag:function(t){var e=this._draggingTarget;if(e){var n=t.offsetX,r=t.offsetY,o=n-this._x,s=r-this._y;this._x=n,this._y=r,e.drift(o,s,t),this.dispatchToElement(i(e,t),"drag",t.event);var a=this.findHover(n,r,e).target,h=this._dropTarget;this._dropTarget=a,e!==a&&(h&&a!==h&&this.dispatchToElement(i(h,t),"dragleave",t.event),a&&a!==h&&this.dispatchToElement(i(a,t),"dragenter",t.event))}},_dragEnd:function(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.dispatchToElement(i(e,t),"dragend",t.event),this._dropTarget&&this.dispatchToElement(i(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null}};var r=n;t.exports=r},function(t,e,n){var i=n(4),r=n(9),o=n(26),s=function(t){t=t||{},r.call(this,t);for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);this._children=[],this.__storage=null,this.__dirty=!0};s.prototype={constructor:s,isGroup:!0,type:"group",silent:!1,children:function(){return this._children.slice()},childAt:function(t){return this._children[t]},childOfName:function(t){for(var e=this._children,n=0;n<e.length;n++)if(e[n].name===t)return e[n]},childCount:function(){return this._children.length},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},addBefore:function(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var n=this._children,i=n.indexOf(e);i>=0&&(n.splice(i,0,t),this._doAdd(t))}return this},_doAdd:function(t){t.parent&&t.parent.remove(t),t.parent=this;var e=this.__storage,n=this.__zr;e&&e!==t.__storage&&(e.addToStorage(t),t instanceof s&&t.addChildrenToStorage(e)),n&&n.refresh()},remove:function(t){var e=this.__zr,n=this.__storage,r=this._children,o=i.indexOf(r,t);return o<0?this:(r.splice(o,1),t.parent=null,n&&(n.delFromStorage(t),t instanceof s&&t.delChildrenFromStorage(n)),e&&e.refresh(),this)},removeAll:function(){var t,e,n=this._children,i=this.__storage;for(e=0;e<n.length;e++)t=n[e],i&&(i.delFromStorage(t),t instanceof s&&t.delChildrenFromStorage(i)),t.parent=null;return n.length=0,this},eachChild:function(t,e){for(var n=this._children,i=0;i<n.length;i++){var r=n[i];t.call(e,r,i)}return this},traverse:function(t,e){for(var n=0;n<this._children.length;n++){var i=this._children[n];t.call(e,i),"group"===i.type&&i.traverse(t,e)}return this},addChildrenToStorage:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.addToStorage(n),n instanceof s&&n.addChildrenToStorage(t)}},delChildrenFromStorage:function(t){for(var e=0;e<this._children.length;e++){var n=this._children[e];t.delFromStorage(n),n instanceof s&&n.delChildrenFromStorage(t)}},dirty:function(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this},getBoundingRect:function(t){for(var e=null,n=new o(0,0,0,0),i=t||this._children,r=[],s=0;s<i.length;s++){var a=i[s];if(!a.ignore&&!a.invisible){var h=a.getBoundingRect(),l=a.getLocalTransform(r);l?(n.copy(h),n.applyTransform(l),e=e||n.clone(),e.union(n)):(e=e||h.clone(),e.union(h))}}return e||n}},i.inherits(s,r);var a=s;t.exports=a},function(t,e,n){function i(t){r.call(this,t)}var r=n(7),o=n(26),s=n(4),a=n(27);i.prototype={constructor:i,type:"image",brush:function(t,e){var n=this.style,i=n.image;n.bind(t,this,e);var r=this._image=a.createOrUpdateImage(i,this._image,this,this.onload);if(r&&a.isImageReady(r)){var o=n.x||0,s=n.y||0,h=n.width,l=n.height,c=r.width/r.height;if(null==h&&null!=l?h=l*c:null==l&&null!=h?l=h/c:null==h&&null==l&&(h=r.width,l=r.height),this.setTransform(t),n.sWidth&&n.sHeight){var u=n.sx||0,p=n.sy||0;t.drawImage(r,u,p,n.sWidth,n.sHeight,o,s,h,l)}else if(n.sx&&n.sy){var u=n.sx,p=n.sy,f=h-u,d=l-p;t.drawImage(r,u,p,f,d,o,s,h,l)}else t.drawImage(r,o,s,h,l);this.restoreTransform(t),null!=n.text&&this.drawRectText(t,this.getBoundingRect())}},getBoundingRect:function(){var t=this.style;return this._rect||(this._rect=new o(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect}},s.inherits(i,r);var h=i;t.exports=h},function(t,e,n){var i=n(7),r=n(4),o=n(25),s=n(24),a=function(t){i.call(this,t)};a.prototype={constructor:a,type:"text",brush:function(t,e){var n=this.style;this.__dirty&&s.normalizeTextStyle(n,!0),n.fill=n.stroke=n.shadowBlur=n.shadowColor=n.shadowOffsetX=n.shadowOffsetY=null;var i=n.text;null!=i&&(i+=""),n.bind(t,this,e),s.needDrawText(i,n)&&(this.setTransform(t),s.renderText(this,t,i,n),this.restoreTransform(t))},getBoundingRect:function(){var t=this.style;if(this.__dirty&&s.normalizeTextStyle(t,!0),!this._rect){var e=t.text;null!=e?e+="":e="";var n=o.getBoundingRect(t.text+"",t.font,t.textAlign,t.textVerticalAlign,t.textPadding,t.rich);if(n.x+=t.x||0,
n.y+=t.y||0,s.getStroke(t.textStroke,t.textStrokeWidth)){var i=t.textStrokeWidth;n.x-=i/2,n.y-=i/2,n.width+=i,n.height+=i}this._rect=n}return this._rect}},r.inherits(a,i);var h=a;t.exports=h},function(t,e,n){var i=n(6),r=i.extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function(t,e,n){n&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0)}});t.exports=r},function(t,e,n){var i=n(6),r=n(48),o=i.extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:r(i.prototype.brush),buildPath:function(t,e){var n=e.cx,i=e.cy,r=Math.max(e.r0||0,0),o=Math.max(e.r,0),s=e.startAngle,a=e.endAngle,h=e.clockwise,l=Math.cos(s),c=Math.sin(s);t.moveTo(l*r+n,c*r+i),t.lineTo(l*o+n,c*o+i),t.arc(n,i,o,s,a,!h),t.lineTo(Math.cos(a)*r+n,Math.sin(a)*r+i),0!==r&&t.arc(n,i,r,a,s,h),t.closePath()}});t.exports=o},function(t,e,n){function i(t){return r.browser.ie&&r.browser.version>=11?function(){var e,n=this.__clipPaths,i=this.style;if(n)for(var r=0;r<n.length;r++){var s=n[r],a=s&&s.shape,h=s&&s.type;if(a&&("sector"===h&&a.startAngle===a.endAngle||"rect"===h&&(!a.width||!a.height))){for(var l=0;l<o.length;l++)o[l][2]=i[o[l][0]],i[o[l][0]]=o[l][1];e=!0;break}}if(t.apply(this,arguments),e)for(var l=0;l<o.length;l++)i[o[l][0]]=o[l][2]}:t}var r=n(49),o=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]];t.exports=i},function(t,e){function n(t){var e={},n={},i=t.match(/Firefox\/([\d.]+)/),r=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),o=t.match(/Edge\/([\d.]+)/),s=/micromessenger/i.test(t);return i&&(n.firefox=!0,n.version=i[1]),r&&(n.ie=!0,n.version=r[1]),o&&(n.edge=!0,n.version=o[1]),s&&(n.weChat=!0),{browser:n,os:e,node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!=typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!n.ie&&!n.edge,pointerEventsSupported:"onpointerdown"in window&&(n.edge||n.ie&&n.version>=11)}}var i={};i="undefined"==typeof navigator?{browser:{},os:{},node:!0,canvasSupported:!0,svgSupported:!0}:n(navigator.userAgent);var r=i;t.exports=r},function(t,e,n){var i=n(6),r=i.extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(t,e){var n=e.cx,i=e.cy,r=2*Math.PI;t.moveTo(n+e.r,i),t.arc(n,i,e.r,0,r,!1),t.moveTo(n+e.r0,i),t.arc(n,i,e.r0,0,r,!0)}});t.exports=r},function(t,e,n){var i=n(6),r=n(52),o=i.extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(t,e){r.buildPath(t,e,!0)}});t.exports=o},function(t,e,n){function i(t,e,n){var i=e.points,s=e.smooth;if(i&&i.length>=2){if(s&&"spline"!==s){var a=o(i,s,n,e.smoothConstraint);t.moveTo(i[0][0],i[0][1]);for(var h=i.length,l=0;l<(n?h:h-1);l++){var c=a[2*l],u=a[2*l+1],p=i[(l+1)%h];t.bezierCurveTo(c[0],c[1],u[0],u[1],p[0],p[1])}}else{"spline"===s&&(i=r(i,n)),t.moveTo(i[0][0],i[0][1]);for(var l=1,f=i.length;l<f;l++)t.lineTo(i[l][0],i[l][1])}n&&t.closePath()}}var r=n(53),o=n(54);e.buildPath=i},function(t,e,n){function i(t,e,n,i,r,o,s){var a=.5*(n-t),h=.5*(i-e);return(2*(e-n)+a+h)*s+(-3*(e-n)-2*a-h)*o+a*r+e}function r(t,e){for(var n=t.length,r=[],o=0,a=1;a<n;a++)o+=s(t[a-1],t[a]);var h=o/2;h=h<n?n:h;for(var a=0;a<h;a++){var l,c,u,p=a/(h-1)*(e?n:n-1),f=Math.floor(p),d=p-f,g=t[f%n];e?(l=t[(f-1+n)%n],c=t[(f+1)%n],u=t[(f+2)%n]):(l=t[0===f?f:f-1],c=t[f>n-2?n-1:f+1],u=t[f>n-3?n-1:f+2]);var v=d*d,y=d*v;r.push([i(l[0],g[0],c[0],u[0],d,v,y),i(l[1],g[1],c[1],u[1],d,v,y)])}return r}var o=n(14),s=o.distance;t.exports=r},function(t,e,n){function i(t,e,n,i){var r,p,f,d,g=[],v=[],y=[],_=[];if(i){f=[1/0,1/0],d=[-(1/0),-(1/0)];for(var m=0,x=t.length;m<x;m++)o(f,f,t[m]),s(d,d,t[m]);o(f,f,i[0]),s(d,d,i[1])}for(var m=0,x=t.length;m<x;m++){var b=t[m];if(n)r=t[m?m-1:x-1],p=t[(m+1)%x];else{if(0===m||m===x-1){g.push(c(t[m]));continue}r=t[m-1],p=t[m+1]}u(v,p,r),a(v,v,e);var w=h(b,r),P=h(b,p),C=w+P;0!==C&&(w/=C,P/=C),a(y,v,-w),a(_,v,P);var S=l([],b,y),T=l([],b,_);i&&(s(S,S,f),o(S,S,d),s(T,T,f),o(T,T,d)),g.push(S),g.push(T)}return n&&g.push(g.shift()),g}var r=n(14),o=r.min,s=r.max,a=r.scale,h=r.distance,l=r.add,c=r.clone,u=r.sub;t.exports=i},function(t,e,n){var i=n(6),r=n(52),o=i.extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(t,e){r.buildPath(t,e,!1)}});t.exports=o},function(t,e,n){var i=n(6),r=n(28),o=i.extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.x,i=e.y,o=e.width,s=e.height;e.r?r.buildPath(t,e):t.rect(n,i,o,s),t.closePath()}});t.exports=o},function(t,e,n){var i=n(6),r=i.extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.x1,i=e.y1,r=e.x2,o=e.y2,s=e.percent;0!==s&&(t.moveTo(n,i),s<1&&(r=n*(1-s)+r*s,o=i*(1-s)+o*s),t.lineTo(r,o))},pointAt:function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]}});t.exports=r},function(t,e,n){function i(t,e,n){var i=t.cpx2,r=t.cpy2;return null===i||null===r?[(n?p:c)(t.x1,t.cpx1,t.cpx2,t.x2,e),(n?p:c)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(n?u:l)(t.x1,t.cpx1,t.x2,e),(n?u:l)(t.y1,t.cpy1,t.y2,e)]}var r=n(6),o=n(14),s=n(30),a=s.quadraticSubdivide,h=s.cubicSubdivide,l=s.quadraticAt,c=s.cubicAt,u=s.quadraticDerivativeAt,p=s.cubicDerivativeAt,f=[],d=r.extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.x1,i=e.y1,r=e.x2,o=e.y2,s=e.cpx1,l=e.cpy1,c=e.cpx2,u=e.cpy2,p=e.percent;0!==p&&(t.moveTo(n,i),null==c||null==u?(p<1&&(a(n,s,r,p,f),s=f[1],r=f[2],a(i,l,o,p,f),l=f[1],o=f[2]),t.quadraticCurveTo(s,l,r,o)):(p<1&&(h(n,s,c,r,p,f),s=f[1],c=f[2],r=f[3],h(i,l,u,o,p,f),l=f[1],u=f[2],o=f[3]),t.bezierCurveTo(s,l,c,u,r,o)))},pointAt:function(t){return i(this.shape,t,!1)},tangentAt:function(t){var e=i(this.shape,t,!0);return o.normalize(e,e)}});t.exports=d},function(t,e,n){var i=n(6),r=i.extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(t,e){var n=e.cx,i=e.cy,r=Math.max(e.r,0),o=e.startAngle,s=e.endAngle,a=e.clockwise,h=Math.cos(o),l=Math.sin(o);t.moveTo(h*r+n,l*r+i),t.arc(n,i,r,o,s,!a)}});t.exports=r},function(t,e,n){var i=n(4),r=n(41),o=function(t,e,n,i,o,s){this.x=null==t?0:t,this.y=null==e?0:e,this.x2=null==n?1:n,this.y2=null==i?0:i,this.type="linear",this.global=s||!1,r.call(this,o)};o.prototype={constructor:o},i.inherits(o,r);var s=o;t.exports=s},function(t,e,n){var i=n(4),r=n(41),o=function(t,e,n,i,o){this.x=null==t?.5:t,this.y=null==e?.5:e,this.r=null==n?.5:n,this.type="radial",this.global=o||!1,r.call(this,i)};o.prototype={constructor:o},i.inherits(o,r);var s=o;t.exports=s},function(t,e,n){var i=n(4),r=n(8),o=n(14),s=o.copy,a=["position","rotation","scale","style","shape"],h=function(t){"string"==typeof t?this._fromStr(t):t&&(t.property&&(this.property=t.property),null!=t.duration&&(this.duration=t.duration),t.easing&&(this.easing=t.easing),t.delay&&(this.delay=t.delay)),"*"!==this.property?this.property=this.property.split(","):this.property=a};h.prototype={constructor:h,property:"*",easing:"Linear",duration:500,delay:0,_fromStr:function(t){var e=t.split(/\s+/g);this.property=e[0],this.duration=+e[1],this.delay=+e[2],this.easing=e[3]}};var l=function(t){t=t||{},this._states={},this._el=t.el,this._subStates=[],this._transitionAnimators=[],t.initialState&&(this._initialState=t.initialState);var e=t.states;if(e)for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];this._addState(n,i)}this.setState(this._initialState)};l.prototype={constructor:l,_initialState:"normal",_currentState:"",el:function(){return this._el},_addState:function(t,e){if(this._states[t]=e,e.transition&&(e.transition=new h(e.transition)),t!==this._initialState)this._extendFromInitial(e);else{var n=this._el;i.merge(e.style,n.style,!1,!1),e.shape?i.merge(e.shape,n.shape,!1,!0):e.shape=i.clone(n.shape,!0);for(var t in this._states)this._states.hasOwnProperty(t)&&this._extendFromInitial(this._states[t])}},_extendFromInitial:function(t){var e=this._states[this._initialState];e&&t!==e&&i.merge(t,e,!1,!0)},setState:function(t,e){if(t!==this._currentState||this.transiting()){var n=this._states[t];if(n){if(this._stopTransition(),!e){var o=this._states[this._currentState];o&&o.onleave&&o.onleave.call(this),n.onenter&&n.onenter.call(this)}if(this._currentState=t,this._el){var a=this._el;if(null!=n.zlevel&&(a.zlevel=n.zlevel),null!=n.z&&(a.z=n.z),n.position&&s(a.position,n.position),n.scale&&s(a.scale,n.scale),null!=n.rotation&&(a.rotation=n.rotation),n.style){var h=this._states[this._initialState];a.style=new r,h&&a.style.extendFrom(h.style,!1),t!=this._initialState&&h.style!==n.style&&a.style.extendFrom(n.style,!0)}n.shape&&(a.shape=i.clone(n.shape,!0)),a.dirty()}}for(var l=0;l<this._subStates.length;l++)this._subStates.setState(t)}},getState:function(){return this._currentState},transitionState:function(t,e){if(t!==this._currentState||this.transiting()){var n=this._states[t],i=/$[style|shape]\./,r=this,o={};if(n){r._stopTransition();var s=r._el;if(n.transition&&s&&s.__zr){for(var a=n.transition,h=a.property,l=0,c=function(){l--,0===l&&(r.setState(t),e&&e())},u=0;u<h.length;u++){var p=h[u];if("style"===p||"shape"===p){if(n[p])for(var f in n[p])if(n[p].hasOwnProperty(f)){var d=p+"."+f;o[d]||(o[d]=1,l+=r._animProp(n,p,f,a,c))}}else{if(o[p])continue;if(o[p]=1,p.match(i)){var g=p.slice(0,5);p=p.slice(6),l+=r._animProp(n,g,p,a,c)}else l+=r._animProp(n,"",p,a,c)}}0===l&&(r.setState(t),e&&e())}else r.setState(t),e&&e()}for(var v=r._subStates,u=0;u<v.length;u++)v.transitionState(t)}},_animProp:function(t,e,n,r,o){var s=this._el,a=e?t[e]:t,h=e?s[e]:s,l=a&&n in a&&h&&n in h,c=this._transitionAnimators;if(l){var u={};if(a[n]===h[n])return 0;u[n]=a[n];var p=s.animate(e).when(r.duration,u).delay(r.dealy).done(function(){var t=i.indexOf(c,1);t>0&&c.splice(t,1),o()}).start(r.easing);return c.push(p),1}return 0},_stopTransition:function(){for(var t=this._transitionAnimators,e=0;e<t.length;e++)t[e].stop();t.length=0},transiting:function(){return this._transitionAnimators.length>0},addSubStates:function(t){this._subStates.push(t)},removeSubStates:function(t){var e=i.indexOf(this._subStates,t);e>=0&&this._subStates.splice(t,1)}};var c=l;t.exports=c},function(t,e,n){"use strict";function i(t){r.each(o,function(e){this[e]=r.bind(t[e],t)},this)}var r=n(4),o=["getDom","getZr","getWidth","getHeight","dispatchAction","on","off","trigger","getDataURL","getConnectedDataURL","getModel","getOption","remove","_getParentZr"];t.exports=i},function(t,e){function n(t,e){this.x=t,this.y=e}n.load=function(t){var e=new n(Number(t.x),Number(t.y));return e},n.loadArray=function(t){for(var e=[],i=0;i<t.length;i++)e.push(n.load(t[i]));return e},n.cloneArray=function(t){for(var e=[],n=0;n<t.length;n++)e.push(t[n].clone());return e},n.prototype={constructor:n,transform:function(t){var e=this.x,n=this.y;this.x=t[0][0]*e+t[0][1]*n+t[0][2],this.y=t[1][0]*e+t[1][1]*n+t[1][2]},equals:function(t){return t instanceof n&&(this.x==t.x&&this.y==t.y)},clone:function(){var t=new n(this.x,this.y);return t},add:function(t){return this.x=this.x+t.x,this.y=this.y+t.y,this},near:function(t,e,n){var i=Math.sqrt(Math.pow(this.x-t,2)+Math.pow(this.y-e,2));return i<=n},contains:function(t,e){return this.x==t&&this.y==e},toString:function(){return"["+this.x+","+this.y+"]"},getPoints:function(){return[this]}},t.exports=n},function(t,e,n){function i(t,e){var n=new x(h(),t,e);return _[n.id]=n,n}function r(t){if(t)t.dispose();else{for(var e in _)_.hasOwnProperty(e)&&_[e].dispose();_={}}return this}function o(t){return _[t]}function s(t,e){y[t]=e}function a(t){delete _[t]}var h=n(10),l=n(49),c=n(4),u=n(66),p=n(67),f=n(69),d=n(72),g=n(74),v=!l.canvasSupported,y={canvas:f},_={},m="3.7.4",x=function(t,e,n){n=n||{},this.dom=e,this.id=t;var i=this,r=new p,o=n.renderer;if(v){if(!y.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");o="vml"}else o&&y[o]||(o="canvas");var s=new y[o](e,r,n);this.storage=r,this.painter=s;var a=l.node?null:new g(s.getViewportRoot());this.handler=new u(r,s,a,s.root),this.animation=new d({stage:{update:c.bind(this.flush,this)}}),this.animation.start(),this._needsRefresh;var h=r.delFromStorage,f=r.addToStorage;r.delFromStorage=function(t){h.call(r,t),t&&t.removeSelfFromZr(i)},r.addToStorage=function(t){f.call(r,t),t.addSelfToZr(i)}};x.prototype={constructor:x,getId:function(){return this.id},add:function(t){this.storage.addRoot(t),this._needsRefresh=!0},remove:function(t){this.storage.delRoot(t),this._needsRefresh=!0},configLayer:function(t,e){this.painter.configLayer(t,e),this._needsRefresh=!0},refreshImmediately:function(){this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},refresh:function(){this._needsRefresh=!0},flush:function(){this._needsRefresh&&this.refreshImmediately(),this._needsRefreshHover&&this.refreshHoverImmediately()},addHover:function(t,e){this.painter.addHover&&(this.painter.addHover(t,e),this.refreshHover())},removeHover:function(t){this.painter.removeHover&&(this.painter.removeHover(t),this.refreshHover())},clearHover:function(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover())},refreshHover:function(){this._needsRefreshHover=!0},refreshHoverImmediately:function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover()},resize:function(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize()},clearAnimation:function(){this.animation.clear()},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()},pathToImage:function(t,e){return this.painter.pathToImage(t,e)},setCursorStyle:function(t){this.handler.setCursorStyle(t)},findHover:function(t,e){return this.handler.findHover(t,e)},on:function(t,e,n){this.handler.on(t,e,n)},off:function(t,e){this.handler.off(t,e)},trigger:function(t,e){this.handler.trigger(t,e)},clear:function(){this.storage.delRoot(),this.painter.clear()},dispose:function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,a(this.id)}},e.version=m,e.init=i,e.dispose=r,e.getInstance=o,e.registerPainter=s},function(t,e,n){function i(t,e,n){return{type:t,event:n,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:n.zrX,offsetY:n.zrY,gestureEvent:n.gestureEvent,pinchX:n.pinchX,pinchY:n.pinchY,pinchScale:n.pinchScale,wheelDelta:n.zrDelta,zrByTouch:n.zrByTouch,which:n.which}}function r(){}function o(t,e,n){if(t[t.rectHover?"rectContain":"contain"](e,n)){for(var i,r=t;r;){if(r.clipPath&&!r.clipPath.contain(e,n))return!1;r.silent&&(i=!0),r=r.parent}return!i||c}return!1}var s=n(4),a=n(14),h=n(42),l=n(11),c="silent";r.prototype.dispose=function(){};var u=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],p=function(t,e,n,i){l.call(this),this.storage=t,this.painter=e,this.painterRoot=i,n=n||new r,this.proxy=n,n.handler=this,this._hovered={},this._lastTouchMoment,this._lastX,this._lastY,h.call(this),s.each(u,function(t){n.on&&n.on(t,this[t],this)},this)};p.prototype={constructor:p,mousemove:function(t){var e=t.zrX,n=t.zrY,i=this._hovered,r=i.target;r&&!r.__zr&&(i=this.findHover(i.x,i.y),r=i.target);var o=this._hovered=this.findHover(e,n),s=o.target,a=this.proxy;a.setCursor&&a.setCursor(s?s.cursor:"default"),r&&s!==r&&this.dispatchToElement(i,"mouseout",t),this.dispatchToElement(o,"mousemove",t),s&&s!==r&&this.dispatchToElement(o,"mouseover",t)},mouseout:function(t){this.dispatchToElement(this._hovered,"mouseout",t);var e,n=t.toElement||t.relatedTarget;do n=n&&n.parentNode;while(n&&9!=n.nodeType&&!(e=n===this.painterRoot));!e&&this.trigger("globalout",{event:t})},resize:function(t){this._hovered={}},dispatch:function(t,e){var n=this[t];n&&n.call(this,e)},dispose:function(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null},setCursorStyle:function(t){var e=this.proxy;e.setCursor&&e.setCursor(t)},dispatchToElement:function(t,e,n){t=t||{};var r=t.target;if(!r||!r.silent){for(var o="on"+e,s=i(e,t,n);r&&(r[o]&&(s.cancelBubble=r[o].call(r,s)),r.trigger(e,s),r=r.parent,!s.cancelBubble););s.cancelBubble||(this.trigger(e,s),this.painter&&this.painter.eachOtherLayer(function(t){"function"==typeof t[o]&&t[o].call(t,s),t.trigger&&t.trigger(e,s)}))}},findHover:function(t,e,n){for(var i=this.storage.getDisplayList(),r={x:t,y:e},s=i.length-1;s>=0;s--){var a;if(i[s]!==n&&!i[s].ignore&&(a=o(i[s],t,e))&&(!r.topTarget&&(r.topTarget=i[s]),a!==c)){r.target=i[s];break}}return r}},s.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){p.prototype[t]=function(e){var n=this.findHover(e.zrX,e.zrY),i=n.target;if("mousedown"===t)this._downEl=i,this._downPoint=[e.zrX,e.zrY],this._upEl=i;else if("mosueup"===t)this._upEl=i;else if("click"===t){if(this._downEl!==this._upEl||!this._downPoint||a.dist(this._downPoint,[e.zrX,e.zrY])>4)return;this._downPoint=null}this.dispatchToElement(n,t,e)}}),s.mixin(p,l),s.mixin(p,h);var f=p;t.exports=f},function(t,e,n){function i(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel}var r=n(4),o=n(49),s=n(43),a=n(68),h=function(){this._roots=[],this._displayList=[],this._displayListLen=0};h.prototype={constructor:h,traverse:function(t,e){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,e)},getDisplayList:function(t,e){return e=e||!1,t&&this.updateDisplayList(e),this._displayList},updateDisplayList:function(t){this._displayListLen=0;for(var e=this._roots,n=this._displayList,r=0,s=e.length;r<s;r++)this._updateAndAddDisplayable(e[r],null,t);n.length=this._displayListLen,o.canvasSupported&&a(n,i)},_updateAndAddDisplayable:function(t,e,n){if(!t.ignore||n){t.beforeUpdate(),t.__dirty&&t.update(),t.afterUpdate();var i=t.clipPath;if(i){e=e?e.slice():[];for(var r=i,o=t;r;)r.parent=o,r.updateTransform(),e.push(r),o=r,r=r.clipPath}if(t.isGroup){for(var s=t._children,a=0;a<s.length;a++){var h=s[a];t.__dirty&&(h.__dirty=!0),this._updateAndAddDisplayable(h,e,n)}t.__dirty=!1}else t.__clipPaths=e,this._displayList[this._displayListLen++]=t}},addRoot:function(t){t.__storage!==this&&(t instanceof s&&t.addChildrenToStorage(this),this.addToStorage(t),this._roots.push(t))},delRoot:function(t){if(null==t){for(var e=0;e<this._roots.length;e++){var n=this._roots[e];n instanceof s&&n.delChildrenFromStorage(this)}return this._roots=[],this._displayList=[],void(this._displayListLen=0)}if(t instanceof Array)for(var e=0,i=t.length;e<i;e++)this.delRoot(t[e]);else{var o=r.indexOf(this._roots,t);o>=0&&(this.delFromStorage(t),this._roots.splice(o,1),t instanceof s&&t.delChildrenFromStorage(this))}},addToStorage:function(t){return t.__storage=this,t.dirty(!1),this},delFromStorage:function(t){return t&&(t.__storage=null),this},dispose:function(){this._renderList=this._roots=null},displayableSortFunc:i};var l=h;t.exports=l},function(t,e){function n(t){for(var e=0;t>=c;)e|=1&t,t>>=1;return t+e}function i(t,e,n,i){var o=e+1;if(o===n)return 1;if(i(t[o++],t[e])<0){for(;o<n&&i(t[o],t[o-1])<0;)o++;r(t,e,o)}else for(;o<n&&i(t[o],t[o-1])>=0;)o++;return o-e}function r(t,e,n){for(n--;e<n;){var i=t[e];t[e++]=t[n],t[n--]=i}}function o(t,e,n,i,r){for(i===e&&i++;i<n;i++){for(var o,s=t[i],a=e,h=i;a<h;)o=a+h>>>1,r(s,t[o])<0?h=o:a=o+1;var l=i-a;switch(l){case 3:t[a+3]=t[a+2];case 2:t[a+2]=t[a+1];case 1:t[a+1]=t[a];break;default:for(;l>0;)t[a+l]=t[a+l-1],l--}t[a]=s}}function s(t,e,n,i,r,o){var s=0,a=0,h=1;if(o(t,e[n+r])>0){for(a=i-r;h<a&&o(t,e[n+r+h])>0;)s=h,h=(h<<1)+1,h<=0&&(h=a);h>a&&(h=a),s+=r,h+=r}else{for(a=r+1;h<a&&o(t,e[n+r-h])<=0;)s=h,h=(h<<1)+1,h<=0&&(h=a);h>a&&(h=a);var l=s;s=r-h,h=r-l}for(s++;s<h;){var c=s+(h-s>>>1);o(t,e[n+c])>0?s=c+1:h=c}return h}function a(t,e,n,i,r,o){var s=0,a=0,h=1;if(o(t,e[n+r])<0){for(a=r+1;h<a&&o(t,e[n+r-h])<0;)s=h,h=(h<<1)+1,h<=0&&(h=a);h>a&&(h=a);var l=s;s=r-h,h=r-l}else{for(a=i-r;h<a&&o(t,e[n+r+h])>=0;)s=h,h=(h<<1)+1,h<=0&&(h=a);h>a&&(h=a),s+=r,h+=r}for(s++;s<h;){var c=s+(h-s>>>1);o(t,e[n+c])<0?h=c:s=c+1}return h}function h(t,e){function n(t,e){c[_]=t,f[_]=e,_+=1}function i(){for(;_>1;){var t=_-2;if(t>=1&&f[t-1]<=f[t]+f[t+1]||t>=2&&f[t-2]<=f[t]+f[t-1])f[t-1]<f[t+1]&&t--;else if(f[t]>f[t+1])break;o(t)}}function r(){for(;_>1;){var t=_-2;t>0&&f[t-1]<f[t+1]&&t--,o(t)}}function o(n){var i=c[n],r=f[n],o=c[n+1],u=f[n+1];f[n]=r+u,n===_-3&&(c[n+1]=c[n+2],f[n+1]=f[n+2]),_--;var p=a(t[o],t,i,r,0,e);i+=p,r-=p,0!==r&&(u=s(t[i+r-1],t,o,u,u-1,e),0!==u&&(r<=u?h(i,r,o,u):l(i,r,o,u)))}function h(n,i,r,o){var h=0;for(h=0;h<i;h++)m[h]=t[n+h];var l=0,c=r,p=n;if(t[p++]=t[c++],0!==--o){if(1===i){for(h=0;h<o;h++)t[p+h]=t[c+h];return void(t[p+o]=m[l])}for(var f,g,v,y=d;;){f=0,g=0,v=!1;do if(e(t[c],m[l])<0){if(t[p++]=t[c++],g++,f=0,0===--o){v=!0;break}}else if(t[p++]=m[l++],f++,g=0,1===--i){v=!0;break}while((f|g)<y);if(v)break;do{if(f=a(t[c],m,l,i,0,e),0!==f){for(h=0;h<f;h++)t[p+h]=m[l+h];if(p+=f,l+=f,i-=f,i<=1){v=!0;break}}if(t[p++]=t[c++],0===--o){v=!0;break}if(g=s(m[l],t,c,o,0,e),0!==g){for(h=0;h<g;h++)t[p+h]=t[c+h];if(p+=g,c+=g,o-=g,0===o){v=!0;break}}if(t[p++]=m[l++],1===--i){v=!0;break}y--}while(f>=u||g>=u);if(v)break;y<0&&(y=0),y+=2}if(d=y,d<1&&(d=1),1===i){for(h=0;h<o;h++)t[p+h]=t[c+h];t[p+o]=m[l]}else{if(0===i)throw new Error;for(h=0;h<i;h++)t[p+h]=m[l+h]}}else for(h=0;h<i;h++)t[p+h]=m[l+h]}function l(n,i,r,o){var h=0;for(h=0;h<o;h++)m[h]=t[r+h];var l=n+i-1,c=o-1,p=r+o-1,f=0,g=0;if(t[p--]=t[l--],0!==--i){if(1===o){for(p-=i,l-=i,g=p+1,f=l+1,h=i-1;h>=0;h--)t[g+h]=t[f+h];return void(t[p]=m[c])}for(var v=d;;){var y=0,_=0,x=!1;do if(e(m[c],t[l])<0){if(t[p--]=t[l--],y++,_=0,0===--i){x=!0;break}}else if(t[p--]=m[c--],_++,y=0,1===--o){x=!0;break}while((y|_)<v);if(x)break;do{if(y=i-a(m[c],t,n,i,i-1,e),0!==y){for(p-=y,l-=y,i-=y,g=p+1,f=l+1,h=y-1;h>=0;h--)t[g+h]=t[f+h];if(0===i){x=!0;break}}if(t[p--]=m[c--],1===--o){x=!0;break}if(_=o-s(t[l],m,0,o,o-1,e),0!==_){for(p-=_,c-=_,o-=_,g=p+1,f=c+1,h=0;h<_;h++)t[g+h]=m[f+h];if(o<=1){x=!0;break}}if(t[p--]=t[l--],0===--i){x=!0;break}v--}while(y>=u||_>=u);if(x)break;v<0&&(v=0),v+=2}if(d=v,d<1&&(d=1),1===o){for(p-=i,l-=i,g=p+1,f=l+1,h=i-1;h>=0;h--)t[g+h]=t[f+h];t[p]=m[c]}else{if(0===o)throw new Error;for(f=p-(o-1),h=0;h<o;h++)t[f+h]=m[h]}}else for(f=p-(o-1),h=0;h<o;h++)t[f+h]=m[h]}var c,f,d=u,g=0,v=p,y=0,_=0;g=t.length,g<2*p&&(v=g>>>1);var m=[];y=g<120?5:g<1542?10:g<119151?19:40,c=[],f=[],this.mergeRuns=i,this.forceMergeRuns=r,this.pushRun=n}function l(t,e,r,s){r||(r=0),s||(s=t.length);var a=s-r;if(!(a<2)){var l=0;if(a<c)return l=i(t,r,s,e),void o(t,r,s,r+l,e);var u=new h(t,e),p=n(a);do{if(l=i(t,r,s,e),l<p){var f=a;f>p&&(f=p),o(t,r,r+f,r+l,e),l=f}u.pushRun(r,l),u.mergeRuns(),a-=l,r+=l}while(0!==a);u.forceMergeRuns()}}var c=32,u=7,p=256;t.exports=l},function(t,e,n){function i(t){return parseInt(t,10)}function r(t){return!!t&&(!!t.__builtin__||"function"==typeof t.resize&&"function"==typeof t.refresh)}function o(t){t.__unusedCount++}function s(t){1==t.__unusedCount&&t.clear()}function a(t,e,n){return b.copy(t.getBoundingRect()),t.transform&&b.applyTransform(t.transform),w.width=e,w.height=n,!b.intersect(w)}function h(t,e){if(t==e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!0}function l(t,e){for(var n=0;n<t.length;n++){var i=t[n];i.setTransform(e),e.beginPath(),i.buildPath(e,i.shape),e.clip(),i.restoreTransform(e)}}function c(t,e){var n=document.createElement("div");return n.style.cssText=["position:relative","overflow:hidden","width:"+t+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",n}var u=n(22),p=u.devicePixelRatio,f=n(4),d=n(21),g=n(26),v=n(68),y=n(70),_=n(71),m=n(44),x=5,b=new g(0,0,0,0),w=new g(0,0,0,0),P=function(t,e,n){this.type="canvas";var i=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._opts=n=f.extend({},n||{}),this.dpr=n.devicePixelRatio||p,this._singleCanvas=i,this.root=t;var r=t.style;r&&(r["-webkit-tap-highlight-color"]="transparent",r["-webkit-user-select"]=r["user-select"]=r["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;var o=this._zlevelList=[],s=this._layers={};if(this._layerConfig={},i){null!=n.width&&(t.width=n.width),null!=n.height&&(t.height=n.height);var a=t.width,h=t.height;this._width=a,this._height=h;var l=new y(t,this,1);l.initContext(),s[0]=l,o.push(0),this._domRoot=t}else{this._width=this._getSize(0),this._height=this._getSize(1);var u=this._domRoot=c(this._width,this._height);t.appendChild(u)}this._progressiveLayers=[],this._hoverlayer,this._hoverElements=[]};P.prototype={constructor:P,getType:function(){return"canvas"},isSingleCanvas:function(){return this._singleCanvas},getViewportRoot:function(){return this._domRoot},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(t){var e=this.storage.getDisplayList(!0),n=this._zlevelList;this._paintList(e,t);for(var i=0;i<n.length;i++){var r=n[i],o=this._layers[r];!o.__builtin__&&o.refresh&&o.refresh()}return this.refreshHover(),this._progressiveLayers.length&&this._startProgessive(),this},addHover:function(t,e){if(!t.__hoverMir){var n=new t.constructor({style:t.style,shape:t.shape});n.__from=t,t.__hoverMir=n,n.setStyle(e),this._hoverElements.push(n)}},removeHover:function(t){var e=t.__hoverMir,n=this._hoverElements,i=f.indexOf(n,e);i>=0&&n.splice(i,1),t.__hoverMir=null},clearHover:function(t){for(var e=this._hoverElements,n=0;n<e.length;n++){var i=e[n].__from;i&&(i.__hoverMir=null)}e.length=0},refreshHover:function(){var t=this._hoverElements,e=t.length,n=this._hoverlayer;if(n&&n.clear(),e){v(t,this.storage.displayableSortFunc),n||(n=this._hoverlayer=this.getLayer(1e5));var i={};n.ctx.save();for(var r=0;r<e;){var o=t[r],s=o.__from;s&&s.__zr?(r++,s.invisible||(o.transform=s.transform,o.invTransform=s.invTransform,o.__clipPaths=s.__clipPaths,this._doPaintEl(o,n,!0,i))):(t.splice(r,1),s.__hoverMir=null,e--)}n.ctx.restore()}},_startProgessive:function(){function t(){n===e._progressiveToken&&e.storage&&(e._doPaintList(e.storage.getDisplayList()),e._furtherProgressive?(e._progress++,_(t)):e._progressiveToken=-1)}var e=this;if(e._furtherProgressive){var n=e._progressiveToken=+new Date;e._progress++,_(t)}},_clearProgressive:function(){this._progressiveToken=-1,this._progress=0,f.each(this._progressiveLayers,function(t){t.__dirty&&t.clear()})},_paintList:function(t,e){null==e&&(e=!1),this._updateLayerStatus(t),this._clearProgressive(),this.eachBuiltinLayer(o),this._doPaintList(t,e),this.eachBuiltinLayer(s)},_doPaintList:function(t,e){function n(t){var e=o.dpr||1;o.save(),o.globalAlpha=1,o.shadowBlur=0,i.__dirty=!0,o.setTransform(1,0,0,1,0,0),o.drawImage(t.dom,0,0,c*e,u*e),o.restore()}for(var i,r,o,s,a,h,l=0,c=this._width,u=this._height,p=this._progress,g=0,v=t.length;g<v;g++){var y=t[g],_=this._singleCanvas?0:y.zlevel,m=y.__frame;if(m<0&&a&&(n(a),a=null),r!==_&&(o&&o.restore(),s={},r=_,i=this.getLayer(r),i.__builtin__||d("ZLevel "+r+" has been used by unkown layer "+i.id),o=i.ctx,o.save(),i.__unusedCount=0,(i.__dirty||e)&&i.clear()),i.__dirty||e){if(m>=0){if(!a){if(a=this._progressiveLayers[Math.min(l++,x-1)],a.ctx.save(),a.renderScope={},a&&a.__progress>a.__maxProgress){g=a.__nextIdxNotProg-1;continue}h=a.__progress,a.__dirty||(p=h),a.__progress=p+1}m===p&&this._doPaintEl(y,a,!0,a.renderScope)}else this._doPaintEl(y,i,e,s);y.__dirty=!1}}a&&n(a),o&&o.restore(),this._furtherProgressive=!1,f.each(this._progressiveLayers,function(t){t.__maxProgress>=t.__progress&&(this._furtherProgressive=!0)},this)},_doPaintEl:function(t,e,n,i){var r=e.ctx,o=t.transform;if((e.__dirty||n)&&!t.invisible&&0!==t.style.opacity&&(!o||o[0]||o[3])&&(!t.culling||!a(t,this._width,this._height))){var s=t.__clipPaths;(i.prevClipLayer!==e||h(s,i.prevElClipPaths))&&(i.prevElClipPaths&&(i.prevClipLayer.ctx.restore(),i.prevClipLayer=i.prevElClipPaths=null,i.prevEl=null),s&&(r.save(),l(s,r),i.prevClipLayer=e,i.prevElClipPaths=s)),t.beforeBrush&&t.beforeBrush(r),t.brush(r,i.prevEl||null),i.prevEl=t,t.afterBrush&&t.afterBrush(r)}},getLayer:function(t){if(this._singleCanvas)return this._layers[0];var e=this._layers[t];return e||(e=new y("zr_"+t,this,this.dpr),e.__builtin__=!0,this._layerConfig[t]&&f.merge(e,this._layerConfig[t],!0),this.insertLayer(t,e),e.initContext()),e},insertLayer:function(t,e){var n=this._layers,i=this._zlevelList,o=i.length,s=null,a=-1,h=this._domRoot;if(n[t])return void d("ZLevel "+t+" has been used already");if(!r(e))return void d("Layer of zlevel "+t+" is not valid");if(o>0&&t>i[0]){for(a=0;a<o-1&&!(i[a]<t&&i[a+1]>t);a++);s=n[i[a]]}if(i.splice(a+1,0,t),n[t]=e,!e.virtual)if(s){var l=s.dom;l.nextSibling?h.insertBefore(e.dom,l.nextSibling):h.appendChild(e.dom)}else h.firstChild?h.insertBefore(e.dom,h.firstChild):h.appendChild(e.dom)},eachLayer:function(t,e){var n,i,r=this._zlevelList;for(i=0;i<r.length;i++)n=r[i],t.call(e,this._layers[n],n)},eachBuiltinLayer:function(t,e){var n,i,r,o=this._zlevelList;for(r=0;r<o.length;r++)i=o[r],n=this._layers[i],n.__builtin__&&t.call(e,n,i)},eachOtherLayer:function(t,e){var n,i,r,o=this._zlevelList;for(r=0;r<o.length;r++)i=o[r],n=this._layers[i],n.__builtin__||t.call(e,n,i)},getLayers:function(){return this._layers},_updateLayerStatus:function(t){var e=this._layers,n=this._progressiveLayers,i={},r={};this.eachBuiltinLayer(function(t,e){i[e]=t.elCount,t.elCount=0,t.__dirty=!1}),f.each(n,function(t,e){r[e]=t.elCount,t.elCount=0,t.__dirty=!1});for(var o,s,a=0,h=0,l=0,c=t.length;l<c;l++){var u=t[l],p=this._singleCanvas?0:u.zlevel,d=e[p],g=u.progressive;if(d&&(d.elCount++,d.__dirty=d.__dirty||u.__dirty),g>=0){s!==g&&(s=g,h++);var v=u.__frame=h-1;if(!o){var _=Math.min(a,x-1);o=n[_],o||(o=n[_]=new y("progressive",this,this.dpr),o.initContext()),o.__maxProgress=0}o.__dirty=o.__dirty||u.__dirty,o.elCount++,o.__maxProgress=Math.max(o.__maxProgress,v),o.__maxProgress>=o.__progress&&(d.__dirty=!0)}else u.__frame=-1,o&&(o.__nextIdxNotProg=l,a++,o=null)}o&&(a++,o.__nextIdxNotProg=l),this.eachBuiltinLayer(function(t,e){i[e]!==t.elCount&&(t.__dirty=!0)}),n.length=Math.min(a,x),f.each(n,function(t,e){r[e]!==t.elCount&&(u.__dirty=!0),t.__dirty&&(t.__progress=0)})},clear:function(){return this.eachBuiltinLayer(this._clearLayer),this},_clearLayer:function(t){t.clear()},configLayer:function(t,e){if(e){var n=this._layerConfig;n[t]?f.merge(n[t],e,!0):n[t]=e;var i=this._layers[t];i&&f.merge(i,n[t],!0)}},delLayer:function(t){var e=this._layers,n=this._zlevelList,i=e[t];i&&(i.dom.parentNode.removeChild(i.dom),delete e[t],n.splice(f.indexOf(n,t),1))},resize:function(t,e){var n=this._domRoot;n.style.display="none";var i=this._opts;if(null!=t&&(i.width=t),null!=e&&(i.height=e),t=this._getSize(0),e=this._getSize(1),n.style.display="",this._width!=t||e!=this._height){n.style.width=t+"px",n.style.height=e+"px";for(var r in this._layers)this._layers.hasOwnProperty(r)&&this._layers[r].resize(t,e);f.each(this._progressiveLayers,function(n){n.resize(t,e)}),this.refresh(!0)}return this._width=t,this._height=e,this},clearLayer:function(t){var e=this._layers[t];e&&e.clear()},dispose:function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},getRenderedCanvas:function(t){function e(t,e){var i=s._zlevelList;null==t&&(t=-(1/0));for(var r,o=0;o<i.length;o++){var a=i[o],h=s._layers[a];if(!h.__builtin__&&a>t&&a<e){r=h;break}}r&&r.renderToCanvas&&(n.ctx.save(),r.renderToCanvas(n.ctx),n.ctx.restore())}if(t=t||{},this._singleCanvas)return this._layers[0].dom;var n=new y("image",this,t.pixelRatio||this.dpr);n.initContext(),n.clearColor=t.backgroundColor,n.clear();for(var i,r=this.storage.getDisplayList(!0),o={},s=this,a=0;a<r.length;a++){var h=r[a];h.zlevel!==i&&(e(i,h.zlevel),i=h.zlevel),this._doPaintEl(h,n,!0,o)}return e(i,1/0),n.dom},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(t){var e=this._opts,n=["width","height"][t],r=["clientWidth","clientHeight"][t],o=["paddingLeft","paddingTop"][t],s=["paddingRight","paddingBottom"][t];
if(null!=e[n]&&"auto"!==e[n])return parseFloat(e[n]);var a=this.root,h=document.defaultView.getComputedStyle(a);return(a[r]||i(h[n])||i(a.style[n]))-(i(h[o])||0)-(i(h[s])||0)|0},pathToImage:function(t,e){e=e||this.dpr;var n=document.createElement("canvas"),i=n.getContext("2d"),r=t.getBoundingRect(),o=t.style,s=o.shadowBlur,a=o.shadowOffsetX,h=o.shadowOffsetY,l=o.hasStroke()?o.lineWidth:0,c=Math.max(l/2,-a+s),u=Math.max(l/2,a+s),p=Math.max(l/2,-h+s),f=Math.max(l/2,h+s),d=r.width+c+u,g=r.height+p+f;n.width=d*e,n.height=g*e,i.scale(e,e),i.clearRect(0,0,d,g),i.dpr=e;var v={position:t.position,rotation:t.rotation,scale:t.scale};t.position=[c-r.x,p-r.y],t.rotation=0,t.scale=[1,1],t.updateTransform(),t&&t.brush(i);var y=m,_=new y({style:{x:0,y:0,image:n}});return null!=v.position&&(_.position=t.position=v.position),null!=v.rotation&&(_.rotation=t.rotation=v.rotation),null!=v.scale&&(_.scale=t.scale=v.scale),_}};var C=P;t.exports=C},function(t,e,n){function i(){return!1}function r(t,e,n){var i=o.createCanvas(),r=e.getWidth(),s=e.getHeight(),a=i.style;return a.position="absolute",a.left=0,a.top=0,a.width=r+"px",a.height=s+"px",i.width=r*n,i.height=s*n,i.setAttribute("data-zr-dom-id",t),i}var o=n(4),s=n(22),a=s.devicePixelRatio,h=n(8),l=n(39),c=function(t,e,n){var s;n=n||a,"string"==typeof t?s=r(t,e,n):o.isObject(t)&&(s=t,t=s.id),this.id=t,this.dom=s;var h=s.style;h&&(s.onselectstart=i,h["-webkit-user-select"]="none",h["user-select"]="none",h["-webkit-touch-callout"]="none",h["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",h.padding=0,h.margin=0,h["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=e,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=n};c.prototype={constructor:c,elCount:0,__dirty:!0,initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.__currentValues={},this.ctx.dpr=this.dpr},createBackBuffer:function(){var t=this.dpr;this.domBack=r("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),this.ctxBack.__currentValues={},1!=t&&this.ctxBack.scale(t,t)},resize:function(t,e){var n=this.dpr,i=this.dom,r=i.style,o=this.domBack;r.width=t+"px",r.height=e+"px",i.width=t*n,i.height=e*n,o&&(o.width=t*n,o.height=e*n,1!=n&&this.ctxBack.scale(n,n))},clear:function(t){var e=this.dom,n=this.ctx,i=e.width,r=e.height,o=this.clearColor,s=this.motionBlur&&!t,a=this.lastFrameAlpha,c=this.dpr;if(s&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(e,0,0,i/c,r/c)),n.clearRect(0,0,i,r),o){var u;o.colorStops?(u=o.__canvasGradient||h.getGradient(n,o,{x:0,y:0,width:i,height:r}),o.__canvasGradient=u):o.image&&(u=l.prototype.getCanvasPattern.call(o,n)),n.save(),n.fillStyle=u||o,n.fillRect(0,0,i,r),n.restore()}if(s){var p=this.domBack;n.save(),n.globalAlpha=a,n.drawImage(p,0,0,i,r),n.restore()}}};var u=c;t.exports=u},function(t,e){var n="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){setTimeout(t,16)};t.exports=n},function(t,e,n){var i=n(4),r=n(73),o=r.Dispatcher,s=n(71),a=n(16),h=function(t){t=t||{},this.stage=t.stage||{},this.onframe=t.onframe||function(){},this._clips=[],this._running=!1,this._time,this._pausedTime,this._pauseStart,this._paused=!1,o.call(this)};h.prototype={constructor:h,addClip:function(t){this._clips.push(t)},addAnimator:function(t){t.animation=this;for(var e=t.getClips(),n=0;n<e.length;n++)this.addClip(e[n])},removeClip:function(t){var e=i.indexOf(this._clips,t);e>=0&&this._clips.splice(e,1)},removeAnimator:function(t){for(var e=t.getClips(),n=0;n<e.length;n++)this.removeClip(e[n]);t.animation=null},_update:function(){for(var t=(new Date).getTime()-this._pausedTime,e=t-this._time,n=this._clips,i=n.length,r=[],o=[],s=0;s<i;s++){var a=n[s],h=a.step(t,e);h&&(r.push(h),o.push(a))}for(var s=0;s<i;)n[s]._needsRemove?(n[s]=n[i-1],n.pop(),i--):s++;i=r.length;for(var s=0;s<i;s++)o[s].fire(r[s]);this._time=t,this.onframe(e),this.trigger("frame",e),this.stage.update&&this.stage.update()},_startLoop:function(){function t(){e._running&&(s(t),!e._paused&&e._update())}var e=this;this._running=!0,s(t)},start:function(){this._time=(new Date).getTime(),this._pausedTime=0,this._startLoop()},stop:function(){this._running=!1},pause:function(){this._paused||(this._pauseStart=(new Date).getTime(),this._paused=!0)},resume:function(){this._paused&&(this._pausedTime+=(new Date).getTime()-this._pauseStart,this._paused=!1)},clear:function(){this._clips=[]},animate:function(t,e){e=e||{};var n=new a(t,e.loop,e.getter,e.setter);return this.addAnimator(n),n}},i.mixin(h,o);var l=h;t.exports=l},function(t,e,n){function i(t){return t.getBoundingClientRect?t.getBoundingClientRect():{left:0,top:0}}function r(t,e,n,i){return n=n||{},i||!u.canvasSupported?o(t,e,n):u.browser.firefox&&null!=e.layerX&&e.layerX!==e.offsetX?(n.zrX=e.layerX,n.zrY=e.layerY):null!=e.offsetX?(n.zrX=e.offsetX,n.zrY=e.offsetY):o(t,e,n),n}function o(t,e,n){var r=i(t);n.zrX=e.clientX-r.left,n.zrY=e.clientY-r.top}function s(t,e,n){if(e=e||window.event,null!=e.zrX)return e;var i=e.type,o=i&&i.indexOf("touch")>=0;if(o){var s="touchend"!=i?e.targetTouches[0]:e.changedTouches[0];s&&r(t,s,e,n)}else r(t,e,e,n),e.zrDelta=e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3;var a=e.button;return null==e.which&&void 0!==a&&f.test(e.type)&&(e.which=1&a?1:2&a?3:4&a?2:0),e}function a(t,e,n){p?t.addEventListener(e,n):t.attachEvent("on"+e,n)}function h(t,e,n){p?t.removeEventListener(e,n):t.detachEvent("on"+e,n)}function l(t){return t.which>1}var c=n(11);e.Dispatcher=c;var u=n(49),p="undefined"!=typeof window&&!!window.addEventListener,f=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,d=p?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0}:function(t){t.returnValue=!1,t.cancelBubble=!0};e.clientToLocal=r,e.normalizeEvent=s,e.addEventListener=a,e.removeEventListener=h,e.stop=d,e.notLeftMouse=l},function(t,e,n){function i(t){return"mousewheel"===t&&g.browser.firefox?"DOMMouseScroll":t}function r(t,e,n){var i=t._gestureMgr;"start"===n&&i.clear();var r=i.recognize(e,t.handler.findHover(e.zrX,e.zrY,null).target,t.dom);if("end"===n&&i.clear(),r){var o=r.type;e.gestureEvent=o,t.handler.dispatchToElement({target:r.target},o,r.event)}}function o(t){t._touching=!0,clearTimeout(t._touchTimer),t._touchTimer=setTimeout(function(){t._touching=!1},700)}function s(t){var e=t.pointerType;return"pen"===e||"touch"===e}function a(t){function e(t,e){return function(){if(!e._touching)return t.apply(e,arguments)}}f.each(m,function(e){t._handlers[e]=f.bind(w[e],t)}),f.each(b,function(e){t._handlers[e]=f.bind(w[e],t)}),f.each(_,function(n){t._handlers[n]=e(w[n],t)})}function h(t){function e(e,n){f.each(e,function(e){c(t,i(e),n._handlers[e])},n)}d.call(this),this.dom=t,this._touching=!1,this._touchTimer,this._gestureMgr=new v,this._handlers={},a(this),g.pointerEventsSupported?e(b,this):(g.touchEventsSupported&&e(m,this),e(_,this))}var l=n(73),c=l.addEventListener,u=l.removeEventListener,p=l.normalizeEvent,f=n(4),d=n(11),g=n(49),v=n(75),y=300,_=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],m=["touchstart","touchend","touchmove"],x={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},b=f.map(_,function(t){var e=t.replace("mouse","pointer");return x[e]?e:t}),w={mousemove:function(t){t=p(this.dom,t),this.trigger("mousemove",t)},mouseout:function(t){t=p(this.dom,t);var e=t.toElement||t.relatedTarget;if(e!=this.dom)for(;e&&9!=e.nodeType;){if(e===this.dom)return;e=e.parentNode}this.trigger("mouseout",t)},touchstart:function(t){t=p(this.dom,t),t.zrByTouch=!0,this._lastTouchMoment=new Date,r(this,t,"start"),w.mousemove.call(this,t),w.mousedown.call(this,t),o(this)},touchmove:function(t){t=p(this.dom,t),t.zrByTouch=!0,r(this,t,"change"),w.mousemove.call(this,t),o(this)},touchend:function(t){t=p(this.dom,t),t.zrByTouch=!0,r(this,t,"end"),w.mouseup.call(this,t),+new Date-this._lastTouchMoment<y&&w.click.call(this,t),o(this)},pointerdown:function(t){w.mousedown.call(this,t)},pointermove:function(t){s(t)||w.mousemove.call(this,t)},pointerup:function(t){w.mouseup.call(this,t)},pointerout:function(t){s(t)||w.mouseout.call(this,t)}};f.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){w[t]=function(e){e=p(this.dom,e),this.trigger(t,e)}});var P=h.prototype;P.dispose=function(){for(var t=_.concat(m),e=0;e<t.length;e++){var n=t[e];u(this.dom,i(n),this._handlers[n])}},P.setCursor=function(t){this.dom.style.cursor=t||"default"},f.mixin(h,d);var C=h;t.exports=C},function(t,e,n){function i(t){var e=t[1][0]-t[0][0],n=t[1][1]-t[0][1];return Math.sqrt(e*e+n*n)}function r(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]}var o=n(73),s=function(){this._track=[]};s.prototype={constructor:s,recognize:function(t,e,n){return this._doTrack(t,e,n),this._recognize(t)},clear:function(){return this._track.length=0,this},_doTrack:function(t,e,n){var i=t.touches;if(i){for(var r={points:[],touches:[],target:e,event:t},s=0,a=i.length;s<a;s++){var h=i[s],l=o.clientToLocal(n,h,{});r.points.push([l.zrX,l.zrY]),r.touches.push(h)}this._track.push(r)}},_recognize:function(t){for(var e in a)if(a.hasOwnProperty(e)){var n=a[e](this._track,t);if(n)return n}}};var a={pinch:function(t,e){var n=t.length;if(n){var o=(t[n-1]||{}).points,s=(t[n-2]||{}).points||o;if(s&&s.length>1&&o&&o.length>1){var a=i(o)/i(s);!isFinite(a)&&(a=1),e.pinchScale=a;var h=r(o);return e.pinchX=h[0],e.pinchY=h[1],{type:"pinch",target:t[0].target,event:e}}}}},h=s;t.exports=h},function(t,e,n){function i(t,e,n){for(var i=[],r=0;r<e.length;r++){var o=e[r];o.parent&&A.isSubProcess(o.parent)||o&&o.toJSON&&i.push(o.toJSON())}for(var s=0;s<n.length;s++){var a=n[s];a.parent&&A.isSubProcess(a.parent)||a&&a.toJSON&&i.push(a.toJSON())}return t.set("childShapes",i),t.option}function r(t,e){function n(e,i){if(e.nodeType===A.SUB_PROCESS)for(var r=i.get("childShapes"),o=0;o<r.length;o++){var s=new g(r[o]);if(A.isFlowModel(s))t.addConnectorByModel(s,e);else{var a=i.get("bounds.upperLeft"),h=s.get("bounds.upperLeft"),l=s.get("bounds.lowerRight");s.set("bounds.upperLeft",{x:h.x+a.x,y:h.y+a.y}),s.set("bounds.lowerRight",{x:l.x+a.x,y:l.y+a.y});var c=t.addNodeByModel(s,!0,!0);n(c,s)}}}t.clear(!0);var i=new g(e);t.model=i;var r=i.get("properties.width"),s=i.get("properties.height");r>0&&s>0&&t.resize(r,s);for(var a=i.get("childShapes"),h=[],l=0;l<a.length;l++){var c=a[l],u=c.stencil.type;if(u===A.SEQUENCE_FLOW)h.push(c);else{var p=new g(c),f=t.addNodeByModel(p,!1,!0);n(f,p)}}for(var d=0,v=h.length;d<v;d++){var y=new g(h[d]);t.addConnectorByModel(y)}for(var _=0;_<a.length;_++)if(a[_].properties.slotEvent)for(var m=0;m<a[_].properties.slotEvent.length;m++)o(t,a[_].resourceId).slotEvent.push(o(t,a[_].properties.slotEvent[m]))}function o(t,e){for(var n,i=t.allNodes.length-1;i>=0;i--)t.allNodes[i].model.get("resourceId")==e&&(n=t.allNodes[i]);return n}function s(){d.registerClass(v,"StartNoneEvent"),d.registerClass(y,"EndNoneEvent"),d.registerClass(_,"UserTask"),d.registerClass(m,"ManualTask"),d.registerClass(x,"ScriptTask"),d.registerClass(b,"MailTask"),d.registerClass(w,"ServiceTask"),d.registerClass(P,"SmsTask"),d.registerClass(C,"Comment"),d.registerClass(S,"CatchTimerEvent"),d.registerClass(R,"CatchMessageEvent"),d.registerClass(T,"CatchSignalEvent"),d.registerClass(E,"ThrowSignalEvent"),d.registerClass(k,"InclusiveGateway"),d.registerClass(N,"ExclusiveGateway"),d.registerClass(M,"ParallelGateway"),d.registerClass(L,"SubProcess")}function a(t){return t.parent&&A.isSubProcess(t.parent)?t.position[0]+a(t.parent):t.position[0]}function h(t){return t.parent&&A.isSubProcess(t.parent)?t.position[1]+h(t.parent):t.position[1]}function l(t,e,n){var i,r;return t.parent?A.isSubProcess(t.parent)?(i=e-a(t.parent),r=n-h(t.parent),t.rectContain(i,r)):void 0:t.rectContain(e,n)}function c(t,e,n,i){for(var r=t.length-1;r>=0;r--)if(u(i,t[r])&&!t[r].ignore&&l(t[r],e,n))return t[r]}function u(t,e){return p.indexOf(t,e)==-1}var p=n(4),f=n(77),d=n(79),g=n(82),v=n(84),y=n(86),_=n(87),m=n(89),x=n(90),b=n(91),w=n(92),P=n(93),C=n(94),S=n(95),T=n(96),E=n(97),R=n(98),k=n(99),N=n(101),M=n(102),L=n(103),A=n(104),O={toJson:i,fromJson:r,registerBPMNNode:s,findHover:c,parentX:a,parentY:h,getUUID:f.getUUID};t.exports=O},function(t,e,n){function i(t,e){function n(){}var i=t.prototype;n.prototype=e.prototype,t.prototype=new n;for(var r in i)t.prototype[r]=i[r];t.prototype.constructor=t,t.superClass=e}function r(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),n=new Array(36),i=0,r=0;r<36;r++)8==r||13==r||18==r||23==r?n[r]="-":14==r?n[r]="4":(i<=2&&(i=33554432+16777216*Math.random()|0),t=15&i,i>>=4,n[r]=e[19==r?3&t|8:t]);return"sid-"+n.join("")}function o(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function s(t){for(var e=o(t[0],t[1]),n=[t[0],t[1]],i=1;i<t.length-1;i++)e<o(t[i],t[i+1])&&(e=o(t[i],t[i+1]),n=[t[i],t[i+1]]);return n}function a(t){for(var e=0,n=0;n<t.length-1;n++)e+=o(t[n],t[n+1]);return e}function h(t){if(0==t.lenght)return NaN;for(var e=t[0],n=0;n<t.length;n++)e<t[n]&&(e=t[n]);return e}function l(t){if(0==t.lenght)return NaN;for(var e=t[0],n=0;n<t.length;n++)e>t[n]&&(e=t[n]);return e}function c(t){if(t.length<=1)return!0;for(var e=0;e<t.length-1;e++)if(t[e].x!=t[e+1].x&&t[e].y!=t[e+1].y)return!1;return!0}function u(t,e){if(t.startPoint.x==t.endPoint.x&&e.startPoint.x==e.endPoint.x)return t.startPoint.x==e.startPoint.x&&(t.contains(e.startPoint.x,e.startPoint.y)||t.contains(e.endPoint.x,e.endPoint.y));if(t.startPoint.x==t.endPoint.x||e.startPoint.x==e.endPoint.x){if(t.startPoint.x==t.endPoint.x){var n=t;t=e,e=n}var i=(t.endPoint.y-t.startPoint.y)/(t.endPoint.x-t.startPoint.x),r=t.startPoint.y-i*t.startPoint.x,o=e.startPoint.x,s=i*o+r;return t.contains(o,s)&&e.contains(o,s)}var a=(t.endPoint.y-t.startPoint.y)/(t.endPoint.x-t.startPoint.x),h=t.startPoint.y-a*t.startPoint.x,l=(e.endPoint.y-e.startPoint.y)/(e.endPoint.x-e.startPoint.x),c=e.startPoint.y-l*e.startPoint.x;return a==l?h==c&&(t.contains(e.startPoint.x,e.startPoint.y)||t.contains(e.endPoint.x,e.endPoint.y)):(o=(c-h)/(a-l),s=a*o+h,t.contains(o,s)&&e.contains(o,s))}function p(t,e,n){var i=[];i.push(new I(new F(e[0],e[1]),new F(e[2],e[1]))),i.push(new I(new F(e[2],e[1]),new F(e[2],e[3]))),i.push(new I(new F(e[2],e[3]),new F(e[0],e[3]))),i.push(new I(new F(e[0],e[3]),new F(e[0],e[1])));for(var r=0;r<t.length-1;r++)for(var o=new I(t[r],t[r+1]),s=0;s<i.length;s++)if(u(o,i[s]))return!0;if(n)for(var a=new I(t[t.length-1],t[0]),h=0;h<i.length;h++)if(u(a,i[h]))return!0;return!1}function f(t){if(t.length<=2)return-1;for(var e=0,n=1;n<t.length-1;n++)if(t[n-1].x==t[n].x&&t[n].x==t[n+1].x){if(d(t[n+1].y-t[n].y)!=d(t[n].y-t[n-1].y))return-1;e++}else if(t[n-1].y==t[n].y&&t[n].y==t[n+1].y){if(d(t[n+1].x-t[n].x)!=d(t[n].x-t[n-1].x))return-1;e++}else e--;return e}function d(t){return t>0?1:t<0?-1:0}function g(t){if(t.length<=2)return!0;for(var e=0;e<t.length-2;e++)if(t[e].x==t[e+1].x&&t[e+1].x==t[e+2].x){if(0!=d(t[e+1].y-t[e].y)&&d(t[e+1].y-t[e].y)==-1*d(t[e+2].y-t[e+1].y))return!1}else if(t[e].y==t[e+1].y&&t[e+1].y==t[e+2].y&&0!=d(t[e+1].x-t[e].x)&&d(t[e+1].x-t[e].x)==-1*d(t[e+2].x-t[e+1].x))return!1;return!0}function v(t,e){var n=[];if(e){for(var i=0;i<t.length;i++){var r=t[i];n.push(new F(r[0],r[1]))}return n}for(var o=0;o<t.length;o++){var s=t[o];n.push([s.x,s.y])}return n}function y(t){var e=[[Math.cos(t),-Math.sin(t),0],[Math.sin(t),Math.cos(t),0],[0,0,1]];return e}function _(t,e){return[[1,0,t],[0,1,e],[0,0,1]]}function m(t,e){return null==e&&(e=t),[[t,0,0],[0,e,0],[0,0,1]]}function x(t,e,n){var i=t.clone();return i.transform(_(-t.x,-t.y)),i.y-=e,i.transform(y(n)),i.transform(_(t.x,t.y)),i}function b(t){return{left:new F(t.x,t.y+t.height/2),top:new F(t.x+t.width/2,t.y),right:new F(t.x+t.width,t.y+t.height/2),bottom:new F(t.x+t.width/2,t.y+t.height),center:new F(t.x+t.width/2,t.y+t.height/2)}}function w(t){return[[10*Math.round(t.getRect().width/3/10),0],[10*Math.round(2*t.getRect().width/3/10),0],[t.getRect().width,10*Math.round(t.getRect().height/3/10)],[t.getRect().width,10*Math.round(2*t.getRect().height/3/10)],[10*Math.round(t.getRect().width/3/10),t.getRect().height],[10*Math.round(2*t.getRect().width/3/10),t.getRect().height],[0,10*Math.round(t.getRect().height/3/10)],[0,10*Math.round(2*t.getRect().height/3/10)]]}function P(t,e){return-Math.PI/2-Math.atan2(e.y-t.y,e.x-t.x)}function C(t,e,n,i){var r=t.x*e.y+t.y*n.x+e.x*n.y-(e.y*n.x+t.y*e.x+t.x*n.y);return i?Math.abs(r)<=i:0===r}function S(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function T(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function E(t,e,n){t.x=S(t.x,5),t.y=S(t.y,5),e.x=S(e.x,5),e.y=S(e.y,5);var i=Math.atan((e.x-t.x)/(e.y-t.y));for(i=-i,e.x>=t.x&&e.y>=t.y?i+=Math.PI:e.x<=t.x&&e.y>=t.y?i+=Math.PI:e.x<=t.x&&e.y<=t.y&&(i+=2*Math.PI);i>=2*Math.PI;)i-=2*Math.PI;return isNaN(i)&&(i=0),n&&(i=Math.round(i/n)*n),i}function R(t,e){var n=t.getBoundingRect(),i=[];i[0]=[-n.width/2,-n.height/2],i[1]=[n.width/2,-n.height/2],i[2]=[n.width/2,n.height/2],i[3]=[-n.width/2,n.height/2],i[4]=[-n.width/2,-n.height/2];var r=t.position[0],o=t.position[1];t.parent&&"GroupNode"===t.parent.type&&e&&(r+=t.parent.position[0],o+=t.parent.position[1]);var s=new B(Number(r+n.x),Number(o+n.y),Number(n.width),Number(n.height)),a=Number(r)+Number(n.width)/2+Number(n.x),h=Number(o)+Number(n.height)/2+Number(n.y);return{x:Number(a),y:Number(h),width:Number(n.width),height:Number(n.height),points:i,boundingRect:s}}function k(){for(var t,e=["0","2","3","4","5","6","7","8","9","a","b","c","d"],n="#",i=0;i<6;i++)t=Math.round(15*Math.random()),n+=e[t];return n}function N(t){return void 0===t}function M(t){var e=[];if(t.length<3)return F.cloneArray(t);e.push(t[0].clone());for(var n=1;n<t.length-1;n++)t[n-1].x==t[n].x&&t[n].x==t[n+1].x||t[n-1].y==t[n].y&&t[n].y==t[n+1].y||e.push(t[n].clone());return e.push(t[t.length-1].clone()),e}function L(t,e,n){!e&&n&&(e=n),e=e||{},e=j.defaults(e,H,!0);var i=RegExp([(e.escape||V).source,(e.interpolate||V).source,(e.evaluate||V).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(i,function(e,n,i,s,a){return o+=t.slice(r,a).replace(U,Y),r=a+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":i?o+="'+\n((__t=("+i+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var s=new Function(e.variable||"obj",o)}catch(a){throw a.source=o,a}var h=function(t){return s.call(this,t)},l=e.variable||"obj";return h.source="function("+l+"){\n"+o+"}",h}function A(t){return null==t||(j.isArrayLike(t)&&(j.isArray(t)||j.isString(t))?0===t.length:void 0)}function O(t,e,n,i){if(!j.isObject(e)||!j.isObject(t))return n?j.clone(e):t;for(var r in e)if(e.hasOwnProperty(r)){var o=t[r],s=e[r];!j.isObject(s)||!j.isObject(o)||j.isArray(s)||j.isArray(o)||j.isDom(s)||j.isDom(o)||j.isBuiltInObject(s)||j.isBuiltInObject(o)||j.isPrimitive(s)||j.isPrimitive(o)?!n&&r in t||r!==i&&(t[r]=j.clone(e[r],!0)):O(o,s,n,i)}return t}function z(){}var F=n(64),I=n(78),B=n(26),j=n(4),D={createNew:function(){var t=[];return{add:function(t,e){var n=this.get(t);n.push(e)},get:function(e){for(var n=0;n<t.length;n++)if(e==t[n].key)return t[n].value;var i=[];return t.push({key:e,value:i}),i},keys:function(){for(var e=[],n=0;n<t.length;n++)e.push(t[n].key);return e},top:function(){return t[t.length-1]},remove:function(e){for(var n=-1,i=0;i<t.length;i++)if(e==t[i].key){n=i;break}return t.splice(n,1)[0]},removeItem:function(t,e){var n=this.get(t),i=j.indexOf(n,e);n.splice(i,1)},removeTop:function(){return t.splice(t.length-1,1)[0]},length:function(){return t.length},clear:function(){t.splice(0,t.length)}}}},H={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},V=/(.)^/,G={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},U=/\\|'|\r|\n|\u2028|\u2029/g,Y=function(t){return"\\"+G[t]};z.extend=function(t){var e,n,i=function(){},r=this,o=t&&t.init?t.init:function(){r.apply(this,arguments)};i.prototype=r.prototype,n=o.fn=o.prototype=new i;for(e in t)null!=t[e]&&t[e].constructor===Object?n[e]=j.mergeAll([{},i.prototype[e],t[e]],!0):n[e]=t[e];return n.constructor=o,o.extend=r.extend,o},t.exports={inherits:i,getUUID:r,distance:o,getPolylineLength:a,max:h,min:l,isEmpty:A,mergeOpt:O,orthogonalPath:c,polylineIntersectsRectangle:p,scorePath:f,forwardPath:g,traslatePoints:v,getEndPoint:x,getConnectorPoints:b,tangentRotation:P,collinearity:C,translationMatrix:_,scaleMatrix:m,round:S,getLength:T,getAngle:E,getRect:R,StackedMap:D,getMaxLineLength:s,randomColor:k,template:L,isUndefined:N,getSoltPoints:w,collinearReduction:M,Class:z}},function(t,e){function n(t,e){this.startPoint=t,this.endPoint=e,this.oType="Line"}n.load=function(t){var e=new n(Point.load(t.startPoint),Point.load(t.endPoint));return e},n.prototype={contructor:n,clone:function(){var t=new n(this.startPoint.clone(),this.endPoint.clone());return t},equals:function(t){return!(!t instanceof n)&&(this.startPoint.equals(t.startPoint)&&this.endPoint.equals(t.endPoint))},contains:function(t,e){if(Math.min(this.startPoint.x,this.endPoint.x)<=t&&t<=Math.max(this.startPoint.x,this.endPoint.x)&&Math.min(this.startPoint.y,this.endPoint.y)<=e&&e<=Math.max(this.startPoint.y,this.endPoint.y)){if(this.startPoint.x==this.endPoint.x)return t==this.startPoint.x;var n=(this.endPoint.y-this.startPoint.y)/(this.endPoint.x-this.startPoint.x),i=this.startPoint.y-n*this.startPoint.x;return e==n*t+i}return!1},near:function(t,e,n){if(this.endPoint.x===this.startPoint.x)return(this.startPoint.y-n<=e&&this.endPoint.y+n>=e||this.endPoint.y-n<=e&&this.startPoint.y+n>=e)&&t>this.startPoint.x-n&&t<this.startPoint.x+n;if(this.startPoint.y===this.endPoint.y)return(this.startPoint.x-n<=t&&this.endPoint.x+n>=t||this.endPoint.x-n<=t&&this.startPoint.x+n>=t)&&e>this.startPoint.y-n&&e<this.startPoint.y+n;var i=Math.min(this.endPoint.x,this.startPoint.x),r=Math.min(this.endPoint.y,this.startPoint.y),o=Math.max(this.endPoint.x,this.startPoint.x),s=Math.max(this.endPoint.y,this.startPoint.y),a=this.endPoint.y-this.startPoint.y,h=this.startPoint.x-this.endPoint.x,l=-(this.startPoint.x*this.endPoint.y-this.endPoint.x*this.startPoint.y),c=Math.abs((a*t+h*e+l)/Math.sqrt(Math.pow(a,2)+Math.pow(h,2))),u=(h*(h*t-a*e)-a*l)/(Math.pow(a,2)+Math.pow(h,2)),p=(a*(-h*t+a*e)-h*l)/(Math.pow(a,2)+Math.pow(h,2)),f=c<=n&&o>=u&&u>=i&&s>=p&&p>=r||this.startPoint.near(t,e,n)||this.endPoint.near(t,e,n);return f},getPoints:function(){var t=[];return t.push(this.startPoint),t.push(this.endPoint),t},getPoint:function(t){var e=t*(this.endPoint.x-this.startPoint.x)+this.startPoint.x,n=t*(this.endPoint.y-this.startPoint.y)+this.startPoint.y;return new Point(e,n)},toString:function(){return"line("+this.startPoint+","+this.endPoint+")"}},t.exports=n},function(t,e,n){function i(t,e){o.call(this),this.model=t,this.options={outline:{enable:!0,radius:!0,initVisible:!1},text:{color:"#000000",lineHeight:24}},this.bpmnInfo={type:-1,name:"BPMNDiagram",displayName:"Task"};var n=t.get("resourceId");n&&""!=n&&(this.resourceId=n);var i=t.get("properties");i.operationIcons&&(this.operationIcons=i.operationIcons),this.initEvent(e)}function r(t){var e=encodeURIComponent(t).match(/%[89ABab]/g);return t.length+(e?e.length:0)}var o=n(80),s=n(4),a=(n(3),n(81));i.prototype.initEvent=function(t){var e=this,n=["dblclick","click"];s.each(n,function(n){e.on(n,function(i){var r={};r.event=i,r.type=n,r.target=e,t.trigger(n,r)},this)})},i.prototype.getRect=function(){},i.prototype.getBoundingRect=function(){},i.prototype.setPosition=function(t,e){},i.prototype.rectContain=function(t,e){var n=this.getRect();return n.boundingRect.contain(t,e)},i.prototype.toJSON=function(){if(this.model.set("resourceId",this.resourceId),this.model.set("properties.type",this.bpmnInfo.type),this.model.set("stencil.type",this.bpmnInfo.name),this.slotEvent&&this.slotEvent.length>0){for(var t=[],e=this.slotEvent.length-1;e>=0;e--)t.push(this.slotEvent[e].resourceId);this.model.set("properties.slotEvent",t)}this.model.set("properties.type",this.bpmnInfo.type);var n=this.getRect().boundingRect;return this.model.set("bounds.upperLeft.x",parseInt(n.x)),this.model.set("bounds.upperLeft.y",parseInt(n.y)),this.model.set("bounds.lowerRight.x",parseInt(n.x+n.width)),this.model.set("bounds.lowerRight.y",parseInt(n.y+n.height)),this.model.option},i.prototype.setModel=function(t){function e(t){return t.parent&&"SubProcess"==t.parent.nodeType?t.position[0]+e(t.parent):t.position[0]}function n(t){return t.parent&&"SubProcess"==t.parent.nodeType?t.position[1]+n(t.parent):t.position[1]}var i,o=this,s=this.model.get("properties.name");if(this.model.mergeOption(t),(t.properties.name||""==t.properties.name||"0"==t.properties.name)&&s!=t.properties.name){var a,h=this.childOfName("Title"),l=r(t.properties.name);if(l>15?(a=t.properties.name.substr(0,6)+"..",this.alarm&&(this.alarm.isShow=!0)):(a=t.properties.name,this.alarm&&(this.alarm.isShow=!1)),h.attr("style",{text:a}),i=t.properties.position?t.properties.position:"init",o.refreshText(i),this.alarm){var c=t.properties.name,u=this.alarm.childOfName("Text");u.attr("style",{text:c});var p=u.getBoundingRect().width+4,f=u.getBoundingRect().height+8,d=[[0,0],[p,0],[p,f],[p-3,f],[p-6,f+3],[p-9,f],[0,f],[0,0]],g=this.alarm.childOfName("Polyline");g.attr("shape",{points:d});var v=e(this),y=n(this),_=[v+this.getBoundingRect().width-(this.alarm.getBoundingRect().width-6),y-this.alarm.getBoundingRect().height-3];this.alarm.attr("position",_)}}},s.inherits(i,o),a.enableClassManagement(i,{registerWhenExtend:!0}),t.exports=i},function(t,e,n){function i(){this.resourceId=o.getUUID(),r.Group.call(this)}var r=n(3),o=n(77);i.prototype.render=function(){},i.prototype.getRect=function(t){},i.prototype.drawText=function(t,e,n){var i,o,s=this.bpmnInfo.name;null!=t&&(s=t);var a=new r.Text({style:{text:s,color:e?e:this.options.text.color,textFont:"12px Microsoft YaHei"},zlevel:20});switch(n=n?n:"init"){case"init":i=this.getRect().x-this.position[0]-a.getBoundingRect().width/2,o=this.getRect().y-this.position[1]+this.getBoundingRect().height/2+6;break;case"center":i=this.getRect().x-this.position[0]-a.getBoundingRect().width/2,o=this.getRect().y-this.position[1]-6;break;case"left":i=this.getRect().x-this.position[0]-a.getBoundingRect().width+6,o=this.getRect().y-this.position[1]-6}return a.attr("style",{x:i,y:o}),{text:a,rect:a.getBoundingRect()}},i.prototype.refreshText=function(t){var e,n,i=this.childOfName("Title");switch(t=t?t:"init"){case"init":e=this.getRect().x-this.position[0]-i.getBoundingRect().width/2,n=this.getRect().y-this.position[1]+this.getBoundingRect().height/2+6;break;case"center":e=this.getRect().x-this.position[0]-i.getBoundingRect().width/2,n=this.getRect().y-this.position[1]-6;break;case"left":e=2,n=this.getRect().y-this.position[1]-6}i.attr("style",{x:e,y:n})},i.prototype.toJSON=function(){},r.Util.inherits(i,r.Group),t.exports=i},function(t,e,n){function i(t,e){var n=o.slice(arguments,2);return this.superClass.prototype[e].apply(t,n)}function r(t,e,n){return this.superClass.prototype[e].apply(t,n)}var o=n(4),s={},a=".",h="___FT__COMPONENT__CONTAINER___",l=s.parseClassType=function(t){var e={main:"",sub:""};return t&&(t=t.split(a),e.main=t[0]||"",e.sub=t[1]||""),e};s.enableClassExtend=function(t,e){t.extend=function(n){var s=function(){e&&e.apply(this,arguments),t.apply(this,arguments)};return o.extend(s.prototype,n),s.extend=this.extend,s.superCall=i,s.superApply=r,o.inherits(s,this),s.superClass=this,s}},s.enableClassManagement=function(t,e){function n(t){var e=i[t.main];return e&&e[h]||(e=i[t.main]={},e[h]=!0),e}e=e||{};var i={};if(t.registerClass=function(t,e){if(e)if(e=l(e),e.sub){if(e.sub!==h){var r=n(e);r[e.sub]=t}}else{if(i[e.main])return;i[e.main]=t}return t},t.getClass=function(t,e,n){var r=i[t];if(r&&r[h]&&(r=e?r[e]:null),n&&!r)throw new Error("Component "+t+"."+(e||"")+" not exists. Load it first.");return r},t.getClassesByMainType=function(t){t=l(t);var e=[],n=i[t.main];return n&&n[h]?o.each(n,function(t,n){n!==h&&e.push(t)}):e.push(n),e},t.hasClass=function(t){return t=l(t),!!i[t.main]},t.getAllClassMainTypes=function(){var t=[];return o.each(i,function(e,n){t.push(n)}),t},t.hasSubTypes=function(t){t=l(t);var e=i[t.main];return e&&e[h]},t.parseClassType=l,e.registerWhenExtend){var r=t.extend;r&&(t.extend=function(e){var n=r.call(this,e);return t.registerClass(n,e.type)})}return t},t.exports=s},function(t,e,n){var i=n(83),r=i.extend({type:"BPMN",defaultOption:{resourceId:"",properties:{type:-1,name:null,notes:"",extProperties:{}},stencil:{type:"BPMNDiagram"},childShapes:[],outgoing:[],bounds:{upperLeft:{x:0,y:0},lowerRight:{x:0,y:0}}}});t.exports=r},function(t,e,n){function i(t,e,n){this.parentModel=e,this.option=t,this.init&&(arguments.length<=3?this.init(t,e,n):this.init.apply(this,arguments))}var r=n(4),o=n(81);i.prototype={constructor:i,init:function(t){r.merge(t,this.getDefaultOption())},getDefaultOption:function(){if(!this.hasOwnProperty("__defaultOption")){for(var t=[],e=this.constructor;e;){var n=e.prototype.defaultOption;n&&t.push(n),e=e.superClass}for(var i={},o=t.length-1;o>=0;o--)i=r.merge(i,t[o],!0);this.__defaultOption=i}return this.__defaultOption},mergeOption:function(t){r.merge(this.option,t,!0)},get:function(t,e){if(!t)return this.option;"string"==typeof t&&(t=t.split("."));for(var n=this.option,i=this.parentModel,r=0;r<t.length&&(n=n&&"object"==typeof n?n[t[r]]:null,null!=n);r++);return null==n&&i&&!e&&(n=i.get(t)),n},set:function(t,e){var n=this.option;if(t.indexOf(".")==-1)n[t]=e;else{for(var i,r=t.split("."),o=r.length,s=n,a=0;a<o-1;a++)i=r[a],null==s[i]&&(s[i]={}),s=s[i];i=r[o-1],s[i]=e}},getShallow:function(t,e){var n=this.option,i=n&&n[t],r=this.parentModel;return null==i&&r&&!e&&(i=r.getShallow(t)),i},getModel:function(t,e){var n=this.get(t,!0),r=this.parentModel,o=new i(n,e||r&&r.getModel(t));return o},isEmpty:function(){return null==this.option},restoreData:function(){},clone:function(){var t=this.constructor;return new t(r.clone(this.option))}},o.enableClassExtend(i),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.itemSize=18,this.model=t,this.bpmnInfo={type:29,name:"StartNoneEvent"},this.render(t)}var r=n(85),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-.5},style:{fill:"#000"},z:2});e.name="Circle",this.add(e);var n=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-2},style:{fill:"#fff"},z:2});this.add(n),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var i=this.drawText(t.get("properties.name"));i.text.name="Title",this.add(i.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.bpmnInfo={type:-1,name:"EventNode"},this.model=t}var r=n(79),o=n(4),s=n(26);i.prototype.render=function(){},i.prototype.getRect=function(){var t=this.getBoundingRect(),e=[];e[0]=[-t.width/2,-t.height/2],e[1]=[t.width/2,-t.height/2],e[2]=[t.width/2,t.height/2],e[3]=[-t.width/2,t.height/2],e[4]=[-t.width/2,-t.height/2];var n=new s(this.position[0]-t.width/2,this.position[1]-t.height/2,t.width,t.height);return{x:this.position[0],y:this.position[1],width:t.width/2,height:t.height/2,points:e,boundingRect:n}},i.prototype.setPosition=function(t,e){this.attr("position",[t,e])},i.prototype.getBoundingRect=function(){var t=this.childOfName("Circle");return t.getBoundingRect()},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.itemSize=18,this.model=t,this.bpmnInfo={type:31,name:"EndNoneEvent"},this.render(t)}var r=n(85),o=n(4),s=n(3);i.prototype.render=function(t){
var e=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-.5},style:{fill:"#000"},z:2});e.name="Circle",this.add(e);var n=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-5},style:{fill:"#fff"},z:2});this.add(n),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var i=this.drawText(t.get("properties.name"));i.text.name="Title",this.add(i.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="M765.573741 718.489888c-14.999622-112.659873-119.671567-196.438974-237.776452-196.438974-118.912273 0-220.514299 85.277222-238.20317 198.770066-11.840676 76.071559 54.585199 71.326489 54.585199 71.326489l360.734878 0C704.913173 792.148491 776.608052 801.364387 765.573741 718.489888zM690.249195 365.718379c0 89.911776-72.889077 162.810063-162.79676 162.810063-89.908706 0-162.797783-72.898287-162.797783-162.810063 0-89.916892 72.889077-162.80597 162.797783-162.80597C617.360118 202.912409 690.249195 275.801487 690.249195 365.718379z",this.bpmnInfo={type:0,name:"UserTask"},this.render(t)}var r=n(88),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);var n={x:5,y:5,width:15,height:15},i=s.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},n);this.add(i),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var r=this.drawText(t.get("properties.name"),"","center");r.text.name="Title",this.add(r.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.bpmnInfo={type:-1,name:"TaskNode"},this.model=t,this.slot=[],this.slotEvent=[],this.isCanSlot=!0}var r=n(79),o=n(4),s=n(26);i.prototype.render=function(){},i.prototype.getRect=function(){var t=this.getBoundingRect(),e=[];e[0]=[-t.width/2,-t.height/2],e[1]=[t.width/2,-t.height/2],e[2]=[t.width/2,t.height/2],e[3]=[-t.width/2,t.height/2],e[4]=[-t.width/2,-t.height/2];var n=new s(this.position[0],this.position[1],t.width,t.height);return{x:this.position[0]+t.width/2,y:this.position[1]+t.height/2,width:t.width,height:t.height,points:e,boundingRect:n}},i.prototype.getBoundingRect=function(){var t=this.childOfName("Rect");return t.getBoundingRect()},i.prototype.setPosition=function(t,e){var n=this.getBoundingRect();this.attr("position",[t-n.width/2,e-n.height/2])},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="m 17,9.3290326 c -0.0069,0.5512461 -0.455166,1.0455894 -0.940778,1.0376604 l -5.792746,0 c 0.0053,0.119381 0.0026,0.237107 0.0061,0.355965 l 5.154918,0 c 0.482032,-0.0096 0.925529,0.49051 0.919525,1.037574 -0.0078,0.537128 -0.446283,1.017531 -0.919521,1.007683 l -5.245273,0 c -0.01507,0.104484 -0.03389,0.204081 -0.05316,0.301591 l 2.630175,0 c 0.454137,-0.0096 0.872112,0.461754 0.866386,0.977186 C 13.619526,14.554106 13.206293,15.009498 12.75924,15 L 3.7753054,15 C 3.6045812,15 3.433552,14.94423 3.2916363,14.837136 c -0.00174,0 -0.00436,0 -0.00609,0 C 1.7212035,14.367801 0.99998255,11.458641 1,11.458641 L 1,7.4588393 c 0,0 0.6623144,-1.316333 1.8390583,-2.0872584 1.1767614,-0.7711868 6.8053358,-2.40497 7.2587847,-2.8052901 0.453484,-0.40032 1.660213,1.4859942 0.04775,2.4010487 C 8.5332315,5.882394 8.507351,5.7996113 8.4370292,5.7936859 l 6.3569748,-0.00871 c 0.497046,-0.00958 0.952273,0.5097676 0.94612,1.0738232 -0.0053,0.556126 -0.456176,1.0566566 -0.94612,1.0496854 l -4.72435,0 c 0.01307,0.1149374 0.0244,0.2281319 0.03721,0.3498661 l 5.952195,0 c 0.494517,-0.00871 0.947906,0.5066305 0.940795,1.0679848 z",this.bpmnInfo={type:4,name:"ManualTask"},this.render(t)}var r=n(88),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);var n={x:5,y:5,width:15,height:15};this.add(s.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},n)),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var i=this.drawText(t.get("properties.name"),"","center");i.text.name="Title",this.add(i.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="m 5,2 0,0.094 c 0.23706,0.064 0.53189,0.1645 0.8125,0.375 0.5582,0.4186 1.05109,1.228 1.15625,2.5312 l 8.03125,0 1,0 1,0 c 0,-3 -2,-3 -2,-3 l -10,0 z M 4,3 4,13 2,13 c 0,3 2,3 2,3 l 9,0 c 0,0 2,0 2,-3 L 15,6 6,6 6,5.5 C 6,4.1111 5.5595,3.529 5.1875,3.25 4.8155,2.971 4.5,3 4.5,3 L 4,3 z",this.bpmnInfo={type:7,name:"ScriptTask"},this.render(t)}var r=n(88),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);var n={x:5,y:5,width:15,height:15};this.add(s.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},n)),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var i=this.drawText(t.get("properties.name"),"","center");i.text.name="Title",this.add(i.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="M49.013,51.003c1.847,1.303,7.414,5.174,16.702,11.61S82.118,74.005,87.061,77.48c0.543,0.381,1.697,1.209,3.462,2.485c1.765,1.277,3.232,2.31,4.399,3.097c1.168,0.787,2.58,1.67,4.237,2.647c1.657,0.977,3.219,1.711,4.685,2.198c1.467,0.49,2.825,0.733,4.074,0.733H108h0.082c1.249,0,2.607-0.243,4.074-0.733c1.466-0.487,3.029-1.222,4.685-2.198c1.656-0.978,3.068-1.86,4.236-2.647s2.634-1.82,4.399-3.097s2.92-2.104,3.463-2.485c4.996-3.476,17.707-12.302,38.129-26.479c3.965-2.769,7.277-6.11,9.939-10.021C179.67,37.071,181,32.97,181,28.679c0-3.585-1.291-6.654-3.871-9.207c-2.58-2.553-5.636-3.829-9.165-3.829H48.035c-4.182,0-7.4,1.412-9.654,4.236C36.127,22.704,35,26.235,35,30.471c0,3.422,1.494,7.13,4.481,11.122S45.646,48.722,49.013,51.003z M172.852,59.72c-17.814,12.057-31.34,21.427-40.572,28.108c-3.096,2.281-5.608,4.061-7.537,5.336c-1.928,1.277-4.494,2.58-7.699,3.911c-3.204,1.331-6.191,1.996-8.961,1.996H108h-0.082c-2.77,0-5.758-0.665-8.962-1.996s-5.771-2.634-7.699-3.911c-1.928-1.275-4.44-3.055-7.536-5.336c-7.333-5.377-20.83-14.747-40.492-28.108c-3.096-2.063-5.839-4.427-8.229-7.088v64.688c0,3.586,1.276,6.654,3.829,9.207c2.553,2.554,5.622,3.83,9.207,3.83h119.929c3.584,0,6.653-1.276,9.206-3.83c2.554-2.554,3.829-5.621,3.829-9.207V52.632C178.664,55.238,175.949,57.602,172.852,59.72z",this.bpmnInfo={type:8,name:"MailTask"},this.render(t)}var r=n(88),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);var n={x:5,y:5,width:15,height:15};this.add(s.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},n)),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var i=this.drawText(t.get("properties.name"),"","center");i.text.name="Title",this.add(i.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="M891.84 410.072c-8.936-33.48-22.192-65.232-39.192-94.584l74.512-112.4-106.272-106.184-112.344 74.456c-29.384-16.944-61.144-30.256-94.648-39.2L587.08 0l-150.16 0-26.816 132.16c-33.504 8.944-65.264 22.256-94.648 39.2l-112.4-74.456L96.832 203.08l74.52 112.4c-17 29.352-30.256 61.112-39.2 94.648L0 436.888l0 150.192 132.16 26.824c8.944 33.504 22.192 65.264 39.2 94.648l-74.52 112.408 106.216 106.152 112.4-74.456c29.384 16.936 61.144 30.256 94.648 39.192L436.92 1024l150.16 0 26.824-132.16c33.504-8.936 65.264-22.256 94.648-39.192l112.344 74.456 106.272-106.152-74.512-112.408c17-29.384 30.256-61.144 39.192-94.648L1024 587.08 1024 436.888 891.84 410.072 891.84 410.072zM689.8 512c0 98.152-79.584 177.8-177.8 177.8S334.208 610.152 334.208 512c0-98.176 79.584-177.792 177.792-177.792S689.8 413.824 689.8 512z",this.bpmnInfo={type:12,name:"ServiceTask"},this.render(t)}var r=n(88),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);var n={x:5,y:5,width:15,height:15};this.add(s.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},n)),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var i=this.drawText(t.get("properties.name"),"","center");i.text.name="Title",this.add(i.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.rectSize={width:100,height:60},this.iconPath="M959.907775 439.894775c0 195.140399-200.607924 352.909655-447.964568 352.909655-21.76163 0-43.083238-1.203408-64.080457-3.499707-41.555441-4.701069-109.897969 121.601522-300.828486 147.517775 100.164281-117.992321 106.727767-206.485795 74.250074-228.301659C125.053646 643.782396 64.091202 547.553751 64.091202 439.894775c0-194.757682 200.607924-352.717274 447.852004-352.717274C759.299851 87.177502 959.907775 245.13607 959.907775 439.894775z",this.bpmnInfo={type:11,name:"SmsTask"},this.render(t)}var r=n(88),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#fff",stroke:"#000"},z:2});e.name="Rect",this.add(e);var n={x:5,y:5,width:15,height:15};this.add(s.makePath(this.iconPath,{style:{fill:"#fff",stroke:"#000"},z:2},n)),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var i=this.drawText(t.get("properties.name"),"","center");i.text.name="Title",this.add(i.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.bpmnInfo={type:21,name:"Comment"},this.model=t,this.render(t)}var r=n(79),o=n(4),s=n(26),a=n(3);i.prototype.render=function(t){var e=new a.Rect({shape:{x:0,y:0,width:100,height:40},style:{opacity:0},z:2});e.name="Rect",this.add(e);var n=new a.Line({shape:{x1:0,y1:0,x2:10,y2:0},style:{lineWidth:1,stroke:"#000"}});this.add(n);var i=new a.Line({shape:{x1:0,y1:0,x2:0,y2:40},style:{lineWidth:1,stroke:"#000"}});this.add(i);var r=new a.Line({shape:{x1:0,y1:40,x2:10,y2:40},style:{lineWidth:1,stroke:"#000"}});this.add(r),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var o=this.drawText(t.get("properties.name"),"","left");o.text.name="Title",this.add(o.text)},i.prototype.getRect=function(t){var e=this.getBoundingRect(),n=[];n[0]=[-e.width/2,-e.height/2],n[1]=[e.width/2,-e.height/2],n[2]=[e.width/2,e.height/2],n[3]=[-e.width/2,e.height/2],n[4]=[-e.width/2,-e.height/2];var i=new s(this.position[0],this.position[1],e.width,e.height);return{x:this.position[0]+e.width/2,y:this.position[1]+e.height/2,width:e.width,height:e.height,points:n,boundingRect:i}},i.prototype.setPosition=function(t,e){var n=this.getBoundingRect();this.attr("position",[t-n.width/2,e-n.height/2])},i.prototype.getBoundingRect=function(){var t=this.childOfName("Rect");return t.getBoundingRect()},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.startIcon="M 10 0 C 4.4771525 0 0 4.4771525 0 10 C 0 15.522847 4.4771525 20 10 20 C 15.522847 20 20 15.522847 20 10 C 20 4.4771525 15.522847 1.1842379e-15 10 0 z M 9.09375 1.03125 C 9.2292164 1.0174926 9.362825 1.0389311 9.5 1.03125 L 9.5 3.5 L 10.5 3.5 L 10.5 1.03125 C 15.063526 1.2867831 18.713217 4.9364738 18.96875 9.5 L 16.5 9.5 L 16.5 10.5 L 18.96875 10.5 C 18.713217 15.063526 15.063526 18.713217 10.5 18.96875 L 10.5 16.5 L 9.5 16.5 L 9.5 18.96875 C 4.9364738 18.713217 1.2867831 15.063526 1.03125 10.5 L 3.5 10.5 L 3.5 9.5 L 1.03125 9.5 C 1.279102 5.0736488 4.7225326 1.4751713 9.09375 1.03125 z M 9.5 5 L 9.5 8.0625 C 8.6373007 8.2844627 8 9.0680195 8 10 C 8 11.104569 8.8954305 12 10 12 C 10.931981 12 11.715537 11.362699 11.9375 10.5 L 14 10.5 L 14 9.5 L 11.9375 9.5 C 11.756642 8.7970599 11.20294 8.2433585 10.5 8.0625 L 10.5 5 L 9.5 5 z",this.itemSize=10,this.bpmnInfo={type:43,name:"CatchTimerEvent"},this.render(t)}var r=n(85),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-.5},style:{fill:"#ffffff",stroke:"#000"},z:3});e.name="Circle",this.add(e);var n=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-3},style:{fill:"#ffffff",stroke:"#000"},z:3});this.add(n);var i=this.itemSize+6,r={x:-i/2,y:-i/2,width:i,height:i};this.add(s.makePath(this.startIcon,{style:{stroke:"#000"},z:3},r,"center")),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var o=this.drawText(t.get("properties.name"));o.text.name="Title",this.add(o.text),this.z=3},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.startIcon="M7.7124971 20.247342  L22.333334 20.247342  L15.022915000000001 7.575951200000001  L7.7124971 20.247342  z",this.itemSize=10,this.bpmnInfo={type:72,name:"CatchSignalEvent"},this.render(t)}var r=n(85),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-.5},style:{fill:"#ffffff",stroke:"#000"},z:3});e.name="Circle",this.add(e);var n=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-3},style:{fill:"#ffffff",stroke:"#000"},z:3});this.add(n);var i=this.itemSize,r={x:-i/2,y:-i/2-2,width:i,height:i};this.add(s.makePath(this.startIcon,{style:{stroke:"#000",fill:"#ffffff"},z:3},r,"center")),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var o=this.drawText(t.get("properties.name"));o.text.name="Title",this.add(o.text),this.z=3},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.startIcon="M7.7124971 20.247342  L22.333334 20.247342  L15.022915000000001 7.575951200000001  L7.7124971 20.247342  z",this.itemSize=10,this.bpmnInfo={type:75,name:"ThrowSignalEvent"},this.render(t)}var r=n(85),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-.5},style:{fill:"#ffffff",stroke:"#000"},z:3});e.name="Circle",this.add(e);var n=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-3},style:{fill:"#ffffff",stroke:"#000"},z:3});this.add(n);var i=this.itemSize,r={x:-i/2,y:-i/2-2,width:i,height:i};this.add(s.makePath(this.startIcon,{style:{stroke:"#000",fill:"#000000"},z:3},r,"center")),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var o=this.drawText(t.get("properties.name"));o.text.name="Title",this.add(o.text),this.z=3},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.startIcon="M664.356571 633.344l-50.797714 0 228.827429 146.980571L181.613714 780.324571l228.827429-146.980571-50.834286 0-203.190857 130.450286L156.416 359.094857l359.021714 242.578286 352.146286-235.300571 0 397.458286L664.356571 633.344zM156.416 299.922286 156.416 243.675429l711.168 0 0 71.314286-351.378286 222.171429L156.416 299.922286z",this.itemSize=18,this.bpmnInfo={type:100,name:"CatchMessageEvent"},this.render(t)}var r=n(85),o=n(4),s=n(3);i.prototype.render=function(t){var e=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-.5},style:{fill:"#ffffff",stroke:"#000"},z:2});e.name="Circle",this.add(e);var n=new s.Circle({shape:{cx:0,cy:0,r:this.itemSize-3},style:{fill:"#ffffff",stroke:"#000"},z:2});this.add(n);var i=this.itemSize,r={x:-i/2,y:-i/2,width:i,height:i};this.add(s.makePath(this.startIcon,{style:{stroke:"#fff"},z:2},r,"center")),this.position=[t.get("bounds.upperLeft.x")+this.itemSize,t.get("bounds.upperLeft.y")+this.itemSize];var o=this.drawText(t.get("properties.name"));o.text.name="Title",this.add(o.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.startIcon="M0 19.506393964  L19.506393964 0  L39.012787964 19.506393964  L19.506393964 39.012787964  L0 19.506393964  L0 19.506393964  z",this.nextIcon="M507.7383 49.463867C327.38957 48.865055 154.337045 165.397235 85.887695 332.095705 13.82828 497.171875 51.26921 702.2376 177.31836 830.98145 298.5502 961.4774 498.29297 1009.3747 665.5781 948.3174 838.948 889.28065 966.9399 719.02055 973.89745 535.7715 985.56715 355.706145 879.6298 176.060825 717.4209 97.625 653.90365 65.927975 582.97465 49.398509 512 49.5 510.57905 49.480728 509.15835 49.468582 507.7383 49.463867zM520.41405 99.450195C696.9503 100.419315 863.2164 228.12953 908.87305 398.964845 957.3881 562.41865 891.7662 751.6676 750.9199 848.47755 604.61365 956.01475 387.64963 948.23445 249.48828 830.3994 110.28125 719.40945 60.452365 514.11165 131.875 351.308595 193.77873 200.80243 349.16891 97.58941 512 99.5 514.8069 99.451185 517.6119 99.43481 520.41405 99.450195z",this.itemSize=20,this.bpmnInfo={type:20,name:"InclusiveGateway"},this.render(t)}var r=n(100),o=n(4),s=n(3);i.prototype.render=function(t){var e=2*this.itemSize,n={x:-e/2,y:-e/2,width:e,height:e},i=s.makePath(this.startIcon,{style:{stroke:"#000",fill:"#fff"},z:2},n,"center");i.name="Path",this.add(i);var r=this.itemSize,o={x:-r/2,y:-r/2,width:r,height:r};this.add(s.makePath(this.nextIcon,{style:{stroke:"#000"},z:2},o,"center")),this.position=[t.get("bounds.upperLeft.x")+r,t.get("bounds.upperLeft.y")+r];var a=this.drawText(t.get("properties.name"));a.text.name="Title",this.add(a.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.bpmnInfo={type:-1,name:"GatewayNode"},this.model=t}var r=n(79),o=n(4),s=n(26);i.prototype.render=function(){},i.prototype.getRect=function(){var t=this.getBoundingRect(),e=[];e[0]=[-t.width/2,-t.height/2],e[1]=[t.width/2,-t.height/2],e[2]=[t.width/2,t.height/2],e[3]=[-t.width/2,t.height/2],e[4]=[-t.width/2,-t.height/2];var n=new s(this.position[0]-t.width/2,this.position[1]-t.height/2,t.width,t.height);return{x:this.position[0],y:this.position[1],width:t.width/2,height:t.height/2,points:e,boundingRect:n}},i.prototype.setPosition=function(t,e){this.attr("position",[t,e])},i.prototype.getBoundingRect=function(){var t=this.childOfName("Path");return t.getBoundingRect()},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.startIcon="M0 19.506393964  L19.506393964 0  L39.012787964 19.506393964  L19.506393964 39.012787964  L0 19.506393964  L0 19.506393964  z",this.nextIcon="M19.904129064000003 17.676993964000005  L24.997457864000005 12.583664864000003  L26.058118064000006 11.523004664000002  L28.179438464 13.644324964000003  L27.118778264 14.704985164000002  L22.025449364000004 19.798314364  L27.118778264 24.891643464000005  L28.179438464 25.952303664000006  L26.058118064000006 28.073623964000003  L24.997457864000005 27.012963764000006  L19.904129064000003 21.919634764  L14.810800164000003 27.012963764000006  L13.750140064000002 28.073623964000003  L11.628819664000003 25.952303664000006  L12.689479764000003 24.891643464000005  L17.782808764000002 19.798314364  L12.689479764000003 14.704985164000002  L11.628819664000003 13.644324964000003  L13.750140064000002 11.523004664000002  L14.810800164000003 12.583664864000003  L19.904129064000003 17.676993964000005  z",this.itemSize=20,this.bpmnInfo={type:17,name:"ExclusiveGateway"},this.render(t)}var r=n(100),o=n(4),s=n(3);i.prototype.render=function(t){var e=2*this.itemSize,n={x:-e/2,y:-e/2,width:e,height:e},i=s.makePath(this.startIcon,{style:{stroke:"#000",fill:"#fff"},z:2},n,"center");i.name="Path",this.add(i);var r=this.itemSize,o={x:-r/2,y:-r/2,width:r,height:r};this.add(s.makePath(this.nextIcon,{style:{stroke:"#000"},z:2},o,"center")),this.position=[t.get("bounds.upperLeft.x")+r,t.get("bounds.upperLeft.y")+r];var a=this.drawText(t.get("properties.name"));a.text.name="Title",this.add(a.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.startIcon="M0 19.506393964  L19.506393964 0  L39.012787964 19.506393964  L19.506393964 39.012787964  L0 19.506393964  L0 19.506393964  z",this.nextIcon="M8.275862069 11.965517269000001  L1.499999999 11.965517269000001  L0 11.965517269000001  L0 8.965517239  L1.499999999 8.965517239  L8.275862069 8.965517239  L8.275862069 1.499999999  L8.275862069 0  L11.275862069 0  L11.275862069 1.499999999  L11.275862069 8.965517239  L18.741379269 8.965517239  L20.241379269 8.965517239  L20.241379269 11.965517269000001  L18.741379269 11.965517269000001  L11.275862069 11.965517269000001  L11.275862069 18.741379269  L11.275862069 20.241379269  L8.275862069 20.241379269  L8.275862069 18.741379269  L8.275862069 11.965517269000001  z",this.itemSize=20,this.bpmnInfo={type:20,name:"ParallelGateway"},this.render(t)}var r=n(100),o=n(4),s=n(3);i.prototype.render=function(t){var e=2*this.itemSize,n={x:-e/2,y:-e/2,width:e,height:e},i=s.makePath(this.startIcon,{style:{stroke:"#000",fill:"#fff"},z:2},n,"center");i.name="Path",this.add(i);var r=this.itemSize,o={x:-r/2,y:-r/2,width:r,height:r};this.add(s.makePath(this.nextIcon,{style:{stroke:"#000"},z:2},o,"center")),this.position=[t.get("bounds.upperLeft.x")+r,t.get("bounds.upperLeft.y")+r];var a=this.drawText(t.get("properties.name"));a.text.name="Title",this.add(a.text)},o.inherits(i,r),t.exports=i},function(t,e,n){function i(t,e){r.call(this,t,e),this.bpmnInfo={type:-1,name:"SubProcess"},this.model=t,this.slot=[],this.slotEvent=[],this.isCanSlot=!0;var n,i;n=t.get("bounds.lowerRight.x")-t.get("bounds.upperLeft.x"),i=t.get("bounds.lowerRight.y")-t.get("bounds.upperLeft.y"),(!n||n<=0)&&(n=160),(!i||i<=0)&&(i=100),this.rectSize={width:n,height:i},this.render(t)}var r=(n(104),n(79)),o=n(4),s=n(26),a=n(3),h=n(105);i.prototype.initEvent=function(t){var e=this,n=["dblclick","click"];o.each(n,function(n){e.on(n,function(i){var r={};r.event=i;var o=i.target;o.parent&&o.parent instanceof h||(r.type=n,r.target=e,t.trigger(n,r))},this)})},i.prototype.render=function(t){var e=new a.Rect({shape:{x:.5,y:.5,width:this.rectSize.width-1,height:this.rectSize.height-1,r:7},style:{fill:"#f9f9f9",stroke:"#bbbbbb"},z:0});e.name="subprocess-rect",this.add(e),this.position=[t.get("bounds.upperLeft.x"),t.get("bounds.upperLeft.y")];var n=this.drawText(t.get("properties.name"));n.text.name="Title",this.add(n.text)},i.prototype.getRect=function(){var t=this.getBoundingRect(),e=[];e[0]=[-t.width/2,-t.height/2],e[1]=[t.width/2,-t.height/2],e[2]=[t.width/2,t.height/2],e[3]=[-t.width/2,t.height/2],e[4]=[-t.width/2,-t.height/2];var n=new s(this.position[0],this.position[1],t.width,t.height);return{x:this.position[0]+t.width/2,y:this.position[1]+t.height/2,width:t.width,height:t.height,points:e,boundingRect:n}},i.prototype.setPosition=function(t,e){var n=this.getBoundingRect();this.attr("position",[t-n.width/2,e-n.height/2])},i.prototype.refresh=function(t){var e=this.childOfName("subprocess-rect");e.setShape(t.shape),this.attr("position",t.position),this.refreshText()},i.prototype.getBoundingRect=function(){var t=this.childOfName("subprocess-rect");return t.getBoundingRect()},i.prototype.toJSON=function(){if(this.model.set("resourceId",this.resourceId),this.model.set("properties.type",this.bpmnInfo.type),this.model.set("stencil.type",this.bpmnInfo.name),this.slotEvent&&this.slotEvent.length>0){for(var t=[],e=this.slotEvent.length-1;e>=0;e--)t.push(this.slotEvent[e].resourceId);this.model.set("properties.slotEvent",t)}var n=this.getRect().boundingRect;this.model.set("bounds.upperLeft.x",parseInt(n.x)),this.model.set("bounds.upperLeft.y",parseInt(n.y)),this.model.set("bounds.lowerRight.x",parseInt(n.x+n.width)),this.model.set("bounds.lowerRight.y",parseInt(n.y+n.height));var i=[];return this.eachChild(function(t){(t instanceof r||t instanceof h)&&i.push(t.toJSON())}),this.model.set("childShapes",i),this.model.option},i.prototype.nodeType="SubProcess",o.inherits(i,r),t.exports=i},function(t,e){var n={BPMN_TYPE:"stencil.type",BPMN_SCRIPT_TASK:"ScriptTask",BPMN_EVENT_SUB_PROCESS:"SubProcessTask",BPMN_TASK:"Task",TEMPLATE:"BPMNDiagram",RESOURCE_ID:"resourceId",SEQUENCE_FLOW:"SequenceFlow",SUB_PROCESS:"SubProcess",USER_DATA:"properties.userData",START_EVENT:"StartNoneEvent",END_EVENT:"EndNoneEvent",USER_TASK:"UserTask",MANUAL_TASK:"ManualTask",SCRIPT_TASK:"ScriptTask",MAIL_TASK:"MailTask",SERVICE_TASK:"ServiceTask",SMS_TASK:"SmsTask",COMMENT:"Comment",CATCH_TIMER_EVENT:"CatchTimerEvent",CATCH_SIGNAL_EVENT:"CatchSignalEvent",THROW_SIGNAL_EVENT:"ThrowSignalEvent",CATCH_MESSAGE_EVENT:"CatchMessageEvent",INCLUSIVE_GATEWAY:"InclusiveGateway",EXCLUSIVE_GATEWAY:"ExclusiveGateway",PARALLEL_GATEWAY:"ParallelGateway",isTemplate:function(t){var e=t.model.get(n.BPMN_TYPE);return e===n.TEMPLATE},isActivity:function(t){var e=t.model.get(n.BPMN_TYPE);return e.indexOf("Task")!=-1||e===n.COMMENT},isSubProcess:function(t){var e=t.nodeType;return e==n.SUB_PROCESS},isGateway:function(t){var e=t.model.get(n.BPMN_TYPE);return e.indexOf("Gateway")!=-1},isFlow:function(t){var e=t.model.get(n.BPMN_TYPE);return e===n.SEQUENCE_FLOW},isFlowModel:function(t){var e=t.get(n.BPMN_TYPE);return e===n.SEQUENCE_FLOW},isEvent:function(t){var e=t.model.get(n.BPMN_TYPE);return e.indexOf("Event")!=-1},isSlotEvent:function(t){var e=t.model.get(n.BPMN_TYPE);return e==n.CATCH_TIMER_EVENT||e==n.CATCH_SIGNAL_EVENT||e==n.THROW_SIGNAL_EVENT},isComment:function(t){var e=t.model.get(n.BPMN_TYPE);return e===n.COMMENT},getType:function(t){var e=t.model.get(n.BPMN_TYPE);return e},getStyle:function(t){return t.model.option.style},getProp:function(t){return t.model.option.properties},getUserData:function(t){var e=t.model;return e.get(n.USER_DATA)},setUserData:function(t,e){var i=t.model;i.set(n.USER_DATA,e)}};t.exports=n},function(t,e,n){function i(t){h.call(this),this.opt=t||{},this.opt.model?(this.resourceId=this.opt.model.get("resourceId"),this.model=this.opt.model,this.opt=this.opt.model.option):(this.resourceId=r.getUUID(),this.model=new d({}));var e={symbol:{type:"arrow",size:10,color:i.NORMAL_COLOR,both:!1,offset:0},style:{lineWidth:1,stroke:i.NORMAL_COLOR,lineType:i.TYPE_STRAIGHT},hoverStyle:{lineWidth:2,stroke:i.SELECTED_COLOR},arrowHoverStyle:{fill:i.SELECTED_COLOR},shape:{points:null,smooth:!1,smoothConstraint:null},position:{startPos:null,endPos:null,startOffset:[0,0],endOffset:[0,0],escapeDistance:[30,30],points:null},autoChangePosition:!1,textContextMenu:null,isEdit:!0,text:{text:null,textFill:"#000000",textFont:"12px Microsoft YaHei",textPos:"center",textRotateable:!0},z:0};this.options=r.mergeOpt(e,this.opt,!0,"textContextMenu"),this.handles=[],this.conPointsGroup=new a.Group,this.startNode=null,this.endNode=null,this.line=null,this.groupCurve=new a.Group,this.icons=[],this.render()}var r=n(77),o=n(4),s=n(14),a=n(3),h=n(80),l=n(106),c=n(107),u=n(108),p=n(109),f=n(64),d=n(83);i.TYPE_STRAIGHT="straight",i.TYPE_JAGGED="jagged",i.TYPE_CURVE="curve",i.TYPE_CHAIN="chain",i.RADIUS=3,i.START_NODE="startNode",i.END_NODE="endNode",i.LEFT="left",i.RIGHT="right",i.TOP="top",i.BOTTOM="bottom",i.BOTTOM="bottom",i.SEPERATOR="-",i.NORMAL_COLOR="#000",i.SELECTED_COLOR="#74B7E0",i.prototype.refresh=function(t){t&&(this.turningPoints=t);var e=r.traslatePoints(this.turningPoints);this.options.style.lineType==i.TYPE_CURVE&&e.length>2?this.modifyCurve(this.turningPoints):this.line.attr("shape",{points:e});var n=this.childOfName("lineText"),s=this,a=[];if(this.options.style.lineType==i.TYPE_CHAIN&&o.isArray(this.options.text.text))this.options.text.text.forEach(function(t,e){a.push(s.childOfName("lineText-"+e))});else if(!n&&this.options.text.text){var h=this.drawText("lineText",this.options.text.text,0,0);this.add(h.text),n=this.childOfName("lineText")}if(a.length>0){var l=a.length,c=this.turningPoints[1].x-this.turningPoints[0].x,u=parseInt(c/l),p=-u*parseInt(l/2);a.forEach(function(t,e){var n=s.getTextPostion(s.options.text),i="",r=s.getTextRotation(n);r===-0||0===r?r=0:i=r>0?"plus":"minus",r=Math.abs(r);var a=180*r/Math.PI,h=null,l=null;t.setStyle("text",o.isString(s.options.text.text[e])?s.options.text.text[e]:s.options.text.text[e].text),i?(h=a>90?(a-45)*Math.PI/180:(45+a)*Math.PI/180,h="minus"===i?-h:h):h=45*Math.PI/180,t.attr("rotation",h),90===a?n[1]-=p:(n[0]+=p,0!==r&&(l=Math.tan(a*Math.PI/180)*p,p>0?n[1]-="plus"===i?l:-l:n[1]+="plus"===i?-l:l)),t.attr("position",n),p+=u})}if(n){n.setStyle("text",this.options.text.text);var f=this.getTextPostion(this.options.text);this.options.style.lineType==i.TYPE_STRAIGHT&&this.options.text.textRotateable&&n.attr("rotation",this.getTextRotation(f)),n.attr("position",f)}this.refreshFromToSymbol(e)},i.prototype.render=function(){var t=this;this.renderFromToSymbol(),this.curveLine=new a.BezierCurve({style:this.options.style,z:this.options.z}),this.groupCurve.add(this.curveLine),this.add(this.groupCurve),this.add(this.conPointsGroup),this.polyLine=new a.Polyline({shape:this.options.shape,style:this.options.style,z:this.options.z}),this.add(this.polyLine),this.options.style.lineType==i.TYPE_CURVE?(this.line=this.groupCurve,this.createHoverStyle(this.curveLine),this.polyLine.hide()):(this.line=this.polyLine,this.createHoverStyle(this.polyLine),this.curveLine.hide());var e=["dblclick","click"];if(o.each(e,function(e){this.line.on(e,o.bind(function(n){n.cancelBubble=!0;var r={};r.event=n,r.type="Connector:"+e,r.target=t,this.trigger(r.type,r),this.setStyle({color:i.SELECTED_COLOR},!0),0!=this.options.isEdit&&(this.options.isEdit&&this.turningPoints.length>=2&&this.createAllconnectionPoint(),this.handles.length<1&&this.shapeSetHandle())},this))},this),this.options.text.text){var n=null;if(o.isArray(this.options.text.text)&&this.options.style.lineType==i.TYPE_CHAIN?this.options.text.text.forEach(function(e,n){var i=t.drawText("lineText-"+n,e,0,0);if(o.isString(e)){var r={};r.text=e,r.textId=i.text.id,t.options.text.text[n]=r}else t.options.text.text[n].textId=i.text.id;if(t.add(i.text),i&&t.opt.textContextMenu){var s=t.opt.textContextMenu;i.text.on("contextmenu",function(t){t.event.preventDefault(),t.event.stopPropagation(),s.buildMenu(t.event,this)})}}):(n=this.drawText("lineText",this.options.text.text,0,0),this.add(n.text)),n&&this.opt.textContextMenu){var r=this.opt.textContextMenu;n.text.on("contextmenu",function(t){t.event.preventDefault(),t.event.stopPropagation(),r.buildMenu(t.event,this)})}}},i.prototype.renderFromToSymbol=function(t){var e=this.createSymbol("toSymbol",this.options);if(e&&this.add(e),this.options.symbol.both){var n=this.createSymbol("fromSymbol",this.options);n&&this.add(n)}},i.prototype.refreshFromToSymbol=function(t){var e=this.childOfName("toSymbol"),n=this.childOfName("fromSymbol"),o=[],a=this.options.symbol.offset;if(e)if(this.options.effect&&this.options.effect.show)new u(e,this.options,this.groupCurve,this.polyLine);else{if(o=t[t.length-1],this.options.style.lineType!==i.TYPE_CURVE){var h=s.distance(t[t.length-1],t[t.length-2]);o=a<=h?s.lerp([],t[t.length-1],t[t.length-2],a/h):t[t.length-1]}e.attr("position",o),e.attr("rotation",r.tangentRotation(this.turningPoints[this.turningPoints.length-2],this.turningPoints[this.turningPoints.length-1]))}if(n){if(o=t[0],this.options.style.lineType!==i.TYPE_CURVE){var l=s.distance(t[0],t[1]);o=a<=l?s.lerp([],t[0],t[1],a/l):t[0]}n.attr("position",o),n.attr("rotation",r.tangentRotation(this.turningPoints[1],this.turningPoints[0]))}},i.prototype.setStyle=function(t,e){var n=null;if(t.color&&(this.options.style.lineType==i.TYPE_CURVE?this.groupCurve.eachChild(function(e){e.attr("style",{stroke:t.color}),a.setNormalStyle(e,{stroke:t.color})}):(this.polyLine.attr("style",{stroke:t.color}),a.setNormalStyle(this.polyLine,{stroke:t.color})),n=this.childOfName("toSymbol"),n&&(n.attr("style",{fill:t.color}),a.setNormalStyle(n,{fill:t.color})),e||(this.options.style.stroke=t.color,this.model.set("options.style.stroke",t.color),this.model.set("options.symbol.color",t.color),this.options.symbol.color=t.color)),t.text){var r=this.childOfName("lineText");if(!r&&t.text.text){var o=this.drawText("lineText",t.text.text,0,0);this.add(o.text),r=this.childOfName("lineText")}(t.text.text||""==t.text.text)&&(r.setStyle("text",t.text.text),
this.options.text.text=t.text.text);var s=this.getTextPostion(t.text);r.attr("position",s),t.text.textPos&&(this.options.text.textPos=t.text.textPos),t.text.offset&&(this.options.text.offset=t.text.offset),t.text.textFill&&(r.attr("style",{textFill:t.text.textFill}),this.options.text.textFill=t.text.textFill),this.model.set("options.text",t.text)}if(t.symbol){t.symbol.type&&(this.options.symbol.type=t.symbol.type,this.model.set("options.symbol.type",t.symbol.type)),t.symbol.size&&(this.options.symbol.size=t.symbol.size,this.model.set("options.symbol.size",t.symbol.size)),t.symbol.color&&(this.options.symbol.color=t.symbol.color,this.model.set("options.symbol.color",t.symbol.color)),t.symbol.z&&(this.options.symbol.z=t.symbol.z,this.model.set("options.symbol.z",t.symbol.z)),n=this.childOfName("toSymbol"),n&&this.remove(n);var h=this.createSymbol("toSymbol",this.model.get("options"));h&&this.add(h),this.refresh()}},i.prototype.getTextPostion=function(t){var e=[],n=a.textContain.getWidth(t.text,t.textFont);if(t&&t.textPos){var i=t.offset||0,s=i;if(o.isArray(i)||(s=[i,0]),"start"==t.textPos)e=[this.turningPoints[0].x+s[0],this.turningPoints[0].y+s[1]];else if("end"==t.textPos){var h=r.getMaxLineLength([this.turningPoints[this.turningPoints.length-2],this.turningPoints[this.turningPoints.length-1]]),l=r.getAngle(h[0],h[1]),c=r.distance(h[0],h[1])-n,u=r.getEndPoint(h[0],c,l);e=[u.x+s[0],u.y+s[1]]}else{var p=this.middle(t);e=[p[0]+s[0],p[1]+s[1]]}}else{var f=this.middle(t);e=[f[0]-n/2,f[1]]}return e},i.prototype.getTextRotation=function(t){var e=r.getMaxLineLength(this.turningPoints),n=-Math.atan2(e[1].y-t[1],e[1].x-t[0]);return n},i.prototype.createHoverStyle=function(t){if(this.options.hoverStyle){a.setElementHoverStl(t,this.options.hoverStyle);var e=this.childOfName("toSymbol");e&&a.setElementHoverStl(e,this.options.arrowHoverStyle),t.on("mouseover",o.bind(function(){a.doEnterHover(t),e&&a.doEnterHover(e),this.groupCurve.eachChild(function(t){a.doEnterHover(t)})},this)).on("mouseout",o.bind(function(){a.doLeaveHover(t),e&&a.doLeaveHover(e),this.groupCurve.eachChild(function(t){a.doLeaveHover(t)})},this))}},i.prototype.createAllconnectionPoint=function(){this.connectionPointCreate(this,this.turningPoints[0].clone(),p.TYPE_CONNECTOR),this.connectionPointCreate(this,this.turningPoints[this.turningPoints.length-1].clone(),p.TYPE_CONNECTOR)},i.prototype.connectionPointCreate=function(t,e,n){var i=new p(this,e,n,this.options);this.conPointsGroup.add(i.shape)},i.prototype.clearHandles=function(){for(var t=0;t<this.handles.length;t++)this.remove(this.handles[t].handleShape);this.handles=[],this.conPointsGroup&&this.conPointsGroup.removeAll(),this.setStyle({color:this.options.style.stroke},!0)},i.prototype.shapeSetHandle=function(){for(var t=1;t<this.turningPoints.length-2;t++){var e,n,i,o=r.collinearity(this.turningPoints[t-1],this.turningPoints[t],this.turningPoints[t+1]),s=r.collinearity(this.turningPoints[t],this.turningPoints[t+1],this.turningPoints[t+2]);(o||s&&!this.turningPoints[t+1].equals(this.turningPoints[t+2]))&&(o&&!this.turningPoints[t-1].equals(this.turningPoints[t])||s)||(this.turningPoints[t].x===this.turningPoints[t+1].x?(n=this.turningPoints[t].x,i=(this.turningPoints[t].y+this.turningPoints[t+1].y)/2,e=new c("h",n,i,this)):this.turningPoints[t].y===this.turningPoints[t+1].y&&(n=(this.turningPoints[t].x+this.turningPoints[t+1].x)/2,i=this.turningPoints[t].y,e=new c("v",n,i,this)),e&&(this.add(e.handleShape),this.handles.push(e)))}},i.prototype.createSymbol=function(t,e){var n=e.symbol.type,i=e.symbol.size;if("none"!==n){o.isArray(i)||(i=[i,i]);var r=e.z;e.symbol.z&&(r=e.symbol.z);var s=l.createSymbol(n,-i[0]/2,-i[1]/2,i[0],i[1],r,e.symbol.color);return s.name=t,s}},i.prototype.drawText=function(t,e,n,i,r){var s=o.isString(e)?{text:e,x:n,y:i,fill:r}:o.defaults({x:n,y:i,fill:r},e,!0),h=o.defaults(o.clone(this.options.text),s,!0),l=new a.Text({style:h,zlevel:20,name:t});return{text:l,rect:l.getBoundingRect()}},i.prototype.middle=function(){if(this.options.style.lineType==i.TYPE_STRAIGHT||this.options.style.lineType==i.TYPE_CHAIN){var t=r.getMaxLineLength(this.turningPoints),e=(t[0].x+t[1].x)/2,n=(t[0].y+t[1].y)/2;return[e,n]}if(this.options.style.lineType==i.TYPE_JAGGED){for(var o=this.getLength(),s=-1,a=0,h=0;h<this.turningPoints.length-1;h++){s=h;var l=r.getLength(this.turningPoints[h],this.turningPoints[h+1]);if(!(a+l<o/2))break;a+=l}if(s!=-1){var c=o/2-a;if(r.round(this.turningPoints[s].x,3)==r.round(this.turningPoints[s+1].x,3))return[this.turningPoints[s].x,Math.min(this.turningPoints[s].y,this.turningPoints[s+1].y)+c];if(r.round(this.turningPoints[s].y,3)==r.round(this.turningPoints[s+1].y,3))return[Math.min(this.turningPoints[s].x,this.turningPoints[s+1].x)+c,this.turningPoints[s].y];console.error("Connector:middle() - this should never happen "+this.turningPoints[s]+" "+this.turningPoints[s+1]+" nr of points "+this.turningPoints.length)}}else if(this.options.style.lineType==i.TYPE_CURVE){for(var u=.5,p=this.getLength(),f=0,d=0;d<this.turningPoints.length-1&&!(f+r.distance(this.turningPoints[d],this.turningPoints[d+1])>p*u);d++)f+=r.distance(this.turningPoints[d],this.turningPoints[d+1]);var g=p*u-f,v=r.distance(this.turningPoints[d],this.turningPoints[d+1]),y=g/v,_=y*(this.turningPoints[d+1].x-this.turningPoints[d].x)+this.turningPoints[d].x,m=y*(this.turningPoints[d+1].y-this.turningPoints[d].y)+this.turningPoints[d].y;return[_,m]}return null},i.prototype.getLength=function(){for(var t=0,e=0;e<this.turningPoints.length-1;e++)t+=r.getLength(this.turningPoints[e],this.turningPoints[e+1]);return t},i.prototype.toJSON=function(){return this.model.set("resourceId",this.resourceId),this.model.set("properties.type",14),this.model.set("bounds.upperLeft.x",this.position[0]),this.model.set("bounds.upperLeft.y",this.position[1]),this.model.set("bounds.lowerRight.x",parseInt(this.position[0]+this.getBoundingRect().width)),this.model.set("bounds.lowerRight.y",parseInt(this.position[1]+this.getBoundingRect().height)),this.model.set("style.sPos",this.options.position.startPos),this.model.set("style.ePos",this.options.position.endPos),this.model.set("style.lineDash",this.options.style.lineDash),this.model.set("style.stroke",this.options.style.stroke),this.model.set("symbol.type",this.options.symbol.type),this.model.set("dockers",this.turningPoints),this.model.option},i.prototype.refreshModel=function(){this.model.set("options",o.clone(this.options)),this.model.set("options.dockers",this.turningPoints);for(var t=[],e=0;e<this.icons.length;e++){var n=this.icons[e],i=[n.key,{icon:n.style.image,width:n.style.width,height:n.style.height}];t.push(i)}this.model.set("icons",t)},i.prototype.modifyCurve=function(t){for(var e=this.getCurvePoint(t),n=[],i=e.length,r=this.groupCurve.childCount();i<r;i++)n.push(this.groupCurve.childAt(i));o.each(n,function(t){this.groupCurve.remove(t)},this);for(var s=0;s<e.length;s++){var h=this.groupCurve.childAt(s);if(h)h.attr("shape",e[s]);else{var l=new a.BezierCurve({style:this.options.style,shape:e[s],z:this.options.z});this.groupCurve.add(l),this.createHoverStyle(l)}}},i.prototype.getCurvePoint=function(t){function e(t,e){return new f(t.x+e.x,t.y+e.y)}function n(t,e){if(0==e)throw"Division by zero not allowed (yet :) "+this.callee;return new f(t.x/e,t.y/e)}function i(t,e){return new f(t.x*e,t.y*e)}var r=t.length,o=[];if(3===r)return o.push({x1:t[0].x,y1:t[0].y,cpx1:t[1].x,cpy1:t[1].y,x2:t[2].x,y2:t[2].y}),o;if(4===r)return o.push({x1:t[0].x,y1:t[0].y,cpx1:t[1].x,cpy1:t[1].y,cpx2:t[2].x,cpy2:t[2].y,x2:t[3].x,y2:t[3].y}),o;var s,a=[0,0,0];for(s=0;s<=r-3;s++)a.push(s);a.push(r-3,r-3);for(var h=1;h<=r-3;h++){var l=n(e(i(t[h],a[h+4]-a[h+2]),i(t[h+1],a[h+2]-a[h+1])),a[h+4]-a[h+1]),c=(a[h+3]-a[h+2])/(a[h+3]-a[h+1]),u=n(e(i(t[h-1],a[h+3]-a[h+2]),i(t[h],a[h+2]-a[h])),a[h+3]-a[h]),p=i(l,(a[h+2]-a[h+1])/(a[h+3]-a[h+1])),d=e(i(u,c),p),g=n(e(i(t[h],a[h+4]-a[h+3]),i(t[h+1],a[h+3]-a[h+1])),a[h+4]-a[h+1]),v=(a[h+3]-a[h+2])/(a[h+4]-a[h+2]),y=n(e(i(t[h+1],a[h+5]-a[h+3]),i(t[h+2],a[h+3]-a[h+2])),a[h+5]-a[h+2]),_=i(g,(a[h+4]-a[h+3])/(a[h+4]-a[h+2])),m=e(i(y,v),_);o.push({x1:d.x,y1:d.y,cpx1:l.x,cpy1:l.y,cpx2:g.x,cpy2:g.y,x2:m.x,y2:m.y})}return o},r.inherits(i,h),t.exports=i},function(t,e,n){"use strict";var i=n(3),r=n(26),o=i.extendShape({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var n=e.cx,i=e.cy,r=e.width/2,o=e.height/2;t.moveTo(n,i-o),t.lineTo(n+r,i+o),t.lineTo(n-r,i+o),t.closePath()}}),s=i.extendShape({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var n=e.cx,i=e.cy,r=e.width/2,o=e.height/2;t.moveTo(n,i-o),t.lineTo(n+r,i),t.lineTo(n,i+o),t.lineTo(n-r,i),t.closePath()}}),a=i.extendShape({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.x,i=e.y,r=e.width/5*3,o=Math.max(r,e.height),s=r/2,a=s*s/(o-s),h=i-o+s+a,l=Math.asin(a/s),c=Math.cos(l)*s,u=Math.sin(l),p=Math.cos(l);t.arc(n,h,s,Math.PI-l,2*Math.PI+l);var f=.6*s,d=.7*s;t.bezierCurveTo(n+c-u*f,h+a+p*f,n,i-d,n,i),t.bezierCurveTo(n,i-d,n-c+u*f,h+a+p*f,n-c,h+a),t.closePath()}}),h=i.extendShape({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var n=e.height,i=e.width,r=e.x,o=e.y,s=i/3*2;t.moveTo(r,o),t.lineTo(r+s,o+n),t.lineTo(r,o+n/4*3),t.lineTo(r-s,o+n),t.lineTo(r,o),t.closePath()}}),l={line:i.Line,rect:i.Rect,roundRect:i.Rect,square:i.Rect,circle:i.Circle,diamond:s,pin:a,arrow:h,triangle:o},c={line:function(t,e,n,i,r){r.x1=t,r.y1=e+i/2,r.x2=t+n,r.y2=e+i/2},rect:function(t,e,n,i,r){r.x=t,r.y=e,r.width=n,r.height=i},roundRect:function(t,e,n,i,r){r.x=t,r.y=e,r.width=n,r.height=i,r.r=Math.min(n,i)/4},square:function(t,e,n,i,r){var o=Math.min(n,i);r.x=t,r.y=e,r.width=o,r.height=o},circle:function(t,e,n,i,r){r.cx=t+n/2,r.cy=e+i/2,r.r=Math.min(n,i)/2},diamond:function(t,e,n,i,r){r.cx=t+n/2,r.cy=e+i/2,r.width=n,r.height=i},pin:function(t,e,n,i,r){r.x=t+n/2,r.y=e+i/2,r.width=n,r.height=i},arrow:function(t,e,n,i,r){r.x=t+n/2,r.y=e+i/2,r.width=n,r.height=i},triangle:function(t,e,n,i,r){r.cx=t+n/2,r.cy=e+i/2,r.width=n,r.height=i}},u={};for(var p in l)u[p]=new l[p];var f=i.extendShape({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},beforeBrush:function(){var t=this.style,e=this.shape;"pin"===e.symbolType&&"inside"===t.textPosition&&(t.textPosition=["50%","40%"],t.textAlign="center",t.textVerticalAlign="middle")},buildPath:function(t,e){var n=e.symbolType,i=u[n];"none"!==e.symbolType&&(i||(n="rect",i=u[n]),c[n](e.x,e.y,e.width,e.height,i.shape),i.buildPath(t,i.shape))}}),d=function(t){if("image"!==this.type){var e=this.style,n=this.shape;n&&"line"===n.symbolType?e.stroke=t:this.__isEmptyBrush?(e.stroke=t,e.fill="#fff"):(e.fill&&(e.fill=t),e.stroke&&(e.stroke=t)),this.dirty()}},g={createSymbol:function(t,e,n,o,s,a,h){var l=0===t.indexOf("empty");l&&(t=t.substr(5,1).toLowerCase()+t.substr(6));var c;return c=0===t.indexOf("image://")?new i.Image({style:{image:t.slice(8),x:e,y:n,width:o,height:s},z:a}):0===t.indexOf("path://")?i.makePath(t.slice(7),{z:a,rectHover:!0},new r(e,n,o,s)):new f({shape:{symbolType:t,x:e,y:n,width:o,height:s},z:a}),c.__isEmptyBrush=l,c.setColor=d,c.setColor(h),c}};t.exports=g},function(t,e,n){function i(t,e,n,o){this.type=t,this.x=e,this.y=n,this.visible=!0,this.connector=o,this.handleShape=new r.Circle({shape:{cx:e,cy:n,r:i.RADIUS},style:{fill:"rgb(0,255,0)",stroke:"rgb(0,0,0)"},z:o.options.z+2,draggable:!0});var s=this;this.handleShape.on("drag",function(t){s.actionConnector(t.offsetX,t.offsetY)})}var r=n(3),o=n(77);i.RADIUS=4,i.prototype={constructor:i,equals:function(t){return!(!t instanceof i)&&(this.type==t.type&&this.x==t.x&&this.y==t.y&&this.visible==t.visible)},actionConnector:function(t,e){switch(this.type){case"v":for(var n,i=1;i<this.connector.turningPoints.length-1;i++)this.connector.turningPoints[i-1].y==this.connector.turningPoints[i].y&&this.connector.turningPoints[i].y==this.y&&Math.min(this.connector.turningPoints[i].x,this.connector.turningPoints[i-1].x)<=this.x&&Math.max(this.connector.turningPoints[i].x,this.connector.turningPoints[i-1].x)>=this.x&&(n=i);var r=e-this.y,s=o.translationMatrix(0,r);this.connector.turningPoints[n-1].transform(s),this.connector.turningPoints[n].transform(s),this.connector.refresh(),this.y=e;break;case"h":for(var n,i=1;i<this.connector.turningPoints.length-1;i++)this.connector.turningPoints[i-1].x==this.connector.turningPoints[i].x&&this.connector.turningPoints[i].x==this.x&&Math.min(this.connector.turningPoints[i].y,this.connector.turningPoints[i-1].y)<=this.y&&Math.max(this.connector.turningPoints[i].y,this.connector.turningPoints[i-1].y)>=this.y&&(n=i);var a=t-this.x,s=o.translationMatrix(a,0);this.connector.turningPoints[n-1].transform(s),this.connector.turningPoints[n].transform(s),this.connector.refresh(),this.x=t}}},t.exports=i},function(t,e,n){function i(t,e,n,i){this._lastFrame=0,this._lastFramePercent=0,this.symbol=t,this.groupCurve=n,this.initSymbol(e,i)}var r=(n(4),n(14)),o=n(30),s=(n(106),i.prototype);s.initSymbol=function(t,e){var n=this;this.symbol.z2=100,this.symbol.culling=!0;var i=1e3*t.effect.period;if(this.symbol.__t=0,this.symbol.stopAnimation(),"curve"==t.style.lineType){if(this.groupCurve){var r=0;i/=this.groupCurve._children.length,this.groupCurveAnimate(this.groupCurve._children[0],r,i)}}else this.symbol.animate("",!0).when(i,{__t:1}).delay(0).during(function(){n.updateSymbolPositionPolyline()}).start(),this.setAnimationPointsPolyline(e.shape.points)},s.groupCurveAnimate=function(t,e,n){var i=this;void 0==t&&(t=this.groupCurve._children[0],e=0);var r,o=t.shape;r=[[o.x1,o.y1],[o.x2,o.y2],[o.cpx1,o.cpy1],[o.cpx2,o.cpy2]],this.setAnimationPointsBezierCurve(r),this.symbol.animate("").when(n,{__t:1}).delay(0).during(function(){i.updateSymbolPositionBezierCurve()}).done(function(){i.symbol.__t=0,i.groupCurveAnimate(i.groupCurve._children[e+1],e+1,n)}).start()},s.setAnimationPointsBezierCurve=function(t){this.symbol.__p1=t[0],this.symbol.__p2=t[1],this.symbol.__cp1=t[2]||[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2],this.symbol.__cp2=t[3]},s.updateSymbolPositionBezierCurve=function(){var t,e,n=this.symbol.__p1,i=this.symbol.__p2,r=this.symbol.__cp1,s=this.symbol.__cp2,a=this.symbol.__t,h=this.symbol.position;if(void 0!=s[0]){var l=o.cubicAt,c=o.cubicDerivativeAt;h[0]=l(n[0],r[0],s[0],i[0],a),h[1]=l(n[1],r[1],s[1],i[1],a),t=c(n[0],r[0],s[0],i[0],a),e=c(n[1],r[1],s[1],i[1],a)}else{var u=o.quadraticAt,p=o.quadraticDerivativeAt;h[0]=u(n[0],r[0],i[0],a),h[1]=u(n[1],r[1],i[1],a),t=p(n[0],r[0],i[0],a),e=p(n[1],r[1],i[1],a)}this.symbol.rotation=-Math.atan2(e,t)-Math.PI/2,this.symbol.ignore=!1},s.setAnimationPointsPolyline=function(t){this._points=t;for(var e=[0],n=0,i=1;i<t.length;i++){var o=t[i-1],s=t[i];n+=r.dist(o,s),e.push(n)}if(0!==n){for(var a=0;a<e.length;a++)e[a]/=n;this._offsets=e,this._length=n,this.symbol._lastFrame=0,this.symbol.__lastFramePercent=0}},s.updateSymbolPositionPolyline=function(){var t=this.symbol.__t,e=this._points,n=this._offsets,i=e.length;if(n){var o,s=this._lastFrame;if(t<this._lastFramePercent){var a=Math.min(s+1,i-1);for(o=a;o>=0&&!(n[o]<=t);o--);o=Math.min(o,i-2)}else{for(var o=s;o<i&&!(n[o]>t);o++);o=Math.min(o-1,i-2)}r.lerp(this.symbol.position,e[o],e[o+1],(t-n[o])/(n[o+1]-n[o])),this._lastFrame=o,this._lastFramePercent=t;var h=-Math.atan2(e[o+1][1]-e[o][1],e[o+1][0]-e[o][0]);this.symbol.rotation=h-Math.PI/2,this.symbol.ignore=!1}},t.exports=i},function(t,e,n){function i(t,e,n,o){this.connector=t,this.point=e.clone(),this.type=n,this.color=i.NORMAL_COLOR,this.oType="ConnectionPoint",this.shape=new r.Circle({shape:{cx:this.point.x,cy:this.point.y,r:i.RADIUS},style:{fill:this.color,stroke:"#000000"},z:o.z+2}),this.shape.type=this.type,this.shape.connector=t}var r=n(3);i.NORMAL_COLOR="#FFFF33",i.OVER_COLOR="#FF9900",i.CONNECTED_COLOR="#ff0000",i.RADIUS=4,i.TYPE_FIGURE="figure",i.TYPE_CONNECTOR="connector",i.prototype={constructor:i,equals:function(t){return this.point.equals(t.point)&&this.connector==t.connector&&this.type==t.type&&this.color==t.color&&this.radius==t.radius}},t.exports=i},function(t,e,n){function i(t){var e=new h({});t.id||(t.id=a.getUUID()),t.style&&0!==t.style.textLineHeight&&!t.style.rich&&(t.style.rich={}),e.set("elementType","GroupNode"),t.style&&t.style.host&&delete t.style.host,e.set("options",r.clone(t)),"draggable"in t&&(t.isdraggable=t.draggable,delete t.draggable),t.z||(t.z=1),a.isUndefined(t.hoverAnimation)&&(t.hoverAnimation=!1),a.isUndefined(t.selectable)&&(t.selectable=!0),this.model=e,s.Group.call(this,t);var n={shape:{width:5,height:5,r:5},style:{fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)"},position:[0,0]};this.options=r.merge(n,t,!0),this.render(this.options)}var r=n(4),o=n(26),s=n(3),a=n(77),h=n(83);i.RECT_NAME="GROUP_RECT_NAME",i.prototype={constructor:i,type:"GroupNode",render:function(t){var e=new s.Rect({shape:t.shape,style:t.style,z:3});e.name=i.RECT_NAME,this.add(e),this.position=t.position},rectContain:function(t,e){var n=a.getRect(this);return n.boundingRect.contain(t,e)},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this._api&&this._api._addGroupNode(this,t),this},each:function(t,e){for(var n=this._children,r=0;r<n.length;r++){var o=n[r];o.name!=i.RECT_NAME&&t.call(e,o,r)}return this},getRect:function(){var t=this.getBoundingRect(),e=[];e[0]=[-t.width/2,-t.height/2],e[1]=[t.width/2,-t.height/2],e[2]=[t.width/2,t.height/2],e[3]=[-t.width/2,t.height/2],e[4]=[-t.width/2,-t.height/2];var n=new o(this.position[0],this.position[1],t.width,t.height);return{x:this.position[0]+t.width/2,y:this.position[1]+t.height/2,width:t.width,height:t.height,points:e,boundingRect:n}},setPosition:function(t,e){var n=this.getBoundingRect();this.attr("position",[t-n.width/2,e-n.height/2])},setProperties:function(t){var e=this.childOfName(i.RECT_NAME);e.setShape(t.shape),this.attr("position",t.position)}},r.inherits(i,s.Group),t.exports=i},function(t,e,n){function i(t,e,n){l.call(this,t,e,n)}var r=n(4),o=n(3),s=n(77),a=n(104),h=n(76),l=n(112);i.prototype.renderOther=function(){if(a.isSubProcess(this.node)){var t={x:0,y:0,width:10,height:10},e="M0 100 L0 0 L100 0 L100 20 L20 20 L20 100 z";this.leftTop=o.makePath(e,{style:{fill:"#000000"}},t),this.leftTop.attr("cursor","nw-resize"),this.leftTop.isSelfComputePos=!0;var n={x:0,y:0,width:10,height:10},i="M0 100 L100 100 L100 0 L80 0 L80 80 L0 80 z";this.rightBottom=o.makePath(i,{style:{fill:"#000000"},rectHover:!0},n),this.rightBottom.attr("cursor","se-resize"),this.rightBottom.isSelfComputePos=!0,this.add(this.rightBottom),this.add(this.leftTop)}},i.prototype.refreshPositionOther=function(t,e){function n(t){function n(t){function n(t,n){for(var i=[],r=0;r<=Math.abs(parseInt((n.event.clientX-o)/d));r++)n.event.clientX-o<=0?(y[0]=c[0]-d*r,i[0]=y[0]-10):(y[0]||(y[0]=c[0]),e.points[2][0]-y[0]>g?(y[0]=c[0]+d*r,i[0]=y[0]-10):i[0]=f.rightBottom.position[0]-g);for(var s=0;s<=Math.abs(parseInt((n.event.clientY-l)/d));s++)n.event.clientY-l<=0?(y[1]=c[1]-d*s,i[1]=y[1]-10):(y[1]||(y[1]=c[1]),e.points[2][1]-y[1]>v?(y[1]=c[1]+d*s,i[1]=y[1]-10):i[1]=f.rightBottom.position[1]-v);t.attr("position",i);var a=[];a[0]=[y[0],y[1]],a[1]=[e.points[1][0],y[1]],a[2]=e.points[2],a[3]=[y[0],e.points[3][1]],a[4]=[y[0],y[1]];var h={};h.type="OperationNode:scaleDragLeft",h.points=a,f.trigger(h.type,h)}f.rightBottom.position[0]-f.leftTop.position[0]<g+10?f.rightBottom.position[1]-f.leftTop.position[1]<v+10?(f.leftTop.position[0]=f.rightBottom.position[0]-(g+10),f.leftTop.position[1]=f.rightBottom.position[1]-(v+10)):(f.leftTop.position[0]=f.rightBottom.position[0]-(g+10),n(f.leftTop,t)):f.rightBottom.position[1]-f.leftTop.position[1]<v?(f.leftTop.position[1]=f.rightBottom.position[1]-(v+10),n(f.leftTop,t)):n(f.leftTop,t)}function i(t){f.zr.off("mousemove",r),f.zr.off("mouseup",s);var e={};e.event=t,e.arrowName="left",e.type="OperationNode:scaleDragEnd",e.startSlotPoints=u,e.startPosition=p,f.trigger(e.type,e)}var r=function(t){n(t)};f.zr.on("mousemove",r);var s=function(t){i(t)};f.zr.on("mouseup",s)}function i(t){function n(t){function n(t,n){for(var i=[],r=0;r<=Math.abs(parseInt((n.event.clientX-o)/d));r++)n.event.clientX-o>0?(m[0]=_[0]+d*r,i[0]=m[0]):(m[0]||(m[0]=_[0]),m[0]-e.points[0][0]>g?(m[0]=_[0]-d*r,i[0]=m[0]):i[0]=f.leftTop.position[0]+g);for(var s=0;s<=Math.abs(parseInt((n.event.clientY-l)/d));s++)n.event.clientY-l>0?(m[1]=_[1]+d*s,i[1]=m[1]):(m[1]||(m[1]=_[1]),m[1]-e.points[0][1]>v?(m[1]=_[1]-d*s,i[1]=m[1]):i[1]=f.leftTop.position[1]+v);t.attr("position",i);var a=[];a[0]=e.points[0],a[1]=[m[0],e.points[1][1]],a[2]=[m[0],m[1]],a[3]=[e.points[3][0],m[1]],a[4]=e.points[0];var h={};h.type="OperationNode:scaleDragRight",h.points=a,f.trigger(h.type,h)}f.rightBottom.position[0]-f.leftTop.position[0]<g+10?f.rightBottom.position[1]-f.leftTop.position[1]<v+10?(f.rightBottom.position[0]=f.leftTop.position[0]+(g+10),f.rightBottom.position[1]=f.leftTop.position[1]+(v+10)):(f.rightBottom.position[0]=f.leftTop.position[0]+g,n(f.rightBottom,t)):f.rightBottom.position[1]-f.leftTop.position[1]<v?(f.rightBottom.position[1]=f.leftTop.position[1]+v,n(f.rightBottom,t)):n(f.rightBottom,t)}function i(t){f.zr.off("mousemove",r),f.zr.off("mouseup",s);var e={};e.event=t,e.arrowName="right",e.type="OperationNode:scaleDragEnd",e.startSlotPoints=u,e.startPosition=p,f.trigger(e.type,e)}var r=function(t){n(t)};f.zr.on("mousemove",r);var s=function(t){i(t)};f.zr.on("mouseup",s)}if(!this.forbidEdit&&a.isSubProcess(this.node)){var o,l,c,u,p,f=this,d=20,g=100,v=60,y=[];this.leftTop.on("mousedown",function(i){u=s.getSoltPoints(t),p=r.clone(t.position),c=e.points[0],o=i.event.clientX,l=i.event.clientY,n(i)});var _,m=[];this.rightBottom.on("mousedown",function(n){u=s.getSoltPoints(t),p=r.clone(t.position),_=e.points[2],o=n.event.clientX,l=n.event.clientY,i(n)}),this.leftTop.attr("position",[e.points[0][0]-10,e.points[0][1]-10]),this.rightBottom.attr("position",[e.points[2][0],e.points[2][1]])}t.parent?a.isSubProcess(t.parent)&&this.attr("position",[e.x+h.parentX(t.parent),e.y+h.parentY(t.parent)]):this.attr("position",[e.x,e.y])},i.ARROW_DRAGEND="OperationNode:dragendArrow",i.ARROW_DRAG="OperationNode:dragArrow",i.ARROW_DRAGSTART="OperationNode:dragstartArrow",i.DELETE_CLICK="OperationNode:deleteClick",r.inherits(i,l),t.exports=i},function(t,e,n){function i(t,e,n,i){r.call(this),this.node=t,this.zr=e,this.forbidEdit=i,this._api=n,this.render()}var r=n(80),o=n(4),s=n(3),a=n(105),h=(n(49),n(113)),l=n(106);i.ARROW_DRAGEND="OperationNode:dragendArrow",i.ARROW_DRAG="OperationNode:dragArrow",i.ARROW_DRAGSTART="OperationNode:dragstartArrow",i.DELETE_CLICK="OperationNode:deleteClick",i.DEL="DEL",i.COMMENT_CLICK="OperationNode:commentClick",i.COMMENT="COMMENT",i.opicons={STRAIGHT:h.STRAIGHT_SVG,JAGGED:h.JAGGED_SVG,CURVE:h.CURVE_SVG,DEL:h.DEL_SVG,COMMENT:h.COMMENT_SVG},i.prototype.render=function(){this.renderBase(),this.forbidEdit||this.renderOther()},i.prototype.renderBase=function(){this.createOperation()},i.prototype.createOperation=function(){var t=this;this.node.selectStyle?"ZPath"===this.node.type?(this.node._zCloneStyle=this.node.style.clone(),this.node.setStyle(this.node.selectStyle)):this.node.setOrCancelSelectStyle?this.node.setOrCancelSelectStyle(!0):this._api.getZr().addHover(this.node,this.node.selectStyle):(this.virtualRect=new s.Polyline({style:{lineDash:[2]}}),this.virtualRect.isSelfComputePos=!0,this.add(this.virtualRect)),this.node.operationIcons&&o.each(this.node.operationIcons,function(e){var n=null,r=i.opicons[e.name.toUpperCase()+""];if(r){if(this.forbidEdit)return;if(e.hidden)return;if(e.name==i.DEL)n=s.makePath(r,{style:{fill:"#aaaaac"},z:t.node.z+1,rectHover:!0},{x:0,y:0,width:10,height:15}),e.callback?n.on("click",function(n){n.data=e,n.node=t.node,e.callback&&e.callback(n)}):n.on("click",function(e){var n={};n.event=e,n.target=this,n.type=i.DELETE_CLICK,t.trigger(n.type,n)});else if(e.name==i.COMMENT){var h={x:0,y:0,width:16,height:16};n=s.makePath(r,{style:{fill:"#aaaaac"},z:t.node.z+2,rectHover:!0},h),n.on("click",function(e){var n={};n.event=e,n.target=this,n.type=i.COMMENT_CLICK,t.trigger(n.type,n)})}else{var c={x:0,y:0,width:15,height:15};n=s.makePath(r,{style:{fill:"#aaaaac"},draggable:!0,z:t.node.z+2,lineType:a["TYPE_"+e.name.toUpperCase()],rectHover:!0},c);var u=["dragstart","drag","dragend"];o.each(u,function(i){n.on(i,function(n){var r={};r.event=n,r.data=e.options,r.type="OperationNode:"+i+"Arrow",t.trigger(r.type,r)})})}}else n=l.createSymbol(e.iconPath,0,0,e.width||15,e.height||15,t.node.z+1,e.color||"#000"),n.on("click",function(n){n.data=e,n.node=t.node,e.callback&&e.callback(n);var i={event:n,type:"OperationNode:"+e.name+"Click"};t._api.trigger(i.type,i)});n.name=e.name,t.add(n)})},i.prototype.refreshPostion=function(t,e){var n=0,i=e.points[2];this.virtualRect&&this.virtualRect.setShape({points:e.points}),this.eachChild(function(t){t.isSelfComputePos||t.attr("position",[i[0]+8+20*n++,i[1]-10])}),this.refreshPositionOther(t,e)},i.prototype.renderOther=function(){},i.prototype.refreshPositionOther=function(t,e){if(t.parent&&t.parent.isBg&&1==t.parent.isBg||"GroupNode"===t.parent.type)this.attr("position",[e.x,e.y]);else{var n=t.shape?t.shape.x:0,i=t.shape?t.shape.y:0;this.attr("position",[e.x+t.parent.position[0]+n,e.y+t.parent.position[1]+i])}},i.prototype.cleanup=function(){this.node.selectStyle&&("ZPath"===this.node.type?this.node.setStyle(this.node._zCloneStyle):this.node.setOrCancelSelectStyle?this.node.setOrCancelSelectStyle(!1):this._api.getZr().removeHover(this.node))},o.inherits(i,r),t.exports=i},function(t,e){var n={STRAIGHT_SVG:"M937.353846 724.676923C882.215385 669.538462 795.569231 661.661538 732.553846 701.046154L362.338462 330.830769C401.723077 267.815385 393.846154 181.169231 338.707692 126.030769 267.815385 55.138462 165.415385 55.138462 94.523077 126.030769 23.630769 196.923077 23.630769 299.323077 94.523077 370.215385 149.661538 425.353846 236.307692 433.230769 299.323077 393.846154L669.538462 764.061538C630.153846 827.076923 638.030769 913.723077 693.169231 968.861538 764.061538 1039.753846 866.461538 1039.753846 937.353846 968.861538 1000.369231 897.969231 1000.369231 795.569231 937.353846 724.676923L937.353846 724.676923ZM275.692308 307.2C244.184615 338.707692 189.046154 338.707692 157.538462 307.2 126.030769 275.692308 126.030769 220.553846 157.538462 189.046154 189.046154 157.538462 244.184615 157.538462 275.692308 189.046154 307.2 220.553846 307.2 267.815385 275.692308 307.2L275.692308 307.2ZM874.338462 913.723077C842.830769 945.230769 787.692308 945.230769 756.184615 913.723077 724.676923 882.215385 724.676923 827.076923 756.184615 795.569231 787.692308 764.061538 842.830769 764.061538 874.338462 795.569231 905.846154 827.076923 905.846154 874.338462 874.338462 913.723077L874.338462 913.723077Z",JAGGED_SVG:"M204.8 819.2l-51.2-102.4 204.8-307.2 51.2 102.4-204.8 307.2zM409.6 512l51.2-102.4 153.6 204.8-51.2 102.4-153.6-204.8zM819.2 204.8l51.2 102.4-204.8 409.6-51.2-102.4 204.8-409.6z                                    M153.6 716.8c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8H102.4v-102.4h102.4v102.4zM409.6 204.8C322.56 204.8 256 271.36 256 358.4s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8H358.4V307.2h102.4v102.4zM614.4 614.4c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8h-102.4v-102.4h102.4v102.4zM870.4 0c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8h-102.4V102.4h102.4v102.4z",CURVE_SVG:"M1014.285039 824.024234l-145.168428-144.37205c-12.969593-12.855825-37.543559-14.505466-44.597197 2.332252-1.877178 4.550734-2.275367 17.179022-2.275368 17.179022v97.556369H330.935383a118.319095 118.319095 0 0 1-118.546632-117.920905A118.319095 118.319095 0 0 1 330.992267 560.878016h445.516899c121.561493 0 220.426198-98.352747 220.426198-219.23163s-98.864705-219.174746-220.426198-219.174746H340.491925A174.236244 174.236244 0 0 0 174.105698 0 173.78117 173.78117 0 0 0 0.040107 173.09856a173.78117 173.78117 0 0 0 174.065591 173.09856 174.236244 174.236244 0 0 0 166.386227-122.471639h436.017241c65.416807 0 118.603516 52.902288 118.603515 117.920905A118.319095 118.319095 0 0 1 776.509166 459.624176H330.992267c-121.504609 0-220.369314 98.352747-220.369314 219.23163s98.864705 219.174746 220.369314 219.174746h491.194895v92.550561s0 14.221045 2.332252 19.795695c7.053638 16.894602 31.627604 17.577212 44.597197 4.664502l145.111543-144.315165a32.879056 32.879056 0 0 0 0-46.645027zM174.105698 244.94328c-39.818926 0-72.242909-32.25333-72.242909-71.84472s32.423983-71.787835 72.242909-71.787835c39.818926 0 72.186025 32.196446 72.186025 71.787835 0 39.591389-32.423983 71.787835-72.242909 71.787836z",DEL_SVG:"M980.992 256h-84.992v683.008c0 47.104-37.888 84.992-84.992 84.992H212.992c-47.104 0-84.992-37.888-84.992-84.992V256H43.008C19.456 256 0 236.544 0 212.992c0-23.552 19.456-43.008 43.008-43.008H256V84.992C256 37.888 293.888 0 340.992 0h340.992C730.112 0 768 37.888 768 84.992v84.992h214.016c23.552 0 43.008 19.456 43.008 43.008-1.024 23.552-20.48 43.008-44.032 43.008zM683.008 84.992H340.992v84.992h340.992V84.992zM212.992 939.008h596.992V256H212.992v683.008z m171.008-470.016v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-23.552 19.456-43.008 43.008-43.008 23.552 1.024 43.008 19.456 43.008 43.008zM512 427.008c23.552 0 43.008 19.456 43.008 43.008v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-24.576 19.456-43.008 43.008-43.008z m171.008 0c23.552 0 43.008 19.456 43.008 43.008v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-24.576 19.456-43.008 43.008-43.008z",COMMENT_SVG:"M209.92 152.064l572.416 1.536c12.8 0 23.04 10.24 23.04 23.04v237.568c0 12.8 10.24 23.04 23.04 23.04s23.04-10.24 23.04-23.04V125.44c0-12.8-10.24-23.04-23.04-23.04H158.72c-12.8 0-23.04 10.24-23.04 23.04v773.12c0 12.8 10.24 23.04 23.04 23.04h236.032c12.8 0 23.04-10.24 23.04-23.04s-10.24-22.528-22.528-23.04l-185.856-1.536c-12.8 0-22.528-10.24-22.528-23.04V174.592c0-12.288 10.24-22.528 23.04-22.528z                                            M268.8 570.368h159.232c13.312 0 24.064 10.752 24.576 24.064v2.56c0 13.312-10.752 24.576-24.576 24.576H268.8c-13.312 0-24.064-10.752-24.576-24.064v-2.56c0.512-13.312 11.264-24.576 24.576-24.576z m0-312.32h441.344c13.312 0 24.576 10.752 24.576 24.576v2.56c0 13.312-10.752 24.576-24.576 24.576H268.8c-13.312 0-24.576-10.752-24.576-24.576v-2.56c0.512-13.312 11.264-24.576 24.576-24.576z m0.512 155.648h269.312c13.312 0 24.576 10.752 24.576 24.064v2.56c0 13.312-10.752 24.576-24.576 24.576H269.312c-13.312 0-24.576-10.752-24.576-24.064v-2.56c0-13.824 10.752-24.576 24.576-24.576z m471.04 13.312l-246.784 339.456c-1.536 2.56-2.56 5.632-2.56 8.704l-1.536 132.096c0 9.728 9.728 16.896 18.944 14.336l122.88-37.888c3.072-1.024 5.632-3.072 7.68-5.632l246.784-338.944c4.608-6.144 3.584-15.36-2.56-19.968l-121.344-94.72c-7.168-5.632-16.896-4.096-21.504 2.56z m23.04 67.584l51.2 39.936c2.048 1.536 2.56 5.12 1.024 7.168l-26.112 35.84c-1.536 2.56-5.12 3.072-7.68 1.024l-51.712-38.912c-2.048-1.536-2.56-4.608-1.024-7.168l26.624-37.376c2.048-1.536 5.632-2.048 7.68-0.512z m-165.888 341.504l-35.328 10.752c-9.216 3.072-18.944-4.096-18.944-13.824l0.512-40.96c0-3.072 1.024-6.144 2.56-8.704l137.216-187.904c1.536-2.56 5.12-2.56 7.168-1.024l51.2 38.4c2.56 2.048 3.072 5.12 1.024 7.68l-137.728 189.952c-2.048 2.56-4.608 4.608-7.68 5.632z",CHANGE_LINE_TYPE_SVG:"M1008 335.2 1008 335.2l-160 144 0 0c-8.8 8-20 12.8-32 12.8-26.4 0-48-21.6-48-48 0-14.4 6.4-26.4 16-35.2l0 0 67.2-60L560 348.8c0 0 0 0 0 0L464 348.8l0 0L352 348.8 48 348.8c-26.4 0-48-21.6-48-48 0-26.4 21.6-48 48-48l124.8 0 0 0L416 252.8l0 0 208 0 0 0 227.2 0L784 192l0 0c-9.6-8.8-16-21.6-16-35.2 0-26.4 21.6-48 48-48 12 0 23.2 4.8 32 12.8l0 0 160 144 0 0c9.6 8.8 16 21.6 16 35.2C1024 314.4 1017.6 326.4 1008 335.2zM16 680.8 16 680.8l160-144 0 0c8.8-8 20-12.8 32-12.8 26.4 0 48 21.6 48 48 0 14.4-6.4 26.4-16 35.2l0 0-67.2 60L400 667.2l0 0 208 0 0 0 243.2 0 0 0L976 667.2c26.4 0 48 21.6 48 48 0 26.4-21.6 48-48 48L672 763.2 560 763.2c0 0 0 0 0 0L464 763.2l0 0L172.8 763.2 240 824l0 0c9.6 8.8 16 21.6 16 35.2 0 26.4-21.6 48-48 48-12 0-23.2-4.8-32-12.8l0 0L16 752l0 0c-9.6-8.8-16-21.6-16-35.2C0 701.6 6.4 689.6 16 680.8z"
};t.exports=n},function(t,e,n){function i(){o.call(this),this.stencilType="SequenceFlow"}var r=n(4),o=n(115),s=n(82),a=n(105),h=n(64),l=n(77);i.prototype.connectorCreate=function(t,e,n,i,r,o){var a=new s({});return a.set("resourceId",l.getUUID()),a.set("style",n.style),a.set("stencil.type",this.stencilType),r&&a.set("style.sPos",r),o&&a.set("style.ePos",o),this.connectorCreateByOptions(t,e,{model:a,isEdit:!0,style:n},i)},i.prototype.connectorCreateByOptions=function(t,e,n,i){var o=this,s=n.model;s.option.text={text:s.option.properties.name},n.text={text:s.option.properties.name};var l=new a(n);l.startNode=t,l.endNode=e,this.connectors.push(l),l.options.position.startPos=s.get("style.sPos"),l.options.position.endPos=s.get("style.ePos");var c=s.get("dockers");if(c&&c.length>=2){var u=h.loadArray(c);l.refresh(u)}else this.refreshConnector(l,!0);l.conPointsGroup.on("click",function(t){var e=t.target.type.split(a.SEPERATOR),n=t.target.connector;e[0]===a.START_NODE?n.options.position.startPos=e[1]:e[0]===a.END_NODE&&(n.options.position.endPos=e[1]),o.refreshConnector(n,!0);var r={};r.event=t,r.type="conPointsGroup:click",r.lineNode=o.selConnector,i.trigger(r.type,r)});var p=["dblclick","click"];if(r.each(p,function(t){l.on("Connector:"+t,function(e){var n=e.target;o.selConnector!==n&&(o.selConnector&&o.refreshConnector(o.selConnector),o.selConnector=n);var r={};r.event=e,r.type=t,r.target=o.selConnector,i.trigger(r.type,r)})}),!n.isFromModel){var f=t.model.get("outgoing");f.push(l.resourceId);var d=l.model.get("outgoing");d.push(e.resourceId)}return l},i.prototype.setModel=function(t,e){var n=t.options.text.text;t.options.text.text=e.properties.name,t.model.mergeOption(e),n!=e.properties.name&&this.refreshConnector(t,!0)},i.prototype.refreshLineByNode=function(t){for(var e=0,n=this.connectors.length;e<n;e++)this.connectors[e].startNode!=t&&this.connectors[e].endNode!=t||this.refreshConnector(this.connectors[e],!0)},r.inherits(i,o),t.exports=i},function(t,e,n){function i(){this.connectors=[],this.selConnector=null,this.tempConnector=null}var r=n(77),o=n(64),s=n(105),a=n(116),h=n(4);i.prototype.connectorForbidEdit=function(t){for(var e=0;e<this.connectors.length;e++)this.connectors[e].options.isEdit=!t},i.prototype.clearSelectCon=function(){null!=this.selConnector&&this.refreshConnector(this.selConnector)},i.prototype.deleteSelectCon=function(t,e){for(var n=0;n<this.connectors.length;n++)if(this.connectors[n].startNode==t||this.connectors[n].endNode==t){var i=this.connectors[n].startNode.model.get("outgoing"),r=h.indexOf(i,this.connectors[n].resourceId);r!=-1&&i.splice(r,1),e.remove(this.connectors[n]),this.connectors.splice(n,1),n--,this.selConnector=null}},i.prototype.removeLine=function(t,e){this.selConnector=t,this.deleteLine(e)},i.prototype.deleteLine=function(t){if(this.selConnector.startNode){var e=this.selConnector.startNode.model.get("outgoing");if(i=h.indexOf(e,this.selConnector.resourceId),i!=-1&&e.splice(i,1),this.connectorMap){var n=this.getTwoNodeId(this.selConnector.startNode,this.selConnector.endNode,this.selConnector.options.position);this.connectorMap.removeItem(n,this.selConnector)}}t.remove(this.selConnector);var i=h.indexOf(this.connectors,this.selConnector);i!=-1&&this.connectors.splice(i,1),this.selConnector=null},i.prototype.refreshConnector=function(t,e){if(e||!t.turningPoints||t.turningPoints.length<2){t.model&&t.model.get("style.lineType")&&(t.options.style.lineType=t.model.get("style.lineType"));var n=this.getStartEndPoint(t),i=null;t.options.position&&t.options.position.escapeDistance&&(i=t.options.position.escapeDistance);var r=this.connector2Points(t.options.style.lineType,n[0],n[1],n[2],n[3],i);t.refresh(r[0][2])}t.clearHandles()},i.prototype.getStartEndPoint=function(t){var e=t.startNode,n=t.endNode,i=!0;i=e.parent!==n.parent;var s=e.getRect?e.getRect().boundingRect:r.getRect(e,i).boundingRect,a=[Number(s.x),Number(s.y),Number(s.x)+Number(s.width),Number(s.y)+Number(s.height)],h=n.getRect?n.getRect().boundingRect:r.getRect(n,i).boundingRect,l=[Number(h.x),Number(h.y),Number(h.x)+Number(h.width),Number(h.y)+Number(h.height)],c=r.getConnectorPoints(s),u=r.getConnectorPoints(h),p=t.options.position;if(p.direction){var f=p.direction.split(",");p.startPos=f[0],p.endPos=f[1]}p.startPos&&p.endPos||(s.x<h.x?(p.startPos="right",p.endPos="left"):(p.startPos="left",p.endPos="right"));var d=this.calcPointExpression(p.startPos,c),g=this.calcPointExpression(p.endPos,u);return d.add(new o(p.startOffset[0],p.startOffset[1])),g.add(new o(p.endOffset[0],p.endOffset[1])),[d,g,a,l]},i.prototype.calcPointExpression=function(t,e){var n={top:e.top.x,left:e.left.y,right:e.right.y,bottom:e.bottom.x,center:e.center.x},i="<% print("+t+") %>",s=parseInt(r.template(i)(n));if(t.indexOf("top")!=-1)return new o(s,e.top.y);if(t.indexOf("left")!=-1)return new o(e.left.x,s);if(t.indexOf("right")!=-1)return new o(e.right.x,s);if(t.indexOf("bottom")!=-1)return new o(s,e.bottom.y);if(t.indexOf("center")!=-1)return new o(s,e.bottom.y);throw new Error("pos")},i.prototype.manageTempConnector=function(t,e,n,i){var o=t.getRect?t.getRect().boundingRect:r.getRect(t,!0).boundingRect,a=[o.x,o.y,o.x+o.width,o.y+o.height],h=r.getConnectorPoints(o);this.tempConnector||(this.tempConnector=new s({isEdit:!1,style:{lineType:n}}));var l=this.tempConnector,c=l.options.position;c.startPos=i?i:o.x<e.x?"right":"left",c.endPos=o.x<e.x?"left":"right",l.options.style.lineType=n;var u=this.connector2Points(n,h[c.startPos],e,a,null);return l.refresh(u[0][2]),l},i.prototype.manageReverseTempConnector=function(t,e,n,i){var o=e.getRect?e.getRect().boundingRect:r.getRect(e,!0).boundingRect,a=[o.x,o.y,o.x+o.width,o.y+o.height],h=r.getConnectorPoints(o);this.tempConnector||(this.tempConnector=new s({isEdit:!1,style:{lineType:n}}));var l=this.tempConnector,c=l.options.position;c.endPos=i?i:o.x<t.x?"right":"left",c.startPos=o.x<t.x?"left":"right",l.options.style.lineType=n;var u=this.connector2Points(n,t,h[c.endPos],a,null);return l.refresh(u[0][2]),l},i.prototype.removeTempConnector=function(t){this.tempConnector&&(t.remove(this.tempConnector),this.tempConnector=null)},i.prototype.connector2Points=function(t,e,n,i,l,c){var u=[30,30];c&&(u=h.isArray(c)?c:[c,c]),a.group("connectionManager: connector2Points"),a.info("ConnectionManager: connector2Points ("+t+", "+e+", "+n+", "+i+", "+l+")");var p=[];switch(t){case s.TYPE_CHAIN:case s.TYPE_STRAIGHT:var f=[e.clone(),n.clone()];p.push(["straight","straight",f]);break;case s.TYPE_CURVE:case s.TYPE_JAGGED:var d=null,g=null;if(null!=i){var v=[];v.push(new o(e.x,i[1]-u[0])),v.push(new o(i[2]+u[0],e.y)),v.push(new o(e.x,i[3]+u[0])),v.push(new o(i[0]-u[0],e.y)),d=v[0];for(var y=1;y<v.length;y++)r.distance(e,v[y])<r.distance(e,d)&&(d=v[y])}if(null!=l){var v=[];v.push(new o(n.x,l[1]-u[1])),v.push(new o(l[2]+u[1],n.y)),v.push(new o(n.x,l[3]+u[1])),v.push(new o(l[0]-u[1],n.y)),g=v[0];for(var y=1;y<v.length;y++)r.distance(n,v[y])<r.distance(n,g)&&(g=v[y])}var _=[e],m=0;d&&(_.push(d),m=1),g&&_.push(g),_.push(n);var x=o.cloneArray(_);p.push(["s0","s0",x]);var b=o.cloneArray(_),w=o.cloneArray(b);w.splice(m+1,0,new o(w[m].x,w[m+1].y)),p.push(["s1","s1_1",w]);var P=o.cloneArray(b);P.splice(m+1,0,new o(P[m+1].x,P[m].y)),p.push(["s1","s1_2",P]);var C=o.cloneArray(_),S=new o((C[m].x+C[m+1].x)/2,C[m].y),T=new o((C[m].x+C[m+1].x)/2,C[m+1].y);C.splice(m+1,0,S,T),p.push(["s2","s2_1",C]);var E=o.cloneArray(_),R=new o(E[m].x,(E[m].y+E[m+1].y)/2),k=new o(E[m+1].x,(E[m].y+E[m+1].y)/2);E.splice(m+1,0,R,k),p.push(["s2","s2_2",E]);var N=o.cloneArray(_),M=[N[m].x+20,N[m+1].x+20];i&&M.push(i[2]+20),l&&M.push(l[2]+20);var L=r.max(M),A=new o(L,N[m].y),O=new o(L,N[m+1].y);N.splice(m+1,0,A,O),p.push(["s2","s2_3",N]);var z=o.cloneArray(_),F=[z[m].y-20,z[m+1].y-20];i&&F.push(i[1]-20),l&&F.push(l[1]-20);var I=r.min(F),B=new o(z[m].x,I),j=new o(z[m+1].x,I);z.splice(m+1,0,B,j),p.push(["s2","s2_4",z]);var D=o.cloneArray(_),H=[D[m].x-20,D[m+1].x-20];i&&H.push(i[0]-20),l&&H.push(l[0]-20);var V=r.min(H),G=new o(V,D[m].y),U=new o(V,D[m+1].y);D.splice(m+1,0,G,U),p.push(["s2","s2_5",D]);var Y=o.cloneArray(_),W=[Y[m].y+20,Y[m+1].y+20];i&&W.push(i[3]+20),l&&W.push(l[3]+20);var X=r.max(W),q=new o(Y[m].x,X),Q=new o(Y[m+1].x,X);Y.splice(m+1,0,q,Q),p.push(["s2","s2_6",Y]),a.info("Filter orthogonal solutions. Initial number of solutions = "+p.length);for(var Z=[],$=0;$<p.length;$++){var J=p[$][2];r.orthogonalPath(J)&&Z.push(p[$])}if(p=Z,a.info("\n\tOrthogonalSolutions = "+p.length),e.equals(n))a.info("Start and end point coincide...skip backward solution. I think we will just fall on s0 :)");else{a.info("Filter backward solutions. Initial number of solutions = "+p.length);for(var K=[],tt="",$=0;$<p.length;$++){var J=p[$][2];r.forwardPath(J)?K.push(p[$]):tt=tt+"\n\t"+J}p=K,a.info("\n\t ForwardSolutions = "+p.length),0==p.length&&a.info("Discarded solutions: "+tt)}a.info("Filter non intersecting solutions. Initial number of solutions = "+p.length);for(var et=[],$=0;$<p.length;$++){var J=p[$][2],nt=!1,it=J.slice();(l||i)&&(it=it.slice(1,it.length-1)),i&&(nt=nt||r.polylineIntersectsRectangle(it,i)),l&&(nt=nt||r.polylineIntersectsRectangle(it,l)),nt||et.push(p[$])}0!=et.length&&(p=et),a.info("\n\t nonIntersectionSolutions = "+p.length),a.info("Get first class of solutions with same nr of points"),0==p.length&&a.info("This is not possible");for(var rt=p[0][2],ot=rt.length,st=[],$=0;$<p.length;$++){var J=p[$][2];J.length==ot&&st.push(p[$])}p=st,a.info("pick the first solution with 90 degree angles (less turnarounds)");for(var at=0,$=0;$<p.length;$++){var J=p[$][2];r.scorePath(p[at][2])<r.scorePath(p[$][2])&&(at=$)}p=[p[at]]}return t===s.TYPE_CURVE&&this.smoothCurve(p),a.groupEnd(),p},i.prototype.smoothCurve=function(t){var e=3;switch(e){case 0:break;case 1:for(var n=0;n<t.length;n++){var i=t[n][2],o=i[0],s=i[1],a=r.getMiddle(o,s);i.splice(1,0,a);var l=i[i.length-2],c=i[i.length-1],u=r.getMiddle(l,c);i.splice(i.length-1,0,u)}break;case 2:h.each(t,function(t){var e=t[0];if("s1"==e||"s2"==e){var n=t[2];n.splice(1,1),n.splice(n.length-2,1)}});break;case 3:h.each(t,function(t){var e=t[0];if("s1"==e){var n=t[2],i=r.collinearReduction(n);t[2]=i}})}},t.exports=i},function(t,e){var n={LOG_LEVEL_NONE:0,LOG_LEVEL_DEBUG:1,LOG_LEVEL_INFO:2,LOG_LEVEL_ERROR:3,level:this.LOG_LEVEL_ERROR,debug:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_DEBUG&&"function"==typeof console.debug&&console.debug(t)},info:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_INFO&&console.info(t)},error:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_ERROR&&console.error(t)},group:function(t){this.level<=this.LOG_LEVEL_INFO&&"undefined"!=typeof console&&"function"==typeof console.group&&console.group(t)},groupEnd:function(){this.level<=this.LOG_LEVEL_INFO&&"undefined"!=typeof console&&"function"==typeof console.groupEnd&&console.groupEnd()}};n.level=n.LOG_LEVEL_ERROR,t.exports=n},function(t,e,n){function i(t,e){this.lineOperations=[],this.isEdit=!0,this.connectionManager=t,this._api=e}var r=n(106),o=n(4),s=n(113);i.prototype.addIcon=function(t,e){var n=o.find(e.lineNode.icons,function(e){return e.key===t});if(n)return void this.bindOperation(e.lineNode);var i=this.creatOperation(t,e);return this._api._getParentZr().add(i),this.bindOperation(e.lineNode),i},i.prototype.creatOperation=function(t,e){var n=r.createSymbol(e.iconPath,0,0,e.width||15,e.height||15,0,e.color||"#aaaaac");return n.key=t,n._width=e.width||15,n._isLineOperationIcon=!0,n.hide(),e.lineNode.icons.push(n),this.lineOperations.push(n),n.on("click",function(t){if(e.callback)t.data=e,t.lineNode=e.lineNode,e.callback(t);else{var n={};n.event=t,n.type="click",n.elementType="LineOperationIcon",this._api.trigger(n.type,n)}}.bind(this)),n},i.prototype.bindOperation=function(t){function e(t){return t.parent&&"SubProcess"==t.parent.nodeType?t.position[0]+e(t.parent):t.position[0]}function n(t){return t.parent&&"SubProcess"==t.parent.nodeType?t.position[1]+n(t.parent):t.position[1]}if(0!=this.isEdit){var i,r,s=t.middle();t.parent&&"SubProcess"==t.parent.nodeType?(i=s[0]+e(t.parent),r=s[1]+n(t.parent)):(i=s[0],r=s[1]);var a=o.map(t.icons,function(t){return t._width}),h=o.reduce(a,function(t,e){return t+e+10},0);o.each(t.icons,function(e,n){for(var o=0,s=0;s<n;s++)o+=a[s]+10;e.attr("position",[i+o-h/2,r+5]),e.show(),e.attachLine=t})}},i.prototype.hideAllLineOperation=function(){o.each(this.lineOperations,function(t){t.hide()})},i.prototype.addDeleteIcon=function(t,e){var n=o.defaults({iconPath:"path://"+s.DEL_SVG,width:12,height:14,lineNode:t,callback:function(t){this._api.remove(t.target.attachLine)}.bind(this)},e,!0);this.addIcon("delete",n)},i.prototype.addChangeLineTypeIcon=function(t,e){var n=o.defaults({iconPath:"path://"+s.CHANGE_LINE_TYPE_SVG,width:15,height:15,lineNode:t,callback:function(){this._api.changeSelectConnectorType()}.bind(this)},e,!0);this.addIcon("change",n)},t.exports=i},function(t,e,n){var i=n(3),r={virtualXLine:null,virtualYLine:null,createGuidelines:function(t){this.virtualXLine=new i.Line({style:{lineDash:[5]},z:3}),this.virtualYLine=new i.Line({style:{lineDash:[5]},z:3}),t.add(this.virtualXLine),t.add(this.virtualYLine)},judgeAlignment:function(t,e,n,i){for(var r=this,o=0,s=e.length;o<s;o++){if(t[1]==e[o].position[1]){r.virtualXLine.attr("position",[0,t[1]]),r.virtualXLine.attr("shape",{x2:n});break}r.virtualXLine.attr("shape",{x2:0})}for(var a=0,h=e.length;a<h;a++){if(t[0]==e[a].position[0]){r.virtualYLine.attr("position",[t[0],0]),r.virtualYLine.attr("shape",{y2:i});break}r.virtualYLine.attr("shape",{y2:0})}}};t.exports=r},function(t,e,n){"use strict";function i(){try{Promise===o&&(Promise=r)}catch(t){}return o}var r;"undefined"!=typeof Promise&&(r=Promise);var o=n(120)();o.noConflict=i,t.exports=o},function(t,e,n){(function(e){"use strict";t.exports=function(){function i(){}function r(t,e){if(null==t||t.constructor!==o)throw new m("the promise constructor cannot be invoked directly\n\n    See http://goo.gl/MqrFmX\n");if("function"!=typeof e)throw new m("expecting a function but got "+d.classString(e))}function o(t){t!==b&&r(this,t),this._bitField=0,this._fulfillmentHandler0=void 0,this._rejectionHandler0=void 0,this._promise0=void 0,this._receiver0=void 0,this._resolveFromExecutor(t),this._promiseCreated(),this._fireEvent("promiseCreated",this)}function s(t){this.promise._resolveCallback(t)}function a(t){this.promise._rejectCallback(t,!1)}function h(t){var e=new o(b);e._fulfillmentHandler0=t,e._rejectionHandler0=t,e._promise0=t,e._receiver0=t}var l,c=function(){return new m("circular promise resolution chain\n\n    See http://goo.gl/MqrFmX\n")},u=function(){return new o.PromiseInspection(this._target())},p=function(t){return o.reject(new m(t))},f={},d=n(122);l=d.isNode?function(){var t=e.domain;return void 0===t&&(t=null),t}:function(){return null},d.notEnumerableProp(o,"_getDomain",l);var g=n(123),v=n(124),y=new v;g.defineProperty(o,"_async",{value:y});var _=n(129),m=o.TypeError=_.TypeError;o.RangeError=_.RangeError;var x=o.CancellationError=_.CancellationError;o.TimeoutError=_.TimeoutError,o.OperationalError=_.OperationalError,o.RejectionError=_.OperationalError,o.AggregateError=_.AggregateError;var b=function(){},w={},P={},C=n(130)(o,b),S=n(131)(o,b,C,p,i),T=n(132)(o),E=T.create,R=n(133)(o,T),k=(R.CapturedTrace,n(134)(o,C,P)),N=n(135)(P),M=n(136),L=d.errorObj,A=d.tryCatch;return o.prototype.toString=function(){return"[object Promise]"},o.prototype.caught=o.prototype["catch"]=function(t){var e=arguments.length;if(e>1){var n,i=new Array(e-1),r=0;for(n=0;n<e-1;++n){var o=arguments[n];if(!d.isObject(o))return p("Catch statement predicate: expecting an object but got "+d.classString(o));i[r++]=o}if(i.length=r,t=arguments[n],"function"!=typeof t)throw new m("The last argument to .catch() must be a function, got "+d.toString(t));return this.then(void 0,N(i,t,this))}return this.then(void 0,t)},o.prototype.reflect=function(){return this._then(u,u,void 0,this,void 0)},o.prototype.then=function(t,e){if(R.warnings()&&arguments.length>0&&"function"!=typeof t&&"function"!=typeof e){var n=".then() only accepts functions but was passed: "+d.classString(t);arguments.length>1&&(n+=", "+d.classString(e)),this._warn(n)}return this._then(t,e,void 0,void 0,void 0)},o.prototype.done=function(t,e){var n=this._then(t,e,void 0,void 0,void 0);n._setIsFinal()},o.prototype.spread=function(t){return"function"!=typeof t?p("expecting a function but got "+d.classString(t)):this.all()._then(t,void 0,void 0,w,void 0)},o.prototype.toJSON=function(){var t={isFulfilled:!1,isRejected:!1,fulfillmentValue:void 0,rejectionReason:void 0};return this.isFulfilled()?(t.fulfillmentValue=this.value(),t.isFulfilled=!0):this.isRejected()&&(t.rejectionReason=this.reason(),t.isRejected=!0),t},o.prototype.all=function(){return arguments.length>0&&this._warn(".all() was passed arguments but it does not take any"),new S(this).promise()},o.prototype.error=function(t){return this.caught(d.originatesFromRejection,t)},o.getNewLibraryCopy=t.exports,o.is=function(t){return t instanceof o},o.fromNode=o.fromCallback=function(t){var e=new o(b);e._captureStackTrace();var n=arguments.length>1&&!!Object(arguments[1]).multiArgs,i=A(t)(M(e,n));return i===L&&e._rejectCallback(i.e,!0),e._isFateSealed()||e._setAsyncGuaranteed(),e},o.all=function(t){return new S(t).promise()},o.cast=function(t){var e=C(t);return e instanceof o||(e=new o(b),e._captureStackTrace(),e._setFulfilled(),e._rejectionHandler0=t),e},o.resolve=o.fulfilled=o.cast,o.reject=o.rejected=function(t){var e=new o(b);return e._captureStackTrace(),e._rejectCallback(t,!0),e},o.setScheduler=function(t){if("function"!=typeof t)throw new m("expecting a function but got "+d.classString(t));return y.setScheduler(t)},o.prototype._then=function(t,e,n,i,r){var s=void 0!==r,a=s?r:new o(b),h=this._target(),c=h._bitField;s||(a._propagateFrom(this,3),a._captureStackTrace(),void 0===i&&0!==(2097152&this._bitField)&&(i=0!==(50397184&c)?this._boundValue():h===this?void 0:this._boundTo),this._fireEvent("promiseChained",this,a));var u=l();if(0!==(50397184&c)){var p,f,g=h._settlePromiseCtx;0!==(33554432&c)?(f=h._rejectionHandler0,p=t):0!==(16777216&c)?(f=h._fulfillmentHandler0,p=e,h._unsetRejectionIsUnhandled()):(g=h._settlePromiseLateCancellationObserver,f=new x("late cancellation observer"),h._attachExtraTrace(f),p=e),y.invoke(g,h,{handler:null===u?p:"function"==typeof p&&d.domainBind(u,p),promise:a,receiver:i,value:f})}else h._addCallbacks(t,e,a,i,u);return a},o.prototype._length=function(){return 65535&this._bitField},o.prototype._isFateSealed=function(){return 0!==(117506048&this._bitField)},o.prototype._isFollowing=function(){return 67108864===(67108864&this._bitField)},o.prototype._setLength=function(t){this._bitField=this._bitField&-65536|65535&t},o.prototype._setFulfilled=function(){this._bitField=33554432|this._bitField,this._fireEvent("promiseFulfilled",this)},o.prototype._setRejected=function(){this._bitField=16777216|this._bitField,this._fireEvent("promiseRejected",this)},o.prototype._setFollowing=function(){this._bitField=67108864|this._bitField,this._fireEvent("promiseResolved",this)},o.prototype._setIsFinal=function(){this._bitField=4194304|this._bitField},o.prototype._isFinal=function(){return(4194304&this._bitField)>0},o.prototype._unsetCancelled=function(){this._bitField=this._bitField&-65537},o.prototype._setCancelled=function(){this._bitField=65536|this._bitField,this._fireEvent("promiseCancelled",this)},o.prototype._setWillBeCancelled=function(){this._bitField=8388608|this._bitField},o.prototype._setAsyncGuaranteed=function(){y.hasCustomScheduler()||(this._bitField=134217728|this._bitField)},o.prototype._receiverAt=function(t){var e=0===t?this._receiver0:this[4*t-4+3];if(e!==f)return void 0===e&&this._isBound()?this._boundValue():e},o.prototype._promiseAt=function(t){return this[4*t-4+2]},o.prototype._fulfillmentHandlerAt=function(t){return this[4*t-4+0]},o.prototype._rejectionHandlerAt=function(t){return this[4*t-4+1]},o.prototype._boundValue=function(){},o.prototype._migrateCallback0=function(t){var e=(t._bitField,t._fulfillmentHandler0),n=t._rejectionHandler0,i=t._promise0,r=t._receiverAt(0);void 0===r&&(r=f),this._addCallbacks(e,n,i,r,null)},o.prototype._migrateCallbackAt=function(t,e){var n=t._fulfillmentHandlerAt(e),i=t._rejectionHandlerAt(e),r=t._promiseAt(e),o=t._receiverAt(e);void 0===o&&(o=f),this._addCallbacks(n,i,r,o,null)},o.prototype._addCallbacks=function(t,e,n,i,r){var o=this._length();if(o>=65531&&(o=0,this._setLength(0)),0===o)this._promise0=n,this._receiver0=i,"function"==typeof t&&(this._fulfillmentHandler0=null===r?t:d.domainBind(r,t)),"function"==typeof e&&(this._rejectionHandler0=null===r?e:d.domainBind(r,e));else{var s=4*o-4;this[s+2]=n,this[s+3]=i,"function"==typeof t&&(this[s+0]=null===r?t:d.domainBind(r,t)),"function"==typeof e&&(this[s+1]=null===r?e:d.domainBind(r,e))}return this._setLength(o+1),o},o.prototype._proxy=function(t,e){this._addCallbacks(void 0,void 0,e,t,null)},o.prototype._resolveCallback=function(t,e){if(0===(117506048&this._bitField)){if(t===this)return this._rejectCallback(c(),!1);var n=C(t,this);if(!(n instanceof o))return this._fulfill(t);e&&this._propagateFrom(n,2);var i=n._target();if(i===this)return void this._reject(c());var r=i._bitField;if(0===(50397184&r)){var s=this._length();s>0&&i._migrateCallback0(this);for(var a=1;a<s;++a)i._migrateCallbackAt(this,a);this._setFollowing(),this._setLength(0),this._setFollowee(i)}else if(0!==(33554432&r))this._fulfill(i._value());else if(0!==(16777216&r))this._reject(i._reason());else{var h=new x("late cancellation observer");i._attachExtraTrace(h),this._reject(h)}}},o.prototype._rejectCallback=function(t,e,n){var i=d.ensureErrorObject(t),r=i===t;if(!r&&!n&&R.warnings()){var o="a promise was rejected with a non-error: "+d.classString(t);this._warn(o,!0)}this._attachExtraTrace(i,!!e&&r),this._reject(t)},o.prototype._resolveFromExecutor=function(t){if(t!==b){var e=this;this._captureStackTrace(),this._pushContext();var n=!0,i=this._execute(t,function(t){e._resolveCallback(t)},function(t){e._rejectCallback(t,n)});n=!1,this._popContext(),void 0!==i&&e._rejectCallback(i,!0)}},o.prototype._settlePromiseFromHandler=function(t,e,n,i){var r=i._bitField;if(0===(65536&r)){i._pushContext();var o;e===w?n&&"number"==typeof n.length?o=A(t).apply(this._boundValue(),n):(o=L,o.e=new m("cannot .spread() a non-array: "+d.classString(n))):o=A(t).call(e,n);var s=i._popContext();r=i._bitField,0===(65536&r)&&(o===P?i._reject(n):o===L?i._rejectCallback(o.e,!1):(R.checkForgottenReturns(o,s,"",i,this),i._resolveCallback(o)))}},o.prototype._target=function(){for(var t=this;t._isFollowing();)t=t._followee();return t},o.prototype._followee=function(){return this._rejectionHandler0},o.prototype._setFollowee=function(t){this._rejectionHandler0=t},o.prototype._settlePromise=function(t,e,n,r){var s=t instanceof o,a=this._bitField,h=0!==(134217728&a);0!==(65536&a)?(s&&t._invokeInternalOnCancel(),n instanceof k&&n.isFinallyHandler()?(n.cancelPromise=t,A(e).call(n,r)===L&&t._reject(L.e)):e===u?t._fulfill(u.call(n)):n instanceof i?n._promiseCancelled(t):s||t instanceof S?t._cancel():n.cancel()):"function"==typeof e?s?(h&&t._setAsyncGuaranteed(),this._settlePromiseFromHandler(e,n,r,t)):e.call(n,r,t):n instanceof i?n._isResolved()||(0!==(33554432&a)?n._promiseFulfilled(r,t):n._promiseRejected(r,t)):s&&(h&&t._setAsyncGuaranteed(),0!==(33554432&a)?t._fulfill(r):t._reject(r))},o.prototype._settlePromiseLateCancellationObserver=function(t){var e=t.handler,n=t.promise,i=t.receiver,r=t.value;"function"==typeof e?n instanceof o?this._settlePromiseFromHandler(e,i,r,n):e.call(i,r,n):n instanceof o&&n._reject(r)},o.prototype._settlePromiseCtx=function(t){this._settlePromise(t.promise,t.handler,t.receiver,t.value)},o.prototype._settlePromise0=function(t,e,n){var i=this._promise0,r=this._receiverAt(0);this._promise0=void 0,this._receiver0=void 0,this._settlePromise(i,t,r,e)},o.prototype._clearCallbackDataAtIndex=function(t){var e=4*t-4;this[e+2]=this[e+3]=this[e+0]=this[e+1]=void 0},o.prototype._fulfill=function(t){var e=this._bitField;if(!((117506048&e)>>>16)){if(t===this){var n=c();return this._attachExtraTrace(n),this._reject(n)}this._setFulfilled(),this._rejectionHandler0=t,(65535&e)>0&&(0!==(134217728&e)?this._settlePromises():y.settlePromises(this),this._dereferenceTrace())}},o.prototype._reject=function(t){var e=this._bitField;if(!((117506048&e)>>>16))return this._setRejected(),this._fulfillmentHandler0=t,this._isFinal()?y.fatalError(t,d.isNode):void((65535&e)>0?y.settlePromises(this):this._ensurePossibleRejectionHandled())},o.prototype._fulfillPromises=function(t,e){for(var n=1;n<t;n++){var i=this._fulfillmentHandlerAt(n),r=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(r,i,o,e)}},o.prototype._rejectPromises=function(t,e){for(var n=1;n<t;n++){var i=this._rejectionHandlerAt(n),r=this._promiseAt(n),o=this._receiverAt(n);this._clearCallbackDataAtIndex(n),this._settlePromise(r,i,o,e)}},o.prototype._settlePromises=function(){var t=this._bitField,e=65535&t;if(e>0){if(0!==(16842752&t)){var n=this._fulfillmentHandler0;this._settlePromise0(this._rejectionHandler0,n,t),this._rejectPromises(e,n)}else{var i=this._rejectionHandler0;this._settlePromise0(this._fulfillmentHandler0,i,t),this._fulfillPromises(e,i)}this._setLength(0)}this._clearCancellationData()},o.prototype._settledValue=function(){var t=this._bitField;return 0!==(33554432&t)?this._rejectionHandler0:0!==(16777216&t)?this._fulfillmentHandler0:void 0},"undefined"!=typeof Symbol&&Symbol.toStringTag&&g.defineProperty(o.prototype,Symbol.toStringTag,{get:function(){return"Object"}}),o.defer=o.pending=function(){R.deprecated("Promise.defer","new Promise");var t=new o(b);return{promise:t,resolve:s,reject:a}},d.notEnumerableProp(o,"_makeSelfResolutionError",c),n(137)(o,b,C,p,R),n(138)(o,b,C,R),n(139)(o,S,p,R),n(140)(o),n(141)(o),n(142)(o,S,C,b,y,l),o.Promise=o,o.version="3.5.5",n(143)(o),n(144)(o,p,b,C,i,R),n(145)(o,S,p,C,b,R),n(146)(o),n(147)(o,b),n(148)(o,S,C,p),n(149)(o,b,C,p),n(150)(o,S,p,C,b,R),n(151)(o,S,R),n(152)(o,S,p),n(153)(o,b,R),n(154)(o,p,C,E,b,R),n(155)(o),n(156)(o,b),n(157)(o,b),d.toFastProperties(o),d.toFastProperties(o.prototype),h({a:1}),h({b:2}),h({c:3}),h(1),h(function(){}),h(void 0),h(!1),h(new o(b)),R.setBounds(v.firstLineError,d.lastLineError),o}}).call(e,n(121))},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function i(){throw new Error("clearTimeout has not been defined")}function r(t){if(c===setTimeout)return setTimeout(t,0);if((c===n||!c)&&setTimeout)return c=setTimeout,setTimeout(t,0);try{return c(t,0)}catch(e){try{return c.call(null,t,0)}catch(e){return c.call(this,t,0)}}}function o(t){if(u===clearTimeout)return clearTimeout(t);if((u===i||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(t);try{return u(t)}catch(e){try{return u.call(null,t)}catch(e){return u.call(this,t)}}}function s(){g&&f&&(g=!1,f.length?d=f.concat(d):v=-1,d.length&&a())}function a(){if(!g){var t=r(s);g=!0;for(var e=d.length;e;){for(f=d,d=[];++v<e;)f&&f[v].run();v=-1,e=d.length}f=null,g=!1,o(t)}}function h(t,e){this.fun=t,this.array=e}function l(){}var c,u,p=t.exports={};!function(){try{c="function"==typeof setTimeout?setTimeout:n}catch(t){c=n}try{u="function"==typeof clearTimeout?clearTimeout:i}catch(t){u=i}}();var f,d=[],g=!1,v=-1;p.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];d.push(new h(t,e)),1!==d.length||g||r(a)},h.prototype.run=function(){this.fun.apply(null,this.array)},p.title="browser",p.browser=!0,p.env={},p.argv=[],p.version="",p.versions={},p.on=l,p.addListener=l,p.once=l,p.off=l,p.removeListener=l,p.removeAllListeners=l,p.emit=l,p.prependListener=l,p.prependOnceListener=l,p.listeners=function(t){return[]},p.binding=function(t){throw new Error("process.binding is not supported")},p.cwd=function(){return"/"},p.chdir=function(t){throw new Error("process.chdir is not supported")},p.umask=function(){return 0}},function(t,e,n){(function(e,i){"use strict";function r(){try{var t=N;return N=null,t.apply(this,arguments)}catch(e){return k.e=e,k}}function o(t){return N=t,r}function s(t){return null==t||t===!0||t===!1||"string"==typeof t||"number"==typeof t}function a(t){return"function"==typeof t||"object"==typeof t&&null!==t}function h(t){return s(t)?new Error(y(t)):t}function l(t,e){var n,i=t.length,r=new Array(i+1);for(n=0;n<i;++n)r[n]=t[n];return r[n]=e,r}function c(t,e,n){if(!E.isES5)return{}.hasOwnProperty.call(t,e)?t[e]:void 0;var i=Object.getOwnPropertyDescriptor(t,e);return null!=i?null==i.get&&null==i.set?i.value:n:void 0}function u(t,e,n){if(s(t))return t;var i={value:n,configurable:!0,enumerable:!1,writable:!0};return E.defineProperty(t,e,i),t}function p(t){throw t}function f(t){try{if("function"==typeof t){var e=E.names(t.prototype),n=E.isES5&&e.length>1,i=e.length>0&&!(1===e.length&&"constructor"===e[0]),r=O.test(t+"")&&E.names(t).length>0;if(n||i||r)return!0}return!1}catch(o){return!1}}function d(t){function e(){}function n(){return typeof i.foo}e.prototype=t;var i=new e;return n(),n(),t}function g(t){return z.test(t)}function v(t,e,n){for(var i=new Array(t),r=0;r<t;++r)i[r]=e+r+n;return i}function y(t){try{return t+""}catch(e){return"[no string representation]"}}function _(t){return t instanceof Error||null!==t&&"object"==typeof t&&"string"==typeof t.message&&"string"==typeof t.name}function m(t){try{u(t,"isOperational",!0)}catch(e){}}function x(t){return null!=t&&(t instanceof Error.__BluebirdErrorTypes__.OperationalError||t.isOperational===!0)}function b(t){return _(t)&&E.propertyIsWritable(t,"stack")}function w(t){return{}.toString.call(t)}function P(t,e,n){for(var i=E.names(t),r=0;r<i.length;++r){var o=i[r];if(n(o))try{E.defineProperty(e,o,E.getDescriptor(t,o))}catch(s){}}}function C(t){return D?i.env[t]:void 0}function S(){if("function"==typeof Promise)try{var t=new Promise(function(){});if("[object Promise]"==={}.toString.call(t))return Promise}catch(e){}}function T(t,e){return t.bind(e)}var E=n(123),R="undefined"==typeof navigator,k={e:{}},N,M="undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof e?e:void 0!==this?this:null,L=function(t,e){function n(){this.constructor=t,this.constructor$=e;for(var n in e.prototype)i.call(e.prototype,n)&&"$"!==n.charAt(n.length-1)&&(this[n+"$"]=e.prototype[n])}var i={}.hasOwnProperty;return n.prototype=e.prototype,t.prototype=new n,t.prototype},A=function(){var t=[Array.prototype,Object.prototype,Function.prototype],e=function(e){for(var n=0;n<t.length;++n)if(t[n]===e)return!0;return!1};if(E.isES5){var n=Object.getOwnPropertyNames;return function(t){for(var i=[],r=Object.create(null);null!=t&&!e(t);){var o;try{o=n(t)}catch(s){return i}for(var a=0;a<o.length;++a){var h=o[a];if(!r[h]){r[h]=!0;var l=Object.getOwnPropertyDescriptor(t,h);null!=l&&null==l.get&&null==l.set&&i.push(h)}}t=E.getPrototypeOf(t)}return i}}var i={}.hasOwnProperty;return function(n){if(e(n))return[];var r=[];t:for(var o in n)if(i.call(n,o))r.push(o);else{for(var s=0;s<t.length;++s)if(i.call(t[s],o))continue t;r.push(o)}return r}}(),O=/this\s*\.\s*\S+\s*=/,z=/^[a-z$_][a-z$_0-9]*$/i,F=function(){return"stack"in new Error?function(t){return b(t)?t:new Error(y(t))}:function(t){if(b(t))return t;try{throw new Error(y(t))}catch(e){return e}}}(),I=function(t){return E.isArray(t)?t:null};if("undefined"!=typeof Symbol&&Symbol.iterator){var B="function"==typeof Array.from?function(t){return Array.from(t)}:function(t){for(var e,n=[],i=t[Symbol.iterator]();!(e=i.next()).done;)n.push(e.value);return n};I=function(t){return E.isArray(t)?t:null!=t&&"function"==typeof t[Symbol.iterator]?B(t):null}}var j="undefined"!=typeof i&&"[object process]"===w(i).toLowerCase(),D="undefined"!=typeof i&&"undefined"!=typeof i.env,H={isClass:f,isIdentifier:g,inheritedDataKeys:A,
getDataPropertyOrDefault:c,thrower:p,isArray:E.isArray,asArray:I,notEnumerableProp:u,isPrimitive:s,isObject:a,isError:_,canEvaluate:R,errorObj:k,tryCatch:o,inherits:L,withAppended:l,maybeWrapAsError:h,toFastProperties:d,filledRange:v,toString:y,canAttachTrace:b,ensureErrorObject:F,originatesFromRejection:x,markAsOriginatingFromRejection:m,classString:w,copyDescriptors:P,hasDevTools:"undefined"!=typeof chrome&&chrome&&"function"==typeof chrome.loadTimes,isNode:j,hasEnvVariables:D,env:C,global:M,getNativePromise:S,domainBind:T};H.isRecentNode=H.isNode&&function(){var t;return i.versions&&i.versions.node?t=i.versions.node.split(".").map(Number):i.version&&(t=i.version.split(".").map(Number)),0===t[0]&&t[1]>10||t[0]>0}(),H.isNode&&H.toFastProperties(i);try{throw new Error}catch(V){H.lastLineError=V}t.exports=H}).call(e,function(){return this}(),n(121))},function(t,e){var n=function(){"use strict";return void 0===this}();if(n)t.exports={freeze:Object.freeze,defineProperty:Object.defineProperty,getDescriptor:Object.getOwnPropertyDescriptor,keys:Object.keys,names:Object.getOwnPropertyNames,getPrototypeOf:Object.getPrototypeOf,isArray:Array.isArray,isES5:n,propertyIsWritable:function(t,e){var n=Object.getOwnPropertyDescriptor(t,e);return!(n&&!n.writable&&!n.set)}};else{var i={}.hasOwnProperty,r={}.toString,o={}.constructor.prototype,s=function(t){var e=[];for(var n in t)i.call(t,n)&&e.push(n);return e},a=function(t,e){return{value:t[e]}},h=function(t,e,n){return t[e]=n.value,t},l=function(t){return t},c=function(t){try{return Object(t).constructor.prototype}catch(e){return o}},u=function(t){try{return"[object Array]"===r.call(t)}catch(e){return!1}};t.exports={isArray:u,keys:s,names:s,defineProperty:h,getDescriptor:a,freeze:l,getPrototypeOf:c,isES5:n,propertyIsWritable:function(){return!0}}}},function(t,e,n){(function(e){"use strict";function i(){this._customScheduler=!1,this._isTickUsed=!1,this._lateQueue=new p(16),this._normalQueue=new p(16),this._haveDrainedQueues=!1,this._trampolineEnabled=!0;var t=this;this.drainQueues=function(){t._drainQueues()},this._schedule=u}function r(t,e,n){this._lateQueue.push(t,e,n),this._queueTick()}function o(t,e,n){this._normalQueue.push(t,e,n),this._queueTick()}function s(t){this._normalQueue._pushOne(t),this._queueTick()}function a(t){for(;t.length()>0;)h(t)}function h(t){var e=t.shift();if("function"!=typeof e)e._settlePromises();else{var n=t.shift(),i=t.shift();e.call(n,i)}}var l;try{throw new Error}catch(c){l=c}var u=n(125),p=n(128),f=n(122);i.prototype.setScheduler=function(t){var e=this._schedule;return this._schedule=t,this._customScheduler=!0,e},i.prototype.hasCustomScheduler=function(){return this._customScheduler},i.prototype.enableTrampoline=function(){this._trampolineEnabled=!0},i.prototype.disableTrampolineIfNecessary=function(){f.hasDevTools&&(this._trampolineEnabled=!1)},i.prototype.haveItemsQueued=function(){return this._isTickUsed||this._haveDrainedQueues},i.prototype.fatalError=function(t,n){n?(e.stderr.write("Fatal "+(t instanceof Error?t.stack:t)+"\n"),e.exit(2)):this.throwLater(t)},i.prototype.throwLater=function(t,e){if(1===arguments.length&&(e=t,t=function(){throw e}),"undefined"!=typeof setTimeout)setTimeout(function(){t(e)},0);else try{this._schedule(function(){t(e)})}catch(n){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")}},f.hasDevTools?(i.prototype.invokeLater=function(t,e,n){this._trampolineEnabled?r.call(this,t,e,n):this._schedule(function(){setTimeout(function(){t.call(e,n)},100)})},i.prototype.invoke=function(t,e,n){this._trampolineEnabled?o.call(this,t,e,n):this._schedule(function(){t.call(e,n)})},i.prototype.settlePromises=function(t){this._trampolineEnabled?s.call(this,t):this._schedule(function(){t._settlePromises()})}):(i.prototype.invokeLater=r,i.prototype.invoke=o,i.prototype.settlePromises=s),i.prototype._drainQueues=function(){a(this._normalQueue),this._reset(),this._haveDrainedQueues=!0,a(this._lateQueue)},i.prototype._queueTick=function(){this._isTickUsed||(this._isTickUsed=!0,this._schedule(this.drainQueues))},i.prototype._reset=function(){this._isTickUsed=!1},t.exports=i,t.exports.firstLineError=l}).call(e,n(121))},function(t,e,n){(function(e,i,r){"use strict";var o,s=n(122),a=function(){throw new Error("No async scheduler available\n\n    See http://goo.gl/MqrFmX\n")},h=s.getNativePromise();if(s.isNode&&"undefined"==typeof MutationObserver){var l=e.setImmediate,c=i.nextTick;o=s.isRecentNode?function(t){l.call(e,t)}:function(t){c.call(i,t)}}else if("function"==typeof h&&"function"==typeof h.resolve){var u=h.resolve();o=function(t){u.then(t)}}else o="undefined"!=typeof MutationObserver&&("undefined"==typeof window||!window.navigator||!window.navigator.standalone&&!window.cordova)&&"classList"in document.documentElement?function(){var t=document.createElement("div"),e={attributes:!0},n=!1,i=document.createElement("div"),r=new MutationObserver(function(){t.classList.toggle("foo"),n=!1});r.observe(i,e);var o=function(){n||(n=!0,i.classList.toggle("foo"))};return function(n){var i=new MutationObserver(function(){i.disconnect(),n()});i.observe(t,e),o()}}():"undefined"!=typeof r?function(t){r(t)}:"undefined"!=typeof setTimeout?function(t){setTimeout(t,0)}:a;t.exports=o}).call(e,function(){return this}(),n(121),n(126).setImmediate)},function(t,e,n){(function(t){function i(t,e){this._id=t,this._clearFn=e}var r="undefined"!=typeof t&&t||"undefined"!=typeof self&&self||window,o=Function.prototype.apply;e.setTimeout=function(){return new i(o.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new i(o.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},i.prototype.unref=i.prototype.ref=function(){},i.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(127),e.setImmediate="undefined"!=typeof self&&self.setImmediate||"undefined"!=typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||"undefined"!=typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(e,function(){return this}())},function(t,e,n){(function(t,e){!function(t,n){"use strict";function i(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return g[d]=i,f(d),d++}function r(t){delete g[t]}function o(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}}function s(t){if(v)setTimeout(s,0,t);else{var e=g[t];if(e){v=!0;try{o(e)}finally{r(t),v=!1}}}}function a(){f=function(t){e.nextTick(function(){s(t)})}}function h(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}function l(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"==typeof n.data&&0===n.data.indexOf(e)&&s(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),f=function(n){t.postMessage(e+n,"*")}}function c(){var t=new MessageChannel;t.port1.onmessage=function(t){var e=t.data;s(e)},f=function(e){t.port2.postMessage(e)}}function u(){var t=y.documentElement;f=function(e){var n=y.createElement("script");n.onreadystatechange=function(){s(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}function p(){f=function(t){setTimeout(s,0,t)}}if(!t.setImmediate){var f,d=1,g={},v=!1,y=t.document,_=Object.getPrototypeOf&&Object.getPrototypeOf(t);_=_&&_.setTimeout?_:t,"[object process]"==={}.toString.call(t.process)?a():h()?l():t.MessageChannel?c():y&&"onreadystatechange"in y.createElement("script")?u():p(),_.setImmediate=i,_.clearImmediate=r}}("undefined"==typeof self?"undefined"==typeof t?this:t:self)}).call(e,function(){return this}(),n(121))},function(t,e){"use strict";function n(t,e,n,i,r){for(var o=0;o<r;++o)n[o+i]=t[o+e],t[o+e]=void 0}function i(t){this._capacity=t,this._length=0,this._front=0}i.prototype._willBeOverCapacity=function(t){return this._capacity<t},i.prototype._pushOne=function(t){var e=this.length();this._checkCapacity(e+1);var n=this._front+e&this._capacity-1;this[n]=t,this._length=e+1},i.prototype.push=function(t,e,n){var i=this.length()+3;if(this._willBeOverCapacity(i))return this._pushOne(t),this._pushOne(e),void this._pushOne(n);var r=this._front+i-3;this._checkCapacity(i);var o=this._capacity-1;this[r+0&o]=t,this[r+1&o]=e,this[r+2&o]=n,this._length=i},i.prototype.shift=function(){var t=this._front,e=this[t];return this[t]=void 0,this._front=t+1&this._capacity-1,this._length--,e},i.prototype.length=function(){return this._length},i.prototype._checkCapacity=function(t){this._capacity<t&&this._resizeTo(this._capacity<<1)},i.prototype._resizeTo=function(t){var e=this._capacity;this._capacity=t;var i=this._front,r=this._length,o=i+r&e-1;n(this,0,this,e,o)},t.exports=i},function(t,e,n){"use strict";function i(t,e){function n(i){return this instanceof n?(u(this,"message","string"==typeof i?i:e),u(this,"name",t),void(Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):Error.call(this))):new n(i)}return c(n,Error),n}function r(t){return this instanceof r?(u(this,"name","OperationalError"),u(this,"message",t),this.cause=t,this.isOperational=!0,void(t instanceof Error?(u(this,"message",t.message),u(this,"stack",t.stack)):Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor))):new r(t)}var o,s,a=n(123),h=a.freeze,l=n(122),c=l.inherits,u=l.notEnumerableProp,p=i("Warning","warning"),f=i("CancellationError","cancellation error"),d=i("TimeoutError","timeout error"),g=i("AggregateError","aggregate error");try{o=TypeError,s=RangeError}catch(v){o=i("TypeError","type error"),s=i("RangeError","range error")}for(var y="join pop push shift unshift slice filter forEach some every map indexOf lastIndexOf reduce reduceRight sort reverse".split(" "),_=0;_<y.length;++_)"function"==typeof Array.prototype[y[_]]&&(g.prototype[y[_]]=Array.prototype[y[_]]);a.defineProperty(g.prototype,"length",{value:0,configurable:!1,writable:!0,enumerable:!0}),g.prototype.isOperational=!0;var m=0;g.prototype.toString=function(){var t=Array(4*m+1).join(" "),e="\n"+t+"AggregateError of:\n";m++,t=Array(4*m+1).join(" ");for(var n=0;n<this.length;++n){for(var i=this[n]===this?"[Circular AggregateError]":this[n]+"",r=i.split("\n"),o=0;o<r.length;++o)r[o]=t+r[o];i=r.join("\n"),e+=i+"\n"}return m--,e},c(r,Error);var x=Error.__BluebirdErrorTypes__;x||(x=h({CancellationError:f,TimeoutError:d,OperationalError:r,RejectionError:r,AggregateError:g}),a.defineProperty(Error,"__BluebirdErrorTypes__",{value:x,writable:!1,enumerable:!1,configurable:!1})),t.exports={Error:Error,TypeError:o,RangeError:s,CancellationError:x.CancellationError,OperationalError:x.OperationalError,TimeoutError:x.TimeoutError,AggregateError:x.AggregateError,Warning:p}},function(t,e,n){"use strict";t.exports=function(t,e){function i(n,i){if(c(n)){if(n instanceof t)return n;var r=o(n);if(r===l){i&&i._pushContext();var h=t.reject(r.e);return i&&i._popContext(),h}if("function"==typeof r){if(s(n)){var h=new t(e);return n._then(h._fulfill,h._reject,void 0,h,null),h}return a(n,r,i)}}return n}function r(t){return t.then}function o(t){try{return r(t)}catch(e){return l.e=e,l}}function s(t){try{return u.call(t,"_promise0")}catch(e){return!1}}function a(n,i,r){function o(t){a&&(a._resolveCallback(t),a=null)}function s(t){a&&(a._rejectCallback(t,u,!0),a=null)}var a=new t(e),c=a;r&&r._pushContext(),a._captureStackTrace(),r&&r._popContext();var u=!0,p=h.tryCatch(i).call(n,o,s);return u=!1,a&&p===l&&(a._rejectCallback(p.e,!0,!0),a=null),c}var h=n(122),l=h.errorObj,c=h.isObject,u={}.hasOwnProperty;return i}},function(t,e,n){"use strict";t.exports=function(t,e,i,r,o){function s(t){switch(t){case-2:return[];case-3:return{};case-6:return new Map}}function a(n){var i=this._promise=new t(e);n instanceof t&&i._propagateFrom(n,3),i._setOnCancel(this),this._values=n,this._length=0,this._totalResolved=0,this._init(void 0,-2)}var h=n(122);h.isArray;return h.inherits(a,o),a.prototype.length=function(){return this._length},a.prototype.promise=function(){return this._promise},a.prototype._init=function l(e,n){var o=i(this._values,this._promise);if(o instanceof t){o=o._target();var a=o._bitField;if(this._values=o,0===(50397184&a))return this._promise._setAsyncGuaranteed(),o._then(l,this._reject,void 0,this,n);if(0===(33554432&a))return 0!==(16777216&a)?this._reject(o._reason()):this._cancel();o=o._value()}if(o=h.asArray(o),null===o){var c=r("expecting an array or an iterable object but got "+h.classString(o)).reason();return void this._promise._rejectCallback(c,!1)}return 0===o.length?void(n===-5?this._resolveEmptyArray():this._resolve(s(n))):void this._iterate(o)},a.prototype._iterate=function(e){var n=this.getActualLength(e.length);this._length=n,this._values=this.shouldCopyValues()?new Array(n):this._values;for(var r=this._promise,o=!1,s=null,a=0;a<n;++a){var h=i(e[a],r);h instanceof t?(h=h._target(),s=h._bitField):s=null,o?null!==s&&h.suppressUnhandledRejections():null!==s?0===(50397184&s)?(h._proxy(this,a),this._values[a]=h):o=0!==(33554432&s)?this._promiseFulfilled(h._value(),a):0!==(16777216&s)?this._promiseRejected(h._reason(),a):this._promiseCancelled(a):o=this._promiseFulfilled(h,a)}o||r._setAsyncGuaranteed()},a.prototype._isResolved=function(){return null===this._values},a.prototype._resolve=function(t){this._values=null,this._promise._fulfill(t)},a.prototype._cancel=function(){!this._isResolved()&&this._promise._isCancellable()&&(this._values=null,this._promise._cancel())},a.prototype._reject=function(t){this._values=null,this._promise._rejectCallback(t,!1)},a.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},a.prototype._promiseCancelled=function(){return this._cancel(),!0},a.prototype._promiseRejected=function(t){return this._totalResolved++,this._reject(t),!0},a.prototype._resultCancelled=function(){if(!this._isResolved()){var e=this._values;if(this._cancel(),e instanceof t)e.cancel();else for(var n=0;n<e.length;++n)e[n]instanceof t&&e[n].cancel()}},a.prototype.shouldCopyValues=function(){return!0},a.prototype.getActualLength=function(t){return t},a}},function(t,e){"use strict";t.exports=function(t){function e(){this._trace=new e.CapturedTrace(i())}function n(){if(r)return new e}function i(){var t=o.length-1;if(t>=0)return o[t]}var r=!1,o=[];return t.prototype._promiseCreated=function(){},t.prototype._pushContext=function(){},t.prototype._popContext=function(){return null},t._peekContext=t.prototype._peekContext=function(){},e.prototype._pushContext=function(){void 0!==this._trace&&(this._trace._promiseCreated=null,o.push(this._trace))},e.prototype._popContext=function(){if(void 0!==this._trace){var t=o.pop(),e=t._promiseCreated;return t._promiseCreated=null,e}return null},e.CapturedTrace=null,e.create=n,e.deactivateLongStackTraces=function(){},e.activateLongStackTraces=function(){var n=t.prototype._pushContext,o=t.prototype._popContext,s=t._peekContext,a=t.prototype._peekContext,h=t.prototype._promiseCreated;e.deactivateLongStackTraces=function(){t.prototype._pushContext=n,t.prototype._popContext=o,t._peekContext=s,t.prototype._peekContext=a,t.prototype._promiseCreated=h,r=!1},r=!0,t.prototype._pushContext=e.prototype._pushContext,t.prototype._popContext=e.prototype._popContext,t._peekContext=t.prototype._peekContext=i,t.prototype._promiseCreated=function(){var t=this._peekContext();t&&null==t._promiseCreated&&(t._promiseCreated=this)}},e}},function(t,e,n){(function(e){"use strict";t.exports=function(t,i){function r(t,e){return{promise:e}}function o(){return!1}function s(t,e,n){var i=this;try{t(e,n,function(t){if("function"!=typeof t)throw new TypeError("onCancel must be a function, got: "+D.toString(t));i._attachCancellationCallback(t)})}catch(r){return r}}function a(t){if(!this._isCancellable())return this;var e=this._onCancel();void 0!==e?D.isArray(e)?e.push(t):this._setOnCancel([e,t]):this._setOnCancel(t)}function h(){return this._onCancelField}function l(t){this._onCancelField=t}function c(){this._cancellationParent=void 0,this._onCancelField=void 0}function u(t,e){if(0!==(1&e)){this._cancellationParent=t;var n=t._branchesRemainingToCancel;void 0===n&&(n=0),t._branchesRemainingToCancel=n+1}0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function p(t,e){0!==(2&e)&&t._isBound()&&this._setBoundTo(t._boundTo)}function f(){var e=this._boundTo;return void 0!==e&&e instanceof t?e.isFulfilled()?e.value():void 0:e}function d(){this._trace=new A(this._peekContext())}function g(t,e){if(V(t)){var n=this._trace;if(void 0!==n&&e&&(n=n._parent),void 0!==n)n.attachExtraTrace(t);else if(!t.__stackCleaned__){var i=S(t);D.notEnumerableProp(t,"stack",i.message+"\n"+i.stack.join("\n")),D.notEnumerableProp(t,"__stackCleaned__",!0)}}}function v(){this._trace=void 0}function y(t,e,n,i,r){if(void 0===t&&null!==e&&J){if(void 0!==r&&r._returnedNonUndefined())return;if(0===(65535&i._bitField))return;n&&(n+=" ");var o="",s="";if(e._trace){for(var a=e._trace.stack.split("\n"),h=P(a),l=h.length-1;l>=0;--l){var c=h[l];if(!U.test(c)){var u=c.match(Y);u&&(o="at "+u[1]+":"+u[2]+":"+u[3]+" ");break}}if(h.length>0)for(var p=h[0],l=0;l<a.length;++l)if(a[l]===p){l>0&&(s="\n"+a[l-1]);break}}var f="a promise was created in a "+n+"handler "+o+"but was not returned from it, see http://goo.gl/rRqMUw"+s;i._warn(f,!0,e)}}function _(t,e){var n=t+" is deprecated and will be removed in a future version.";return e&&(n+=" Use "+e+" instead."),m(n)}function m(e,n,i){if(ht.warnings){var r,o=new j(e);if(n)i._attachExtraTrace(o);else if(ht.longStackTraces&&(r=t._peekContext()))r.attachExtraTrace(o);else{var s=S(o);o.stack=s.message+"\n"+s.stack.join("\n")}it("warning",o)||T(o,"",!0)}}function x(t,e){for(var n=0;n<e.length-1;++n)e[n].push("From previous event:"),e[n]=e[n].join("\n");return n<e.length&&(e[n]=e[n].join("\n")),t+"\n"+e.join("\n")}function b(t){for(var e=0;e<t.length;++e)(0===t[e].length||e+1<t.length&&t[e][0]===t[e+1][0])&&(t.splice(e,1),e--)}function w(t){for(var e=t[0],n=1;n<t.length;++n){for(var i=t[n],r=e.length-1,o=e[r],s=-1,a=i.length-1;a>=0;--a)if(i[a]===o){s=a;break}for(var a=s;a>=0;--a){var h=i[a];if(e[r]!==h)break;e.pop(),r--}e=i}}function P(t){for(var e=[],n=0;n<t.length;++n){var i=t[n],r="    (No stack trace)"===i||W.test(i),o=r&&ot(i);r&&!o&&(q&&" "!==i.charAt(0)&&(i="    "+i),e.push(i))}return e}function C(t){for(var e=t.stack.replace(/\s+$/g,"").split("\n"),n=0;n<e.length;++n){var i=e[n];if("    (No stack trace)"===i||W.test(i))break}return n>0&&"SyntaxError"!=t.name&&(e=e.slice(n)),e}function S(t){var e=t.stack,n=t.toString();return e="string"==typeof e&&e.length>0?C(t):["    (No stack trace)"],{message:n,stack:"SyntaxError"==t.name?e:P(e)}}function T(t,e,n){if("undefined"!=typeof console){var i;if(D.isObject(t)){var r=t.stack;i=e+X(r,t)}else i=e+String(t);"function"==typeof F?F(i,n):"function"!=typeof console.log&&"object"!=typeof console.log||console.log(i)}}function E(t,e,n,i){var r=!1;try{"function"==typeof e&&(r=!0,"rejectionHandled"===t?e(i):e(n,i))}catch(o){B.throwLater(o)}"unhandledRejection"===t?it(t,n,i)||r||T(n,"Unhandled rejection "):it(t,i)}function R(t){var e;if("function"==typeof t)e="[function "+(t.name||"anonymous")+"]";else{e=t&&"function"==typeof t.toString?t.toString():D.toString(t);var n=/\[object [a-zA-Z0-9$_]+\]/;if(n.test(e))try{var i=JSON.stringify(t);e=i}catch(r){}0===e.length&&(e="(empty array)")}return"(<"+k(e)+">, no stack trace)"}function k(t){var e=41;return t.length<e?t:t.substr(0,e-3)+"..."}function N(){return"function"==typeof at}function M(t){var e=t.match(st);if(e)return{fileName:e[1],line:parseInt(e[2],10)}}function L(t,e){if(N()){for(var n,i,r=(t.stack||"").split("\n"),o=(e.stack||"").split("\n"),s=-1,a=-1,h=0;h<r.length;++h){var l=M(r[h]);if(l){n=l.fileName,s=l.line;break}}for(var h=0;h<o.length;++h){var l=M(o[h]);if(l){i=l.fileName,a=l.line;break}}s<0||a<0||!n||!i||n!==i||s>=a||(ot=function(t){if(G.test(t))return!0;var e=M(t);return!!(e&&e.fileName===n&&s<=e.line&&e.line<=a)})}}function A(t){this._parent=t,this._promisesCreated=0;var e=this._length=1+(void 0===t?0:t._length);at(this,A),e>32&&this.uncycle()}var O,z,F,I=t._getDomain,B=t._async,j=n(129).Warning,D=n(122),H=n(123),V=D.canAttachTrace,G=/[\\\/]bluebird[\\\/]js[\\\/](release|debug|instrumented)/,U=/\((?:timers\.js):\d+:\d+\)/,Y=/[\/<\(](.+?):(\d+):(\d+)\)?\s*$/,W=null,X=null,q=!1,Q=!(0==D.env("BLUEBIRD_DEBUG")||!D.env("BLUEBIRD_DEBUG")&&"development"!==D.env("NODE_ENV")),Z=!(0==D.env("BLUEBIRD_WARNINGS")||!Q&&!D.env("BLUEBIRD_WARNINGS")),$=!(0==D.env("BLUEBIRD_LONG_STACK_TRACES")||!Q&&!D.env("BLUEBIRD_LONG_STACK_TRACES")),J=0!=D.env("BLUEBIRD_W_FORGOTTEN_RETURN")&&(Z||!!D.env("BLUEBIRD_W_FORGOTTEN_RETURN"));t.prototype.suppressUnhandledRejections=function(){var t=this._target();t._bitField=t._bitField&-1048577|524288},t.prototype._ensurePossibleRejectionHandled=function(){if(0===(524288&this._bitField)){this._setRejectionIsUnhandled();var t=this;setTimeout(function(){t._notifyUnhandledRejection()},1)}},t.prototype._notifyUnhandledRejectionIsHandled=function(){E("rejectionHandled",O,void 0,this)},t.prototype._setReturnedNonUndefined=function(){this._bitField=268435456|this._bitField},t.prototype._returnedNonUndefined=function(){return 0!==(268435456&this._bitField)},t.prototype._notifyUnhandledRejection=function(){if(this._isRejectionUnhandled()){var t=this._settledValue();this._setUnhandledRejectionIsNotified(),E("unhandledRejection",z,t,this)}},t.prototype._setUnhandledRejectionIsNotified=function(){this._bitField=262144|this._bitField},t.prototype._unsetUnhandledRejectionIsNotified=function(){this._bitField=this._bitField&-262145},t.prototype._isUnhandledRejectionNotified=function(){return(262144&this._bitField)>0},t.prototype._setRejectionIsUnhandled=function(){this._bitField=1048576|this._bitField},t.prototype._unsetRejectionIsUnhandled=function(){this._bitField=this._bitField&-1048577,this._isUnhandledRejectionNotified()&&(this._unsetUnhandledRejectionIsNotified(),this._notifyUnhandledRejectionIsHandled())},t.prototype._isRejectionUnhandled=function(){return(1048576&this._bitField)>0},t.prototype._warn=function(t,e,n){return m(t,e,n||this)},t.onPossiblyUnhandledRejection=function(t){var e=I();z="function"==typeof t?null===e?t:D.domainBind(e,t):void 0},t.onUnhandledRejectionHandled=function(t){var e=I();O="function"==typeof t?null===e?t:D.domainBind(e,t):void 0};var K=function(){};t.longStackTraces=function(){if(B.haveItemsQueued()&&!ht.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");if(!ht.longStackTraces&&N()){var e=t.prototype._captureStackTrace,n=t.prototype._attachExtraTrace,r=t.prototype._dereferenceTrace;ht.longStackTraces=!0,K=function(){if(B.haveItemsQueued()&&!ht.longStackTraces)throw new Error("cannot enable long stack traces after promises have been created\n\n    See http://goo.gl/MqrFmX\n");t.prototype._captureStackTrace=e,t.prototype._attachExtraTrace=n,t.prototype._dereferenceTrace=r,i.deactivateLongStackTraces(),B.enableTrampoline(),ht.longStackTraces=!1},t.prototype._captureStackTrace=d,t.prototype._attachExtraTrace=g,t.prototype._dereferenceTrace=v,i.activateLongStackTraces(),B.disableTrampolineIfNecessary()}},t.hasLongStackTraces=function(){return ht.longStackTraces&&N()};var tt=function(){try{if("function"==typeof CustomEvent){var t=new CustomEvent("CustomEvent");return D.global.dispatchEvent(t),function(t,e){var n={detail:e,cancelable:!0};H.defineProperty(n,"promise",{value:e.promise}),H.defineProperty(n,"reason",{value:e.reason});var i=new CustomEvent(t.toLowerCase(),n);return!D.global.dispatchEvent(i)}}if("function"==typeof Event){var t=new Event("CustomEvent");return D.global.dispatchEvent(t),function(t,e){var n=new Event(t.toLowerCase(),{cancelable:!0});return n.detail=e,H.defineProperty(n,"promise",{value:e.promise}),H.defineProperty(n,"reason",{value:e.reason}),!D.global.dispatchEvent(n)}}var t=document.createEvent("CustomEvent");return t.initCustomEvent("testingtheevent",!1,!0,{}),D.global.dispatchEvent(t),function(t,e){var n=document.createEvent("CustomEvent");return n.initCustomEvent(t.toLowerCase(),!1,!0,e),!D.global.dispatchEvent(n)}}catch(e){}return function(){return!1}}(),et=function(){return D.isNode?function(){return e.emit.apply(e,arguments)}:D.global?function(t){var e="on"+t.toLowerCase(),n=D.global[e];return!!n&&(n.apply(D.global,[].slice.call(arguments,1)),!0)}:function(){return!1}}(),nt={promiseCreated:r,promiseFulfilled:r,promiseRejected:r,promiseResolved:r,promiseCancelled:r,promiseChained:function(t,e,n){return{promise:e,child:n}},warning:function(t,e){return{warning:e}},unhandledRejection:function(t,e,n){return{reason:e,promise:n}},rejectionHandled:r},it=function(t){var e=!1;try{e=et.apply(null,arguments)}catch(n){B.throwLater(n),e=!0}var i=!1;try{i=tt(t,nt[t].apply(null,arguments))}catch(n){B.throwLater(n),i=!0}return i||e};t.config=function(e){if(e=Object(e),"longStackTraces"in e&&(e.longStackTraces?t.longStackTraces():!e.longStackTraces&&t.hasLongStackTraces()&&K()),"warnings"in e){var n=e.warnings;ht.warnings=!!n,J=ht.warnings,D.isObject(n)&&"wForgottenReturn"in n&&(J=!!n.wForgottenReturn)}if("cancellation"in e&&e.cancellation&&!ht.cancellation){if(B.haveItemsQueued())throw new Error("cannot enable cancellation after promises are in use");t.prototype._clearCancellationData=c,t.prototype._propagateFrom=u,t.prototype._onCancel=h,t.prototype._setOnCancel=l,t.prototype._attachCancellationCallback=a,t.prototype._execute=s,rt=u,ht.cancellation=!0}return"monitoring"in e&&(e.monitoring&&!ht.monitoring?(ht.monitoring=!0,t.prototype._fireEvent=it):!e.monitoring&&ht.monitoring&&(ht.monitoring=!1,t.prototype._fireEvent=o)),t},t.prototype._fireEvent=o,t.prototype._execute=function(t,e,n){try{t(e,n)}catch(i){return i}},t.prototype._onCancel=function(){},t.prototype._setOnCancel=function(t){},t.prototype._attachCancellationCallback=function(t){},t.prototype._captureStackTrace=function(){},t.prototype._attachExtraTrace=function(){},t.prototype._dereferenceTrace=function(){},t.prototype._clearCancellationData=function(){},t.prototype._propagateFrom=function(t,e){};var rt=p,ot=function(){return!1},st=/[\/<\(]([^:\/]+):(\d+):(?:\d+)\)?\s*$/;D.inherits(A,Error),i.CapturedTrace=A,A.prototype.uncycle=function(){var t=this._length;if(!(t<2)){for(var e=[],n={},i=0,r=this;void 0!==r;++i)e.push(r),r=r._parent;t=this._length=i;for(var i=t-1;i>=0;--i){var o=e[i].stack;void 0===n[o]&&(n[o]=i)}for(var i=0;i<t;++i){var s=e[i].stack,a=n[s];if(void 0!==a&&a!==i){a>0&&(e[a-1]._parent=void 0,e[a-1]._length=1),e[i]._parent=void 0,e[i]._length=1;var h=i>0?e[i-1]:this;a<t-1?(h._parent=e[a+1],h._parent.uncycle(),h._length=h._parent._length+1):(h._parent=void 0,h._length=1);for(var l=h._length+1,c=i-2;c>=0;--c)e[c]._length=l,l++;return}}}},A.prototype.attachExtraTrace=function(t){if(!t.__stackCleaned__){this.uncycle();for(var e=S(t),n=e.message,i=[e.stack],r=this;void 0!==r;)i.push(P(r.stack.split("\n"))),r=r._parent;w(i),b(i),D.notEnumerableProp(t,"stack",x(n,i)),D.notEnumerableProp(t,"__stackCleaned__",!0)}};var at=function(){var t=/^\s*at\s*/,e=function(t,e){return"string"==typeof t?t:void 0!==e.name&&void 0!==e.message?e.toString():R(e)};if("number"==typeof Error.stackTraceLimit&&"function"==typeof Error.captureStackTrace){Error.stackTraceLimit+=6,W=t,X=e;var n=Error.captureStackTrace;return ot=function(t){return G.test(t)},function(t,e){Error.stackTraceLimit+=6,n(t,e),Error.stackTraceLimit-=6}}var i=new Error;if("string"==typeof i.stack&&i.stack.split("\n")[0].indexOf("stackDetection@")>=0)return W=/@/,X=e,q=!0,function(t){t.stack=(new Error).stack};var r;try{throw new Error}catch(o){r="stack"in o}return"stack"in i||!r||"number"!=typeof Error.stackTraceLimit?(X=function(t,e){return"string"==typeof t?t:"object"!=typeof e&&"function"!=typeof e||void 0===e.name||void 0===e.message?R(e):e.toString()},null):(W=t,X=e,function(t){Error.stackTraceLimit+=6;try{throw new Error}catch(e){t.stack=e.stack}Error.stackTraceLimit-=6})}([]);"undefined"!=typeof console&&"undefined"!=typeof console.warn&&(F=function(t){console.warn(t)},D.isNode&&e.stderr.isTTY?F=function(t,e){var n=e?"[33m":"[31m";console.warn(n+t+"[0m\n")}:D.isNode||"string"!=typeof(new Error).stack||(F=function(t,e){console.warn("%c"+t,e?"color: darkorange":"color: red")}));var ht={warnings:Z,longStackTraces:!1,cancellation:!1,monitoring:!1};return $&&t.longStackTraces(),{longStackTraces:function(){return ht.longStackTraces},warnings:function(){return ht.warnings},cancellation:function(){return ht.cancellation},monitoring:function(){return ht.monitoring},propagateFromFunction:function(){return rt},boundValueFunction:function(){return f},checkForgottenReturns:y,setBounds:L,warn:m,deprecated:_,CapturedTrace:A,fireDomEvent:tt,fireGlobalEvent:et}}}).call(e,n(121))},function(t,e,n){"use strict";t.exports=function(t,e,i){function r(t,e,n){this.promise=t,this.type=e,this.handler=n,this.called=!1,this.cancelPromise=null}function o(t){this.finallyHandler=t}function s(t,e){return null!=t.cancelPromise&&(arguments.length>1?t.cancelPromise._reject(e):t.cancelPromise._cancel(),t.cancelPromise=null,!0)}function a(){return l.call(this,this.promise._target()._settledValue())}function h(t){if(!s(this,t))return p.e=t,p}function l(n){var r=this.promise,l=this.handler;if(!this.called){this.called=!0;var c=this.isFinallyHandler()?l.call(r._boundValue()):l.call(r._boundValue(),n);if(c===i)return c;if(void 0!==c){r._setReturnedNonUndefined();var f=e(c,r);if(f instanceof t){if(null!=this.cancelPromise){if(f._isCancelled()){var d=new u("late cancellation observer");return r._attachExtraTrace(d),p.e=d,p}f.isPending()&&f._attachCancellationCallback(new o(this))}return f._then(a,h,void 0,this,void 0)}}}return r.isRejected()?(s(this),p.e=n,p):(s(this),n)}var c=n(122),u=t.CancellationError,p=c.errorObj,f=n(135)(i);return r.prototype.isFinallyHandler=function(){return 0===this.type},o.prototype._resultCancelled=function(){s(this.finallyHandler)},t.prototype._passThrough=function(t,e,n,i){return"function"!=typeof t?this.then():this._then(n,i,void 0,new r(this,e,t),void 0)},t.prototype.lastly=t.prototype["finally"]=function(t){return this._passThrough(t,0,l,l)},t.prototype.tap=function(t){return this._passThrough(t,1,l)},t.prototype.tapCatch=function(e){var n=arguments.length;if(1===n)return this._passThrough(e,1,void 0,l);var i,r=new Array(n-1),o=0;for(i=0;i<n-1;++i){var s=arguments[i];if(!c.isObject(s))return t.reject(new TypeError("tapCatch statement predicate: expecting an object but got "+c.classString(s)));r[o++]=s}r.length=o;var a=arguments[i];return this._passThrough(f(r,a,this),1,void 0,l)},r}},function(t,e,n){"use strict";t.exports=function(t){function e(e,n,a){return function(h){var l=a._boundValue();t:for(var c=0;c<e.length;++c){var u=e[c];if(u===Error||null!=u&&u.prototype instanceof Error){if(h instanceof u)return o(n).call(l,h)}else if("function"==typeof u){var p=o(u).call(l,h);if(p===s)return p;if(p)return o(n).call(l,h)}else if(i.isObject(h)){for(var f=r(u),d=0;d<f.length;++d){var g=f[d];if(u[g]!=h[g])continue t}return o(n).call(l,h)}}return t}}var i=n(122),r=n(123).keys,o=i.tryCatch,s=i.errorObj;return e}},function(t,e,n){"use strict";function i(t){return t instanceof Error&&c.getPrototypeOf(t)===Error.prototype}function r(t){var e;if(i(t)){e=new l(t),e.name=t.name,e.message=t.message,
e.stack=t.stack;for(var n=c.keys(t),r=0;r<n.length;++r){var o=n[r];u.test(o)||(e[o]=t[o])}return e}return s.markAsOriginatingFromRejection(t),t}function o(t,e){return function(n,i){if(null!==t){if(n){var o=r(a(n));t._attachExtraTrace(o),t._reject(o)}else if(e){for(var s=arguments.length,h=new Array(Math.max(s-1,0)),l=1;l<s;++l)h[l-1]=arguments[l];t._fulfill(h)}else t._fulfill(i);t=null}}}var s=n(122),a=s.maybeWrapAsError,h=n(129),l=h.OperationalError,c=n(123),u=/^(?:name|message|stack|cause)$/;t.exports=o},function(t,e,n){"use strict";t.exports=function(t,e,i,r,o){var s=n(122),a=s.tryCatch;t.method=function(n){if("function"!=typeof n)throw new t.TypeError("expecting a function but got "+s.classString(n));return function(){var i=new t(e);i._captureStackTrace(),i._pushContext();var r=a(n).apply(this,arguments),s=i._popContext();return o.checkForgottenReturns(r,s,"Promise.method",i),i._resolveFromSyncValue(r),i}},t.attempt=t["try"]=function(n){if("function"!=typeof n)return r("expecting a function but got "+s.classString(n));var i=new t(e);i._captureStackTrace(),i._pushContext();var h;if(arguments.length>1){o.deprecated("calling Promise.try with more than 1 argument");var l=arguments[1],c=arguments[2];h=s.isArray(l)?a(n).apply(c,l):a(n).call(c,l)}else h=a(n)();var u=i._popContext();return o.checkForgottenReturns(h,u,"Promise.try",i),i._resolveFromSyncValue(h),i},t.prototype._resolveFromSyncValue=function(t){t===s.errorObj?this._rejectCallback(t.e,!1):this._resolveCallback(t,!0)}}},function(t,e){"use strict";t.exports=function(t,e,n,i){var r=!1,o=function(t,e){this._reject(e)},s=function(t,e){e.promiseRejectionQueued=!0,e.bindingPromise._then(o,o,null,this,t)},a=function(t,e){0===(50397184&this._bitField)&&this._resolveCallback(e.target)},h=function(t,e){e.promiseRejectionQueued||this._reject(t)};t.prototype.bind=function(o){r||(r=!0,t.prototype._propagateFrom=i.propagateFromFunction(),t.prototype._boundValue=i.boundValueFunction());var l=n(o),c=new t(e);c._propagateFrom(this,1);var u=this._target();if(c._setBoundTo(l),l instanceof t){var p={promiseRejectionQueued:!1,promise:c,target:u,bindingPromise:l};u._then(e,s,void 0,c,p),l._then(a,h,void 0,c,p),c._setOnCancel(l)}else c._resolveCallback(u);return c},t.prototype._setBoundTo=function(t){void 0!==t?(this._bitField=2097152|this._bitField,this._boundTo=t):this._bitField=this._bitField&-2097153},t.prototype._isBound=function(){return 2097152===(2097152&this._bitField)},t.bind=function(e,n){return t.resolve(n).bind(e)}}},function(t,e,n){"use strict";t.exports=function(t,e,i,r){var o=n(122),s=o.tryCatch,a=o.errorObj,h=t._async;t.prototype["break"]=t.prototype.cancel=function(){if(!r.cancellation())return this._warn("cancellation is disabled");for(var t=this,e=t;t._isCancellable();){if(!t._cancelBy(e)){e._isFollowing()?e._followee().cancel():e._cancelBranched();break}var n=t._cancellationParent;if(null==n||!n._isCancellable()){t._isFollowing()?t._followee().cancel():t._cancelBranched();break}t._isFollowing()&&t._followee().cancel(),t._setWillBeCancelled(),e=t,t=n}},t.prototype._branchHasCancelled=function(){this._branchesRemainingToCancel--},t.prototype._enoughBranchesHaveCancelled=function(){return void 0===this._branchesRemainingToCancel||this._branchesRemainingToCancel<=0},t.prototype._cancelBy=function(t){return t===this?(this._branchesRemainingToCancel=0,this._invokeOnCancel(),!0):(this._branchHasCancelled(),!!this._enoughBranchesHaveCancelled()&&(this._invokeOnCancel(),!0))},t.prototype._cancelBranched=function(){this._enoughBranchesHaveCancelled()&&this._cancel()},t.prototype._cancel=function(){this._isCancellable()&&(this._setCancelled(),h.invoke(this._cancelPromises,this,void 0))},t.prototype._cancelPromises=function(){this._length()>0&&this._settlePromises()},t.prototype._unsetOnCancel=function(){this._onCancelField=void 0},t.prototype._isCancellable=function(){return this.isPending()&&!this._isCancelled()},t.prototype.isCancellable=function(){return this.isPending()&&!this.isCancelled()},t.prototype._doInvokeOnCancel=function(t,e){if(o.isArray(t))for(var n=0;n<t.length;++n)this._doInvokeOnCancel(t[n],e);else if(void 0!==t)if("function"==typeof t){if(!e){var i=s(t).call(this._boundValue());i===a&&(this._attachExtraTrace(i.e),h.throwLater(i.e))}}else t._resultCancelled(this)},t.prototype._invokeOnCancel=function(){var t=this._onCancel();this._unsetOnCancel(),h.invoke(this._doInvokeOnCancel,this,t)},t.prototype._invokeInternalOnCancel=function(){this._isCancellable()&&(this._doInvokeOnCancel(this._onCancel(),!0),this._unsetOnCancel())},t.prototype._resultCancelled=function(){this.cancel()}}},function(t,e){"use strict";t.exports=function(t){function e(){return this.value}function n(){throw this.reason}t.prototype["return"]=t.prototype.thenReturn=function(n){return n instanceof t&&n.suppressUnhandledRejections(),this._then(e,void 0,void 0,{value:n},void 0)},t.prototype["throw"]=t.prototype.thenThrow=function(t){return this._then(n,void 0,void 0,{reason:t},void 0)},t.prototype.catchThrow=function(t){if(arguments.length<=1)return this._then(void 0,n,void 0,{reason:t},void 0);var e=arguments[1],i=function(){throw e};return this.caught(t,i)},t.prototype.catchReturn=function(n){if(arguments.length<=1)return n instanceof t&&n.suppressUnhandledRejections(),this._then(void 0,e,void 0,{value:n},void 0);var i=arguments[1];i instanceof t&&i.suppressUnhandledRejections();var r=function(){return i};return this.caught(n,r)}}},function(t,e){"use strict";t.exports=function(t){function e(t){void 0!==t?(t=t._target(),this._bitField=t._bitField,this._settledValueField=t._isFateSealed()?t._settledValue():void 0):(this._bitField=0,this._settledValueField=void 0)}e.prototype._settledValue=function(){return this._settledValueField};var n=e.prototype.value=function(){if(!this.isFulfilled())throw new TypeError("cannot get fulfillment value of a non-fulfilled promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},i=e.prototype.error=e.prototype.reason=function(){if(!this.isRejected())throw new TypeError("cannot get rejection reason of a non-rejected promise\n\n    See http://goo.gl/MqrFmX\n");return this._settledValue()},r=e.prototype.isFulfilled=function(){return 0!==(33554432&this._bitField)},o=e.prototype.isRejected=function(){return 0!==(16777216&this._bitField)},s=e.prototype.isPending=function(){return 0===(50397184&this._bitField)},a=e.prototype.isResolved=function(){return 0!==(50331648&this._bitField)};e.prototype.isCancelled=function(){return 0!==(8454144&this._bitField)},t.prototype.__isCancelled=function(){return 65536===(65536&this._bitField)},t.prototype._isCancelled=function(){return this._target().__isCancelled()},t.prototype.isCancelled=function(){return 0!==(8454144&this._target()._bitField)},t.prototype.isPending=function(){return s.call(this._target())},t.prototype.isRejected=function(){return o.call(this._target())},t.prototype.isFulfilled=function(){return r.call(this._target())},t.prototype.isResolved=function(){return a.call(this._target())},t.prototype.value=function(){return n.call(this._target())},t.prototype.reason=function(){var t=this._target();return t._unsetRejectionIsUnhandled(),i.call(t)},t.prototype._value=function(){return this._settledValue()},t.prototype._reason=function(){return this._unsetRejectionIsUnhandled(),this._settledValue()},t.PromiseInspection=e}},function(t,e,n){"use strict";t.exports=function(t,e,i,r,o,s){var a,h=n(122),l=h.canEvaluate,c=h.tryCatch,u=h.errorObj;if(l){for(var p=function(t){return new Function("value","holder","                             \n\t            'use strict';                                                    \n\t            holder.pIndex = value;                                           \n\t            holder.checkFulfillment(this);                                   \n\t            ".replace(/Index/g,t))},f=function(t){return new Function("promise","holder","                           \n\t            'use strict';                                                    \n\t            holder.pIndex = promise;                                         \n\t            ".replace(/Index/g,t))},d=function(e){for(var n=new Array(e),i=0;i<n.length;++i)n[i]="this.p"+(i+1);var r=n.join(" = ")+" = null;",s="var promise;\n"+n.map(function(t){return"                                                         \n\t                promise = "+t+";                                      \n\t                if (promise instanceof Promise) {                            \n\t                    promise.cancel();                                        \n\t                }                                                            \n\t            "}).join("\n"),a=n.join(", "),h="Holder$"+e,l="return function(tryCatch, errorObj, Promise, async) {    \n\t            'use strict';                                                    \n\t            function [TheName](fn) {                                         \n\t                [TheProperties]                                              \n\t                this.fn = fn;                                                \n\t                this.asyncNeeded = true;                                     \n\t                this.now = 0;                                                \n\t            }                                                                \n\t                                                                             \n\t            [TheName].prototype._callFunction = function(promise) {          \n\t                promise._pushContext();                                      \n\t                var ret = tryCatch(this.fn)([ThePassedArguments]);           \n\t                promise._popContext();                                       \n\t                if (ret === errorObj) {                                      \n\t                    promise._rejectCallback(ret.e, false);                   \n\t                } else {                                                     \n\t                    promise._resolveCallback(ret);                           \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype.checkFulfillment = function(promise) {       \n\t                var now = ++this.now;                                        \n\t                if (now === [TheTotal]) {                                    \n\t                    if (this.asyncNeeded) {                                  \n\t                        async.invoke(this._callFunction, this, promise);     \n\t                    } else {                                                 \n\t                        this._callFunction(promise);                         \n\t                    }                                                        \n\t                                                                             \n\t                }                                                            \n\t            };                                                               \n\t                                                                             \n\t            [TheName].prototype._resultCancelled = function() {              \n\t                [CancellationCode]                                           \n\t            };                                                               \n\t                                                                             \n\t            return [TheName];                                                \n\t        }(tryCatch, errorObj, Promise, async);                               \n\t        ";return l=l.replace(/\[TheName\]/g,h).replace(/\[TheTotal\]/g,e).replace(/\[ThePassedArguments\]/g,a).replace(/\[TheProperties\]/g,r).replace(/\[CancellationCode\]/g,s),new Function("tryCatch","errorObj","Promise","async",l)(c,u,t,o)},g=[],v=[],y=[],_=0;_<8;++_)g.push(d(_+1)),v.push(p(_+1)),y.push(f(_+1));a=function(t){this._reject(t)}}t.join=function(){var n,o=arguments.length-1;if(o>0&&"function"==typeof arguments[o]&&(n=arguments[o],o<=8&&l)){var c=new t(r);c._captureStackTrace();for(var u=g[o-1],p=new u(n),f=v,d=0;d<o;++d){var _=i(arguments[d],c);if(_ instanceof t){_=_._target();var m=_._bitField;0===(50397184&m)?(_._then(f[d],a,void 0,c,p),y[d](_,p),p.asyncNeeded=!1):0!==(33554432&m)?f[d].call(c,_._value(),p):0!==(16777216&m)?c._reject(_._reason()):c._cancel()}else f[d].call(c,_,p)}if(!c._isFateSealed()){if(p.asyncNeeded){var x=s();null!==x&&(p.fn=h.domainBind(x,p.fn))}c._setAsyncGuaranteed(),c._setOnCancel(p)}return c}for(var b=arguments.length,w=new Array(b),P=0;P<b;++P)w[P]=arguments[P];n&&w.pop();var c=new e(w).promise();return void 0!==n?c.spread(n):c}}},function(t,e,n){"use strict";var i=Object.create;if(i){var r=i(null),o=i(null);r[" size"]=o[" size"]=0}t.exports=function(t){function e(e,n){var i;if(null!=e&&(i=e[n]),"function"!=typeof i){var r="Object "+c.classString(e)+" has no method '"+c.toString(n)+"'";throw new t.TypeError(r)}return i}function i(t){var n=this.pop(),i=e(t,n);return i.apply(t,this)}function s(t){return t[this]}function a(t){var e=+this;return e<0&&(e=Math.max(0,e+t.length)),t[e]}var h,l,c=n(122),u=c.canEvaluate,p=c.isIdentifier,f=function(t){return new Function("ensureMethod","                                    \n\t        return function(obj) {                                               \n\t            'use strict'                                                     \n\t            var len = this.length;                                           \n\t            ensureMethod(obj, 'methodName');                                 \n\t            switch(len) {                                                    \n\t                case 1: return obj.methodName(this[0]);                      \n\t                case 2: return obj.methodName(this[0], this[1]);             \n\t                case 3: return obj.methodName(this[0], this[1], this[2]);    \n\t                case 0: return obj.methodName();                             \n\t                default:                                                     \n\t                    return obj.methodName.apply(obj, this);                  \n\t            }                                                                \n\t        };                                                                   \n\t        ".replace(/methodName/g,t))(e)},d=function(t){return new Function("obj","                                             \n\t        'use strict';                                                        \n\t        return obj.propertyName;                                             \n\t        ".replace("propertyName",t))},g=function(t,e,n){var i=n[t];if("function"!=typeof i){if(!p(t))return null;if(i=e(t),n[t]=i,n[" size"]++,n[" size"]>512){for(var r=Object.keys(n),o=0;o<256;++o)delete n[r[o]];n[" size"]=r.length-256}}return i};h=function(t){return g(t,f,r)},l=function(t){return g(t,d,o)},t.prototype.call=function(t){for(var e=arguments.length,n=new Array(Math.max(e-1,0)),r=1;r<e;++r)n[r-1]=arguments[r];if(u){var o=h(t);if(null!==o)return this._then(o,void 0,void 0,n,void 0)}return n.push(t),this._then(i,void 0,void 0,n,void 0)},t.prototype.get=function(t){var e,n="number"==typeof t;if(n)e=a;else if(u){var i=l(t);e=null!==i?i:s}else e=s;return this._then(e,void 0,void 0,t,void 0)}}},function(t,e,n){"use strict";t.exports=function(t,e,i,r,o,s){function a(e,n,i){for(var o=0;o<n.length;++o){i._pushContext();var s=f(n[o])(e);if(i._popContext(),s===p){i._pushContext();var a=t.reject(p.e);return i._popContext(),a}var h=r(s,i);if(h instanceof t)return h}return null}function h(e,n,r,o){if(s.cancellation()){var a=new t(i),h=this._finallyPromise=new t(i);this._promise=a.lastly(function(){return h}),a._captureStackTrace(),a._setOnCancel(this)}else{var l=this._promise=new t(i);l._captureStackTrace()}this._stack=o,this._generatorFunction=e,this._receiver=n,this._generator=void 0,this._yieldHandlers="function"==typeof r?[r].concat(d):d,this._yieldedPromise=null,this._cancellationPhase=!1}var l=n(129),c=l.TypeError,u=n(122),p=u.errorObj,f=u.tryCatch,d=[];u.inherits(h,o),h.prototype._isResolved=function(){return null===this._promise},h.prototype._cleanup=function(){this._promise=this._generator=null,s.cancellation()&&null!==this._finallyPromise&&(this._finallyPromise._fulfill(),this._finallyPromise=null)},h.prototype._promiseCancelled=function(){if(!this._isResolved()){var e,n="undefined"!=typeof this._generator["return"];if(n)this._promise._pushContext(),e=f(this._generator["return"]).call(this._generator,void 0),this._promise._popContext();else{var i=new t.CancellationError("generator .return() sentinel");t.coroutine.returnSentinel=i,this._promise._attachExtraTrace(i),this._promise._pushContext(),e=f(this._generator["throw"]).call(this._generator,i),this._promise._popContext()}this._cancellationPhase=!0,this._yieldedPromise=null,this._continue(e)}},h.prototype._promiseFulfilled=function(t){this._yieldedPromise=null,this._promise._pushContext();var e=f(this._generator.next).call(this._generator,t);this._promise._popContext(),this._continue(e)},h.prototype._promiseRejected=function(t){this._yieldedPromise=null,this._promise._attachExtraTrace(t),this._promise._pushContext();var e=f(this._generator["throw"]).call(this._generator,t);this._promise._popContext(),this._continue(e)},h.prototype._resultCancelled=function(){if(this._yieldedPromise instanceof t){var e=this._yieldedPromise;this._yieldedPromise=null,e.cancel()}},h.prototype.promise=function(){return this._promise},h.prototype._run=function(){this._generator=this._generatorFunction.call(this._receiver),this._receiver=this._generatorFunction=void 0,this._promiseFulfilled(void 0)},h.prototype._continue=function(e){var n=this._promise;if(e===p)return this._cleanup(),this._cancellationPhase?n.cancel():n._rejectCallback(e.e,!1);var i=e.value;if(e.done===!0)return this._cleanup(),this._cancellationPhase?n.cancel():n._resolveCallback(i);var o=r(i,this._promise);if(!(o instanceof t)&&(o=a(o,this._yieldHandlers,this._promise),null===o))return void this._promiseRejected(new c("A value %s was yielded that could not be treated as a promise\n\n    See http://goo.gl/MqrFmX\n\n".replace("%s",String(i))+"From coroutine:\n"+this._stack.split("\n").slice(1,-7).join("\n")));o=o._target();var s=o._bitField;0===(50397184&s)?(this._yieldedPromise=o,o._proxy(this,null)):0!==(33554432&s)?t._async.invoke(this._promiseFulfilled,this,o._value()):0!==(16777216&s)?t._async.invoke(this._promiseRejected,this,o._reason()):this._promiseCancelled()},t.coroutine=function(t,e){if("function"!=typeof t)throw new c("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var n=Object(e).yieldHandler,i=h,r=(new Error).stack;return function(){var e=t.apply(this,arguments),o=new i((void 0),(void 0),n,r),s=o.promise();return o._generator=e,o._promiseFulfilled(void 0),s}},t.coroutine.addYieldHandler=function(t){if("function"!=typeof t)throw new c("expecting a function but got "+u.classString(t));d.push(t)},t.spawn=function(n){if(s.deprecated("Promise.spawn()","Promise.coroutine()"),"function"!=typeof n)return e("generatorFunction must be a function\n\n    See http://goo.gl/MqrFmX\n");var i=new h(n,this),r=i.promise();return i._run(t.spawn),r}}},function(t,e,n){"use strict";t.exports=function(t,e,i,r,o,s){function a(t,e,n,i){this.constructor$(t),this._promise._captureStackTrace();var r=l();this._callback=null===r?e:c.domainBind(r,e),this._preservedValues=i===o?new Array(this.length()):null,this._limit=n,this._inFlight=0,this._queue=[],f.invoke(this._asyncInit,this,void 0)}function h(e,n,r,o){if("function"!=typeof n)return i("expecting a function but got "+c.classString(n));var s=0;if(void 0!==r){if("object"!=typeof r||null===r)return t.reject(new TypeError("options argument must be an object but it is "+c.classString(r)));if("number"!=typeof r.concurrency)return t.reject(new TypeError("'concurrency' must be a number but it is "+c.classString(r.concurrency)));s=r.concurrency}return s="number"==typeof s&&isFinite(s)&&s>=1?s:0,new a(e,n,s,o).promise()}var l=t._getDomain,c=n(122),u=c.tryCatch,p=c.errorObj,f=t._async;c.inherits(a,e),a.prototype._asyncInit=function(){this._init$(void 0,-2)},a.prototype._init=function(){},a.prototype._promiseFulfilled=function(e,n){var i=this._values,o=this.length(),a=this._preservedValues,h=this._limit;if(n<0){if(n=n*-1-1,i[n]=e,h>=1&&(this._inFlight--,this._drainQueue(),this._isResolved()))return!0}else{if(h>=1&&this._inFlight>=h)return i[n]=e,this._queue.push(n),!1;null!==a&&(a[n]=e);var l=this._promise,c=this._callback,f=l._boundValue();l._pushContext();var d=u(c).call(f,e,n,o),g=l._popContext();if(s.checkForgottenReturns(d,g,null!==a?"Promise.filter":"Promise.map",l),d===p)return this._reject(d.e),!0;var v=r(d,this._promise);if(v instanceof t){v=v._target();var y=v._bitField;if(0===(50397184&y))return h>=1&&this._inFlight++,i[n]=v,v._proxy(this,(n+1)*-1),!1;if(0===(33554432&y))return 0!==(16777216&y)?(this._reject(v._reason()),!0):(this._cancel(),!0);d=v._value()}i[n]=d}var _=++this._totalResolved;return _>=o&&(null!==a?this._filter(i,a):this._resolve(i),!0)},a.prototype._drainQueue=function(){for(var t=this._queue,e=this._limit,n=this._values;t.length>0&&this._inFlight<e;){if(this._isResolved())return;var i=t.pop();this._promiseFulfilled(n[i],i)}},a.prototype._filter=function(t,e){for(var n=e.length,i=new Array(n),r=0,o=0;o<n;++o)t[o]&&(i[r++]=e[o]);i.length=r,this._resolve(i)},a.prototype.preservedValues=function(){return this._preservedValues},t.prototype.map=function(t,e){return h(this,t,e,null)},t.map=function(t,e,n,i){return h(t,e,n,i)}}},function(t,e,n){"use strict";t.exports=function(t){function e(t,e){var n=this;if(!o.isArray(t))return i.call(n,t,e);var r=a(e).apply(n._boundValue(),[null].concat(t));r===h&&s.throwLater(r.e)}function i(t,e){var n=this,i=n._boundValue(),r=void 0===t?a(e).call(i,null):a(e).call(i,null,t);r===h&&s.throwLater(r.e)}function r(t,e){var n=this;if(!t){var i=new Error(t+"");i.cause=t,t=i}var r=a(e).call(n._boundValue(),t);r===h&&s.throwLater(r.e)}var o=n(122),s=t._async,a=o.tryCatch,h=o.errorObj;t.prototype.asCallback=t.prototype.nodeify=function(t,n){if("function"==typeof t){var o=i;void 0!==n&&Object(n).spread&&(o=e),this._then(o,r,void 0,this,t)}return this}}},function(t,e,n){"use strict";t.exports=function(t,e){function i(t){return!w.test(t)}function r(t){try{return t.__isPromisified__===!0}catch(e){return!1}}function o(t,e,n){var i=f.getDataPropertyOrDefault(t,e+n,x);return!!i&&r(i)}function s(t,e,n){for(var i=0;i<t.length;i+=2){var r=t[i];if(n.test(r))for(var o=r.replace(n,""),s=0;s<t.length;s+=2)if(t[s]===o)throw new _("Cannot promisify an API that has normal methods with '%s'-suffix\n\n    See http://goo.gl/MqrFmX\n".replace("%s",e))}}function a(t,e,n,i){for(var a=f.inheritedDataKeys(t),h=[],l=0;l<a.length;++l){var c=a[l],u=t[c],p=i===P||P(c,u,t);"function"!=typeof u||r(u)||o(t,c,e)||!i(c,u,t,p)||h.push(c,u)}return s(h,e,n),h}function h(n,i,r,o,s,a){function h(){var r=i;i===p&&(r=this);var o=new t(e);o._captureStackTrace();var s="string"==typeof c&&this!==l?this[c]:n,h=d(o,a);try{s.apply(r,g(arguments,h))}catch(u){o._rejectCallback(v(u),!0,!0)}return o._isFateSealed()||o._setAsyncGuaranteed(),o}var l=function(){return this}(),c=n;return"string"==typeof c&&(n=o),f.notEnumerableProp(h,"__isPromisified__",!0),h}function l(t,e,n,i,r){for(var o=new RegExp(C(e)+"$"),s=a(t,e,o,n),h=0,l=s.length;h<l;h+=2){var c=s[h],u=s[h+1],d=c+e;if(i===k)t[d]=k(c,p,c,u,e,r);else{var g=i(u,function(){return k(c,p,c,u,e,r)});f.notEnumerableProp(g,"__isPromisified__",!0),t[d]=g}}return f.toFastProperties(t),t}function c(t,e,n){return k(t,e,void 0,t,null,n)}var u,p={},f=n(122),d=n(136),g=f.withAppended,v=f.maybeWrapAsError,y=f.canEvaluate,_=n(129).TypeError,m="Async",x={__isPromisified__:!0},b=["arity","length","name","arguments","caller","callee","prototype","__isPromisified__"],w=new RegExp("^(?:"+b.join("|")+")$"),P=function(t){return f.isIdentifier(t)&&"_"!==t.charAt(0)&&"constructor"!==t},C=function(t){return t.replace(/([$])/,"\\$")},S=function(t){for(var e=[t],n=Math.max(0,t-1-3),i=t-1;i>=n;--i)e.push(i);for(var i=t+1;i<=3;++i)e.push(i);return e},T=function(t){return f.filledRange(t,"_arg","")},E=function(t){return f.filledRange(Math.max(t,3),"_arg","")},R=function(t){return"number"==typeof t.length?Math.max(Math.min(t.length,1024),0):0};u=function(n,i,r,o,s,a){function h(t){var e,n=T(t).join(", "),r=t>0?", ":"";return e=y?"ret = callback.call(this, {{args}}, nodeback); break;\n":void 0===i?"ret = callback({{args}}, nodeback); break;\n":"ret = callback.call(receiver, {{args}}, nodeback); break;\n",e.replace("{{args}}",n).replace(", ",r)}function l(){for(var t="",e=0;e<u.length;++e)t+="case "+u[e]+":"+h(u[e]);return t+="                                                             \n\t        default:                                                             \n\t            var args = new Array(len + 1);                                   \n\t            var i = 0;                                                       \n\t            for (var i = 0; i < len; ++i) {                                  \n\t               args[i] = arguments[i];                                       \n\t            }                                                                \n\t            args[i] = nodeback;                                              \n\t            [CodeForCall]                                                    \n\t            break;                                                           \n\t        ".replace("[CodeForCall]",y?"ret = callback.apply(this, args);\n":"ret = callback.apply(receiver, args);\n")}var c=Math.max(0,R(o)-1),u=S(c),y="string"==typeof n||i===p,_="string"==typeof n?"this != null ? this['"+n+"'] : fn":"fn",m="'use strict';                                                \n\t        var ret = function (Parameters) {                                    \n\t            'use strict';                                                    \n\t            var len = arguments.length;                                      \n\t            var promise = new Promise(INTERNAL);                             \n\t            promise._captureStackTrace();                                    \n\t            var nodeback = nodebackForPromise(promise, "+a+");   \n\t            var ret;                                                         \n\t            var callback = tryCatch([GetFunctionCode]);                      \n\t            switch(len) {                                                    \n\t                [CodeForSwitchCase]                                          \n\t            }                                                                \n\t            if (ret === errorObj) {                                          \n\t                promise._rejectCallback(maybeWrapAsError(ret.e), true, true);\n\t            }                                                                \n\t            if (!promise._isFateSealed()) promise._setAsyncGuaranteed();     \n\t            return promise;                                                  \n\t        };                                                                   \n\t        notEnumerableProp(ret, '__isPromisified__', true);                   \n\t        return ret;                                                          \n\t    ".replace("[CodeForSwitchCase]",l()).replace("[GetFunctionCode]",_);return m=m.replace("Parameters",E(c)),new Function("Promise","fn","receiver","withAppended","maybeWrapAsError","nodebackForPromise","tryCatch","errorObj","notEnumerableProp","INTERNAL",m)(t,o,i,g,v,d,f.tryCatch,f.errorObj,f.notEnumerableProp,e)};var k=y?u:h;t.promisify=function(t,e){if("function"!=typeof t)throw new _("expecting a function but got "+f.classString(t));if(r(t))return t;e=Object(e);var n=void 0===e.context?p:e.context,o=!!e.multiArgs,s=c(t,n,o);return f.copyDescriptors(t,s,i),s},t.promisifyAll=function(t,e){if("function"!=typeof t&&"object"!=typeof t)throw new _("the target of promisifyAll must be an object or a function\n\n    See http://goo.gl/MqrFmX\n");e=Object(e);var n=!!e.multiArgs,i=e.suffix;"string"!=typeof i&&(i=m);var r=e.filter;"function"!=typeof r&&(r=P);var o=e.promisifier;if("function"!=typeof o&&(o=k),!f.isIdentifier(i))throw new RangeError("suffix must be a valid identifier\n\n    See http://goo.gl/MqrFmX\n");for(var s=f.inheritedDataKeys(t),a=0;a<s.length;++a){var h=t[s[a]];"constructor"!==s[a]&&f.isClass(h)&&(l(h.prototype,i,r,o,n),l(h,i,r,o,n))}return l(t,i,r,o,n)}}},function(t,e,n){"use strict";t.exports=function(t,e,i,r){function o(t){var e,n=!1;if(void 0!==a&&t instanceof a)e=u(t),n=!0;else{var i=c.keys(t),r=i.length;e=new Array(2*r);for(var o=0;o<r;++o){var s=i[o];e[o]=t[s],e[o+r]=s}}this.constructor$(e),this._isMap=n,this._init$(void 0,n?-6:-3)}function s(e){var n,s=i(e);return l(s)?(n=s instanceof t?s._then(t.props,void 0,void 0,void 0,void 0):new o(s).promise(),s instanceof t&&n._propagateFrom(s,2),n):r("cannot await properties of a non-object\n\n    See http://goo.gl/MqrFmX\n")}var a,h=n(122),l=h.isObject,c=n(123);"function"==typeof Map&&(a=Map);var u=function(){function t(t,i){this[e]=t,this[e+n]=i,e++}var e=0,n=0;return function(i){n=i.size,e=0;var r=new Array(2*i.size);return i.forEach(t,r),r}}(),p=function(t){for(var e=new a,n=t.length/2|0,i=0;i<n;++i){var r=t[n+i],o=t[i];e.set(r,o)}return e};h.inherits(o,e),o.prototype._init=function(){},o.prototype._promiseFulfilled=function(t,e){this._values[e]=t;var n=++this._totalResolved;if(n>=this._length){var i;if(this._isMap)i=p(this._values);else{i={};for(var r=this.length(),o=0,s=this.length();o<s;++o)i[this._values[o+r]]=this._values[o]}return this._resolve(i),!0}return!1},o.prototype.shouldCopyValues=function(){return!1},o.prototype.getActualLength=function(t){return t>>1},t.prototype.props=function(){return s(this)},t.props=function(t){return s(t)}}},function(t,e,n){"use strict";t.exports=function(t,e,i,r){function o(n,o){var h=i(n);if(h instanceof t)return a(h);if(n=s.asArray(n),null===n)return r("expecting an array or an iterable object but got "+s.classString(n));var l=new t(e);void 0!==o&&l._propagateFrom(o,3);for(var c=l._fulfill,u=l._reject,p=0,f=n.length;p<f;++p){var d=n[p];(void 0!==d||p in n)&&t.cast(d)._then(c,u,void 0,l,null)}return l}var s=n(122),a=function(t){return t.then(function(e){return o(e,t)})};t.race=function(t){return o(t,void 0)},t.prototype.race=function(){return o(this,void 0)}}},function(t,e,n){"use strict";t.exports=function(t,e,i,r,o,s){function a(e,n,i,r){this.constructor$(e);var s=p();this._fn=null===s?n:f.domainBind(s,n),void 0!==i&&(i=t.resolve(i),i._attachCancellationCallback(this)),this._initialValue=i,this._currentCancellable=null,r===o?this._eachValues=Array(this._length):0===r?this._eachValues=null:this._eachValues=void 0,this._promise._captureStackTrace(),this._init$(void 0,-5)}function h(t,e){this.isFulfilled()?e._resolve(t):e._reject(t)}function l(t,e,n,r){if("function"!=typeof e)return i("expecting a function but got "+f.classString(e));var o=new a(t,e,n,r);return o.promise()}function c(e){this.accum=e,this.array._gotAccum(e);var n=r(this.value,this.array._promise);return n instanceof t?(this.array._currentCancellable=n,n._then(u,void 0,void 0,this,void 0)):u.call(this,n)}function u(e){var n=this.array,i=n._promise,r=d(n._fn);i._pushContext();var o;o=void 0!==n._eachValues?r.call(i._boundValue(),e,this.index,this.length):r.call(i._boundValue(),this.accum,e,this.index,this.length),o instanceof t&&(n._currentCancellable=o);var a=i._popContext();return s.checkForgottenReturns(o,a,void 0!==n._eachValues?"Promise.each":"Promise.reduce",i),o}var p=t._getDomain,f=n(122),d=f.tryCatch;
f.inherits(a,e),a.prototype._gotAccum=function(t){void 0!==this._eachValues&&null!==this._eachValues&&t!==o&&this._eachValues.push(t)},a.prototype._eachComplete=function(t){return null!==this._eachValues&&this._eachValues.push(t),this._eachValues},a.prototype._init=function(){},a.prototype._resolveEmptyArray=function(){this._resolve(void 0!==this._eachValues?this._eachValues:this._initialValue)},a.prototype.shouldCopyValues=function(){return!1},a.prototype._resolve=function(t){this._promise._resolveCallback(t),this._values=null},a.prototype._resultCancelled=function(e){return e===this._initialValue?this._cancel():void(this._isResolved()||(this._resultCancelled$(),this._currentCancellable instanceof t&&this._currentCancellable.cancel(),this._initialValue instanceof t&&this._initialValue.cancel()))},a.prototype._iterate=function(e){this._values=e;var n,i,r=e.length;if(void 0!==this._initialValue?(n=this._initialValue,i=0):(n=t.resolve(e[0]),i=1),this._currentCancellable=n,!n.isRejected())for(;i<r;++i){var o={accum:null,value:e[i],index:i,length:r,array:this};n=n._then(c,void 0,void 0,o,void 0)}void 0!==this._eachValues&&(n=n._then(this._eachComplete,void 0,void 0,this,void 0)),n._then(h,h,void 0,n,this)},t.prototype.reduce=function(t,e){return l(this,t,e,null)},t.reduce=function(t,e,n,i){return l(t,e,n,i)}}},function(t,e,n){"use strict";t.exports=function(t,e,i){function r(t){this.constructor$(t)}var o=t.PromiseInspection,s=n(122);s.inherits(r,e),r.prototype._promiseResolved=function(t,e){this._values[t]=e;var n=++this._totalResolved;return n>=this._length&&(this._resolve(this._values),!0)},r.prototype._promiseFulfilled=function(t,e){var n=new o;return n._bitField=33554432,n._settledValueField=t,this._promiseResolved(e,n)},r.prototype._promiseRejected=function(t,e){var n=new o;return n._bitField=16777216,n._settledValueField=t,this._promiseResolved(e,n)},t.settle=function(t){return i.deprecated(".settle()",".reflect()"),new r(t).promise()},t.prototype.settle=function(){return t.settle(this)}}},function(t,e,n){"use strict";t.exports=function(t,e,i){function r(t){this.constructor$(t),this._howMany=0,this._unwrap=!1,this._initialized=!1}function o(t,e){if((0|e)!==e||e<0)return i("expecting a positive integer\n\n    See http://goo.gl/MqrFmX\n");var n=new r(t),o=n.promise();return n.setHowMany(e),n.init(),o}var s=n(122),a=n(129).RangeError,h=n(129).AggregateError,l=s.isArray,c={};s.inherits(r,e),r.prototype._init=function(){if(this._initialized){if(0===this._howMany)return void this._resolve([]);this._init$(void 0,-5);var t=l(this._values);!this._isResolved()&&t&&this._howMany>this._canPossiblyFulfill()&&this._reject(this._getRangeError(this.length()))}},r.prototype.init=function(){this._initialized=!0,this._init()},r.prototype.setUnwrap=function(){this._unwrap=!0},r.prototype.howMany=function(){return this._howMany},r.prototype.setHowMany=function(t){this._howMany=t},r.prototype._promiseFulfilled=function(t){return this._addFulfilled(t),this._fulfilled()===this.howMany()&&(this._values.length=this.howMany(),1===this.howMany()&&this._unwrap?this._resolve(this._values[0]):this._resolve(this._values),!0)},r.prototype._promiseRejected=function(t){return this._addRejected(t),this._checkOutcome()},r.prototype._promiseCancelled=function(){return this._values instanceof t||null==this._values?this._cancel():(this._addRejected(c),this._checkOutcome())},r.prototype._checkOutcome=function(){if(this.howMany()>this._canPossiblyFulfill()){for(var t=new h,e=this.length();e<this._values.length;++e)this._values[e]!==c&&t.push(this._values[e]);return t.length>0?this._reject(t):this._cancel(),!0}return!1},r.prototype._fulfilled=function(){return this._totalResolved},r.prototype._rejected=function(){return this._values.length-this.length()},r.prototype._addRejected=function(t){this._values.push(t)},r.prototype._addFulfilled=function(t){this._values[this._totalResolved++]=t},r.prototype._canPossiblyFulfill=function(){return this.length()-this._rejected()},r.prototype._getRangeError=function(t){var e="Input array must contain at least "+this._howMany+" items but contains only "+t+" items";return new a(e)},r.prototype._resolveEmptyArray=function(){this._reject(this._getRangeError(0))},t.some=function(t,e){return o(t,e)},t.prototype.some=function(t){return o(this,t)},t._SomePromiseArray=r}},function(t,e,n){"use strict";t.exports=function(t,e,i){function r(t){this.handle=t}function o(t){return clearTimeout(this.handle),t}function s(t){throw clearTimeout(this.handle),t}var a=n(122),h=t.TimeoutError;r.prototype._resultCancelled=function(){clearTimeout(this.handle)};var l=function(t){return c(+this).thenReturn(t)},c=t.delay=function(n,o){var s,a;return void 0!==o?(s=t.resolve(o)._then(l,null,null,n,void 0),i.cancellation()&&o instanceof t&&s._setOnCancel(o)):(s=new t(e),a=setTimeout(function(){s._fulfill()},+n),i.cancellation()&&s._setOnCancel(new r(a)),s._captureStackTrace()),s._setAsyncGuaranteed(),s};t.prototype.delay=function(t){return c(t,this)};var u=function(t,e,n){var i;i="string"!=typeof e?e instanceof Error?e:new h("operation timed out"):new h(e),a.markAsOriginatingFromRejection(i),t._attachExtraTrace(i),t._reject(i),null!=n&&n.cancel()};t.prototype.timeout=function(t,e){t=+t;var n,a,h=new r(setTimeout(function(){n.isPending()&&u(n,e,a)},t));return i.cancellation()?(a=this.then(),n=a._then(o,s,void 0,h,void 0),n._setOnCancel(h)):n=this._then(o,s,void 0,h,void 0),n}}},function(t,e,n){"use strict";t.exports=function(t,e,i,r,o,s){function a(t){setTimeout(function(){throw t},0)}function h(t){var e=i(t);return e!==t&&"function"==typeof t._isDisposable&&"function"==typeof t._getDisposer&&t._isDisposable()&&e._setDisposable(t._getDisposer()),e}function l(e,n){function r(){if(s>=l)return c._fulfill();var o=h(e[s++]);if(o instanceof t&&o._isDisposable()){try{o=i(o._getDisposer().tryDispose(n),e.promise)}catch(u){return a(u)}if(o instanceof t)return o._then(r,a,null,null,null)}r()}var s=0,l=e.length,c=new t(o);return r(),c}function c(t,e,n){this._data=t,this._promise=e,this._context=n}function u(t,e,n){this.constructor$(t,e,n)}function p(t){return c.isDisposer(t)?(this.resources[this.index]._setDisposable(t),t.promise()):t}function f(t){this.length=t,this.promise=null,this[t-1]=null}var d=n(122),g=n(129).TypeError,v=n(122).inherits,y=d.errorObj,_=d.tryCatch,m={};c.prototype.data=function(){return this._data},c.prototype.promise=function(){return this._promise},c.prototype.resource=function(){return this.promise().isFulfilled()?this.promise().value():m},c.prototype.tryDispose=function(t){var e=this.resource(),n=this._context;void 0!==n&&n._pushContext();var i=e!==m?this.doDispose(e,t):null;return void 0!==n&&n._popContext(),this._promise._unsetDisposable(),this._data=null,i},c.isDisposer=function(t){return null!=t&&"function"==typeof t.resource&&"function"==typeof t.tryDispose},v(u,c),u.prototype.doDispose=function(t,e){var n=this.data();return n.call(t,t,e)},f.prototype._resultCancelled=function(){for(var e=this.length,n=0;n<e;++n){var i=this[n];i instanceof t&&i.cancel()}},t.using=function(){var n=arguments.length;if(n<2)return e("you must pass at least 2 arguments to Promise.using");var r=arguments[n-1];if("function"!=typeof r)return e("expecting a function but got "+d.classString(r));var o,a=!0;2===n&&Array.isArray(arguments[0])?(o=arguments[0],n=o.length,a=!1):(o=arguments,n--);for(var h=new f(n),u=0;u<n;++u){var g=o[u];if(c.isDisposer(g)){var v=g;g=g.promise(),g._setDisposable(v)}else{var m=i(g);m instanceof t&&(g=m._then(p,null,null,{resources:h,index:u},void 0))}h[u]=g}for(var x=new Array(h.length),u=0;u<x.length;++u)x[u]=t.resolve(h[u]).reflect();var b=t.all(x).then(function(t){for(var e=0;e<t.length;++e){var n=t[e];if(n.isRejected())return y.e=n.error(),y;if(!n.isFulfilled())return void b.cancel();t[e]=n.value()}w._pushContext(),r=_(r);var i=a?r.apply(void 0,t):r(t),o=w._popContext();return s.checkForgottenReturns(i,o,"Promise.using",w),i}),w=b.lastly(function(){var e=new t.PromiseInspection(b);return l(h,e)});return h.promise=w,w._setOnCancel(h),w},t.prototype._setDisposable=function(t){this._bitField=131072|this._bitField,this._disposer=t},t.prototype._isDisposable=function(){return(131072&this._bitField)>0},t.prototype._getDisposer=function(){return this._disposer},t.prototype._unsetDisposable=function(){this._bitField=this._bitField&-131073,this._disposer=void 0},t.prototype.disposer=function(t){if("function"==typeof t)return new u(t,this,r());throw new g}}},function(t,e){"use strict";t.exports=function(t){function e(t){var e=new n(t),i=e.promise();return e.setHowMany(1),e.setUnwrap(),e.init(),i}var n=t._SomePromiseArray;t.any=function(t){return e(t)},t.prototype.any=function(){return e(this)}}},function(t,e){"use strict";t.exports=function(t,e){function n(){return o(this)}function i(t,n){return r(t,n,e,e)}var r=t.reduce,o=t.all;t.prototype.each=function(t){return r(this,t,e,0)._then(n,void 0,void 0,this,void 0)},t.prototype.mapSeries=function(t){return r(this,t,e,e)},t.each=function(t,i){return r(t,i,e,0)._then(n,void 0,void 0,t,void 0)},t.mapSeries=i}},function(t,e){"use strict";t.exports=function(t,e){var n=t.map;t.prototype.filter=function(t,i){return n(this,t,i,e)},t.filter=function(t,i,r){return n(t,i,r,e)}}},function(t,e){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),n=this,i=function(){},r=function(){return n.apply(this instanceof i&&t?this:t||window,e.concat(Array.prototype.slice.call(arguments)))};return i.prototype=this.prototype,r.prototype=new i,r}),"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var n=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>n.length)&&(e=n.length),e-=t.length;var i=n.indexOf(t,e);return i!==-1&&i===e})},function(t,e,n){n(160);var i=n(65),r=i.registerPainter,o=n(162);r("vml",o)},function(t,e,n){var i=n(49),r=n(14),o=r.applyTransform,s=n(26),a=n(19),h=n(25),l=n(24),c=n(23),u=n(7),p=n(44),f=n(45),d=n(6),g=n(29),v=n(41),y=n(161),_=g.CMD,m=Math.round,x=Math.sqrt,b=Math.abs,w=Math.cos,P=Math.sin,C=Math.max;if(!i.canvasSupported){var S=",",T="progid:DXImageTransform.Microsoft",E=21600,R=E/2,k=1e5,N=1e3,M=function(t){t.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",t.coordsize=E+","+E,t.coordorigin="0,0"},L=function(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;")},A=function(t,e,n){return"rgb("+[t,e,n].join(",")+")"},O=function(t,e){e&&t&&e.parentNode!==t&&t.appendChild(e)},z=function(t,e){e&&t&&e.parentNode===t&&t.removeChild(e)},F=function(t,e,n){return(parseFloat(t)||0)*k+(parseFloat(e)||0)*N+n},I=function(t,e){return"string"==typeof t?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t},B=function(t,e,n){var i=a.parse(e);n=+n,isNaN(n)&&(n=1),i&&(t.color=A(i[0],i[1],i[2]),t.opacity=n*i[3])},j=function(t){var e=a.parse(t);return[A(e[0],e[1],e[2]),e[3]]},D=function(t,e,n){var i=e.fill;if(null!=i)if(i instanceof v){var r,s=0,a=[0,0],h=0,l=1,c=n.getBoundingRect(),u=c.width,p=c.height;if("linear"===i.type){r="gradient";var f=n.transform,d=[i.x*u,i.y*p],g=[i.x2*u,i.y2*p];f&&(o(d,d,f),o(g,g,f));var y=g[0]-d[0],_=g[1]-d[1];s=180*Math.atan2(y,_)/Math.PI,s<0&&(s+=360),s<1e-6&&(s=0)}else{r="gradientradial";var d=[i.x*u,i.y*p],f=n.transform,m=n.scale,x=u,b=p;a=[(d[0]-c.x)/x,(d[1]-c.y)/b],f&&o(d,d,f),x/=m[0]*E,b/=m[1]*E;var w=C(x,b);h=0/w,l=2*i.r/w-h}var P=i.colorStops.slice();P.sort(function(t,e){return t.offset-e.offset});for(var S=P.length,T=[],R=[],k=0;k<S;k++){var N=P[k],M=j(N.color);R.push(N.offset*l+h+" "+M[0]),0!==k&&k!==S-1||T.push(M)}if(S>=2){var L=T[0][0],A=T[1][0],O=T[0][1]*e.opacity,z=T[1][1]*e.opacity;t.type=r,t.method="none",t.focus="100%",t.angle=s,t.color=L,t.color2=A,t.colors=R.join(","),t.opacity=z,t.opacity2=O}"radial"===r&&(t.focusposition=a.join(","))}else B(t,i,e.opacity)},H=function(t,e){null!=e.lineDash&&(t.dashstyle=e.lineDash.join(" ")),null==e.stroke||e.stroke instanceof v||B(t,e.stroke,e.opacity)},V=function(t,e,n,i){var r="fill"==e,o=t.getElementsByTagName(e)[0];null!=n[e]&&"none"!==n[e]&&(r||!r&&n.lineWidth)?(t[r?"filled":"stroked"]="true",n[e]instanceof v&&z(t,o),o||(o=y.createNode(e)),r?D(o,n,i):H(o,n),O(t,o)):(t[r?"filled":"stroked"]="false",z(t,o))},G=[[],[],[]],U=function(t,e){var n,i,r,s,a,h,l=_.M,c=_.C,u=_.L,p=_.A,f=_.Q,d=[],g=t.data,v=t.len();for(s=0;s<v;){switch(r=g[s++],i="",n=0,r){case l:i=" m ",n=1,a=g[s++],h=g[s++],G[0][0]=a,G[0][1]=h;break;case u:i=" l ",n=1,a=g[s++],h=g[s++],G[0][0]=a,G[0][1]=h;break;case f:case c:i=" c ",n=3;var y,b,C=g[s++],T=g[s++],k=g[s++],N=g[s++];r===f?(y=k,b=N,k=(k+2*C)/3,N=(N+2*T)/3,C=(a+2*C)/3,T=(h+2*T)/3):(y=g[s++],b=g[s++]),G[0][0]=C,G[0][1]=T,G[1][0]=k,G[1][1]=N,G[2][0]=y,G[2][1]=b,a=y,h=b;break;case p:var M=0,L=0,A=1,O=1,z=0;e&&(M=e[4],L=e[5],A=x(e[0]*e[0]+e[1]*e[1]),O=x(e[2]*e[2]+e[3]*e[3]),z=Math.atan2(-e[1]/O,e[0]/A));var F=g[s++],I=g[s++],B=g[s++],j=g[s++],D=g[s++]+z,H=g[s++]+D+z;s++;var V=g[s++],U=F+w(D)*B,Y=I+P(D)*j,C=F+w(H)*B,T=I+P(H)*j,W=V?" wa ":" at ";Math.abs(U-C)<1e-4&&(Math.abs(H-D)>.01?V&&(U+=270/E):Math.abs(Y-I)<1e-4?V&&U<F||!V&&U>F?T-=270/E:T+=270/E:V&&Y<I||!V&&Y>I?C+=270/E:C-=270/E),d.push(W,m(((F-B)*A+M)*E-R),S,m(((I-j)*O+L)*E-R),S,m(((F+B)*A+M)*E-R),S,m(((I+j)*O+L)*E-R),S,m((U*A+M)*E-R),S,m((Y*O+L)*E-R),S,m((C*A+M)*E-R),S,m((T*O+L)*E-R)),a=C,h=T;break;case _.R:var X=G[0],q=G[1];X[0]=g[s++],X[1]=g[s++],q[0]=X[0]+g[s++],q[1]=X[1]+g[s++],e&&(o(X,X,e),o(q,q,e)),X[0]=m(X[0]*E-R),q[0]=m(q[0]*E-R),X[1]=m(X[1]*E-R),q[1]=m(q[1]*E-R),d.push(" m ",X[0],S,X[1]," l ",q[0],S,X[1]," l ",q[0],S,q[1]," l ",X[0],S,q[1]);break;case _.Z:d.push(" x ")}if(n>0){d.push(i);for(var Q=0;Q<n;Q++){var Z=G[Q];e&&o(Z,Z,e),d.push(m(Z[0]*E-R),S,m(Z[1]*E-R),Q<n-1?S:"")}}}return d.join("")};d.prototype.brushVML=function(t){var e=this.style,n=this._vmlEl;n||(n=y.createNode("shape"),M(n),this._vmlEl=n),V(n,"fill",e,this),V(n,"stroke",e,this);var i=this.transform,r=null!=i,o=n.getElementsByTagName("stroke")[0];if(o){var s=e.lineWidth;if(r&&!e.strokeNoScale){var a=i[0]*i[3]-i[1]*i[2];s*=x(b(a))}o.weight=s+"px"}var h=this.path||(this.path=new g);this.__dirtyPath&&(h.beginPath(),this.buildPath(h,this.shape),h.toStatic(),this.__dirtyPath=!1),n.path=U(h,this.transform),n.style.zIndex=F(this.zlevel,this.z,this.z2),O(t,n),null!=e.text?this.drawRectText(t,this.getBoundingRect()):this.removeRectText(t)},d.prototype.onRemove=function(t){z(t,this._vmlEl),this.removeRectText(t)},d.prototype.onAdd=function(t){O(t,this._vmlEl),this.appendRectText(t)};var Y=function(t){return"object"==typeof t&&t.tagName&&"IMG"===t.tagName.toUpperCase()};p.prototype.brushVML=function(t){var e,n,i=this.style,r=i.image;if(Y(r)){var s=r.src;if(s===this._imageSrc)e=this._imageWidth,n=this._imageHeight;else{var a=r.runtimeStyle,h=a.width,l=a.height;a.width="auto",a.height="auto",e=r.width,n=r.height,a.width=h,a.height=l,this._imageSrc=s,this._imageWidth=e,this._imageHeight=n}r=s}else r===this._imageSrc&&(e=this._imageWidth,n=this._imageHeight);if(r){var c=i.x||0,u=i.y||0,p=i.width,f=i.height,d=i.sWidth,g=i.sHeight,v=i.sx||0,_=i.sy||0,b=d&&g,w=this._vmlEl;w||(w=y.doc.createElement("div"),M(w),this._vmlEl=w);var P,E=w.style,R=!1,k=1,N=1;if(this.transform&&(P=this.transform,k=x(P[0]*P[0]+P[1]*P[1]),N=x(P[2]*P[2]+P[3]*P[3]),R=P[1]||P[2]),R){var L=[c,u],A=[c+p,u],z=[c,u+f],I=[c+p,u+f];o(L,L,P),o(A,A,P),o(z,z,P),o(I,I,P);var B=C(L[0],A[0],z[0],I[0]),j=C(L[1],A[1],z[1],I[1]),D=[];D.push("M11=",P[0]/k,S,"M12=",P[2]/N,S,"M21=",P[1]/k,S,"M22=",P[3]/N,S,"Dx=",m(c*k+P[4]),S,"Dy=",m(u*N+P[5])),E.padding="0 "+m(B)+"px "+m(j)+"px 0",E.filter=T+".Matrix("+D.join("")+", SizingMethod=clip)"}else P&&(c=c*k+P[4],u=u*N+P[5]),E.filter="",E.left=m(c)+"px",E.top=m(u)+"px";var H=this._imageEl,V=this._cropEl;H||(H=y.doc.createElement("div"),this._imageEl=H);var G=H.style;if(b){if(e&&n)G.width=m(k*e*p/d)+"px",G.height=m(N*n*f/g)+"px";else{var U=new Image,W=this;U.onload=function(){U.onload=null,e=U.width,n=U.height,G.width=m(k*e*p/d)+"px",G.height=m(N*n*f/g)+"px",W._imageWidth=e,W._imageHeight=n,W._imageSrc=r},U.src=r}V||(V=y.doc.createElement("div"),V.style.overflow="hidden",this._cropEl=V);var X=V.style;X.width=m((p+v*p/d)*k),X.height=m((f+_*f/g)*N),X.filter=T+".Matrix(Dx="+-v*p/d*k+",Dy="+-_*f/g*N+")",V.parentNode||w.appendChild(V),H.parentNode!=V&&V.appendChild(H)}else G.width=m(k*p)+"px",G.height=m(N*f)+"px",w.appendChild(H),V&&V.parentNode&&(w.removeChild(V),this._cropEl=null);var q="",Q=i.opacity;Q<1&&(q+=".Alpha(opacity="+m(100*Q)+") "),q+=T+".AlphaImageLoader(src="+r+", SizingMethod=scale)",G.filter=q,w.style.zIndex=F(this.zlevel,this.z,this.z2),O(t,w),null!=i.text&&this.drawRectText(t,this.getBoundingRect())}},p.prototype.onRemove=function(t){z(t,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(t)},p.prototype.onAdd=function(t){O(t,this._vmlEl),this.appendRectText(t)};var W,X="normal",q={},Q=0,Z=100,$=document.createElement("div"),J=function(t){var e=q[t];if(!e){Q>Z&&(Q=0,q={});var n,i=$.style;try{i.font=t,n=i.fontFamily.split(",")[0]}catch(r){}e={style:i.fontStyle||X,variant:i.fontVariant||X,weight:i.fontWeight||X,size:0|parseFloat(i.fontSize||12),family:n||"Microsoft YaHei"},q[t]=e,Q++}return e};h.$override("measureText",function(t,e){var n=y.doc;W||(W=n.createElement("div"),W.style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",y.doc.body.appendChild(W));try{W.style.font=e}catch(i){}return W.innerHTML="",W.appendChild(n.createTextNode(t)),{width:W.offsetWidth}});for(var K=new s,tt=function(t,e,n,i){var r=this.style;this.__dirty&&l.normalizeTextStyle(r,!0);var s=r.text;if(null!=s&&(s+=""),s){if(r.rich){var a=h.parseRichText(s,r);s=[];for(var c=0;c<a.lines.length;c++){for(var u=a.lines[c].tokens,p=[],f=0;f<u.length;f++)p.push(u[f].text);s.push(p.join(""))}s=s.join("\n")}var d,g,v=r.textAlign,_=r.textVerticalAlign,x=J(r.font),b=x.style+" "+x.variant+" "+x.weight+" "+x.size+'px "'+x.family+'"';n=n||h.getBoundingRect(s,b,v,_);var w=this.transform;if(w&&!i&&(K.copy(e),K.applyTransform(w),e=K),i)d=e.x,g=e.y;else{var P=r.textPosition,C=r.textDistance;if(P instanceof Array)d=e.x+I(P[0],e.width),g=e.y+I(P[1],e.height),v=v||"left";else{var T=h.adjustTextPositionOnRect(P,e,C);d=T.x,g=T.y,v=v||T.textAlign,_=_||T.textVerticalAlign}}d=h.adjustTextX(d,n.width,v),g=h.adjustTextY(g,n.height,_),g+=n.height/2;var E,R,k,N=y.createNode,A=this._textVmlEl;A?(k=A.firstChild,E=k.nextSibling,R=E.nextSibling):(A=N("line"),E=N("path"),R=N("textpath"),k=N("skew"),R.style["v-text-align"]="left",M(A),E.textpathok=!0,R.on=!0,A.from="0 0",A.to="1000 0.05",O(A,k),O(A,E),O(A,R),this._textVmlEl=A);var z=[d,g],B=A.style;w&&i?(o(z,z,w),k.on=!0,k.matrix=w[0].toFixed(3)+S+w[2].toFixed(3)+S+w[1].toFixed(3)+S+w[3].toFixed(3)+",0,0",k.offset=(m(z[0])||0)+","+(m(z[1])||0),k.origin="0 0",B.left="0px",B.top="0px"):(k.on=!1,B.left=m(d)+"px",B.top=m(g)+"px"),R.string=L(s);try{R.style.font=b}catch(j){}V(A,"fill",{fill:r.textFill,opacity:r.opacity},this),V(A,"stroke",{stroke:r.textStroke,opacity:r.opacity,lineDash:r.lineDash},this),A.style.zIndex=F(this.zlevel,this.z,this.z2),O(t,A)}},et=function(t){z(t,this._textVmlEl),this._textVmlEl=null},nt=function(t){O(t,this._textVmlEl)},it=[c,u,p,d,f],rt=0;rt<it.length;rt++){var ot=it[rt].prototype;ot.drawRectText=tt,ot.removeRectText=et,ot.appendRectText=nt}f.prototype.brushVML=function(t){var e=this.style;null!=e.text?this.drawRectText(t,{x:e.x||0,y:e.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(t)},f.prototype.onRemove=function(t){this.removeRectText(t)},f.prototype.onAdd=function(t){this.appendRectText(t)}}},function(t,e,n){function i(t){return o(t)}function r(){if(!l&&c){l=!0;var t=c.styleSheets;t.length<31?c.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):t[0].addRule(".zrvml","behavior:url(#default#VML)")}}var o,s=n(49),a="urn:schemas-microsoft-com:vml",h="undefined"==typeof window?null:window,l=!1,c=h&&h.document;if(c&&!s.canvasSupported)try{!c.namespaces.zrvml&&c.namespaces.add("zrvml",a),o=function(t){return c.createElement("<zrvml:"+t+' class="zrvml">')}}catch(u){o=function(t){return c.createElement("<"+t+' xmlns="'+a+'" class="zrvml">')}}e.doc=c,e.createNode=i,e.initVML=r},function(t,e,n){function i(t){return parseInt(t,10)}function r(t,e){a.initVML(),this.root=t,this.storage=e;var n=document.createElement("div"),i=document.createElement("div");n.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",i.style.cssText="position:absolute;left:0;top:0;",t.appendChild(n),this._vmlRoot=i,this._vmlViewport=n,this.resize();var r=e.delFromStorage,o=e.addToStorage;e.delFromStorage=function(t){r.call(e,t),t&&t.onRemove&&t.onRemove(i)},e.addToStorage=function(t){t.onAdd&&t.onAdd(i),o.call(e,t)},this._firstPaint=!0}function o(t){return function(){s('In IE8.0 VML mode painter not support method "'+t+'"')}}var s=n(21),a=n(161),h=n(4),l=h.each;r.prototype={constructor:r,getType:function(){return"vml"},getViewportRoot:function(){return this._vmlViewport},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(){var t=this.storage.getDisplayList(!0,!0);this._paintList(t)},_paintList:function(t){for(var e=this._vmlRoot,n=0;n<t.length;n++){var i=t[n];i.invisible||i.ignore?(i.__alreadyNotVisible||i.onRemove(e),i.__alreadyNotVisible=!0):(i.__alreadyNotVisible&&i.onAdd(e),i.__alreadyNotVisible=!1,i.__dirty&&(i.beforeBrush&&i.beforeBrush(),(i.brushVML||i.brush).call(i,e),i.afterBrush&&i.afterBrush())),i.__dirty=!1}this._firstPaint&&(this._vmlViewport.appendChild(e),this._firstPaint=!1)},resize:function(t,e){var t=null==t?this._getWidth():t,e=null==e?this._getHeight():e;if(this._width!=t||this._height!=e){this._width=t,this._height=e;var n=this._vmlViewport.style;n.width=t+"px",n.height=e+"px"}},dispose:function(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null},getWidth:function(){return this._width},getHeight:function(){return this._height},clear:function(){this._vmlViewport&&this.root.removeChild(this._vmlViewport)},_getWidth:function(){var t=this.root,e=t.currentStyle;return(t.clientWidth||i(e.width))-i(e.paddingLeft)-i(e.paddingRight)|0},_getHeight:function(){var t=this.root,e=t.currentStyle;return(t.clientHeight||i(e.height))-i(e.paddingTop)-i(e.paddingBottom)|0}},l(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(t){r.prototype[t]=o(t)});var c=r;t.exports=c}])});
//# sourceMappingURL=fish-topo-bpmn.min.js.map
