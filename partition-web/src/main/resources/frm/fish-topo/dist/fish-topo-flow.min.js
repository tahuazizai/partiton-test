!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.fishTopoFlow=e():t.fishTopoFlow=e()}(this,function(){return function(t){function e(n){if(i[n])return i[n].exports;var o=i[n]={exports:{},id:n,loaded:!1};return t[n].call(o.exports,o,o.exports,e),o.loaded=!0,o.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){t.exports=i(1)},function(t,e,i){t.exports=i(2),i(137)},function(t,e,i){function n(t,e){this.id,this.group=null,this._dom=t,this.nowZoom=1,this.canScale=!0,this.eagleEye=!1,this.eagleEyeNode=null,this.initScaleRatio=1,this.operationNode=null,this.step=0,this.stepJson=[],this.selectedNode=null,this.allNodes=[],this.minimap=null,this._api=new h(this),this.connectionManager=new p(this._api),this.lineOperationManager=new x(this.connectionManager,this._api),this._zr=c.init(t,{renderer:e.renderer||"canvas",devicePixelRatio:e.devicePixelRatio}),this._tooltipView=new S(new M(e.tooltip),this._api),this.Shape=o,this.lineOpt={},this.selectedNodes=[],this.model=new v({}),this.model.set(g.ELEMENT_TYPE,"scene"),this.model.set(g.MODE,"normal"),this.options=e,this.cursorMap={tl:"nw-resize",tr:"ne-resize",bl:"sw-resize",br:"se-resize",mtr:"url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAAAYFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD6T+iNAAAAH3RSTlMA7sUMoYXnEkYYzaaTjQiAQCweBcG7fvnULh2ZdjMy6Fzd7wAAALJJREFUGNN1kFkOwzAIBQHvW/Y6Sbfc/5Y1ltqoljIf2BohBA8qU096xeV5L/+uFH4SpsGAGSKmThCyMz64Ud38Te0meIpHcTP1ndTKvqzSUuQILFMQJAUwIngBLCd0UrJhSRGqzHHU3FcHBVMokqxS38YNGQLQbhmgZZ23sVEXnXVmS467Fq0892SSLaW5SHrN9rz9bXv9EHIB+E9pdMG7Ys48Z2cjxo7FL3k8kPIE13wAmEUIO2ML9YMAAAAASUVORK5CYII=) 10 10, auto"},this.cursorMaps=["n-resize","ne-resize","e-resize","se-resize","s-resize","sw-resize","w-resize","nw-resize"],this.cursorOffset={tr:1,br:3,bl:5,tl:7},l.call(this)}i(3);var o=i(4),r=i(64),s=i(65),a=i(66),h=i(68),l=i(12),c=i(69),u=i(5),d=i(80),p=i(90),f=i(94),g=i(93),v=i(87),y=i(77),m=i(82),x=i(123),_=i(119),b=i(96),w=i(95),P=i(117),C=i(124),T=i(26),N=i(132),S=i(133),M=i(136),A={},E={ENTER:13,ESCAPE:27},R=n.prototype;R.getDom=function(){return this._dom},R.getZr=function(){return this._zr},R.getWidth=function(){return this._zr.getWidth()},R.getHeight=function(){return this._zr.getHeight()},R.isDisposed=function(){return this._disposed},R.dispose=function(){this._disposed=!0,this._zr.dispose(),k[this.id]=null},R.resize=function(){this._zr.resize()},R.dispatchAction=function(t){!A[t.type]},R.option=function(t,e){var i=new v(this.options);return 0===arguments.length?u.clone(this.options):1===arguments.length?i.get(t):2===arguments.length?("roam"===t&&this.setRoam(e),i.set(t,e)):void 0},R.init=function(){var t="ontouchstart"in window?["touchstart","touchmove","touchend"]:["mousedown","mousemove","mouseup"];this.group=new o.Group,this.group.model=this.model,this.group.isBg=!0,this._zr.add(this.group),this.options.roam===!0&&this.zrScale(),this.connectionManager.connectors=[],this._zr.on("mouseup",function(t){var e=t.target;e&&e.model&&_.isLink(e.model)||e&&e.connector instanceof m||(this.connectionManager.clearSelectCon(),e&&e._isLineOperationIcon&&1==e._isLineOperationIcon||this.lineOperationManager.hideAllLineOperation())}.bind(this)),this._zr.on("click",function(t){var e=t.target||{},i=e.type;if("ConnectControlLine"!==i&&"ConnectControl"!==i){this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode();var n,o=t.target;if(o&&(n=o.model),o&&n&&_.isLink(n)||o&&n&&_.isNode(n))return}var r={};r.event=t,r.type="click",r.target=this,this._api.trigger(r.type,r)}.bind(this)),this._zr.on("mousedown",function(t){if("drag-select"===this.options.mouseMode){if(t.target&&t.target.model||t.target&&t.target.lineType&&t.target.parent||t.target&&t.target.connector instanceof m||t.target&&t.target instanceof o.Circle||t.target&&"GROUP_RECT_NAME"===t.target.name)return;this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode(),this._dragSelect(t.target,t.offsetX,t.offsetY)}if("drag-move"===this.options.mouseMode){if(t.target&&t.target.model||t.target&&t.target.lineType&&t.target.parent||t.target&&t.target.connector instanceof m||t.target&&t.target instanceof o.Circle)return;this._groupDragHandler(t.offsetX,t.offsetY)}}.bind(this)),this.on("conPointsGroup:click",function(t){this.lineOperationManager.bindOperation(t.lineNode)}.bind(this)),u.each(t,function(t){this._zr.on(t,function(e){var i={};i.event=e,i.type=t,i.target=this,this._api.trigger(i.type,i)},this)},this)},R.setRoam=function(t){this._zr.off("mousewheel"),t===!0&&this.zrScale()},R.addGroupModel=function(t){var e=this;t.eachChild(function(t){if(t.model&&t instanceof w&&t.model&&!t.model.option.childs&&t.children().length>0){var i=[];t.eachChild(function(n){n.model&&(n instanceof w&&!n.model.option.childs&&n.children().length>0&&e.addGroupModel(t),i.push(n.model.option),t.model.option.childs=i)})}})},R.toJson=function(){return this.addGroupModel(this.group),f.toJson(this.model,this.group)},R.fromJson=function(t,e){this.clear(!0);var i=new v(t);this.setBackground(i.get(g.BACKGROUND));var n=[];f.fromJson(this,this.group,i.get(g.CHILDS),!1,n,e)},R.add=R.addNode=function(t,e,i){if(!t)return null;var n=e||{};if(n.trigger!==!1&&!this._trigger("beforeCreate",{target:t}))return null;if(t instanceof m)this.addConnectorAttrEvent(t);else{if(_.isGroupNode(t)){t.willRender(this._api);var r=t.model.get(g.OPTIONS);if(r.mergedImage){var s=new b.Image({style:{image:r.mergedImage,text:r.style.text,textPosition:"bottom"},position:[-5e3,-5e3]});this.drag(s),t._relationImage=s,this.group.add(s),setTimeout(function(){s.hide()},300),t.on("dblclick",function(){t.merged()})}t.each(function(e){this._addGroupNode(t,e)},this)}this.addNodeAttrEvent(t,!0)}return this._trigger("create",{target:t}),t.hoverStyle&&o.setHoverStyle(t),this.group.add(t),t.relative&&this._handleRelativePostion(t),t.hoverAnimation&&this.options.isAnimationEnabled&&b.addHoverAnimation(t),1!=i&&this.stepCounter(),t},R._addGroupNode=function(t,e){e instanceof m?this.addConnectorAttrEvent(e):(this.addNodeAttrEvent(e,t.options.childDraggable),s.isUndefined(e.selectable)&&(e.selectable=!1),e.relative&&this._handleRelativePostion(e),e.hoverStyle&&o.setHoverStyle(e)),this._trigger("create",{target:e})},R.addTextOnChain=function(t,e){if(t.options.style.lineType===m.TYPE_CHAIN){this.connectionManager.removeLine(t,this._getParentZr(t)),t.options.text.text.push(e),t.options.textContextMenu=t.opt.textContextMenu;var i=new P.Chain(t.startNode,t.endNode,t.options);return this.add(i),i}},R.delTextOnChain=function(t){var e,i=t.id,n=t.parent;if(n.options.style.lineType===m.TYPE_CHAIN&&u.isArray(n.options.text.text)){n.options.text.text.forEach(function(t,n){t.textId===i&&(e=n)}),n.options.text.text.splice(e,1),this.connectionManager.removeLine(n,this._getParentZr(n)),n.options.textContextMenu=n.opt.textContextMenu;var o=new P.Chain(n.startNode,n.endNode,n.options);return this.add(o),o}},R.modifyTextOnChain=function(t,e){var i=t.id,n=t.parent;n.options.style.lineType===m.TYPE_CHAIN&&u.isArray(n.options.text.text)&&(n.options.text.text.forEach(function(t,n){t.textId===i&&(t.text=e)}),t.setStyle("text",e))},R.toggleAllConNodeLine=function(t,e){var i=this.connectionManager.connectors;u.isArray(i)&&i.forEach(function(i){i.startNode.id===t.id&&("hide"===e?i.hide():i.show())})},R.addConnectorAttrEvent=function(t){var e=this,i=null;if(t.options.style.lineType===m.TYPE_CHAIN){var n=this.connectionManager.getTwoNodeId(t.startNode,t.endNode,t.options.position),o=this.connectionManager.connectorMap.get(n),r=[].concat(t.options.text.text);o.length>0&&o.forEach(function(t){t.options.style.lineType===m.TYPE_CHAIN&&(r=r.concat(t.options.text.text),i=t)})}i&&(t.options.text.text=r,this.connectionManager.removeLine(i,this._getParentZr(i))),t.options.isEdit=!!this.options.linkModify,t.on("mousedown",function(){this.connectionManager.connectorForbidEdit(!this.options.linkModify),this.isNode=!1}.bind(this)),this.connectionManager.add(t),t.on("dblclick",function(){"undefined"==typeof this.options.text.textEditable?e.options.textEditable&&e.connectorEdit(this):this.options.text.textEditable&&e.connectorEdit(this)})},R.addNodeAttrEvent=function(t,e){var i=this;e&&this.drag(t),t.attr("operationIcons",t.model.get("options.operationIcons")),t.on("click",function(t){var e=this;i.nodeClickHandler(e);var n={};if(n.event=t,n.type="click",n.target=e,i._api.trigger(n.type,n),t.cancelBubble=!0,_.isInGroup(e)){var o=e.parent;o.childDraggable||o.trigger("click",{event:t,type:"click",target:o})}}),t.on("dblclick",function(t){var e=this;e.style&&"undefined"!=typeof e.style.textEditable?e.style.textEditable&&i.nodeEdit(e):i.options.textEditable&&i.nodeEdit(e);var n={};n.event=t,n.type="dblclick",n.target=e,i._api.trigger(n.type,n),t.cancelBubble=!0}),this.allNodes.push(t)},R._handleRelativePostion=function(t){var e=t.parent,i=e===this.group?{width:this._api.getWidth(),height:this._api.getHeight()}:{width:e.getBoundingRect().width,height:e.getBoundingRect().height};C.positionElement(t,t.relative,i,t.relative.padding,{boundingMode:t.relative.bounding||"all"})},R._getParentZr=function(t){var e=null;return e=t&&t.parent?t.parent:this.group},R._removeOperationNode=function(){this.operationNode&&(this.group.remove(this.operationNode),this.operationNode.cleanup(),this.operationNode=null)},R.clear=function(t){for(var e=0;e<this.allNodes.length;e++){var i=this._getParentZr(this.allNodes[e]);this.connectionManager.deleteSelectCon(this.allNodes[e],i)}this.connectionManager.connectorMap.clear(),this.allNodes=[],this.operationNode=null,this.selectedNode=null,this.dragSelectRect=null,this.selectedNodes=[],this.hideConnectorPoint(),this.hideConnectorControl(),this.connectionManager.connectors=[],this._zr.clear(),this.group=new o.Group,this.group.isBg=!0,this._zr.add(this.group),1!=t&&this.stepCounter()},R.addLineIcon=R.addIcon=function(t,e){this.lineOperationManager.addIcon(t,e)},R.lineDefaultIcon=function(t){this.addLineDeleteIcon(t),this.addLineChangeIcon(t)},R.addLineDeleteIcon=function(t,e){this.lineOperationManager.addDeleteIcon(t,e)},R.addLineChangeIcon=function(t,e){this.lineOperationManager.addChangeLineTypeIcon(t,e)},R.changeSelectConnectorType=function(t){var e=t,i=this.connectionManager.selConnector,n=i.options.style.lineType;if(e){if(e==n)return}else{var o=[m.TYPE_STRAIGHT,m.TYPE_JAGGED,m.TYPE_CURVE],r=u.indexOf(o,n);e=o[(r+1)%o.length]}this.connectionManager.deleteLine(this._getParentZr(i)),this.lineOperationManager.hideAllLineOperation(),u.merge(i.options,{dockers:[]},!0),u.merge(i.options.style,{lineType:e},!0);var s=this.createConnectorByNodes(i.startNode,i.endNode,i.options,!1);s&&(s.icons=i.icons,s.on("Connector:click",function(){this.lineOperationManager.bindOperation(s)}.bind(this)))},R.createConnectorPoint=function(t,e,i){var n=this,r=new o.Circle({shape:{cx:t.x,cy:t.y,r:4},style:{fill:"#FFFF33",stroke:"#000000"},z:4,draggable:!0,lineType:i});r.type="ConnectPoint",r.pos=e;var s=["dragstart","drag","dragend"];u.each(s,function(t){r.on(t,function(e){var i={};i.event=e,i.type="ConnectPoint:"+t,n.group.trigger(i.type,i)})}),this.group.add(r)},R.hideConnectorPoint=function(){var t=this;this.group.children().forEach(function(e){"ConnectPoint"===e.type&&t.group.remove(e)}),this.group.off("ConnectPoint:dragstart"),this.group.off("ConnectPoint:drag"),this.group.off("ConnectPoint:dragend")},R.filterConnectPoint=function(t,e){var i=this,n=[],o=[],r=[];t.length>1?(t.forEach(function(t){_.isGroupNode(t)?(r.push(t),n=n.concat(t.children())):o.push(t)}),o.forEach(function(t){n.includes(t)||r.push(t)})):r=t,r.forEach(function(t){var n=s.getRect(t),o=s.getConnectorPoints(n,t);i.createConnectorPoint(o.left,"left",e),i.createConnectorPoint(o.right,"right",e),i.createConnectorPoint(o.top,"top",e),i.createConnectorPoint(o.bottom,"bottom",e)})},R.showConnectorPoint=function(t,e,i){function n(t,e,i,n){var r,a=null;return o.allNodes.forEach(function(o){var h=s.getRect(o),l=s.getConnectorPoints(h,o);n?Math.abs(l[n].x-t)<=i&&Math.abs(l[n].y-e)<=i&&(r=o):Math.abs(l.left.x-t)<=i&&Math.abs(l.left.y-e)<=i?(a="left",r=o):Math.abs(l.top.x-t)<=i&&Math.abs(l.top.y-e)<=i?(a="top",r=o):Math.abs(l.right.x-t)<=i&&Math.abs(l.right.y-e)<=i?(a="right",r=o):Math.abs(l.bottom.x-t)<=i&&Math.abs(l.bottom.y-e)<=i&&(a="bottom",r=o)}),{node:r,endPos:a}}var o=this;this.hideConnectorPoint(),e&&(this.lineOpt=e),i||(i=!1);var r=i?[o.selectedNode]:o.allNodes;i||(o._removeOperationNode(),o._releaseSelectNode()),this.filterConnectPoint(r,t),this.group.on("ConnectPoint:dragstart",function(e){i&&o.filterConnectPoint(o.allNodes,t);var r=(e.event.offsetX-o.group.position[0])/o.nowZoom,s=(e.event.offsetY-o.group.position[1])/o.nowZoom,h=e.event.target;o.startPos=h.pos,o.selectConnNode=n(h.shape.cx,h.shape.cy,0,o.startPos).node,h.hide(),o.lineOperationManager.hideAllLineOperation(),o.reverseConnect=!1,o.originNode=null;var l=new a(r,s);o.connectionManager.connectors.forEach(function(t){t.endNode.id===o.selectConnNode.id&&o.startPos===t.options.position.endPos?(o.connectionManager.deleteByLine(t,o.group),o.selectConnNode=t.startNode,o.startPos=t.options.position.startPos,o.originNode=t.endNode,o.originPos=t.options.position.endPos):t.startNode.id===o.selectConnNode.id&&o.startPos===t.options.position.startPos&&(o.connectionManager.deleteByLine(t,o.group),o.reverseConnect=!0,o.selectConnNode=t.endNode,o.endPos=t.options.position.endPos,o.originNode=t.startNode,o.originPos=t.options.position.startPos)});var c;c=o.reverseConnect?o.connectionManager.manageReverseTempConnector(l,o.selectConnNode,h.lineType,o.endPos):o.connectionManager.manageTempConnector(o.selectConnNode,l,h.lineType,o.startPos),o.group.add(c)}),this.group.on("ConnectPoint:drag",function(t){var e=(t.event.offsetX-o.group.position[0])/o.nowZoom,i=(t.event.offsetY-o.group.position[1])/o.nowZoom,r=new a(e,i),s=t.event.target;o.reverseConnect?o.connectionManager.manageReverseTempConnector(r,o.selectConnNode,s.lineType,o.endPos):o.connectionManager.manageTempConnector(o.selectConnNode,r,s.lineType,o.startPos),o.group.children().forEach(function(t){if("ConnectPoint"===t.type&&(t.attr({style:{fill:"#FFFF33"},scale:[1,1],origin:[t.shape.cx,t.shape.cy]}),Math.abs(t.shape.cx-e)<=10&&Math.abs(t.shape.cy-i)<=10)){var a=n(e,i,10);o.reverseConnect?o.connectionManager.manageReverseTempConnector(r,o.selectConnNode,s.lineType,o.endPos,a.endPos,a.node):o.connectionManager.manageTempConnector(o.selectConnNode,r,s.lineType,o.startPos,a.endPos,a.node),t.attr({style:{fill:"#ff0000"},scale:[1.5,1.5],origin:[t.shape.cx,t.shape.cy]})}})}),this.group.on("ConnectPoint:dragend",function(t){var e=(t.event.offsetX-o.group.position[0])/o.nowZoom,i=(t.event.offsetY-o.group.position[1])/o.nowZoom,r=n(e,i,10),a=r.node,h=r.endPos||"left",l=t.event.target;if(o.connectionManager.removeTempConnector(o.group),a&&o.selectConnNode.id!==a.id){var c={},u={style:{lineType:l.lineType},position:{startPos:o.reverseConnect?h:o.startPos,endPos:o.reverseConnect?o.endPos:h}},d=s.mergeOpt(u,o.lineOpt,!0,"position"),p=o.reverseConnect?a:o.selectConnNode,f=o.reverseConnect?o.selectConnNode:a;if(o.originNode&&(c.startNode=o.reverseConnect?o.originNode:o.selectConnNode,c.endNode=o.reverseConnect?o.selectConnNode:o.originNode,c.options=s.mergeOpt({style:{lineType:l.lineType},position:{startPos:o.reverseConnect?o.originPos:o.startPos,endPos:o.reverseConnect?o.endPos:o.originPos}},o.lineOpt,!0,"position")),!o._trigger("beforeCreate",{target:p,endNode:f,connectOptions:d,origin:c}))return!1;o.createConnectorByNodes(p,f,d),o.hideConnectorPoint()}else l.show(),l.position=[0,0],o.group.children().forEach(function(t){"ConnectPoint"===t.type&&t.attr({style:{fill:"#FFFF33"},scale:[1,1],origin:[t.shape.cx,t.shape.cy]})})})},R.createLineConnectorPoint=function(t,e,i){var n=new o.Circle({shape:{cx:t.x,cy:t.y,r:4},style:{fill:"#FFFF33",stroke:"#000000"},z:4,draggable:!0,lineType:i});n.type="ConnectPoint",n.pos=e,this.group.add(n)},R.getRotatedCornerCursor=function(t,e){var i=this,n=t.rotation;if("mtr"===e)return i.cursorMap[e];if(Math.abs(n)>0){var o=-n/(Math.PI/180),r=Math.round(o%360/45);return r<0&&(r+=8),r+=i.cursorOffset[e],r%=8,i.cursorMaps[r]}return i.cursorMap[e]},R.createConnectorControl=function(t,e,i){var n=this,r=e.split(",");if(r.length<2){var s=n.getRotatedCornerCursor(i,e),a=new o.Rect({shape:{x:t.x-4,y:t.y-4,width:8,height:8},style:{fill:"#ffffff",stroke:"#000000"},z:4,rotation:i.rotation,origin:[t.x,t.y],cursor:s,draggable:!0});a.type="ConnectControl",a.pos=e;var h=["dragstart","drag","dragend"];u.each(h,function(t){a.on(t,function(e){var o={};o.event=e,o.type="ConnectControl:"+t,o.nodeId=i.id,o.cursor=s,n.group.trigger(o.type,o)})}),this.group.add(a)}else{var l=new o.Line({shape:{x1:t.top.x,y1:t.top.y,x2:t.bottom.x,y2:t.bottom.y},style:{lineWidth:1},z:1,draggable:!1,cursor:"default"});l.type="ConnectControlLine",l.nodeId=i.id,this.group.add(l)}},R.returnConnectorControlParam=function(t){var e="boolean"==typeof t.scaleable?t.scaleable:this.options.scaleable,i="boolean"==typeof t.rotatable?t.rotatable:this.options.rotatable;return{scaleable:e,rotatable:i}},R.hideConnectorControl=function(){var t=this,e=["ConnectControl","ConnectControlLine"];this.group.children().forEach(function(i){e.includes(i.type)&&t.group.remove(i)}),this.group.off("ConnectControl:dragstart"),this.group.off("ConnectControl:drag"),this.group.off("ConnectControl:dragend")},R.showConnectorControl=function(){function t(t){var i=null;return e.group.children().forEach(function(e){e.id===t&&(i=e)}),i}var e=this;this.hideConnectorControl();var i=s.getRect(this.selectedNode),n=s.getConnectorControls(i,this.selectedNode),o=this.returnConnectorControlParam(this.selectedNode);o.scaleable&&(e.createConnectorControl(n.tl,"tl",this.selectedNode),e.createConnectorControl(n.tr,"tr",this.selectedNode),e.createConnectorControl(n.bl,"bl",this.selectedNode),e.createConnectorControl(n.br,"br",this.selectedNode)),o.rotatable&&(e.createConnectorControl(n.mtr,"mtr",this.selectedNode),e.createConnectorControl({top:n.mtr,bottom:n.tc},"mtr,tc",this.selectedNode)),this.group.on("ConnectControl:dragstart",function(i){var n=i.event.target.cursor,o=i.event.target.pos,r={tl:"br",tr:"bl",bl:"tr",br:"tl"};if(e.selectConnNode=t(i.nodeId),n&&"mtr"!==o){var a=e.group.children().find(function(t){return t.pos===r[o]}),h=e.group.children().find(function(t){return t.pos===o}),l=e.selectConnNode.getBoundingRect();e.oppositeShape=u.clone(a.shape),e.currentShape=u.clone(h.shape);var c=u.clone(s.getRect(e.selectConnNode,!0)),d=Math.sqrt(Math.pow(c.width,2)+Math.pow(c.height,2));e.diagonal=d,e.originRect=u.clone(c),e.ifPointCenter=l.x<-1,e.selectConnNode.selectStyle&&e._api.getZr().removeHover(e.selectConnNode)}}),this.group.on("ConnectControl:drag",function(t){var i=t.event.target.cursor,n=t.event.target.pos,o=e.selectConnNode,r=(t.event.offsetX-e.group.position[0])/e.nowZoom,a=(t.event.offsetY-e.group.position[1])/e.nowZoom,h=s.getRect(o,!0);if("mtr"===n){var l=r-o.position[0],c=a-o.position[1],u={x:h.x-o.position[0],y:h.y-o.position[1]},d=Math.atan2(c,l);e.selectedNode.attr({origin:[u.x,u.y],rotation:-d});var p=s.getConnectorPoints(h,e.selectedNode),f=s.getConnectorControls(h,e.selectedNode);e.group.children().forEach(function(t){var e=t.pos;"ConnectControl"===t.type?("mtr"===e&&(t.attr("position",[0,0]),t.attr("rotation",0)),t.setShape({x:f[e].x-4,y:f[e].y-4}),t.attr({origin:[t.shape.x+4,t.shape.y+4],rotation:-d})):"ConnectControlLine"===t.type?t.setShape({x1:f.mtr.x,x2:f.tc.x,y1:f.mtr.y,y2:f.tc.y}):"ConnectPoint"===t.type&&t.setShape({cx:p[e].x,cy:p[e].y})})}else{var g,v,y=1,m=[],x={},b=["n-resize","s-resize"],w={tl:"br",tr:"bl",bl:"tr",br:"tl"},P=e.group.children().filter(function(t){return"ConnectControl"===t.type&&"mtr"!==t.pos}),C=P.find(function(t){return t.pos===n});if(r<=8&&(r=8),a<=8&&(a=8),b.includes(i)){var T=C.shape.y+4;y=e.currentShape.y>=e.oppositeShape.y?(a-e.oppositeShape.y-4)/(T-e.oppositeShape.y):(e.oppositeShape.y+4-a)/(e.oppositeShape.y-T)}else{var N=C.shape.x+4;y=e.currentShape.x>=e.oppositeShape.x?(r-e.oppositeShape.x-4)/(N-e.oppositeShape.x):(e.oppositeShape.x+4-r)/(e.oppositeShape.x-N)}/^[0-9]+.?[0-9]*/.test(y)||(y=1),o.updateShape(y);var S=s.getRect(o,!0);x=e.ifPointCenter?{x:e.originRect.x,y:e.originRect.y}:{x:e.originRect.boundingRect.x,y:e.originRect.boundingRect.y};var M=Math.sqrt(Math.pow(S.width,2)+Math.pow(S.height,2));switch(i){case"n-resize":case"nw-resize":g=(e.oppositeShape.x+4-x.x)*M/e.diagonal,v=(e.oppositeShape.y+4-x.y)*M/e.diagonal,m.push(e.oppositeShape.x-g+4,e.oppositeShape.y-v+4);break;case"e-resize":case"ne-resize":g=(x.x-e.oppositeShape.x-4)*M/e.diagonal,v=(e.oppositeShape.y+4-x.y)*M/e.diagonal,m.push(e.oppositeShape.x+g+4,e.oppositeShape.y-v+4);break;case"s-resize":case"se-resize":g=(x.x-e.oppositeShape.x-4)*M/e.diagonal,v=(x.y-e.oppositeShape.y-4)*M/e.diagonal,m.push(e.oppositeShape.x+g+4,e.oppositeShape.y+v+4);break;case"w-resize":case"sw-resize":g=(e.oppositeShape.x+4-x.x)*M/e.diagonal,v=(x.y-e.oppositeShape.y-4)*M/e.diagonal,m.push(e.oppositeShape.x-g+4,e.oppositeShape.y+v+4)}var A={x:S.x-m[0],y:S.y-m[1]};o.attr({position:m,origin:[A.x,A.y]});var E=s.getRect(o,!0),R=s.getConnectorPoints(E,o),L=s.getConnectorControls(E,o);e.group.children().forEach(function(t){var e=t.pos;e===n&&t.attr("position",[0,0]),"ConnectControl"===t.type&&e!==w[n]?(t.setShape({x:L[e].x-4,y:L[e].y-4}),t.attr("origin",[L[e].x,L[e].y])):"ConnectControlLine"===t.type?t.setShape({x1:L.mtr.x,x2:L.tc.x,y1:L.mtr.y,y2:L.tc.y}):"ConnectPoint"===t.type&&t.setShape({cx:R[e].x,cy:R[e].y})})}e.operationNode.refreshPostion(e.selectedNode,s.getRect(e.selectedNode)),e.connectionManager.refreshLineByNode(e.selectedNode),_.isGroupNode(e.selectedNode)&&e.selectedNode.each(function(t){e.connectionManager.refreshLineByNode(t)})}),this.group.on("ConnectControl:dragend",function(t){var i=e.selectConnNode,n=i.position,o=i.origin;if(e.selectConnNode.attr("position",[parseInt(n[0],10),parseInt(n[1],10)]),Array.isArray(o)&&e.selectConnNode.attr("origin",[parseInt(o[0],10),parseInt(o[1],10)]),i.updateShape(1,!0),i.model){i.model.set("options.rotation",i.rotation),i.model.set("options.origin",i.origin);var r=i.model.option.elementType;"Image"===r?i.model.set("options.style",i.style):i.model.set("options.shape",i.shape)}e.nodeClickHandler(i),e.stepCounter(),e.oppositeShape=null,e.currentShape=null,e.diagonal=null,e.originRect=null,e.ifPointCenter=null})},R.initOperationNode=function(t,e){function i(t,e,i,o){var r,a=null;return n.allNodes.forEach(function(n){var h=s.getRect(n),l=s.getConnectorPoints(h,n);o?Math.abs(l[o].x-t)<=i&&Math.abs(l[o].y-e)<=i&&(r=n):Math.abs(l.left.x-t)<=i&&Math.abs(l.left.y-e)<=i?(a="left",r=n):Math.abs(l.top.x-t)<=i&&Math.abs(l.top.y-e)<=i?(a="top",r=n):Math.abs(l.right.x-t)<=i&&Math.abs(l.right.y-e)<=i?(a="right",r=n):Math.abs(l.bottom.x-t)<=i&&Math.abs(l.bottom.y-e)<=i&&(a="bottom",r=n)}),{node:r,endPos:a}}var n=this;e||(e=!1),this.operationNode=new d(t,this.group,this._api),this.operationNode.on(d.ARROW_DRAGSTART,function(t){this.hideConnectorPoint(),n.filterConnectPoint(n.allNodes,t.event.target.lineType);var e=(t.event.offsetX-this.group.position[0])/this.nowZoom,i=(t.event.offsetY-this.group.position[1])/this.nowZoom;t.data&&(this.lineOpt=t.data);var o=t.event.target;o.hide();var r=new a(e,i),s=this.connectionManager.manageTempConnector(this.selectedNode,r,o.lineType);this.group.add(s),t.cancelBubble=!0}.bind(this)),this.operationNode.on(d.ARROW_DRAG,function(t){var e=(t.event.offsetX-this.group.position[0])/this.nowZoom,o=(t.event.offsetY-this.group.position[1])/this.nowZoom,r=t.event.target,s=new a(e,o);this.connectionManager.manageTempConnector(this.selectedNode,s,r.lineType),n.group.children().forEach(function(t){if("ConnectPoint"===t.type&&(t.attr({style:{fill:"#FFFF33"},scale:[1,1],origin:[t.shape.cx,t.shape.cy]}),Math.abs(t.shape.cx-e)<=10&&Math.abs(t.shape.cy-o)<=10)){var a=i(e,o,10);n.connectionManager.manageTempConnector(n.selectedNode,s,r.lineType,"right",a.endPos,a.node),t.attr({style:{fill:"#ff0000"},scale:[1.5,1.5],origin:[t.shape.cx,t.shape.cy]})}}),t.cancelBubble=!0}.bind(this)),this.operationNode.on(d.ARROW_DRAGEND,function(t){t.cancelBubble=!0;var e=(t.event.offsetX-n.group.position[0])/n.nowZoom,o=(t.event.offsetY-n.group.position[1])/n.nowZoom,r=i(e,o,10),a=r.node,h=r.endPos||"left",l=t.event.target;if(l.show(),this.connectionManager.removeTempConnector(this.group),a&&this.selectedNode!=a){var c={},u={style:{lineType:l.lineType},position:{startPos:"right",endPos:h}},d=s.mergeOpt(u,n.lineOpt,!0,"position"),p=n.selectedNode,f=a;if(n.originNode&&(c.startNode=n.selectedNode,c.endNode=n.originNode,c.options=s.mergeOpt({style:{lineType:l.lineType},position:{startPos:n.startPos,endPos:n.originPos}},n.lineOpt,!0,"position")),!this._trigger("beforeCreate",{target:this.selectedNode,endNode:a,connectOptions:u,origin:{}}))return null;n.createConnectorByNodes(p,f,d)}n.hideConnectorPoint();var g=n.selectedNode,v=s.getRect(g,!0);n.showConnectorPoint("jagged",void 0,!0),n.operationNode.refreshPostion(g,v)}.bind(this)),this.operationNode.on(d.DELETE_CLICK,function(){this.removeNode(this.selectedNode)}.bind(this)),this.group.add(this.operationNode)},R.removeSelectedNodes=function(){var t=this;this.selectedNodes.length?(this.selectedNodes.forEach(function(e,i){t.removeNode(e,{},!0),i===t.selectedNodes.length-1&&t.stepCounter()}),this.selectedNodes=[],this.dragSelectRect.off("mousedown"),this.group.remove(this.dragSelectRect)):t.selectedNode&&(t.removeNode(t.selectedNode),this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode())},R.findNodeChildIds=function(t,e){e.push(t.id),t.children().filter(function(t){var e=this.allNodes.findIndex(function(e){return e.id===t.id});return e!==-1}.bind(this)).forEach(function(t){_.isGroupNode(t)?this.findNodeChildIds(t,e):e.push(t.id)}.bind(this))},R.remove=R.removeNode=function(t,e,i){var n=e||{};if(n.trigger===!1||this._trigger("beforeDelete",{target:t})){var o=this._getParentZr(t);if(t instanceof m)u.each(t.icons,function(t){o.remove(t)}),this.connectionManager.deleteByLine(t,o);else{o.remove(t);var r=[];_.isGroupNode(t)?this.findNodeChildIds(t,r):r.push(t.id),this.allNodes=this.allNodes.filter(function(t){return r.indexOf(t.id)===-1}),this.connectionManager.deleteSelectCon(t,this.group),this._removeOperationNode()}this.connectionManager.clearSelectCon(),this.lineOperationManager.hideAllLineOperation(),1!=i&&this.stepCounter(),this._trigger("delete",{target:t})}},R.selectNode=function(t){t&&(this.nodeClickHandler(t),this._trigger("selectNode",{target:t}))},R.createConnectorByNodes=function(t,e,i,n){var o=i.style.lineType||m.TYPE_STRAIGHT;if(!P[o])return null;var r=P[o],s=new r(t,e,i);return this.connectionManager.add(s),t.parent&&e.parent&&t.parent==e.parent?e.parent.add(s):this.group.add(s),s.on("mousedown",function(t){this.connectionManager.connectorForbidEdit(),this.isNode=!1,this.showConnectorPoint(t.target.style.lineType)}.bind(this)),s.on("dblclick",function(){this.options.textEditable&&this.connectorEdit(this)}.bind(this)),n!==!1&&this._trigger("create",{target:s}),this.stepCounter(),s},R._trigger=function(t,e,i){var n=this.options[t];return void 0===i&&(i={}),null===e?e={type:t,target:this}:e.type=t,e.data=i,this._api.trigger(e.type,e),!(u.isFunction(n)&&n.apply(this,[e].concat(i))===!1)},R.nodeClickHandler=function(t){var e="dragSelect"!==t.type;if(t.parent&&"dragSelect"===t.parent.type&&(e=!1),this.hideConnectorPoint(),this.hideConnectorControl(),this._removeOperationNode(),t.selectable===!1){if(!_.isInGroup(t))return;var i=t.parent;if(i.selectable===!1)return;t=i}this.selectedNode=t;var n=s.getRect(t,!0);if(this.operationNode||this.initOperationNode(t,!0),e){this.showConnectorPoint("jagged",void 0,!0);var o=this.returnConnectorControlParam(t);(o.scaleable||o.rotatable)&&this.showConnectorControl()}this.operationNode.refreshPostion(t,n)},R.drag=function(t){var e=this;t.on("mousedown",function(t){var i=this;0==i.isdraggable||this.parent&&"dragSelect"===this.parent.type||(e._nodeDragHandler(i,t.offsetX,t.offsetY),t.cancelBubble=!0)})},R._nodeDragHandler=function(t,e,i){var n=0,o=this,r=t.position,s=t.position[0],a=t.position[1];if(t._startX=e,t._startY=i,"dragSelect"===t.type){var h=this.group.children().filter(function(t){return t.model&&"connection"===t.model.option.elementType}),l=this.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&t.model&&"connection"!==t.model.option.elementType}),c=this.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name&&t.model&&"connection"===t.model.option.elementType});h.forEach(function(t){var e=l.find(function(e){return e.id===t.startNode.id}),i=l.find(function(e){return e.id===t.endNode.id}),n=c.findIndex(function(e){return e.id===t.id});(e||i)&&n===-1&&o.connectionManager.removeLine(t,o._getParentZr(t))})}t.trigger("dragstart");var u=function(e){e.cancelBubble=!0;var i=(e.offsetX-t._startX)/this.nowZoom,o=(e.offsetY-t._startY)/this.nowZoom;if(0==i&&0==o||(n=1),t.trigger("drag"),_.isInGroup(t)){var h={width:_.isGroupNode(t)?t.options.shape.width:t.shape?t.shape.width:t.style.width,height:_.isGroupNode(t)?t.options.shape.height:t.shape?t.shape.height:t.style.height,position:t.position,movePosition:[s,a],moveX:i,moveY:o,node:t,isMove:n};t.parent.modifyGroupRect(h)}if(r[0]=s+i,r[1]=a+o,t.attr("position",r),t.alarm){var l=[r[0]+t.getBoundingRect().width-(t.alarm.getBoundingRect().width-6),r[1]-t.alarm.getBoundingRect().height-3];t.alarm.attr("position",l)}if(this.nodeClickHandler(t),this.connectionManager.refreshLineByNode(t),_.isGroupNode(t)&&t.each(function(t){this.connectionManager.refreshLineByNode(t)}.bind(this)),!_.isInGroup(t))for(var c=this.isPosInGroup(this.allNodes,t),u=0;u<this.allNodes.length;u++){var d=this.allNodes[u];_.isGroupNode(d)&&(c&&d.id===c.id&&d.id!==t.id?d.children().find(function(t){return"GROUP_RECT_NAME"===t.name}).attr("style",{fill:"#b6e3f5"}):d.children().find(function(t){return"GROUP_RECT_NAME"===t.name}).attr("style",{fill:"rgba(0,0,0,0)"}))}}.bind(this);this._zr.on("mousemove",u);var d=function(){if(t.model&&t.model.set("options.position",f.truncPosition(t.position)),this._zr.off("mousemove",u),this._zr.off("mouseup",d),this._zr.off("globalout",d),1==n){if(this._trigger("dropDrag",{target:t}),t.trigger("dragend"),1==this.eagleEye&&this.openEagleEye(this.eagleEyeNode),!_.isInGroup(t)){var e=this.isPosInGroup(this.allNodes,t);if(e)for(var i=0;i<this.allNodes.length;i++){var o=this.allNodes[i];if(_.isGroupNode(o)&&o.id===e.id&&o.id!==t.id){var r=this._getParentZr(t);r.remove(t),o.add(t);var s=_.isGroupNode(t)?t.position[0]+t.options.shape.x:t.position[0],a=_.isGroupNode(t)?t.position[1]+t.options.shape.y:t.position[1],h=this.parentX(e),l=this.parentY(e);t.attr("position",[s-h+o.options.shape.x,a-l+o.options.shape.y]),o.children().find(function(t){return"GROUP_RECT_NAME"===t.name}).attr("style",{fill:"rgba(0,0,0,0)"})}}}this.stepCounter()}}.bind(this);this._zr.on("mouseup",d),this._zr.on("globalout",d)},R.parentX=function(t){return t.parent&&_.isGroupNode(t.parent)&&this.group.id!==t.parent.id?t.position[0]+t.options.shape.x+this.parentX(t.parent):t.position[0]+t.options.shape.x},R.parentY=function(t){return t.parent&&_.isGroupNode(t.parent)&&this.group.id!==t.parent.id?t.position[1]+t.options.shape.y+this.parentY(t.parent):t.position[1]+t.options.shape.y},R.isPosInGroup=function(t,e){if(t.length>0){for(var i=null,n=0;n<t.length;n++){var o=t[n];if(_.isGroupNode(o)){var r=o.options.shape.width,a=o.options.shape.height,h=this.parentX(o),l=this.parentY(o),c=s.getRect(e,!0),u=c.width,d=c.height,p=c.x-u/2,f=c.y-d/2;if(p>=h&&f>=l&&p+u<=h+r&&f+d<=l+a){var g=o.children(),v=this.isPosInGroup(g,e);i=v?v:o;break}}}return i}return null;
},R.createNode=R.creatNode=function(t,e,i){if(!b[t])return null;var n=b[t],o=new n(e);return _.setUserData(o,i),o},R.childOfName=function(t){for(var e=[],i=this.allNodes,n=this.connectionManager.connectors,o=0;o<i.length;o++)i[o].model.get("options.name")&&i[o].model.get("options.name")==t?e.push(i[o]):i[o].model.get("userData.name")==t&&e.push(i[o]);for(var r=0;r<n.length;r++)n[r].model.get("options.name")&&n[r].model.get("options.name")==t?e.push(n[r]):n[r].model.get("userData.name")==t&&e.push(n[r]);return e.length>1?e:e[0]},R.findElements=function(t,e){for(var i=this.allNodes,n=this.connectionManager.connectors,o=[],r=0;r<i.length;r++){var s=i[r];t.call(e,s,r)&&o.push(s)}for(var a=0;a<n.length;a++){var h=n[a];t.call(e,h,a)&&o.push(h)}return o},R.findConnectorsByNode=function(t,e){var i=e||{},n=[];u.defaults(i,{startNode:!0});for(var o=this.connectionManager.connectors,r=0;r<o.length;r++){var s=o[r];i.startNode?s.startNode.id===t.id&&n.push(s):s.endNode.id===t.id&&n.push(s)}return n},R.setBackground=function(t,e){if(t&&t.length>0)if(this.model.set(g.BACKGROUND,t),"#"==t.substr(0,1)||"rgba"==t.substr(0,4))if(document.createElement("canvas").getContext){var i=new this.Shape.Rect({shape:{width:this._zr.getWidth(),height:this._zr.getHeight()},style:{fill:t},cursor:"default",z:-1});this._zr.add(i)}else this._dom.style.backgroundColor=t;else if("gridLine"==t)this.gridLineGroup=new o.Group,this.gridLine(.2),this._zr.add(this.gridLineGroup);else if(!document.createElement("canvas").getContext||e)this._dom.style.backgroundImage="url("+t+")",this._dom.style.backgroundRepeat="repeat";else{var n=new this.Shape.Image({position:[0,0],scale:[1,1],style:{x:0,y:0,image:t,width:this._zr.getWidth(),height:this._zr.getHeight()},cursor:"default",z:-1});this._zr.add(n)}},R.gridLine=function(t){for(var e=10,i=parseInt(this.getWidth()/e),n=0;n<=i;n++){var r=new o.Line({shape:{x1:n*e,y1:0,x2:n*e,y2:this.getHeight()},style:{lineDash:[1],opacity:t},z:0,draggable:!1,cursor:"default"});this.gridLineGroup.add(r)}for(var s=parseInt(this.getHeight()/e,e),a=0;a<=s;a++){var h=new o.Line({shape:{x1:0,y1:a*e,x2:this.getWidth(),y2:a*e},style:{lineDash:[1],opacity:t},z:0,draggable:!1,cursor:"default"});this.gridLineGroup.add(h)}},R.createLink=R.creatLink=function(t,e,i,n){var o=m.TYPE_STRAIGHT;if(i&&i.style&&i.style.lineType&&(o=i.style.lineType),!P[o])return null;var r=P[o],s=new r(t,e,i);return n&&s.model.set(g.USERDATA,u.clone(n)),s},R.refreshLineByNode=function(t){this.connectionManager.refreshLineByNode(t)},R.connectorEdit=function(t){var e=t.childOfName("lineText");if(e){var i=this.createTextArea(),n=T.getBoundingRect(e.style.text,e.style.textFont),o=1.2*s.getRect(e).width*this.nowZoom+10;i.style.width=1.2*s.getRect(e).width*this.nowZoom+"px",i.style.height=(2*n.height||12)*this.nowZoom+"px",i.style.border="1px dashed #2e2e2e",i.innerHTML=e.style.text,t.setStyle({text:{text:""}}),this._dom.appendChild(i),this._dom.style.position="relative",i.style.lineHeight=(1.2*n.lineHeight||12)+"px",i.style.top=(e.position[1]-n.height)*this.nowZoom+this.group.position[1]+"px",i.style.left=(e.position[0]-.55*n.width)*this.nowZoom+this.group.position[0]+"px",i.focus(),i.select(),this._textareaResize(n,i,o),i.onkeyup=function(){i.style.width=n.width<60?"80px":i.style.width,i.style.height=i.scrollHeight+"px"},i.onfocusout=function(){t.setStyle({text:{text:i.value||""}}),i.remove()}}},R.nodeEdit=function(t){var e=3.3,i=!1,n=this.createTextArea(),o=u.clone(t.style.text),r=T.getBoundingRect(o,t.style.textFont),a=r.width<25?1.2*r.width*this.nowZoom+10:36,h=(2*r.height||24)*this.nowZoom;n.style.width=a+"px",n.style.height=h+"px";var l=s.getRect(t),c=1.2*l.width*this.nowZoom;n.style.lineHeight=(1.2*r.lineHeight||14.4)+"px",n.style.border="1px dashed #2e2e2e",n.innerHTML=t.style.text,n.style.maxWidth=c+"px",this.setStyle(t,{text:""}),this._dom.appendChild(n),this._dom.style.position="relative";var d=1;"left"==t.style.textAlign&&(d=0),"right"==t.style.textAlign&&(d=2);var p=0;t.style.textPosition&&"bottom"==t.style.textPosition&&(p=1,c=e*l.width*this.nowZoom,n.style.maxWidth=c+"px"),t.style.textPosition&&"top"==t.style.textPosition&&(p=-1,c=e*l.width*this.nowZoom,n.style.maxWidth=c+"px"),n.style.top=(l.y-h/2+p*(l.height-r.height/2))*this.nowZoom+this.group.position[1]+"px",n.style.left=(l.x-d*a/2)*this.nowZoom+this.group.position[0]+"px",n.focus(),n.select(),n.onkeyup=function(){if(event.keyCode==E.ESCAPE)i=!0,n.blur();else{var e=T.getBoundingRect(n.value,t.style.textFont);this._textareaResize(e,n,c)}}.bind(this),n.onblur=function(){if(i)this.setStyle(t,{text:o});else{var e=this.handleWrap(n.value,n.style.maxWidth);this.setStyle(t,{text:e})}n.remove()}.bind(this)},R.createTextArea=function(){var t=document.createElement("textarea");return t.style.position="absolute",t.style.padding="6px",t.style.resize="none",t.style.whiteSpace="pre",t.style.lineHeight="125%",t.style.overflow="hidden",t.style.border="0",t.spellcheck=!1,t},R.handleWrap=function(t,e){var i=document.createElement("span");i.style.position="absolute",i.style.overflow="hidden",i.style.border="0",i.style.padding="0",i.style.left="0",i.style.top="0",this._dom.appendChild(i);var n=t.split("\n"),o="";return n.forEach(function(t,r){var s=t.length;if(0==s);else for(var a,h,l,c="",u=0;u<s;u++)a=t.charAt(u),i.innerHTML=i.innerHTML+a,h=i.clientWidth,l=Number(e.substring(0,e.length-2)),h>l?(o+=c,o+="\n",i.innerHTML=a,c=a):u==s-1?(o+=c+a,r<n.length-1&&(o+="\n"),i.innerHTML="",c=""):c+=a}),this._dom.removeChild(i),o},R._textareaResize=function(t,e,i){var n=0;e.style.width=0,e.style.width=1.2*t.width*this.nowZoom+"px",n=i<60?i:80,t.width<=n&&(e.style.width=n+"px"),e.style.height="0px",e.style.height=e.scrollHeight+"px",e.scrollHeight<=0&&(e.style.height="12px")},R.setStyle=function(t,e){t.setStyle(e),u.merge(t.model.get("options.style"),e,!0)},R.setShape=function(t,e){t.setShape(e),t.model&&u.merge(t.model.get("options.shape"),e,!0)},R.createAlarm=R.creatAlarm=function(t,e){var i=this.createNode("Group",{style:{fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)"}});i.isdraggable=!1;var n=this.createNode("Text",{style:{text:e.text,textFont:e.textFont,fill:e.textFill,textBaseline:"top"},selectable:!1,position:[2,0],z:2});n.isdraggable=!1,i.add(n),_.isInGroup(t)?t.parent.add(i):this.group.add(i);var o=i.getBoundingRect().width+2,r=i.getBoundingRect().height+6,s=[[0,0],[o,0],[o,r],[o-3,r],[o-6,r+3],[o-9,r],[0,r],[0,0]],a=this.createNode("Polyline",{shape:{points:s},style:{fill:e.textBackground,stroke:e.textBackground},selectable:!1,z:1});a.isdraggable=!1,i.add(a);var h=[t.position[0]+t.getBoundingRect().width-(i.getBoundingRect().width-6),t.position[1]-i.getBoundingRect().height-3];i.attr("position",h),t.alarm=i;var l=new v({});return l.set(g.ELEMENT_TYPE,g.ALARM),l.set(g.OPTIONS,u.clone(e)),l.set(g.RELATIONID,t.model.get(g.ID)),i.model=l,i},R.toDataURL=function(t){return f.toDataURL(this._zr,t)},R._releaseSelectNode=function(){if(this.dragSelectRect){for(var t=this.dragSelectRect.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name}),e=this.group.children().filter(function(t){return"GROUP_RECT_NAME"!==t.name}).map(function(t){return t.id}),i=this.dragSelectRect.position[0],n=this.dragSelectRect.position[1],o=0;o<t.length;o++){var r=t[o],s=_.isGroupNode(r)?r.position[0]+r.options.shape.x:r.position[0],a=_.isGroupNode(r)?r.position[1]+r.options.shape.y:r.position[1];this.dragSelectRect.remove(r),e.includes(r.id)||this.group.add(r),"connection"!==r.model.option.elementType&&(r.attr("position",[s+i,a+n]),this.connectionManager.refreshLineByNode(r))}this.dragSelectRect.off("mousedown"),this.group.remove(this.dragSelectRect)}},R._dragSelect=function(t,e,i){var n=this.group.position[0],o=this.group.position[1];this._releaseSelectNode(),this.dragSelectRect=new w({shape:{width:0,height:0},position:[(e-n)/this.nowZoom,(i-o)/this.nowZoom],childDraggable:!1,style:{lineDash:[2,2],fill:"rgba(239,222,221,0.7)",stroke:"#ddd"}}),this.dragSelectRect.type="dragSelect",this.group.add(this.dragSelectRect),this.drag(this.dragSelectRect);var r=function(t){var r=e<=t.offsetX?e:t.offsetX,s=i<=t.offsetY?i:t.offsetY,a=Math.abs(t.offsetX-e),h=Math.abs(t.offsetY-i);this.dragSelectRect.shape={width:a/this.nowZoom,height:h/this.nowZoom},this.dragSelectRect.setProperties({shape:{width:a/this.nowZoom,height:h/this.nowZoom},position:[(r-n)/this.nowZoom,(s-o)/this.nowZoom]})}.bind(this);this._zr.on("mousemove",r);var a=function(t){this._zr.off("mousemove",r),this._zr.off("mouseup",a),this._zr.off("globalout",a);var e=this,i=this.group.children().filter(function(t){return t.id!==e.dragSelectRect.id&&t.model&&"connection"!==t.model.option.elementType}),n=this.group.children().filter(function(t){return t.model&&"connection"===t.model.option.elementType}),o=this.dragSelectRect.position[0],h=this.dragSelectRect.position[1],l=this.dragSelectRect.options.shape.width,c=this.dragSelectRect.options.shape.height,u=0;i.forEach(function(t){var i=s.getRect(t,!0),n=i.width,r=i.height,a=i.x-n/2,d=i.y-r/2;a>=o&&d>=h&&a+n<=o+l&&d+r<=h+c&&(e.group.remove(t),e.dragSelectRect.add(t),e.selectedNodes.push(t),t.attr("position",[t.position[0]-o,t.position[1]-h]),u++)}),n.forEach(function(t){var i=e.dragSelectRect.children().find(function(e){return e.id===t.startNode.id}),n=e.dragSelectRect.children().find(function(e){return e.id===t.endNode.id});i&&n?(e.group.remove(t),e.dragSelectRect.add(t),e.selectedNodes.push(t),e.connectionManager.refreshLineByNode(t.startNode)):(i||n)&&e.group.remove(t)}),u?this.dragSelectRect.childOfName("GROUP_RECT_NAME").attr("style",{fill:"rgba(0,0,0,0)"}):(this.dragSelectRect.off("mousedown"),this.group.remove(this.dragSelectRect)),this.dragSelectRect.model.set("options.position",f.truncPosition(this.dragSelectRect.position)),this.dragSelectRect.model.set("options.shape",this.dragSelectRect.shape)}.bind(this);this._zr.on("mouseup",a),this._zr.on("globalout",a)},R._groupDragHandler=function(t,e){var i=this.group.position,n=this.group.position[0],o=this.group.position[1],r=function(r){var s=this.group.getBoundingRect().width*this.nowZoom,a=this.group.getBoundingRect().height*this.nowZoom,h=this.group.getBoundingRect().x*this.nowZoom,l=this.group.getBoundingRect().y*this.nowZoom,c=[10-(s+h),10-(a+l)],u=[this._zr.getWidth()-h-10,this._zr.getHeight()-l-10],d=r.offsetX-t,p=r.offsetY-e;i[0]=n+d,i[1]=o+p,i[0]>u[0]||i[1]>u[1]||i[0]<c[0]||i[1]<c[1]||(this.group.attr("position",i),1==this.eagleEye&&this.minimap.updataSelectionPosition(i,this.nowZoom))}.bind(this);this._zr.on("mousemove",r);var s=function(){this._zr.off("mousemove",r),this._zr.off("mouseup",s),this._zr.off("globalout",s)}.bind(this);this._zr.on("mouseup",s),this._zr.on("globalout",s)},R.initScale=function(){var t=this.group.getBoundingRect().width,e=this.group.getBoundingRect().height,i=this.getWidth(),n=this.getHeight(),o=1,r=[];t/e>i/n?t>i&&(o=i/t):e>n&&(o=n/e),r[0]=Math.abs(this.group.getBoundingRect().x)*o,r[1]=Math.abs(this.group.getBoundingRect().y)*o,this.group.attr("position",[r[0],r[1]]),this.group.attr("scale",[o,o]),this.initScaleRatio=o;var s=[r[0],r[1],this.initScaleRatio,t,e];return s},R.zrCenter=function(t){var e,i=this.group.position;e=u.isArray(t)?u.extend({},{minX:t[0],minY:t[1],maxX:t[2],maxY:t[3]}):u.extend({},t),i[0]=this._zr.dom.offsetWidth/2-(e.minX+(e.maxX-e.minX)/2),i[1]=this._zr.dom.offsetHeight/2-(e.minY+(e.maxY-e.minY)/2),this.group.attr("position",i)},R.stepCounter=function(){this.stepJson.splice(this.step,this.stepJson.length-this.step),this.step+=1;var t=this.toJson();this.stepJson.push(JSON.stringify(t))},R.zrScale=function(t){if(t){var e=0;if("narrowing"==t&&(e=-.07,this.zoom(e,this._zr.getWidth()/2,this._zr.getHeight()/2)),"enlarge"==t&&(e=.07,this.zoom(e,this._zr.getWidth()/2,this._zr.getHeight()/2)),!isNaN(t)){var i=this.group;if(i){var n=t/i.scale[0];this._zoom=t,this.nowZoom=t,this.setScale(this._zr.getWidth()/2,this._zr.getHeight()/2,n)}}}else this._zr.on("mousewheel",u.bind(function(t){y.stop(t.event);var e=t.wheelDelta>0?.07:-.07;this.zoom(e,this._zr.getWidth()/2,this._zr.getHeight()/2)},this))},R.zoom=function(t,e,i){if(0!=this.canScale){var n=this.group;if(n){var o=this._zoom=this._zoom||1;o+=t,o=Number(o.toFixed(2));var r=o/this._zoom;if(o>this.options.maxScale||o<this.options.minScale)return;this._zoom=o,this.nowZoom=o,this.setScale(e,i,r)}}},R.setScale=function(t,e,i){var n=this.group,o=n.position,r=n.scale;o[0]-=(t-o[0])*(i-1),o[1]-=(e-o[1])*(i-1),r[0]*=i,r[1]*=i,n.attr("position",[o[0],o[1]]),n.attr("scale",[r[0],r[1]]),1==this.eagleEye&&this.minimap.updataSelection(o[0],o[1],i,this.nowZoom)},R.openEagleEye=function(t){this.eagleEye=!0,this.eagleEyeNode=t;var e=u.clone(this.group.position),i=u.clone(this.group.scale);this.group.attr("position",[0,0]),this.group.attr("scale",[1,1]);var n=this.initScale(),o=this.toDataURL();this.group.attr("position",e),this.group.attr("scale",i),this.minimap?this.minimap.updataMap(o,this.group.getBoundingRect()):(this.minimap=new r(this,this.group.position,this.group.getBoundingRect(),t,n,o),setTimeout(u.bind(function(){this.openEagleEye(this.eagleEyeNode)},this),10)),this.minimap.selection.addEventListener("mousedown",function(t){var e=t.clientX,i=t.clientY,n=Number(this.minimap.selection.style.left.substring(0,this.minimap.selection.style.left.length-2)),o=Number(this.minimap.selection.style.top.substring(0,this.minimap.selection.style.top.length-2)),r=function(t){var r=t.clientX-e,s=t.clientY-i;this.minimap.selection.style.left=n+r+"px",this.minimap.selection.style.top=o+s+"px",this.minimap.updataGroupPosition(this.group,this.nowZoom)}.bind(this);this.minimap.selection.addEventListener("mousemove",r);var s=function(){this.minimap.selection.removeEventListener("mousemove",r),this.minimap.selection.removeEventListener("mouseup",s)}.bind(this);this.minimap.selection.addEventListener("mouseup",s)}.bind(this))},R.refreshGroupByNode=function(t){if(_.isInGroup(t)){var e={width:t.shape.width,height:t.shape.height,position:t.position,isMove:0,node:t};t.parent.modifyGroupRect(e)}this.connectionManager.refreshLineByNode(t),_.isGroupNode(t)&&t.each(function(t){this.connectionManager.refreshLineByNode(t)}.bind(this))},u.mixin(n,l);var L=new Date-0,k={},O="_fishTopoFlow_instance_",I={version:"3.0.0",dependencies:{zrender:"3.6.3"}};I.init=function(t,e){if(!t)throw new Error("Initialize failed: invalid dom.");e=e||{},u.defaults(e,{type:"flow",linkModify:!1,textEditable:!1,roam:!0,mouseMode:"default",tooltip:{show:!0},isAnimationEnabled:!0,scaleable:!1,rotatable:!1,beforeDelete:null,beforeCreate:null,maxScale:1.7,minScale:.3});var i=new n(t,e);return i.init(),i.Flow=_,i.id="ft_"+L++,k[i.id]=i,t.setAttribute&&t.setAttribute(O,i.id),i},I.getInstanceByDom=function(t){var e=t.getAttribute(O);return k[e]},I.dispose=function(t){var e;u.isDom(t)?e=I.getInstanceByDom(t):"string"==typeof t&&(e=k[t]),e instanceof I&&!e.isDisposed()&&e.dispose()},I.graphic=o,I.node=f.registerFlowNode(b),I.link=P,I.layout=C,I.Flow=_,I.constants=g,I.util=s,I.util.initImagePool=N.initImagePool,u.each(["map","each","filter","indexOf","inherits","reduce","filter","bind","curry","isArray","isString","isObject","isFunction","extend","merge","mergeAll"],function(t){I.util[t]=u[t]}),t.exports=I},function(t,e){Function.prototype.bind||(Function.prototype.bind=function(t){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var e=Array.prototype.slice.call(arguments,1),i=this,n=function(){},o=function(){return i.apply(this instanceof n&&t?this:t||window,e.concat(Array.prototype.slice.call(arguments)))};return n.prototype=this.prototype,o.prototype=new n,o}),"remove"in Element.prototype||(Element.prototype.remove=function(){this.parentNode&&this.parentNode.removeChild(this)}),String.prototype.endsWith||(String.prototype.endsWith=function(t,e){var i=this.toString();("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e>i.length)&&(e=i.length),e-=t.length;var n=i.indexOf(t,e);return n!==-1&&n===e})},function(t,e,i){"use strict";function n(t){if(!t.__isHover){if(t.__hoverStlDirty){var e=t.style.stroke,i=t.style.fill,n=t.__hoverStl,o=y.lift;n.fill=n.fill||i&&(i instanceof _?i:o(i,-.1)),n.stroke=n.stroke||e&&(e instanceof _?e:o(e,-.1));var r={};for(var s in n)n.hasOwnProperty(s)&&(r[s]=t.style[s]);t.__normalStl=r,t.__hoverStlDirty=!1}t.setStyle(t.__hoverStl),t.z2+=1,t.__isHover=!0}}function o(t){if(t.__isHover){var e=t.__normalStl;e&&t.setStyle(e),t.z2-=1,t.__isHover=!1}}function r(t){"group"===t.type||"GroupNode"===t.type?t.traverse(function(t){"group"!==t.type&&n(t)}):n(t)}function s(t){"group"===t.type?t.traverse(function(t){"group"!==t.type&&o(t)}):o(t)}function a(t,e){t.__hoverStl=t.hoverStyle||e||{},t.__hoverStlDirty=!0}function h(){!this.__isEmphasis&&r(this)}function l(){!this.__isEmphasis&&s(this)}function c(){this.__isEmphasis=!0,r(this)}function u(){this.__isEmphasis=!1,s(this)}function d(t,e,i,n,o){var r=t?"Update":"",s=n&&n.getShallow("animationDuration"+r),a=n&&n.getShallow("animationEasing"+r);n&&n.getShallow("animation")?e.animateTo(i,s,a,o):(e.attr(i),o&&o())}var p=i(5),f=i(6),g=Math.round,v=i(7),y=i(20),m=i(14),x=i(15),_=i(42),b=i(43),w={};w.Util=p,w.Group=i(44),w.Image=i(45),w.Text=i(46),w.textContain=i(26),w.Circle=i(47),w.Sector=i(48),w.Ring=i(51),w.Polygon=i(52),w.Polyline=i(56),w.Rect=i(57),w.Line=i(58),w.BezierCurve=i(59),w.Arc=i(60),w.LinearGradient=i(61),w.RadialGradient=i(62),w.BoundingRect=i(27),w.States=i(63),w.extendShape=function(t){return v.extend(t)},w.extendPath=function(t,e){return f.extendFromString(t,e)},w.makePath=function(t,e,i,n){var o=f.createFromString(t,e);b.call(o);var r=o.getBoundingRect();if(i){var s=r.width/r.height;if("center"===n){var a,h=i.height*s;h<=i.width?a=i.height:(h=i.width,a=h/s);var l=i.x+i.width/2,c=i.y+i.height/2;i.x=l-h/2,i.y=c-a/2,i.width=h,i.height=a}this.resizePath(o,i)}return p.inherits(o,b),o},w.mergePath=f.mergePath,w.resizePath=function(t,e){if(t.applyTransform){var i=t.getBoundingRect(),n=i.calculateTransform(e);t.applyTransform(n)}},w.subPixelOptimizeLine=function(t){var e=w.subPixelOptimize,i=t.shape,n=t.style.lineWidth;return g(2*i.x1)===g(2*i.x2)&&(i.x1=i.x2=e(i.x1,n,!0)),g(2*i.y1)===g(2*i.y2)&&(i.y1=i.y2=e(i.y1,n,!0)),t},w.subPixelOptimizeRect=function(t){var e=w.subPixelOptimize,i=t.shape,n=t.style.lineWidth,o=i.x,r=i.y,s=i.width,a=i.height;return i.x=e(i.x,n,!0),i.y=e(i.y,n,!0),i.width=Math.max(e(o+s,n,!1)-i.x,0===s?0:1),i.height=Math.max(e(r+a,n,!1)-i.y,0===a?0:1),t},w.subPixelOptimize=function(t,e,i){var n=g(2*t);return(n+g(e))%2===0?n/2:(n+(i?1:-1))/2},w.doEnterHover=r,w.doLeaveHover=s,w.setElementHoverStl=a,w.setHoverStyle=function(t,e){"group"===t.type?t.traverse(function(t){"group"!==t.type&&a(t,e)}):a(t,e),t.on("mouseover",h).on("mouseout",l),t.on("emphasis",c).on("normal",u)},w.setNormalStyle=function(t,e){if(t.__normalStl)for(var i in e)t.__normalStl.hasOwnProperty(i)&&(t.__normalStl[i]=e[i])},w.setText=function(t,e,i){var n=e.getShallow("position")||"inside",o=n.indexOf("inside")>=0?"white":i,r=e.getModel("textStyle");p.extend(t,{textDistance:e.getShallow("distance")||5,textFont:r.getFont(),textPosition:n,textFill:r.getTextColor()||o})},w.updateProps=p.curry(d,!0),w.initProps=p.curry(d,!1),w.getTransform=function(t,e){for(var i=m.identity([]);t&&t!==e;)m.mul(i,t.getLocalTransform(),i),t=t.parent;return i},w.applyTransform=function(t,e,i){return i&&(e=m.invert([],e)),x.applyTransform([],t,e)},w.transformDirection=function(t,e,i){var n=0===e[4]||0===e[5]||0===e[0]?1:Math.abs(2*e[4]/e[0]),o=0===e[4]||0===e[5]||0===e[2]?1:Math.abs(2*e[4]/e[2]),r=["left"===t?-n:"right"===t?n:0,"top"===t?-o:"bottom"===t?o:0];return r=w.applyTransform(r,e,i),Math.abs(r[0])>Math.abs(r[1])?r[0]>0?"right":"left":r[1]>0?"bottom":"top"},t.exports=w},function(t,e){function i(t,e){j[t]=e}function n(t){if(null==t||"object"!=typeof t)return t;var e=t,i=F.call(t);if("[object Array]"===i){e=[];for(var o=0,r=t.length;o<r;o++)e[o]=n(t[o])}else if(H[i]){var s=t.constructor;if(t.constructor.from)e=s.from(t);else{e=new s(t.length);for(var o=0,r=t.length;o<r;o++)e[o]=n(t[o])}}else if(!D[i]&&!O(t)&&!T(t)){e={};for(var a in t)t.hasOwnProperty(a)&&(e[a]=n(t[a]))}return e}function o(t,e,i){if(!P(e)||!P(t))return i?n(e):t;for(var r in e)if(e.hasOwnProperty(r)){var s=t[r],a=e[r];!P(a)||!P(s)||_(a)||_(s)||T(a)||T(s)||C(a)||C(s)||O(a)||O(s)?!i&&r in t||(t[r]=n(e[r],!0)):o(s,a,i)}return t}function r(t,e){for(var i=t[0],n=1,r=t.length;n<r;n++)i=o(i,t[n],e);return i}function s(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function a(t,e,i){for(var n in e)e.hasOwnProperty(n)&&(i?null!=e[n]:null==t[n])&&(t[n]=e[n]);return t}function h(){return X||(X=Z().getContext("2d")),X}function l(t,e){if(t){if(t.indexOf)return t.indexOf(e);for(var i=0,n=t.length;i<n;i++)if(t[i]===e)return i}return-1}function c(t,e){function i(){}var n=t.prototype;i.prototype=e.prototype,t.prototype=new i;for(var o in n)t.prototype[o]=n[o];t.prototype.constructor=t,t.superClass=e}function u(t,e,i){t="prototype"in t?t.prototype:t,e="prototype"in e?e.prototype:e,a(t,e,i)}function d(t){if(t)return"string"!=typeof t&&"number"==typeof t.length}function p(t,e,i){if(t&&e)if(t.forEach&&t.forEach===Y)t.forEach(e,i);else if(t.length===+t.length)for(var n=0,o=t.length;n<o;n++)e.call(i,t[n],n,t);else for(var r in t)t.hasOwnProperty(r)&&e.call(i,t[r],r,t)}function f(t,e,i){if(t&&e){if(t.map&&t.map===U)return t.map(e,i);for(var n=[],o=0,r=t.length;o<r;o++)n.push(e.call(i,t[o],o,t));return n}}function g(t,e,i,n){if(t&&e){if(t.reduce&&t.reduce===q)return t.reduce(e,i,n);for(var o=0,r=t.length;o<r;o++)i=e.call(n,i,t[o],o,t);return i}}function v(t,e,i){if(t&&e){if(t.filter&&t.filter===W)return t.filter(e,i);for(var n=[],o=0,r=t.length;o<r;o++)e.call(i,t[o],o,t)&&n.push(t[o]);return n}}function y(t,e,i){if(t&&e)for(var n=0,o=t.length;n<o;n++)if(e.call(i,t[n],n,t))return t[n]}function m(t,e){var i=V.call(arguments,2);return function(){return t.apply(e,i.concat(V.call(arguments)))}}function x(t){var e=V.call(arguments,1);return function(){return t.apply(this,e.concat(V.call(arguments)))}}function _(t){return"[object Array]"===F.call(t)}function b(t){return"function"==typeof t}function w(t){return"[object String]"===F.call(t)}function P(t){var e=typeof t;return"function"===e||!!t&&"object"==e}function C(t){return!!D[F.call(t)]}function T(t){return"object"==typeof t&&"number"==typeof t.nodeType&&"object"==typeof t.ownerDocument}function N(t){return t!==t}function S(t){for(var e=0,i=arguments.length;e<i;e++)if(null!=arguments[e])return arguments[e]}function M(t,e){return null!=t?t:e}function A(t,e,i){return null!=t?t:null!=e?e:i}function E(){return Function.call.apply(V,arguments)}function R(t){if("number"==typeof t)return[t,t,t,t];var e=t.length;return 2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t}function L(t,e){if(!t)throw new Error(e)}function k(t){t[Q]=!0}function O(t){return t[Q]}function I(t){t&&p(t,function(t,e){this.set(e,t)},this)}function z(t){return new I(t)}function B(){}var D={"[object Function]":1,"[object RegExp]":1,"[object Date]":1,"[object Error]":1,"[object CanvasGradient]":1,"[object CanvasPattern]":1,"[object Image]":1,"[object Canvas]":1},H={"[object Int8Array]":1,"[object Uint8Array]":1,"[object Uint8ClampedArray]":1,"[object Int16Array]":1,"[object Uint16Array]":1,"[object Int32Array]":1,"[object Uint32Array]":1,"[object Float32Array]":1,"[object Float64Array]":1},F=Object.prototype.toString,G=Array.prototype,Y=G.forEach,W=G.filter,V=G.slice,U=G.map,q=G.reduce,j={},Z=function(){return j.createCanvas()};j.createCanvas=function(){return document.createElement("canvas")};var X,Q="__ec_primitive__",J="_ec_",K=4;I.prototype={constructor:I,get:function(t){return this[J+t]},set:function(t,e){return this[J+t]=e,e},each:function(t,e){void 0!==e&&(t=m(t,e));for(var i in this)this.hasOwnProperty(i)&&t(this[i],i.slice(K))},removeKey:function(t){delete this[J+t]}},e.$override=i,e.clone=n,e.merge=o,e.mergeAll=r,e.extend=s,e.defaults=a,e.createCanvas=Z,e.getContext=h,e.indexOf=l,e.inherits=c,e.mixin=u,e.isArrayLike=d,e.each=p,e.map=f,e.reduce=g,e.filter=v,e.find=y,e.bind=m,e.curry=x,e.isArray=_,e.isFunction=b,e.isString=w,e.isObject=P,e.isBuiltInObject=C,e.isDom=T,e.eqNaN=N,e.retrieve=S,e.retrieve2=M,e.retrieve3=A,e.slice=E,e.normalizeCssArray=R,e.assert=L,e.setAsPrimitive=k,e.isPrimitive=O,e.createHashMap=z,e.noop=B},function(t,e,i){function n(t,e,i,n,o,r,s,a,h,l,c){var u=h*(v/180),d=g(u)*(t-i)/2+f(u)*(e-n)/2,y=-1*f(u)*(t-i)/2+g(u)*(e-n)/2,_=d*d/(s*s)+y*y/(a*a);_>1&&(s*=p(_),a*=p(_));var b=(o===r?-1:1)*p((s*s*(a*a)-s*s*(y*y)-a*a*(d*d))/(s*s*(y*y)+a*a*(d*d)))||0,w=b*s*y/a,P=b*-a*d/s,C=(t+i)/2+g(u)*w-f(u)*P,T=(e+n)/2+f(u)*w+g(u)*P,N=x([1,0],[(d-w)/s,(y-P)/a]),S=[(d-w)/s,(y-P)/a],M=[(-1*d-w)/s,(-1*y-P)/a],A=x(S,M);m(S,M)<=-1&&(A=v),m(S,M)>=1&&(A=0),0===r&&A>0&&(A-=2*v),1===r&&A<0&&(A+=2*v),c.addData(l,C,T,s,a,N,A,u,r)}function o(t){if(!t)return[];var e,i=t.replace(/-/g," -").replace(/  /g," ").replace(/ /g,",").replace(/,,/g,",");for(e=0;e<d.length;e++)i=i.replace(new RegExp(d[e],"g"),"|"+d[e]);var o,r=i.split("|"),s=0,a=0,h=new c,l=c.CMD;for(e=1;e<r.length;e++){var u,p=r[e],f=p.charAt(0),g=0,v=p.slice(1).replace(/e,-/g,"e-").split(",");v.length>0&&""===v[0]&&v.shift();for(var y=0;y<v.length;y++)v[y]=parseFloat(v[y]);for(;g<v.length&&!isNaN(v[g])&&!isNaN(v[0]);){var m,x,_,b,w,P,C,T=s,N=a;switch(f){case"l":s+=v[g++],a+=v[g++],u=l.L,h.addData(u,s,a);break;case"L":s=v[g++],a=v[g++],u=l.L,h.addData(u,s,a);break;case"m":s+=v[g++],a+=v[g++],u=l.M,h.addData(u,s,a),f="l";break;case"M":s=v[g++],a=v[g++],u=l.M,h.addData(u,s,a),f="L";break;case"h":s+=v[g++],u=l.L,h.addData(u,s,a);break;case"H":s=v[g++],u=l.L,h.addData(u,s,a);break;case"v":a+=v[g++],u=l.L,h.addData(u,s,a);break;case"V":a=v[g++],u=l.L,h.addData(u,s,a);break;case"C":u=l.C,h.addData(u,v[g++],v[g++],v[g++],v[g++],v[g++],v[g++]),s=v[g-2],a=v[g-1];break;case"c":u=l.C,h.addData(u,v[g++]+s,v[g++]+a,v[g++]+s,v[g++]+a,v[g++]+s,v[g++]+a),s+=v[g-2],a+=v[g-1];break;case"S":m=s,x=a;var S=h.len(),M=h.data;o===l.C&&(m+=s-M[S-4],x+=a-M[S-3]),u=l.C,T=v[g++],N=v[g++],s=v[g++],a=v[g++],h.addData(u,m,x,T,N,s,a);break;case"s":m=s,x=a;var S=h.len(),M=h.data;o===l.C&&(m+=s-M[S-4],x+=a-M[S-3]),u=l.C,T=s+v[g++],N=a+v[g++],s+=v[g++],a+=v[g++],h.addData(u,m,x,T,N,s,a);break;case"Q":T=v[g++],N=v[g++],s=v[g++],a=v[g++],u=l.Q,h.addData(u,T,N,s,a);break;case"q":T=v[g++]+s,N=v[g++]+a,s+=v[g++],a+=v[g++],u=l.Q,h.addData(u,T,N,s,a);break;case"T":m=s,x=a;var S=h.len(),M=h.data;o===l.Q&&(m+=s-M[S-4],x+=a-M[S-3]),s=v[g++],a=v[g++],u=l.Q,h.addData(u,m,x,s,a);break;case"t":m=s,x=a;var S=h.len(),M=h.data;o===l.Q&&(m+=s-M[S-4],x+=a-M[S-3]),s+=v[g++],a+=v[g++],u=l.Q,h.addData(u,m,x,s,a);break;case"A":_=v[g++],b=v[g++],w=v[g++],P=v[g++],C=v[g++],T=s,N=a,s=v[g++],a=v[g++],u=l.A,n(T,N,s,a,P,C,_,b,w,u,h);break;case"a":_=v[g++],b=v[g++],w=v[g++],P=v[g++],C=v[g++],T=s,N=a,s+=v[g++],a+=v[g++],u=l.A,n(T,N,s,a,P,C,_,b,w,u,h)}}"z"!==f&&"Z"!==f||(u=l.Z,h.addData(u)),o=u}return h.toStatic(),h}function r(t,e){var i=o(t);return e=e||{},e.buildPath=function(t){if(t.setData){t.setData(i.data);var e=t.getContext();e&&t.rebuildPath(e)}else{var e=t;i.rebuildPath(e)}},e.applyTransform=function(t){u(i,t),this.dirty(!0)},e}function s(t,e){return new l(r(t,e))}function a(t,e){return l.extend(r(t,e))}function h(t,e){for(var i=[],n=t.length,o=0;o<n;o++){var r=t[o];r.path||r.createPathProxy(),r.__dirtyPath&&r.buildPath(r.path,r.shape,!0),i.push(r.path)}var s=new l(e);return s.createPathProxy(),s.buildPath=function(t){t.appendPath(i);var e=t.getContext();e&&t.rebuildPath(e)},s}var l=i(7),c=i(30),u=i(41),d=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"],p=Math.sqrt,f=Math.sin,g=Math.cos,v=Math.PI,y=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])},m=function(t,e){return(t[0]*e[0]+t[1]*e[1])/(y(t)*y(e))},x=function(t,e){return(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(m(t,e))};e.createFromString=s,e.extendFromString=a,e.mergePath=h},function(t,e,i){function n(t){o.call(this,t),this.path=null}var o=i(8),r=i(5),s=i(30),a=i(33),h=i(40),l=h.prototype.getCanvasPattern,c=Math.abs,u=new s((!0));n.prototype={constructor:n,type:"path",__dirtyPath:!0,strokeContainThreshold:5,brush:function(t,e){var i=this.style,n=this.path||u,o=i.hasStroke(),r=i.hasFill(),s=i.fill,a=i.stroke,h=r&&!!s.colorStops,c=o&&!!a.colorStops,d=r&&!!s.image,p=o&&!!a.image;if(i.bind(t,this,e),this.setTransform(t),this.__dirty){var f;h&&(f=f||this.getBoundingRect(),this._fillGradient=i.getGradient(t,s,f)),c&&(f=f||this.getBoundingRect(),this._strokeGradient=i.getGradient(t,a,f))}h?t.fillStyle=this._fillGradient:d&&(t.fillStyle=l.call(s,t)),c?t.strokeStyle=this._strokeGradient:p&&(t.strokeStyle=l.call(a,t));var g=i.lineDash,v=i.lineDashOffset,y=!!t.setLineDash,m=this.getGlobalScale();n.setScale(m[0],m[1]),this.__dirtyPath||g&&!y&&o?(n.beginPath(t),g&&!y&&(n.setLineDash(g),n.setLineDashOffset(v)),this.buildPath(n,this.shape,!1),this.path&&(this.__dirtyPath=!1)):(t.beginPath(),this.path.rebuildPath(t)),r&&n.fill(t),g&&y&&(t.setLineDash(g),t.lineDashOffset=v),o&&n.stroke(t),g&&y&&t.setLineDash([]),this.restoreTransform(t),null!=i.text&&this.drawRectText(t,this.getBoundingRect())},buildPath:function(t,e,i){},createPathProxy:function(){this.path=new s},getBoundingRect:function(){var t=this._rect,e=this.style,i=!t;if(i){var n=this.path;n||(n=this.path=new s),this.__dirtyPath&&(n.beginPath(),this.buildPath(n,this.shape,!1)),t=n.getBoundingRect()}if(this._rect=t,e.hasStroke()){var o=this._rectWithStroke||(this._rectWithStroke=t.clone());if(this.__dirty||i){o.copy(t);var r=e.lineWidth,a=e.strokeNoScale?this.getLineScale():1;e.hasFill()||(r=Math.max(r,this.strokeContainThreshold||4)),a>1e-10&&(o.width+=r/a,o.height+=r/a,o.x-=r/a/2,o.y-=r/a/2)}return o}return t},contain:function(t,e){var i=this.transformCoordToLocal(t,e),n=this.getBoundingRect(),o=this.style;if(t=i[0],e=i[1],n.contain(t,e)){var r=this.path.data;if(o.hasStroke()){var s=o.lineWidth,h=o.strokeNoScale?this.getLineScale():1;if(h>1e-10&&(o.hasFill()||(s=Math.max(s,this.strokeContainThreshold)),a.containStroke(r,s/h,t,e)))return!0}if(o.hasFill())return a.contain(r,t,e)}return!1},dirty:function(t){null==t&&(t=!0),t&&(this.__dirtyPath=t,this._rect=null),this.__dirty=!0,this.__zr&&this.__zr.refresh(),this.__clipTarget&&this.__clipTarget.dirty()},animateShape:function(t){return this.animate("shape",t)},attrKV:function(t,e){"shape"===t?(this.setShape(e),this.__dirtyPath=!0,this._rect=null):o.prototype.attrKV.call(this,t,e)},setShape:function(t,e){var i=this.shape;if(i){if(r.isObject(t))for(var n in t)t.hasOwnProperty(n)&&(i[n]=t[n]);else i[t]=e;this.dirty(!0)}return this},getLineScale:function(){var t=this.transform;return t&&c(t[0]-1)>1e-10&&c(t[3]-1)>1e-10?Math.sqrt(c(t[0]*t[3]-t[2]*t[1])):1}},n.extend=function(t){var e=function(e){n.call(this,e),t.style&&this.style.extendFrom(t.style,!1);var i=t.shape;if(i){this.shape=this.shape||{};var o=this.shape;for(var r in i)!o.hasOwnProperty(r)&&i.hasOwnProperty(r)&&(o[r]=i[r])}t.init&&t.init.call(this,e)};r.inherits(e,n);for(var i in t)"style"!==i&&"shape"!==i&&(e.prototype[i]=t[i]);return e},r.inherits(n,o);var d=n;t.exports=d},function(t,e,i){function n(t){t=t||{},s.call(this,t);for(var e in t)t.hasOwnProperty(e)&&"style"!==e&&(this[e]=t[e]);this.style=new r(t.style,this),this._rect=null,this.__clipPaths=[]}var o=i(5),r=i(9),s=i(10),a=i(24);n.prototype={constructor:n,type:"displayable",__dirty:!0,invisible:!1,z:0,z2:0,zlevel:0,draggable:!1,dragging:!1,silent:!1,culling:!1,cursor:"pointer",rectHover:!1,progressive:-1,beforeBrush:function(t){},afterBrush:function(t){},brush:function(t,e){},getBoundingRect:function(){},contain:function(t,e){return this.rectContain(t,e)},traverse:function(t,e){t.call(e,this)},rectContain:function(t,e){var i=this.transformCoordToLocal(t,e),n=this.getBoundingRect();return n.contain(i[0],i[1])},dirty:function(){this.__dirty=!0,this._rect=null,this.__zr&&this.__zr.refresh();
},animateStyle:function(t){return this.animate("style",t)},attrKV:function(t,e){"style"!==t?s.prototype.attrKV.call(this,t,e):this.style.set(e)},setStyle:function(t,e){return this.style.set(t,e),this.dirty(!1),this},useStyle:function(t){return this.style=new r(t,this),this.dirty(!1),this}},o.inherits(n,s),o.mixin(n,a);var h=n;t.exports=h},function(t,e){function i(t,e,i){var n=null==e.x?0:e.x,o=null==e.x2?1:e.x2,r=null==e.y?0:e.y,s=null==e.y2?0:e.y2;e.global||(n=n*i.width+i.x,o=o*i.width+i.x,r=r*i.height+i.y,s=s*i.height+i.y);var a=t.createLinearGradient(n,r,o,s);return a}function n(t,e,i){var n=i.width,o=i.height,r=Math.min(n,o),s=null==e.x?.5:e.x,a=null==e.y?.5:e.y,h=null==e.r?.5:e.r;e.global||(s=s*n+i.x,a=a*o+i.y,h*=r);var l=t.createRadialGradient(s,a,0,s,a,h);return l}var o=[["shadowBlur",0],["shadowOffsetX",0],["shadowOffsetY",0],["shadowColor","#000"],["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]],r=function(t,e){this.extendFrom(t,!1),this.host=e};r.prototype={constructor:r,host:null,fill:"#000",stroke:null,opacity:1,lineDash:null,lineDashOffset:0,shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,lineWidth:1,strokeNoScale:!1,text:null,font:null,textFont:null,fontStyle:null,fontWeight:null,fontSize:null,fontFamily:null,textTag:null,textFill:"#000",textStroke:null,textWidth:null,textHeight:null,textStrokeWidth:0,textLineHeight:null,textPosition:"inside",textRect:null,textOffset:null,textAlign:null,textVerticalAlign:null,textDistance:5,textShadowColor:"transparent",textShadowBlur:0,textShadowOffsetX:0,textShadowOffsetY:0,textBoxShadowColor:"transparent",textBoxShadowBlur:0,textBoxShadowOffsetX:0,textBoxShadowOffsetY:0,transformText:!1,textRotation:0,textOrigin:null,textBackgroundColor:null,textBorderColor:null,textBorderWidth:0,textBorderRadius:0,textPadding:null,rich:null,truncate:null,blend:null,bind:function(t,e,i){for(var n=this,r=i&&i.style,s=!r,a=0;a<o.length;a++){var h=o[a],l=h[0];(s||n[l]!==r[l])&&(t[l]=n[l]||h[1])}if((s||n.fill!==r.fill)&&(t.fillStyle=n.fill),(s||n.stroke!==r.stroke)&&(t.strokeStyle=n.stroke),(s||n.opacity!==r.opacity)&&(t.globalAlpha=null==n.opacity?1:n.opacity),(s||n.blend!==r.blend)&&(t.globalCompositeOperation=n.blend||"source-over"),this.hasStroke()){var c=n.lineWidth;t.lineWidth=c/(this.strokeNoScale&&e&&e.getLineScale?e.getLineScale():1)}},hasFill:function(){var t=this.fill;return null!=t&&"none"!==t},hasStroke:function(){var t=this.stroke;return null!=t&&"none"!==t&&this.lineWidth>0},extendFrom:function(t,e){if(t)for(var i in t)!t.hasOwnProperty(i)||e!==!0&&(e===!1?this.hasOwnProperty(i):null==t[i])||(this[i]=t[i])},set:function(t,e){"string"==typeof t?this[t]=e:this.extendFrom(t,!0)},clone:function(){var t=new this.constructor;return t.extendFrom(this,!0),t},getGradient:function(t,e,o){for(var r="radial"===e.type?n:i,s=r(t,e,o),a=e.colorStops,h=0;h<a.length;h++)s.addColorStop(a[h].offset,a[h].color);return s}};for(var s=r.prototype,a=0;a<o.length;a++){var h=o[a];h[0]in s||(s[h[0]]=h[1])}r.getGradient=s.getGradient;var l=r;t.exports=l},function(t,e,i){var n=i(11),o=i(12),r=i(13),s=i(16),a=i(5),h=function(t){r.call(this,t),o.call(this,t),s.call(this,t),this.id=t.id||n()};h.prototype={type:"element",name:"",__zr:null,ignore:!1,clipPath:null,drift:function(t,e){switch(this.draggable){case"horizontal":e=0;break;case"vertical":t=0}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=t,i[5]+=e,this.decomposeTransform(),this.dirty(!1)},beforeUpdate:function(){},afterUpdate:function(){},update:function(){this.updateTransform()},traverse:function(t,e){},attrKV:function(t,e){if("position"===t||"scale"===t||"origin"===t){if(e){var i=this[t];i||(i=this[t]=[]),i[0]=e[0],i[1]=e[1]}}else this[t]=e},hide:function(){this.ignore=!0,this.__zr&&this.__zr.refresh()},show:function(){this.ignore=!1,this.__zr&&this.__zr.refresh()},attr:function(t,e){if("string"==typeof t)this.attrKV(t,e);else if(a.isObject(t))for(var i in t)t.hasOwnProperty(i)&&this.attrKV(i,t[i]);return this.dirty(!1),this},setClipPath:function(t){var e=this.__zr;e&&t.addSelfToZr(e),this.clipPath&&this.clipPath!==t&&this.removeClipPath(),this.clipPath=t,t.__zr=e,t.__clipTarget=this,this.dirty(!1)},removeClipPath:function(){var t=this.clipPath;t&&(t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__clipTarget=null,this.clipPath=null,this.dirty(!1))},addSelfToZr:function(t){this.__zr=t;var e=this.animators;if(e)for(var i=0;i<e.length;i++)t.animation.addAnimator(e[i]);this.clipPath&&this.clipPath.addSelfToZr(t)},removeSelfFromZr:function(t){this.__zr=null;var e=this.animators;if(e)for(var i=0;i<e.length;i++)t.animation.removeAnimator(e[i]);this.clipPath&&this.clipPath.removeSelfFromZr(t)}},a.mixin(h,s),a.mixin(h,r),a.mixin(h,o);var l=h;t.exports=l},function(t,e){function i(){return n++}var n=2311;t.exports=i},function(t,e){var i=Array.prototype.slice,n=function(){this._$handlers={}};n.prototype={constructor:n,one:function(t,e,i){var n=this._$handlers;if(!e||!t)return this;n[t]||(n[t]=[]);for(var o=0;o<n[t].length;o++)if(n[t][o].h===e)return this;return n[t].push({h:e,one:!0,ctx:i||this}),this},on:function(t,e,i){var n=this._$handlers;if(!e||!t)return this;n[t]||(n[t]=[]);for(var o=0;o<n[t].length;o++)if(n[t][o].h===e)return this;return n[t].push({h:e,one:!1,ctx:i||this}),this},isSilent:function(t){var e=this._$handlers;return e[t]&&e[t].length},off:function(t,e){var i=this._$handlers;if(!t)return this._$handlers={},this;if(e){if(i[t]){for(var n=[],o=0,r=i[t].length;o<r;o++)i[t][o].h!=e&&n.push(i[t][o]);i[t]=n}i[t]&&0===i[t].length&&delete i[t]}else delete i[t];return this},trigger:function(t){if(this._$handlers[t]){var e=arguments,n=e.length;n>3&&(e=i.call(e,1));for(var o=this._$handlers[t],r=o.length,s=0;s<r;){switch(n){case 1:o[s].h.call(o[s].ctx);break;case 2:o[s].h.call(o[s].ctx,e[1]);break;case 3:o[s].h.call(o[s].ctx,e[1],e[2]);break;default:o[s].h.apply(o[s].ctx,e)}o[s].one?(o.splice(s,1),r--):s++}}return this},triggerWithContext:function(t){if(this._$handlers[t]){var e=arguments,n=e.length;n>4&&(e=i.call(e,1,e.length-1));for(var o=e[e.length-1],r=this._$handlers[t],s=r.length,a=0;a<s;){switch(n){case 1:r[a].h.call(o);break;case 2:r[a].h.call(o,e[1]);break;case 3:r[a].h.call(o,e[1],e[2]);break;default:r[a].h.apply(o,e)}r[a].one?(r.splice(a,1),s--):a++}}return this}};var o=n;t.exports=o},function(t,e,i){function n(t){return t>a||t<-a}var o=i(14),r=i(15),s=o.identity,a=5e-5,h=function(t){t=t||{},t.position||(this.position=[0,0]),null==t.rotation&&(this.rotation=0),t.scale||(this.scale=[1,1]),this.origin=this.origin||null},l=h.prototype;l.transform=null,l.needLocalTransform=function(){return n(this.rotation)||n(this.position[0])||n(this.position[1])||n(this.scale[0]-1)||n(this.scale[1]-1)},l.updateTransform=function(){var t=this.parent,e=t&&t.transform,i=this.needLocalTransform(),n=this.transform;return i||e?(n=n||o.create(),i?this.getLocalTransform(n):s(n),e&&(i?o.mul(n,t.transform,n):o.copy(n,t.transform)),this.transform=n,this.invTransform=this.invTransform||o.create(),void o.invert(this.invTransform,n)):void(n&&s(n))},l.getLocalTransform=function(t){return h.getLocalTransform(this,t)},l.setTransform=function(t){var e=this.transform,i=t.dpr||1;e?t.setTransform(i*e[0],i*e[1],i*e[2],i*e[3],i*e[4],i*e[5]):t.setTransform(i,0,0,i,0,0)},l.restoreTransform=function(t){var e=t.dpr||1;t.setTransform(e,0,0,e,0,0)};var c=[];l.decomposeTransform=function(){if(this.transform){var t=this.parent,e=this.transform;t&&t.transform&&(o.mul(c,t.invTransform,e),e=c);var i=e[0]*e[0]+e[1]*e[1],r=e[2]*e[2]+e[3]*e[3],s=this.position,a=this.scale;n(i-1)&&(i=Math.sqrt(i)),n(r-1)&&(r=Math.sqrt(r)),e[0]<0&&(i=-i),e[3]<0&&(r=-r),s[0]=e[4],s[1]=e[5],a[0]=i,a[1]=r,this.rotation=Math.atan2(-e[1]/r,e[0]/i)}},l.getGlobalScale=function(){var t=this.transform;if(!t)return[1,1];var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]),i=Math.sqrt(t[2]*t[2]+t[3]*t[3]);return t[0]<0&&(e=-e),t[3]<0&&(i=-i),[e,i]},l.transformCoordToLocal=function(t,e){var i=[t,e],n=this.invTransform;return n&&r.applyTransform(i,i,n),i},l.transformCoordToGlobal=function(t,e){var i=[t,e],n=this.transform;return n&&r.applyTransform(i,i,n),i},h.getLocalTransform=function(t,e){e=e||[],s(e);var i=t.origin,n=t.scale||[1,1],r=t.rotation||0,a=t.position||[0,0];return i&&(e[4]-=i[0],e[5]-=i[1]),o.scale(e,e,n),r&&o.rotate(e,e,r),i&&(e[4]+=i[0],e[5]+=i[1]),e[4]+=a[0],e[5]+=a[1],e};var u=h;t.exports=u},function(t,e){function i(){var t=new c(6);return n(t),t}function n(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function o(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function r(t,e,i){var n=e[0]*i[0]+e[2]*i[1],o=e[1]*i[0]+e[3]*i[1],r=e[0]*i[2]+e[2]*i[3],s=e[1]*i[2]+e[3]*i[3],a=e[0]*i[4]+e[2]*i[5]+e[4],h=e[1]*i[4]+e[3]*i[5]+e[5];return t[0]=n,t[1]=o,t[2]=r,t[3]=s,t[4]=a,t[5]=h,t}function s(t,e,i){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4]+i[0],t[5]=e[5]+i[1],t}function a(t,e,i){var n=e[0],o=e[2],r=e[4],s=e[1],a=e[3],h=e[5],l=Math.sin(i),c=Math.cos(i);return t[0]=n*c+s*l,t[1]=-n*l+s*c,t[2]=o*c+a*l,t[3]=-o*l+c*a,t[4]=c*r+l*h,t[5]=c*h-l*r,t}function h(t,e,i){var n=i[0],o=i[1];return t[0]=e[0]*n,t[1]=e[1]*o,t[2]=e[2]*n,t[3]=e[3]*o,t[4]=e[4]*n,t[5]=e[5]*o,t}function l(t,e){var i=e[0],n=e[2],o=e[4],r=e[1],s=e[3],a=e[5],h=i*s-r*n;return h?(h=1/h,t[0]=s*h,t[1]=-r*h,t[2]=-n*h,t[3]=i*h,t[4]=(n*a-s*o)*h,t[5]=(r*o-i*a)*h,t):null}var c="undefined"==typeof Float32Array?Array:Float32Array;e.create=i,e.identity=n,e.copy=o,e.mul=r,e.translate=s,e.rotate=a,e.scale=h,e.invert=l},function(t,e){function i(t,e){var i=new P(2);return null==t&&(t=0),null==e&&(e=0),i[0]=t,i[1]=e,i}function n(t,e){return t[0]=e[0],t[1]=e[1],t}function o(t){var e=new P(2);return e[0]=t[0],e[1]=t[1],e}function r(t,e,i){return t[0]=e,t[1]=i,t}function s(t,e,i){return t[0]=e[0]+i[0],t[1]=e[1]+i[1],t}function a(t,e,i,n){return t[0]=e[0]+i[0]*n,t[1]=e[1]+i[1]*n,t}function h(t,e,i){return t[0]=e[0]-i[0],t[1]=e[1]-i[1],t}function l(t){return Math.sqrt(c(t))}function c(t){return t[0]*t[0]+t[1]*t[1]}function u(t,e,i){return t[0]=e[0]*i[0],t[1]=e[1]*i[1],t}function d(t,e,i){return t[0]=e[0]/i[0],t[1]=e[1]/i[1],t}function p(t,e){return t[0]*e[0]+t[1]*e[1]}function f(t,e,i){return t[0]=e[0]*i,t[1]=e[1]*i,t}function g(t,e){var i=l(e);return 0===i?(t[0]=0,t[1]=0):(t[0]=e[0]/i,t[1]=e[1]/i),t}function v(t,e){return Math.sqrt((t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1]))}function y(t,e){return(t[0]-e[0])*(t[0]-e[0])+(t[1]-e[1])*(t[1]-e[1])}function m(t,e){return t[0]=-e[0],t[1]=-e[1],t}function x(t,e,i,n){return t[0]=e[0]+n*(i[0]-e[0]),t[1]=e[1]+n*(i[1]-e[1]),t}function _(t,e,i){var n=e[0],o=e[1];return t[0]=i[0]*n+i[2]*o+i[4],t[1]=i[1]*n+i[3]*o+i[5],t}function b(t,e,i){return t[0]=Math.min(e[0],i[0]),t[1]=Math.min(e[1],i[1]),t}function w(t,e,i){return t[0]=Math.max(e[0],i[0]),t[1]=Math.max(e[1],i[1]),t}var P="undefined"==typeof Float32Array?Array:Float32Array,C=l,T=c,N=v,S=y;e.create=i,e.copy=n,e.clone=o,e.set=r,e.add=s,e.scaleAndAdd=a,e.sub=h,e.len=l,e.length=C,e.lenSquare=c,e.lengthSquare=T,e.mul=u,e.div=d,e.dot=p,e.scale=f,e.normalize=g,e.distance=v,e.dist=N,e.distanceSquare=y,e.distSquare=S,e.negate=m,e.lerp=x,e.applyTransform=_,e.min=b,e.max=w},function(t,e,i){var n=i(17),o=i(22),r=i(5),s=r.isString,a=r.isFunction,h=r.isObject,l=r.isArrayLike,c=r.indexOf,u=function(){this.animators=[]};u.prototype={constructor:u,animate:function(t,e){var i,r=!1,s=this,a=this.__zr;if(t){var h=t.split("."),l=s;r="shape"===h[0];for(var u=0,d=h.length;u<d;u++)l&&(l=l[h[u]]);l&&(i=l)}else i=s;if(!i)return void o('Property "'+t+'" is not existed in element '+s.id);var p=s.animators,f=new n(i,e);return f.during(function(t){s.dirty(r)}).done(function(){p.splice(c(p,f),1)}),p.push(f),a&&a.animation.addAnimator(f),f},stopAnimation:function(t){for(var e=this.animators,i=e.length,n=0;n<i;n++)e[n].stop(t);return e.length=0,this},animateTo:function(t,e,i,n,o,r){function h(){c--,c||o&&o()}s(i)?(o=n,n=i,i=0):a(n)?(o=n,n="linear",i=0):a(i)?(o=i,i=0):a(e)?(o=e,e=500):e||(e=500),this.stopAnimation(),this._animateToShallow("",this,t,e,i);var l=this.animators.slice(),c=l.length;c||o&&o();for(var u=0;u<l.length;u++)l[u].done(h).start(n,r)},_animateToShallow:function(t,e,i,n,o){var r={},s=0;for(var a in i)if(i.hasOwnProperty(a))if(null!=e[a])h(i[a])&&!l(i[a])?this._animateToShallow(t?t+"."+a:a,e[a],i[a],n,o):(r[a]=i[a],s++);else if(null!=i[a])if(t){var c={};c[t]={},c[t][a]=i[a],this.attr(c)}else this.attr(a,i[a]);return s>0&&this.animate(t,!1).when(null==n?500:n,r).delay(o||0),this}};var d=u;t.exports=d},function(t,e,i){function n(t,e){return t[e]}function o(t,e,i){t[e]=i}function r(t,e,i){return(e-t)*i+t}function s(t,e,i){return i>.5?e:t}function a(t,e,i,n,o){var s=t.length;if(1==o)for(var a=0;a<s;a++)n[a]=r(t[a],e[a],i);else for(var h=s&&t[0].length,a=0;a<s;a++)for(var l=0;l<h;l++)n[a][l]=r(t[a][l],e[a][l],i)}function h(t,e,i){var n=t.length,o=e.length;if(n!==o){var r=n>o;if(r)t.length=o;else for(var s=n;s<o;s++)t.push(1===i?e[s]:_.call(e[s]))}for(var a=t[0]&&t[0].length,s=0;s<t.length;s++)if(1===i)isNaN(t[s])&&(t[s]=e[s]);else for(var h=0;h<a;h++)isNaN(t[s][h])&&(t[s][h]=e[s][h])}function l(t,e,i){if(t===e)return!0;var n=t.length;if(n!==e.length)return!1;if(1===i){for(var o=0;o<n;o++)if(t[o]!==e[o])return!1}else for(var r=t[0].length,o=0;o<n;o++)for(var s=0;s<r;s++)if(t[o][s]!==e[o][s])return!1;return!0}function c(t,e,i,n,o,r,s,a,h){var l=t.length;if(1==h)for(var c=0;c<l;c++)a[c]=u(t[c],e[c],i[c],n[c],o,r,s);else for(var d=t[0].length,c=0;c<l;c++)for(var p=0;p<d;p++)a[c][p]=u(t[c][p],e[c][p],i[c][p],n[c][p],o,r,s)}function u(t,e,i,n,o,r,s){var a=.5*(i-t),h=.5*(n-e);return(2*(e-i)+a+h)*s+(-3*(e-i)-2*a-h)*r+a*o+e}function d(t){if(x(t)){var e=t.length;if(x(t[0])){for(var i=[],n=0;n<e;n++)i.push(_.call(t[n]));return i}return _.call(t)}return t}function p(t){return t[0]=Math.floor(t[0]),t[1]=Math.floor(t[1]),t[2]=Math.floor(t[2]),"rgba("+t.join(",")+")"}function f(t){var e=t[t.length-1].value;return x(e&&e[0])?2:1}function g(t,e,i,n,o,d){var g=t._getter,m=t._setter,_="spline"===e,b=n.length;if(b){var w,P=n[0].value,C=x(P),T=!1,N=!1,S=C?f(n):0;n.sort(function(t,e){return t.time-e.time}),w=n[b-1].time;for(var M=[],A=[],E=n[0].value,R=!0,L=0;L<b;L++){M.push(n[L].time/w);var k=n[L].value;if(C&&l(k,E,S)||!C&&k===E||(R=!1),E=k,"string"==typeof k){var O=y.parse(k);O?(k=O,T=!0):N=!0}A.push(k)}if(d||!R){for(var I=A[b-1],L=0;L<b-1;L++)C?h(A[L],I,S):!isNaN(A[L])||isNaN(I)||N||T||(A[L]=I);C&&h(g(t._target,o),I,S);var z,B,D,H,F,G,Y=0,W=0;if(T)var V=[0,0,0,0];var U=function(t,e){var i;if(e<0)i=0;else if(e<W){for(z=Math.min(Y+1,b-1),i=z;i>=0&&!(M[i]<=e);i--);i=Math.min(i,b-2)}else{for(i=Y;i<b&&!(M[i]>e);i++);i=Math.min(i-1,b-2)}Y=i,W=e;var n=M[i+1]-M[i];if(0!==n)if(B=(e-M[i])/n,_)if(H=A[i],D=A[0===i?i:i-1],F=A[i>b-2?b-1:i+1],G=A[i>b-3?b-1:i+2],C)c(D,H,F,G,B,B*B,B*B*B,g(t,o),S);else{var h;if(T)h=c(D,H,F,G,B,B*B,B*B*B,V,1),h=p(V);else{if(N)return s(H,F,B);h=u(D,H,F,G,B,B*B,B*B*B)}m(t,o,h)}else if(C)a(A[i],A[i+1],B,g(t,o),S);else{var h;if(T)a(A[i],A[i+1],B,V,1),h=p(V);else{if(N)return s(A[i],A[i+1],B);h=r(A[i],A[i+1],B)}m(t,o,h)}},q=new v({target:t._target,life:w,loop:t._loop,delay:t._delay,onframe:U,ondestroy:i});return e&&"spline"!==e&&(q.easing=e),q}}}var v=i(18),y=i(20),m=i(5),x=m.isArrayLike,_=Array.prototype.slice,b=function(t,e,i,r){this._tracks={},this._target=t,this._loop=e||!1,this._getter=i||n,this._setter=r||o,this._clipCount=0,this._delay=0,this._doneList=[],this._onframeList=[],this._clipList=[]};b.prototype={when:function(t,e){var i=this._tracks;for(var n in e)if(e.hasOwnProperty(n)){if(!i[n]){i[n]=[];var o=this._getter(this._target,n);if(null==o)continue;0!==t&&i[n].push({time:0,value:d(o)})}i[n].push({time:t,value:e[n]})}return this},during:function(t){return this._onframeList.push(t),this},pause:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].pause();this._paused=!0},resume:function(){for(var t=0;t<this._clipList.length;t++)this._clipList[t].resume();this._paused=!1},isPaused:function(){return!!this._paused},_doneCallback:function(){this._tracks={},this._clipList.length=0;for(var t=this._doneList,e=t.length,i=0;i<e;i++)t[i].call(this)},start:function(t,e){var i,n=this,o=0,r=function(){o--,o||n._doneCallback()};for(var s in this._tracks)if(this._tracks.hasOwnProperty(s)){var a=g(this,t,r,this._tracks[s],s,e);a&&(this._clipList.push(a),o++,this.animation&&this.animation.addClip(a),i=a)}if(i){var h=i.onframe;i.onframe=function(t,e){h(t,e);for(var i=0;i<n._onframeList.length;i++)n._onframeList[i](t,e)}}return o||this._doneCallback(),this},stop:function(t){for(var e=this._clipList,i=this.animation,n=0;n<e.length;n++){var o=e[n];t&&o.onframe(this._target,1),i&&i.removeClip(o)}e.length=0},delay:function(t){return this._delay=t,this},done:function(t){return t&&this._doneList.push(t),this},getClips:function(){return this._clipList}};var w=b;t.exports=w},function(t,e,i){function n(t){this._target=t.target,this._life=t.life||1e3,this._delay=t.delay||0,this._initialized=!1,this.loop=null!=t.loop&&t.loop,this.gap=t.gap||0,this.easing=t.easing||"Linear",this.onframe=t.onframe,this.ondestroy=t.ondestroy,this.onrestart=t.onrestart,this._pausedTime=0,this._paused=!1}var o=i(19);n.prototype={constructor:n,step:function(t,e){if(this._initialized||(this._startTime=t+this._delay,this._initialized=!0),this._paused)return void(this._pausedTime+=e);var i=(t-this._startTime-this._pausedTime)/this._life;if(!(i<0)){i=Math.min(i,1);var n=this.easing,r="string"==typeof n?o[n]:n,s="function"==typeof r?r(i):i;return this.fire("frame",s),1==i?this.loop?(this.restart(t),"restart"):(this._needsRemove=!0,"destroy"):null}},restart:function(t){var e=(t-this._startTime-this._pausedTime)%this._life;this._startTime=t-e+this.gap,this._pausedTime=0,this._needsRemove=!1},fire:function(t,e){t="on"+t,this[t]&&this[t](this._target,e)},pause:function(){this._paused=!0},resume:function(){this._paused=!1}};var r=n;t.exports=r},function(t,e){var i={linear:function(t){return t},quadraticIn:function(t){return t*t},quadraticOut:function(t){return t*(2-t)},quadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},cubicIn:function(t){return t*t*t},cubicOut:function(t){return--t*t*t+1},cubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},quarticIn:function(t){return t*t*t*t},quarticOut:function(t){return 1- --t*t*t*t},quarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},quinticIn:function(t){return t*t*t*t*t},quinticOut:function(t){return--t*t*t*t*t+1},quinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},sinusoidalIn:function(t){return 1-Math.cos(t*Math.PI/2)},sinusoidalOut:function(t){return Math.sin(t*Math.PI/2)},sinusoidalInOut:function(t){return.5*(1-Math.cos(Math.PI*t))},exponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},exponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},exponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(-Math.pow(2,-10*(t-1))+2)},circularIn:function(t){return 1-Math.sqrt(1-t*t)},circularOut:function(t){return Math.sqrt(1- --t*t)},circularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},elasticIn:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),-(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)))},elasticOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),i*Math.pow(2,-10*t)*Math.sin((t-e)*(2*Math.PI)/n)+1)},elasticInOut:function(t){var e,i=.1,n=.4;return 0===t?0:1===t?1:(!i||i<1?(i=1,e=n/4):e=n*Math.asin(1/i)/(2*Math.PI),(t*=2)<1?-.5*(i*Math.pow(2,10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)):i*Math.pow(2,-10*(t-=1))*Math.sin((t-e)*(2*Math.PI)/n)*.5+1)},backIn:function(t){var e=1.70158;return t*t*((e+1)*t-e)},backOut:function(t){var e=1.70158;return--t*t*((e+1)*t+e)+1},backInOut:function(t){var e=2.5949095;return(t*=2)<1?.5*(t*t*((e+1)*t-e)):.5*((t-=2)*t*((e+1)*t+e)+2)},bounceIn:function(t){return 1-i.bounceOut(1-t)},bounceOut:function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},bounceInOut:function(t){return t<.5?.5*i.bounceIn(2*t):.5*i.bounceOut(2*t-1)+.5}},n=i;t.exports=n},function(t,e,i){function n(t){return t=Math.round(t),t<0?0:t>255?255:t}function o(t){return t=Math.round(t),t<0?0:t>360?360:t}function r(t){return t<0?0:t>1?1:t}function s(t){return n(t.length&&"%"===t.charAt(t.length-1)?parseFloat(t)/100*255:parseInt(t,10))}function a(t){return r(t.length&&"%"===t.charAt(t.length-1)?parseFloat(t)/100:parseFloat(t))}function h(t,e,i){return i<0?i+=1:i>1&&(i-=1),6*i<1?t+(e-t)*i*6:2*i<1?e:3*i<2?t+(e-t)*(2/3-i)*6:t}function l(t,e,i){return t+(e-t)*i}function c(t,e,i,n,o){return t[0]=e,t[1]=i,t[2]=n,t[3]=o,t}function u(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function d(t,e){N&&u(N,e),N=T.put(t,N||e.slice())}function p(t,e){if(t){e=e||[];var i=T.get(t);if(i)return u(e,i);t+="";var n=t.replace(/ /g,"").toLowerCase();if(n in C)return u(e,C[n]),d(t,e),e;if("#"!==n.charAt(0)){var o=n.indexOf("("),r=n.indexOf(")");if(o!==-1&&r+1===n.length){var h=n.substr(0,o),l=n.substr(o+1,r-(o+1)).split(","),p=1;switch(h){case"rgba":if(4!==l.length)return void c(e,0,0,0,1);p=a(l.pop());case"rgb":return 3!==l.length?void c(e,0,0,0,1):(c(e,s(l[0]),s(l[1]),s(l[2]),p),d(t,e),e);case"hsla":return 4!==l.length?void c(e,0,0,0,1):(l[3]=a(l[3]),f(l,e),d(t,e),e);case"hsl":return 3!==l.length?void c(e,0,0,0,1):(f(l,e),d(t,e),e);default:return}}c(e,0,0,0,1)}else{if(4===n.length){var g=parseInt(n.substr(1),16);return g>=0&&g<=4095?(c(e,(3840&g)>>4|(3840&g)>>8,240&g|(240&g)>>4,15&g|(15&g)<<4,1),d(t,e),e):void c(e,0,0,0,1)}if(7===n.length){var g=parseInt(n.substr(1),16);return g>=0&&g<=16777215?(c(e,(16711680&g)>>16,(65280&g)>>8,255&g,1),d(t,e),e):void c(e,0,0,0,1)}}}}function f(t,e){var i=(parseFloat(t[0])%360+360)%360/360,o=a(t[1]),r=a(t[2]),s=r<=.5?r*(o+1):r+o-r*o,l=2*r-s;return e=e||[],c(e,n(255*h(l,s,i+1/3)),n(255*h(l,s,i)),n(255*h(l,s,i-1/3)),1),4===t.length&&(e[3]=t[3]),e}function g(t){if(t){var e,i,n=t[0]/255,o=t[1]/255,r=t[2]/255,s=Math.min(n,o,r),a=Math.max(n,o,r),h=a-s,l=(a+s)/2;if(0===h)e=0,i=0;else{i=l<.5?h/(a+s):h/(2-a-s);var c=((a-n)/6+h/2)/h,u=((a-o)/6+h/2)/h,d=((a-r)/6+h/2)/h;n===a?e=d-u:o===a?e=1/3+c-d:r===a&&(e=2/3+u-c),e<0&&(e+=1),e>1&&(e-=1)}var p=[360*e,i,l];return null!=t[3]&&p.push(t[3]),p}}function v(t,e){var i=p(t);if(i){for(var n=0;n<3;n++)e<0?i[n]=i[n]*(1-e)|0:i[n]=(255-i[n])*e+i[n]|0;return w(i,4===i.length?"rgba":"rgb")}}function y(t){var e=p(t);if(e)return((1<<24)+(e[0]<<16)+(e[1]<<8)+ +e[2]).toString(16).slice(1)}function m(t,e,i){if(e&&e.length&&t>=0&&t<=1){i=i||[];var o=t*(e.length-1),s=Math.floor(o),a=Math.ceil(o),h=e[s],c=e[a],u=o-s;return i[0]=n(l(h[0],c[0],u)),i[1]=n(l(h[1],c[1],u)),i[2]=n(l(h[2],c[2],u)),i[3]=r(l(h[3],c[3],u)),i}}function x(t,e,i){if(e&&e.length&&t>=0&&t<=1){var o=t*(e.length-1),s=Math.floor(o),a=Math.ceil(o),h=p(e[s]),c=p(e[a]),u=o-s,d=w([n(l(h[0],c[0],u)),n(l(h[1],c[1],u)),n(l(h[2],c[2],u)),r(l(h[3],c[3],u))],"rgba");return i?{color:d,leftIndex:s,rightIndex:a,value:o}:d}}function _(t,e,i,n){if(t=p(t))return t=g(t),null!=e&&(t[0]=o(e)),null!=i&&(t[1]=a(i)),null!=n&&(t[2]=a(n)),w(f(t),"rgba")}function b(t,e){if(t=p(t),t&&null!=e)return t[3]=r(e),w(t,"rgba")}function w(t,e){if(t&&t.length){var i=t[0]+","+t[1]+","+t[2];return"rgba"!==e&&"hsva"!==e&&"hsla"!==e||(i+=","+t[3]),e+"("+i+")"}}var P=i(21),C={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]},T=new P(20),N=null,S=m,M=x;e.parse=p,e.lift=v,e.toHex=y,e.fastLerp=m,e.fastMapToColor=S,e.lerp=x,e.mapToColor=M,e.modifyHSL=_,e.modifyAlpha=b,e.stringify=w},function(t,e){var i=function(){this.head=null,this.tail=null,this._len=0},n=i.prototype;n.insert=function(t){var e=new o(t);return this.insertEntry(e),e},n.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},n.remove=function(t){var e=t.prev,i=t.next;e?e.next=i:this.head=i,i?i.prev=e:this.tail=e,t.next=t.prev=null,this._len--},n.len=function(){return this._len},n.clear=function(){this.head=this.tail=null,this._len=0};var o=function(t){this.value=t,this.next,this.prev},r=function(t){this._list=new i,this._map={},this._maxSize=t||10,this._lastRemovedEntry=null},s=r.prototype;s.put=function(t,e){var i=this._list,n=this._map,r=null;if(null==n[t]){var s=i.len(),a=this._lastRemovedEntry;if(s>=this._maxSize&&s>0){var h=i.head;i.remove(h),delete n[h.key],r=h.value,this._lastRemovedEntry=h}a?a.value=e:a=new o(e),a.key=t,i.insertEntry(a),n[t]=a}return r},s.get=function(t){var e=this._map[t],i=this._list;if(null!=e)return e!==i.tail&&(i.remove(e),i.insertEntry(e)),e.value},s.clear=function(){this._list.clear(),this._map={}};var a=r;t.exports=a},function(t,e,i){var n=i(23),o=n.debugMode,r=function(){};1===o?r=function(){for(var t in arguments)throw new Error(arguments[t])}:o>1&&(r=function(){for(var t in arguments)console.log(arguments[t])});var s=r;t.exports=s},function(t,e){var i=1;"undefined"!=typeof window&&(i=Math.max(window.devicePixelRatio||1,1));var n=0,o=i;e.debugMode=n,e.devicePixelRatio=o},function(t,e,i){var n=i(25),o=i(27),r=new o,s=function(){};s.prototype={constructor:s,drawRectText:function(t,e){var i=this.style;e=i.textRect||e,this.__dirty&&n.normalizeTextStyle(i,!0);var o=i.text;if(null!=o&&(o+=""),n.needDrawText(o,i)){t.save();var s=this.transform;i.transformText?this.setTransform(t):s&&(r.copy(e),r.applyTransform(s),e=r),n.renderText(this,t,o,i,e),t.restore()}}};var a=s;t.exports=a},function(t,e,i){function n(t){return o(t),C(t.rich,o),t}function o(t){if(t){t.font=M.makeFont(t);var e=t.textAlign;"middle"===e&&(e="center"),t.textAlign=null==e||R[e]?e:"left";var i=t.textVerticalAlign||t.textBaseline;"center"===i&&(i="middle"),t.textVerticalAlign=null==i||L[i]?i:"top";var n=t.textPadding;n&&(t.textPadding=T(t.textPadding))}}function r(t,e,i,n,o){n.rich?a(t,e,i,n,o):s(t,e,i,n,o)}function s(t,e,i,n,o){var r=g(e,"font",n.font||M.DEFAULT_FONT),s=n.textPadding,a=t.__textCotentBlock;a&&!t.__dirty||(a=t.__textCotentBlock=M.parsePlainText(i,r,s,n.truncate));var h=a.outerHeight,c=a.lines,p=a.lineHeight,m=f(h,n,o),_=m.baseX,b=m.baseY,w=m.textAlign,P=m.textVerticalAlign;l(e,n,o,_,b);var C=M.adjustTextY(b,h,P),T=_,N=C,S=u(n);if(S||s){var A=M.getWidth(i,r),E=A;s&&(E+=s[1]+s[3]);var R=M.adjustTextX(_,E,w);S&&d(t,e,n,R,C,E,h),s&&(T=x(_,w,s),N+=s[0])}g(e,"textAlign",w||"left"),g(e,"textBaseline","middle"),g(e,"shadowBlur",n.textShadowBlur||0),g(e,"shadowColor",n.textShadowColor||"transparent"),g(e,"shadowOffsetX",n.textShadowOffsetX||0),g(e,"shadowOffsetY",n.textShadowOffsetY||0),N+=p/2;var L=n.textStrokeWidth,k=v(n.textStroke,L),O=y(n.textFill);k&&(g(e,"lineWidth",L),g(e,"strokeStyle",k)),O&&g(e,"fillStyle",O);for(var I=0;I<c.length;I++)k&&e.strokeText(c[I],T,N),O&&e.fillText(c[I],T,N),N+=p}function a(t,e,i,n,o){var r=t.__textCotentBlock;r&&!t.__dirty||(r=t.__textCotentBlock=M.parseRichText(i,n)),h(t,e,r,n,o)}function h(t,e,i,n,o){var r=i.width,s=i.outerWidth,a=i.outerHeight,h=n.textPadding,p=f(a,n,o),g=p.baseX,v=p.baseY,y=p.textAlign,m=p.textVerticalAlign;l(e,n,o,g,v);var x=M.adjustTextX(g,s,y),_=M.adjustTextY(v,a,m),b=x,w=_;h&&(b+=h[3],w+=h[0]);var P=b+r;u(n)&&d(t,e,n,x,_,s,a);for(var C=0;C<i.lines.length;C++){for(var T,N=i.lines[C],S=N.tokens,A=S.length,E=N.lineHeight,R=N.width,L=0,k=b,O=P,I=A-1;L<A&&(T=S[L],!T.textAlign||"left"===T.textAlign);)c(t,e,T,n,E,w,k,"left"),R-=T.width,k+=T.width,L++;for(;I>=0&&(T=S[I],"right"===T.textAlign);)c(t,e,T,n,E,w,O,"right"),R-=T.width,O-=T.width,I--;for(k+=(r-(k-b)-(P-O)-R)/2;L<=I;)T=S[L],c(t,e,T,n,E,w,k+T.width/2,"center"),k+=T.width,L++;w+=E}}function l(t,e,i,n,o){if(i&&e.textRotation){var r=e.textOrigin;"center"===r?(n=i.width/2+i.x,o=i.height/2+i.y):r&&(n=r[0]+i.x,o=r[1]+i.y),t.translate(n,o),t.rotate(-e.textRotation),t.translate(-n,-o)}}function c(t,e,i,n,o,r,s,a){var h=n.rich[i.styleName]||{},l=i.textVerticalAlign,c=r+o/2;"top"===l?c=r+i.height/2:"bottom"===l&&(c=r+o-i.height/2),!i.isLineHolder&&u(h)&&d(t,e,h,"right"===a?s-i.width:"center"===a?s-i.width/2:s,c-i.height/2,i.width,i.height);var p=i.textPadding;p&&(s=x(s,a,p),c-=i.height/2-p[2]-i.textHeight/2),g(e,"shadowBlur",P(h.textShadowBlur,n.textShadowBlur,0)),g(e,"shadowColor",h.textShadowColor||n.textShadowColor||"transparent"),
g(e,"shadowOffsetX",P(h.textShadowOffsetX,n.textShadowOffsetX,0)),g(e,"shadowOffsetY",P(h.textShadowOffsetY,n.textShadowOffsetY,0)),g(e,"textAlign",a),g(e,"textBaseline","middle"),g(e,"font",i.font||M.DEFAULT_FONT);var f=v(h.textStroke||n.textStroke,_),m=y(h.textFill||n.textFill),_=w(h.textStrokeWidth,n.textStrokeWidth);f&&(g(e,"lineWidth",_),g(e,"strokeStyle",f),e.strokeText(i.text,s,c)),m&&(g(e,"fillStyle",m),e.fillText(i.text,s,c))}function u(t){return t.textBackgroundColor||t.textBorderWidth&&t.textBorderColor}function d(t,e,i,n,o,r,s){var a=i.textBackgroundColor,h=i.textBorderWidth,l=i.textBorderColor,c=N(a);if(g(e,"shadowBlur",i.textBoxShadowBlur||0),g(e,"shadowColor",i.textBoxShadowColor||"transparent"),g(e,"shadowOffsetX",i.textBoxShadowOffsetX||0),g(e,"shadowOffsetY",i.textBoxShadowOffsetY||0),c||h&&l){e.beginPath();var u=i.textBorderRadius;u?A.buildPath(e,{x:n,y:o,width:r,height:s,r:u}):e.rect(n,o,r,s),e.closePath()}if(c)g(e,"fillStyle",a),e.fill();else if(S(a)){var d=a.image;d=E.createOrUpdateImage(d,null,t,p,a),d&&E.isImageReady(d)&&e.drawImage(d,n,o,r,s)}h&&l&&(g(e,"lineWidth",h),g(e,"strokeStyle",l),e.stroke())}function p(t,e){e.image=t}function f(t,e,i){var n=e.x||0,o=e.y||0,r=e.textAlign,s=e.textVerticalAlign;if(i){var a=e.textPosition;if(a instanceof Array)n=i.x+m(a[0],i.width),o=i.y+m(a[1],i.height);else{var h=M.adjustTextPositionOnRect(a,i,e.textDistance);n=h.x,o=h.y,r=r||h.textAlign,s=s||h.textVerticalAlign}var l=e.textOffset;l&&(n+=l[0],o+=l[1])}return{baseX:n,baseY:o,textAlign:r,textVerticalAlign:s}}function g(t,e,i){return t[e]=i,t[e]}function v(t,e){return null==t||e<=0||"transparent"===t||"none"===t?null:t.image||t.colorStops?"#000":t}function y(t){return null==t||"none"===t?null:t.image||t.colorStops?"#000":t}function m(t,e){return"string"==typeof t?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t}function x(t,e,i){return"right"===e?t-i[1]:"center"===e?t+i[3]/2-i[1]/2:t+i[3]}function _(t,e){return null!=t&&(t||e.textBackgroundColor||e.textBorderWidth&&e.textBorderColor||e.textPadding)}var b=i(5),w=b.retrieve2,P=b.retrieve3,C=b.each,T=b.normalizeCssArray,N=b.isString,S=b.isObject,M=i(26),A=i(29),E=i(28),R={left:1,right:1,center:1},L={top:1,bottom:1,middle:1};e.normalizeTextStyle=n,e.renderText=r,e.getStroke=v,e.getFill=y,e.needDrawText=_},function(t,e,i){function n(t,e){k[t]=e}function o(t,e){e=e||L;var i=t+":"+e;if(M[i])return M[i];for(var n=(t+"").split("\n"),o=0,r=0,s=n.length;r<s;r++)o=Math.max(v(n[r],e).width,o);return A>E&&(A=0,M={}),A++,M[i]=o,o}function r(t,e,i,n,o,r,h){return r?a(t,e,i,n,o,r,h):s(t,e,i,n,o,h)}function s(t,e,i,n,r,s){var a=y(t,e,r,s),c=o(t,e);r&&(c+=r[1]+r[3]);var u=a.outerHeight,d=h(0,c,i),p=l(0,u,n),f=new b(d,p,c,u);return f.lineHeight=a.lineHeight,f}function a(t,e,i,n,o,r,s){var a=m(t,{rich:r,truncate:s,font:e,textAlign:i,textPadding:o}),c=a.outerWidth,u=a.outerHeight,d=h(0,c,i),p=l(0,u,n);return new b(d,p,c,u)}function h(t,e,i){return"right"===i?t-=e:"center"===i&&(t-=e/2),t}function l(t,e,i){return"middle"===i?t-=e/2:"bottom"===i&&(t-=e),t}function c(t,e,i){var n=e.x,o=e.y,r=e.height,s=e.width,a=r/2,h="left",l="top";switch(t){case"left":n-=i,o+=a,h="right",l="middle";break;case"right":n+=i+s,o+=a,l="middle";break;case"top":n+=s/2,o-=i,h="center",l="bottom";break;case"bottom":n+=s/2,o+=r+i,h="center";break;case"inside":n+=s/2,o+=a,h="center",l="middle";break;case"insideLeft":n+=i,o+=a,l="middle";break;case"insideRight":n+=s-i,o+=a,h="right",l="middle";break;case"insideTop":n+=s/2,o+=i,h="center";break;case"insideBottom":n+=s/2,o+=r-i,h="center",l="bottom";break;case"insideTopLeft":n+=i,o+=i;break;case"insideTopRight":n+=s-i,o+=i,h="right";break;case"insideBottomLeft":n+=i,o+=r-i,l="bottom";break;case"insideBottomRight":n+=s-i,o+=r-i,h="right",l="bottom"}return{x:n,y:o,textAlign:h,textVerticalAlign:l}}function u(t,e,i,n,o){if(!e)return"";var r=(t+"").split("\n");o=d(e,i,n,o);for(var s=0,a=r.length;s<a;s++)r[s]=p(r[s],o);return r.join("\n")}function d(t,e,i,n){n=T({},n),n.font=e;var i=N(i,"...");n.maxIterations=N(n.maxIterations,2);var r=n.minChar=N(n.minChar,0);n.cnCharWidth=o("",e);var s=n.ascCharWidth=o("a",e);n.placeholder=N(n.placeholder,"");for(var a=t=Math.max(0,t-1),h=0;h<r&&a>=s;h++)a-=s;var l=o(i);return l>a&&(i="",l=0),a=t-l,n.ellipsis=i,n.ellipsisWidth=l,n.contentWidth=a,n.containerWidth=t,n}function p(t,e){var i=e.containerWidth,n=e.font,r=e.contentWidth;if(!i)return"";var s=o(t,n);if(s<=i)return t;for(var a=0;;a++){if(s<=r||a>=e.maxIterations){t+=e.ellipsis;break}var h=0===a?f(t,r,e.ascCharWidth,e.cnCharWidth):s>0?Math.floor(t.length*r/s):0;t=t.substr(0,h),s=o(t,n)}return""===t&&(t=e.placeholder),t}function f(t,e,i,n){for(var o=0,r=0,s=t.length;r<s&&o<e;r++){var a=t.charCodeAt(r);o+=0<=a&&a<=127?i:n}return r}function g(t){return o("",t)}function v(t,e){return k.measureText(t,e)}function y(t,e,i,n){null!=t&&(t+="");var o=g(e),r=t?t.split("\n"):[],s=r.length*o,a=s;if(i&&(a+=i[0]+i[2]),t&&n){var h=n.outerHeight,l=n.outerWidth;if(null!=h&&a>h)t="",r=[];else if(null!=l)for(var c=d(l-(i?i[1]+i[3]:0),e,n.ellipsis,{minChar:n.minChar,placeholder:n.placeholder}),u=0,f=r.length;u<f;u++)r[u]=p(r[u],c)}return{lines:r,height:s,outerHeight:a,lineHeight:o}}function m(t,e){var i={lines:[],width:0,height:0};if(null!=t&&(t+=""),!t)return i;for(var n,r=R.lastIndex=0;null!=(n=R.exec(t));){var s=n.index;s>r&&x(i,t.substring(r,s)),x(i,n[2],n[1]),r=R.lastIndex}r<t.length&&x(i,t.substring(r,t.length));var a=i.lines,h=0,l=0,c=[],d=e.textPadding,p=e.truncate,f=p&&p.outerWidth,v=p&&p.outerHeight;d&&(null!=f&&(f-=d[1]+d[3]),null!=v&&(v-=d[0]+d[2]));for(var y=0;y<a.length;y++){for(var m=a[y],_=0,b=0,P=0;P<m.tokens.length;P++){var C=m.tokens[P],T=C.styleName&&e.rich[C.styleName]||{},M=C.textPadding=T.textPadding,A=C.font=T.font||e.font,E=C.textHeight=N(T.textHeight,g(A));if(M&&(E+=M[0]+M[2]),C.height=E,C.lineHeight=S(T.textLineHeight,e.textLineHeight,E),C.textAlign=T&&T.textAlign||e.textAlign,C.textVerticalAlign=T&&T.textVerticalAlign||"middle",null!=v&&h+C.lineHeight>v)return{lines:[],width:0,height:0};C.textWidth=o(C.text,A);var L=T.textWidth,k=null==L||"auto"===L;if("string"==typeof L&&"%"===L.charAt(L.length-1))C.percentWidth=L,c.push(C),L=0;else{if(k){L=C.textWidth;var O=T.textBackgroundColor,I=O&&O.image;I&&(I=w.findExistImage(I),w.isImageReady(I)&&(L=Math.max(L,I.width*E/I.height)))}var z=M?M[1]+M[3]:0;L+=z;var B=null!=f?f-b:null;null!=B&&B<L&&(!k||B<z?(C.text="",C.textWidth=L=0):(C.text=u(C.text,B-z,A,p.ellipsis,{minChar:p.minChar}),C.textWidth=o(C.text,A),L=C.textWidth+z))}b+=C.width=L,T&&(_=Math.max(_,C.lineHeight))}m.width=b,m.lineHeight=_,h+=_,l=Math.max(l,b)}i.outerWidth=i.width=N(e.textWidth,l),i.outerHeight=i.height=N(e.textHeight,h),d&&(i.outerWidth+=d[1]+d[3],i.outerHeight+=d[0]+d[2]);for(var y=0;y<c.length;y++){var C=c[y],D=C.percentWidth;C.width=parseInt(D,10)/100*l}return i}function x(t,e,i){for(var n=""===e,o=e.split("\n"),r=t.lines,s=0;s<o.length;s++){var a=o[s],h={styleName:i,text:a,isLineHolder:!a&&!n};if(s)r.push({tokens:[h]});else{var l=(r[r.length-1]||(r[0]={tokens:[]})).tokens,c=l.length;1===c&&l[0].isLineHolder?l[0]=h:(a||!c||n)&&l.push(h)}}}function _(t){return(t.fontSize||t.fontFamily)&&[t.fontStyle,t.fontWeight,(t.fontSize||12)+"px",t.fontFamily||"sans-serif"].join(" ")||t.textFont||t.font}var b=i(27),w=i(28),P=i(5),C=P.getContext,T=P.extend,N=P.retrieve2,S=P.retrieve3,M={},A=0,E=5e3,R=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g,L="12px sans-serif",k={};k.measureText=function(t,e){var i=C();return i.font=e||L,i.measureText(t)},e.DEFAULT_FONT=L,e.$override=n,e.getWidth=o,e.getBoundingRect=r,e.adjustTextX=h,e.adjustTextY=l,e.adjustTextPositionOnRect=c,e.truncateText=u,e.getLineHeight=g,e.measureText=v,e.parsePlainText=y,e.parseRichText=m,e.makeFont=_},function(t,e,i){function n(t,e,i,n){i<0&&(t+=i,i=-i),n<0&&(e+=n,n=-n),this.x=t,this.y=e,this.width=i,this.height=n}var o=i(15),r=i(14),s=o.applyTransform,a=Math.min,h=Math.max;n.prototype={constructor:n,union:function(t){var e=a(t.x,this.x),i=a(t.y,this.y);this.width=h(t.x+t.width,this.x+this.width)-e,this.height=h(t.y+t.height,this.y+this.height)-i,this.x=e,this.y=i},applyTransform:function(){var t=[],e=[],i=[],n=[];return function(o){if(o){t[0]=i[0]=this.x,t[1]=n[1]=this.y,e[0]=n[0]=this.x+this.width,e[1]=i[1]=this.y+this.height,s(t,t,o),s(e,e,o),s(i,i,o),s(n,n,o),this.x=a(t[0],e[0],i[0],n[0]),this.y=a(t[1],e[1],i[1],n[1]);var r=h(t[0],e[0],i[0],n[0]),l=h(t[1],e[1],i[1],n[1]);this.width=r-this.x,this.height=l-this.y}}}(),calculateTransform:function(t){var e=this,i=t.width/e.width,n=t.height/e.height,o=r.create();return r.translate(o,o,[-e.x,-e.y]),r.scale(o,o,[i,n]),r.translate(o,o,[t.x,t.y]),o},intersect:function(t){if(!t)return!1;t instanceof n||(t=n.create(t));var e=this,i=e.x,o=e.x+e.width,r=e.y,s=e.y+e.height,a=t.x,h=t.x+t.width,l=t.y,c=t.y+t.height;return!(o<a||h<i||s<l||c<r)},contain:function(t,e){var i=this;return t>=i.x&&t<=i.x+i.width&&e>=i.y&&e<=i.y+i.height},clone:function(){return new n(this.x,this.y,this.width,this.height)},copy:function(t){this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height},plain:function(){return{x:this.x,y:this.y,width:this.width,height:this.height}}},n.create=function(t){return new n(t.x,t.y,t.width,t.height)};var l=n;t.exports=l},function(t,e,i){function n(t){if("string"==typeof t){var e=h.get(t);return e&&e.image}return t}function o(t,e,i,n,o){if(t){if("string"==typeof t){if(e&&e.__zrImageSrc===t||!i)return e;var a=h.get(t),l={hostEl:i,cb:n,cbPayload:o};return a?(e=a.image,!s(e)&&a.pending.push(l)):(!e&&(e=new Image),e.onload=r,h.put(t,e.__cachedImgObj={image:e,pending:[l]}),e.src=e.__zrImageSrc=t),e}return t}return e}function r(){var t=this.__cachedImgObj;this.onload=this.__cachedImgObj=null;for(var e=0;e<t.pending.length;e++){var i=t.pending[e],n=i.cb;n&&n(this,i.cbPayload),i.hostEl.dirty()}t.pending.length=0}function s(t){return t&&t.width&&t.height}var a=i(21),h=new a(50);e.findExistImage=n,e.createOrUpdateImage=o,e.isImageReady=s},function(t,e){function i(t,e){var i,n,o,r,s=e.x,a=e.y,h=e.width,l=e.height,c=e.r;h<0&&(s+=h,h=-h),l<0&&(a+=l,l=-l),"number"==typeof c?i=n=o=r=c:c instanceof Array?1===c.length?i=n=o=r=c[0]:2===c.length?(i=o=c[0],n=r=c[1]):3===c.length?(i=c[0],n=r=c[1],o=c[2]):(i=c[0],n=c[1],o=c[2],r=c[3]):i=n=o=r=0;var u;i+n>h&&(u=i+n,i*=h/u,n*=h/u),o+r>h&&(u=o+r,o*=h/u,r*=h/u),n+o>l&&(u=n+o,n*=l/u,o*=l/u),i+r>l&&(u=i+r,i*=l/u,r*=l/u),t.moveTo(s+i,a),t.lineTo(s+h-n,a),0!==n&&t.quadraticCurveTo(s+h,a,s+h,a+n),t.lineTo(s+h,a+l-o),0!==o&&t.quadraticCurveTo(s+h,a+l,s+h-o,a+l),t.lineTo(s+r,a+l),0!==r&&t.quadraticCurveTo(s,a+l,s,a+l-r),t.lineTo(s,a+i),0!==i&&t.quadraticCurveTo(s,a,s+i,a)}e.buildPath=i},function(t,e,i){var n=i(31),o=i(15),r=i(32),s=i(27),a=i(23),h=a.devicePixelRatio,l={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},c=[],u=[],d=[],p=[],f=Math.min,g=Math.max,v=Math.cos,y=Math.sin,m=Math.sqrt,x=Math.abs,_="undefined"!=typeof Float32Array,b=function(t){this._saveData=!t,this._saveData&&(this.data=[]),this._ctx=null};b.prototype={constructor:b,_xi:0,_yi:0,_x0:0,_y0:0,_ux:0,_uy:0,_len:0,_lineDash:null,_dashOffset:0,_dashIdx:0,_dashSum:0,setScale:function(t,e){this._ux=x(1/h/t)||0,this._uy=x(1/h/e)||0},getContext:function(){return this._ctx},beginPath:function(t){return this._ctx=t,t&&t.beginPath(),t&&(this.dpr=t.dpr),this._saveData&&(this._len=0),this._lineDash&&(this._lineDash=null,this._dashOffset=0),this},moveTo:function(t,e){return this.addData(l.M,t,e),this._ctx&&this._ctx.moveTo(t,e),this._x0=t,this._y0=e,this._xi=t,this._yi=e,this},lineTo:function(t,e){var i=x(t-this._xi)>this._ux||x(e-this._yi)>this._uy||this._len<5;return this.addData(l.L,t,e),this._ctx&&i&&(this._needsDash()?this._dashedLineTo(t,e):this._ctx.lineTo(t,e)),i&&(this._xi=t,this._yi=e),this},bezierCurveTo:function(t,e,i,n,o,r){return this.addData(l.C,t,e,i,n,o,r),this._ctx&&(this._needsDash()?this._dashedBezierTo(t,e,i,n,o,r):this._ctx.bezierCurveTo(t,e,i,n,o,r)),this._xi=o,this._yi=r,this},quadraticCurveTo:function(t,e,i,n){return this.addData(l.Q,t,e,i,n),this._ctx&&(this._needsDash()?this._dashedQuadraticTo(t,e,i,n):this._ctx.quadraticCurveTo(t,e,i,n)),this._xi=i,this._yi=n,this},arc:function(t,e,i,n,o,r){return this.addData(l.A,t,e,i,i,n,o-n,0,r?0:1),this._ctx&&this._ctx.arc(t,e,i,n,o,r),this._xi=v(o)*i+t,this._yi=y(o)*i+t,this},arcTo:function(t,e,i,n,o){return this._ctx&&this._ctx.arcTo(t,e,i,n,o),this},rect:function(t,e,i,n){return this._ctx&&this._ctx.rect(t,e,i,n),this.addData(l.R,t,e,i,n),this},closePath:function(){this.addData(l.Z);var t=this._ctx,e=this._x0,i=this._y0;return t&&(this._needsDash()&&this._dashedLineTo(e,i),t.closePath()),this._xi=e,this._yi=i,this},fill:function(t){t&&t.fill(),this.toStatic()},stroke:function(t){t&&t.stroke(),this.toStatic()},setLineDash:function(t){if(t instanceof Array){this._lineDash=t,this._dashIdx=0;for(var e=0,i=0;i<t.length;i++)e+=t[i];this._dashSum=e}return this},setLineDashOffset:function(t){return this._dashOffset=t,this},len:function(){return this._len},setData:function(t){var e=t.length;this.data&&this.data.length==e||!_||(this.data=new Float32Array(e));for(var i=0;i<e;i++)this.data[i]=t[i];this._len=e},appendPath:function(t){t instanceof Array||(t=[t]);for(var e=t.length,i=0,n=this._len,o=0;o<e;o++)i+=t[o].len();_&&this.data instanceof Float32Array&&(this.data=new Float32Array(n+i));for(var o=0;o<e;o++)for(var r=t[o].data,s=0;s<r.length;s++)this.data[n++]=r[s];this._len=n},addData:function(t){if(this._saveData){var e=this.data;this._len+arguments.length>e.length&&(this._expandData(),e=this.data);for(var i=0;i<arguments.length;i++)e[this._len++]=arguments[i];this._prevCmd=t}},_expandData:function(){if(!(this.data instanceof Array)){for(var t=[],e=0;e<this._len;e++)t[e]=this.data[e];this.data=t}},_needsDash:function(){return this._lineDash},_dashedLineTo:function(t,e){var i,n,o=this._dashSum,r=this._dashOffset,s=this._lineDash,a=this._ctx,h=this._xi,l=this._yi,c=t-h,u=e-l,d=m(c*c+u*u),p=h,v=l,y=s.length;for(c/=d,u/=d,r<0&&(r=o+r),r%=o,p-=r*c,v-=r*u;c>0&&p<=t||c<0&&p>=t||0==c&&(u>0&&v<=e||u<0&&v>=e);)n=this._dashIdx,i=s[n],p+=c*i,v+=u*i,this._dashIdx=(n+1)%y,c>0&&p<h||c<0&&p>h||u>0&&v<l||u<0&&v>l||a[n%2?"moveTo":"lineTo"](c>=0?f(p,t):g(p,t),u>=0?f(v,e):g(v,e));c=p-t,u=v-e,this._dashOffset=-m(c*c+u*u)},_dashedBezierTo:function(t,e,i,o,r,s){var a,h,l,c,u,d=this._dashSum,p=this._dashOffset,f=this._lineDash,g=this._ctx,v=this._xi,y=this._yi,x=n.cubicAt,_=0,b=this._dashIdx,w=f.length,P=0;for(p<0&&(p=d+p),p%=d,a=0;a<1;a+=.1)h=x(v,t,i,r,a+.1)-x(v,t,i,r,a),l=x(y,e,o,s,a+.1)-x(y,e,o,s,a),_+=m(h*h+l*l);for(;b<w&&(P+=f[b],!(P>p));b++);for(a=(P-p)/_;a<=1;)c=x(v,t,i,r,a),u=x(y,e,o,s,a),b%2?g.moveTo(c,u):g.lineTo(c,u),a+=f[b]/_,b=(b+1)%w;b%2!==0&&g.lineTo(r,s),h=r-c,l=s-u,this._dashOffset=-m(h*h+l*l)},_dashedQuadraticTo:function(t,e,i,n){var o=i,r=n;i=(i+2*t)/3,n=(n+2*e)/3,t=(this._xi+2*t)/3,e=(this._yi+2*e)/3,this._dashedBezierTo(t,e,i,n,o,r)},toStatic:function(){var t=this.data;t instanceof Array&&(t.length=this._len,_&&(this.data=new Float32Array(t)))},getBoundingRect:function(){c[0]=c[1]=d[0]=d[1]=Number.MAX_VALUE,u[0]=u[1]=p[0]=p[1]=-Number.MAX_VALUE;for(var t=this.data,e=0,i=0,n=0,a=0,h=0;h<t.length;){var f=t[h++];switch(1==h&&(e=t[h],i=t[h+1],n=e,a=i),f){case l.M:n=t[h++],a=t[h++],e=n,i=a,d[0]=n,d[1]=a,p[0]=n,p[1]=a;break;case l.L:r.fromLine(e,i,t[h],t[h+1],d,p),e=t[h++],i=t[h++];break;case l.C:r.fromCubic(e,i,t[h++],t[h++],t[h++],t[h++],t[h],t[h+1],d,p),e=t[h++],i=t[h++];break;case l.Q:r.fromQuadratic(e,i,t[h++],t[h++],t[h],t[h+1],d,p),e=t[h++],i=t[h++];break;case l.A:var g=t[h++],m=t[h++],x=t[h++],_=t[h++],b=t[h++],w=t[h++]+b,P=(t[h++],1-t[h++]);1==h&&(n=v(b)*x+g,a=y(b)*_+m),r.fromArc(g,m,x,_,b,w,P,d,p),e=v(w)*x+g,i=y(w)*_+m;break;case l.R:n=e=t[h++],a=i=t[h++];var C=t[h++],T=t[h++];r.fromLine(n,a,n+C,a+T,d,p);break;case l.Z:e=n,i=a}o.min(c,c,d),o.max(u,u,p)}return 0===h&&(c[0]=c[1]=u[0]=u[1]=0),new s(c[0],c[1],u[0]-c[0],u[1]-c[1])},rebuildPath:function(t){for(var e,i,n,o,r,s,a=this.data,h=this._ux,c=this._uy,u=this._len,d=0;d<u;){var p=a[d++];switch(1==d&&(n=a[d],o=a[d+1],e=n,i=o),p){case l.M:e=n=a[d++],i=o=a[d++],t.moveTo(n,o);break;case l.L:r=a[d++],s=a[d++],(x(r-n)>h||x(s-o)>c||d===u-1)&&(t.lineTo(r,s),n=r,o=s);break;case l.C:t.bezierCurveTo(a[d++],a[d++],a[d++],a[d++],a[d++],a[d++]),n=a[d-2],o=a[d-1];break;case l.Q:t.quadraticCurveTo(a[d++],a[d++],a[d++],a[d++]),n=a[d-2],o=a[d-1];break;case l.A:var f=a[d++],g=a[d++],m=a[d++],_=a[d++],b=a[d++],w=a[d++],P=a[d++],C=a[d++],T=m>_?m:_,N=m>_?1:m/_,S=m>_?_/m:1,M=Math.abs(m-_)>.001,A=b+w;M?(t.translate(f,g),t.rotate(P),t.scale(N,S),t.arc(0,0,T,b,A,1-C),t.scale(1/N,1/S),t.rotate(-P),t.translate(-f,-g)):t.arc(f,g,T,b,A,1-C),1==d&&(e=v(b)*m+f,i=y(b)*_+g),n=v(A)*m+f,o=y(A)*_+g;break;case l.R:e=n=a[d],i=o=a[d+1],t.rect(a[d++],a[d++],a[d++],a[d++]);break;case l.Z:t.closePath(),n=e,o=i}}}},b.CMD=l;var w=b;t.exports=w},function(t,e,i){function n(t){return t>-w&&t<w}function o(t){return t>w||t<-w}function r(t,e,i,n,o){var r=1-o;return r*r*(r*t+3*o*e)+o*o*(o*n+3*r*i)}function s(t,e,i,n,o){var r=1-o;return 3*(((e-t)*r+2*(i-e)*o)*r+(n-i)*o*o)}function a(t,e,i,o,r,s){var a=o+3*(e-i)-t,h=3*(i-2*e+t),l=3*(e-t),c=t-r,u=h*h-3*a*l,d=h*l-9*a*c,p=l*l-3*h*c,f=0;if(n(u)&&n(d))if(n(h))s[0]=0;else{var g=-l/h;g>=0&&g<=1&&(s[f++]=g)}else{var v=d*d-4*u*p;if(n(v)){var y=d/u,g=-h/a+y,m=-y/2;g>=0&&g<=1&&(s[f++]=g),m>=0&&m<=1&&(s[f++]=m)}else if(v>0){var x=b(v),w=u*h+1.5*a*(-d+x),P=u*h+1.5*a*(-d-x);w=w<0?-_(-w,T):_(w,T),P=P<0?-_(-P,T):_(P,T);var g=(-h-(w+P))/(3*a);g>=0&&g<=1&&(s[f++]=g)}else{var N=(2*u*h-3*a*d)/(2*b(u*u*u)),S=Math.acos(N)/3,M=b(u),A=Math.cos(S),g=(-h-2*M*A)/(3*a),m=(-h+M*(A+C*Math.sin(S)))/(3*a),E=(-h+M*(A-C*Math.sin(S)))/(3*a);g>=0&&g<=1&&(s[f++]=g),m>=0&&m<=1&&(s[f++]=m),E>=0&&E<=1&&(s[f++]=E)}}return f}function h(t,e,i,r,s){var a=6*i-12*e+6*t,h=9*e+3*r-3*t-9*i,l=3*e-3*t,c=0;if(n(h)){if(o(a)){var u=-l/a;u>=0&&u<=1&&(s[c++]=u)}}else{var d=a*a-4*h*l;if(n(d))s[0]=-a/(2*h);else if(d>0){var p=b(d),u=(-a+p)/(2*h),f=(-a-p)/(2*h);u>=0&&u<=1&&(s[c++]=u),f>=0&&f<=1&&(s[c++]=f)}}return c}function l(t,e,i,n,o,r){var s=(e-t)*o+t,a=(i-e)*o+e,h=(n-i)*o+i,l=(a-s)*o+s,c=(h-a)*o+a,u=(c-l)*o+l;r[0]=t,r[1]=s,r[2]=l,r[3]=u,r[4]=u,r[5]=c,r[6]=h,r[7]=n}function c(t,e,i,n,o,s,a,h,l,c,u){var d,p,f,g,v,y=.005,m=1/0;N[0]=l,N[1]=c;for(var _=0;_<1;_+=.05)S[0]=r(t,i,o,a,_),S[1]=r(e,n,s,h,_),g=x(N,S),g<m&&(d=_,m=g);m=1/0;for(var w=0;w<32&&!(y<P);w++)p=d-y,f=d+y,S[0]=r(t,i,o,a,p),S[1]=r(e,n,s,h,p),g=x(S,N),p>=0&&g<m?(d=p,m=g):(M[0]=r(t,i,o,a,f),M[1]=r(e,n,s,h,f),v=x(M,N),f<=1&&v<m?(d=f,m=v):y*=.5);return u&&(u[0]=r(t,i,o,a,d),u[1]=r(e,n,s,h,d)),b(m)}function u(t,e,i,n){var o=1-n;return o*(o*t+2*n*e)+n*n*i}function d(t,e,i,n){return 2*((1-n)*(e-t)+n*(i-e))}function p(t,e,i,r,s){var a=t-2*e+i,h=2*(e-t),l=t-r,c=0;if(n(a)){if(o(h)){var u=-l/h;u>=0&&u<=1&&(s[c++]=u)}}else{var d=h*h-4*a*l;if(n(d)){var u=-h/(2*a);u>=0&&u<=1&&(s[c++]=u)}else if(d>0){var p=b(d),u=(-h+p)/(2*a),f=(-h-p)/(2*a);u>=0&&u<=1&&(s[c++]=u),f>=0&&f<=1&&(s[c++]=f)}}return c}function f(t,e,i){var n=t+i-2*e;return 0===n?.5:(t-e)/n}function g(t,e,i,n,o){var r=(e-t)*n+t,s=(i-e)*n+e,a=(s-r)*n+r;o[0]=t,o[1]=r,o[2]=a,o[3]=a,o[4]=s,o[5]=i}function v(t,e,i,n,o,r,s,a,h){var l,c=.005,d=1/0;N[0]=s,N[1]=a;for(var p=0;p<1;p+=.05){S[0]=u(t,i,o,p),S[1]=u(e,n,r,p);var f=x(N,S);f<d&&(l=p,d=f)}d=1/0;for(var g=0;g<32&&!(c<P);g++){var v=l-c,y=l+c;S[0]=u(t,i,o,v),S[1]=u(e,n,r,v);var f=x(S,N);if(v>=0&&f<d)l=v,d=f;else{M[0]=u(t,i,o,y),M[1]=u(e,n,r,y);var m=x(M,N);y<=1&&m<d?(l=y,d=m):c*=.5}}return h&&(h[0]=u(t,i,o,l),h[1]=u(e,n,r,l)),b(d)}var y=i(15),m=y.create,x=y.distSquare,_=Math.pow,b=Math.sqrt,w=1e-8,P=1e-4,C=b(3),T=1/3,N=m(),S=m(),M=m();e.cubicAt=r,e.cubicDerivativeAt=s,e.cubicRootAt=a,e.cubicExtrema=h,e.cubicSubdivide=l,e.cubicProjectPoint=c,e.quadraticAt=u,e.quadraticDerivativeAt=d,e.quadraticRootAt=p,e.quadraticExtremum=f,e.quadraticSubdivide=g,e.quadraticProjectPoint=v},function(t,e,i){function n(t,e,i){if(0!==t.length){var n,o=t[0],r=o[0],s=o[0],a=o[1],h=o[1];for(n=1;n<t.length;n++)o=t[n],r=c(r,o[0]),s=u(s,o[0]),a=c(a,o[1]),h=u(h,o[1]);e[0]=r,e[1]=a,i[0]=s,i[1]=h}}function o(t,e,i,n,o,r){o[0]=c(t,i),o[1]=c(e,n),r[0]=u(t,i),r[1]=u(e,n)}function r(t,e,i,n,o,r,s,a,h,d){var p,f=l.cubicExtrema,g=l.cubicAt,v=f(t,i,o,s,m);for(h[0]=1/0,h[1]=1/0,d[0]=-(1/0),d[1]=-(1/0),p=0;p<v;p++){var y=g(t,i,o,s,m[p]);h[0]=c(y,h[0]),d[0]=u(y,d[0])}for(v=f(e,n,r,a,x),p=0;p<v;p++){var _=g(e,n,r,a,x[p]);h[1]=c(_,h[1]),d[1]=u(_,d[1])}h[0]=c(t,h[0]),d[0]=u(t,d[0]),h[0]=c(s,h[0]),d[0]=u(s,d[0]),h[1]=c(e,h[1]),d[1]=u(e,d[1]),h[1]=c(a,h[1]),d[1]=u(a,d[1])}function s(t,e,i,n,o,r,s,a){var h=l.quadraticExtremum,d=l.quadraticAt,p=u(c(h(t,i,o),1),0),f=u(c(h(e,n,r),1),0),g=d(t,i,o,p),v=d(e,n,r,f);s[0]=c(t,o,g),s[1]=c(e,r,v),a[0]=u(t,o,g),a[1]=u(e,r,v)}function a(t,e,i,n,o,r,s,a,l){var c=h.min,u=h.max,m=Math.abs(o-r);if(m%f<1e-4&&m>1e-4)return a[0]=t-i,a[1]=e-n,l[0]=t+i,void(l[1]=e+n);if(g[0]=p(o)*i+t,g[1]=d(o)*n+e,v[0]=p(r)*i+t,v[1]=d(r)*n+e,c(a,g,v),u(l,g,v),o%=f,o<0&&(o+=f),r%=f,r<0&&(r+=f),o>r&&!s?r+=f:o<r&&s&&(o+=f),s){var x=r;r=o,o=x}for(var _=0;_<r;_+=Math.PI/2)_>o&&(y[0]=p(_)*i+t,y[1]=d(_)*n+e,c(a,y,a),u(l,y,l))}var h=i(15),l=i(31),c=Math.min,u=Math.max,d=Math.sin,p=Math.cos,f=2*Math.PI,g=h.create(),v=h.create(),y=h.create(),m=[],x=[];e.fromPoints=n,e.fromLine=o,e.fromCubic=r,e.fromQuadratic=s,e.fromArc=a},function(t,e,i){function n(t,e){return Math.abs(t-e)<w}function o(){var t=C[0];C[0]=C[1],C[1]=t}function r(t,e,i,n,r,s,a,h,l,c){if(c>e&&c>n&&c>s&&c>h||c<e&&c<n&&c<s&&c<h)return 0;var u=m.cubicRootAt(e,n,s,h,c,P);if(0===u)return 0;for(var d,p,f=0,g=-1,v=0;v<u;v++){var y=P[v],x=0===y||1===y?.5:1,_=m.cubicAt(t,i,r,a,y);_<l||(g<0&&(g=m.cubicExtrema(e,n,s,h,C),C[1]<C[0]&&g>1&&o(),d=m.cubicAt(e,n,s,h,C[0]),g>1&&(p=m.cubicAt(e,n,s,h,C[1]))),f+=2==g?y<C[0]?d<e?x:-x:y<C[1]?p<d?x:-x:h<p?x:-x:y<C[0]?d<e?x:-x:h<d?x:-x)}return f}function s(t,e,i,n,o,r,s,a){if(a>e&&a>n&&a>r||a<e&&a<n&&a<r)return 0;var h=m.quadraticRootAt(e,n,r,a,P);if(0===h)return 0;var l=m.quadraticExtremum(e,n,r);if(l>=0&&l<=1){for(var c=0,u=m.quadraticAt(e,n,r,l),d=0;d<h;d++){var p=0===P[d]||1===P[d]?.5:1,f=m.quadraticAt(t,i,o,P[d]);f<s||(c+=P[d]<l?u<e?p:-p:r<u?p:-p)}return c}var p=0===P[0]||1===P[0]?.5:1,f=m.quadraticAt(t,i,o,P[0]);return f<s?0:r<e?p:-p}function a(t,e,i,n,o,r,s,a){if(a-=e,a>i||a<-i)return 0;var h=Math.sqrt(i*i-a*a);P[0]=-h,P[1]=h;var l=Math.abs(n-o);if(l<1e-4)return 0;if(l%b<1e-4){n=0,o=b;var c=r?1:-1;return s>=P[0]+t&&s<=P[1]+t?c:0}if(r){var h=n;n=y(o),o=y(h)}else n=y(n),o=y(o);n>o&&(o+=b);for(var u=0,d=0;d<2;d++){var p=P[d];if(p+t>s){var f=Math.atan2(a,p),c=r?1:-1;f<0&&(f=b+f),(f>=n&&f<=o||f+b>=n&&f+b<=o)&&(f>Math.PI/2&&f<1.5*Math.PI&&(c=-c),u+=c)}}return u}function h(t,e,i,o,h){for(var l=0,c=0,u=0,v=0,y=0,m=0;m<t.length;){var b=t[m++];switch(b===_.M&&m>1&&(i||(l+=x(c,u,v,y,o,h))),1==m&&(c=t[m],u=t[m+1],v=c,y=u),b){case _.M:v=t[m++],y=t[m++],c=v,u=y;break;case _.L:if(i){if(d.containStroke(c,u,t[m],t[m+1],e,o,h))return!0}else l+=x(c,u,t[m],t[m+1],o,h)||0;c=t[m++],u=t[m++];break;case _.C:if(i){if(p.containStroke(c,u,t[m++],t[m++],t[m++],t[m++],t[m],t[m+1],e,o,h))return!0}else l+=r(c,u,t[m++],t[m++],t[m++],t[m++],t[m],t[m+1],o,h)||0;c=t[m++],u=t[m++];break;case _.Q:if(i){if(f.containStroke(c,u,t[m++],t[m++],t[m],t[m+1],e,o,h))return!0}else l+=s(c,u,t[m++],t[m++],t[m],t[m+1],o,h)||0;c=t[m++],u=t[m++];break;case _.A:var w=t[m++],P=t[m++],C=t[m++],T=t[m++],N=t[m++],S=t[m++],M=(t[m++],1-t[m++]),A=Math.cos(N)*C+w,E=Math.sin(N)*T+P;m>1?l+=x(c,u,A,E,o,h):(v=A,y=E);var R=(o-w)*T/C+w;if(i){if(g.containStroke(w,P,T,N,N+S,M,e,R,h))return!0}else l+=a(w,P,T,N,N+S,M,R,h);c=Math.cos(N+S)*C+w,u=Math.sin(N+S)*T+P;break;case _.R:v=c=t[m++],y=u=t[m++];var L=t[m++],k=t[m++],A=v+L,E=y+k;if(i){if(d.containStroke(v,y,A,y,e,o,h)||d.containStroke(A,y,A,E,e,o,h)||d.containStroke(A,E,v,E,e,o,h)||d.containStroke(v,E,v,y,e,o,h))return!0}else l+=x(A,y,A,E,o,h),l+=x(v,E,v,y,o,h);break;case _.Z:if(i){if(d.containStroke(c,u,v,y,e,o,h))return!0}else l+=x(c,u,v,y,o,h);c=v,u=y}}return i||n(u,y)||(l+=x(c,u,v,y,o,h)||0),0!==l}function l(t,e,i){return h(t,0,!1,e,i)}function c(t,e,i,n){return h(t,e,!0,i,n)}var u=i(30),d=i(34),p=i(35),f=i(36),g=i(37),v=i(38),y=v.normalizeRadian,m=i(31),x=i(39),_=u.CMD,b=2*Math.PI,w=1e-4,P=[-1,-1,-1],C=[-1,-1];e.contain=l,e.containStroke=c},function(t,e){function i(t,e,i,n,o,r,s){if(0===o)return!1;var a=o,h=0,l=t;if(s>e+a&&s>n+a||s<e-a&&s<n-a||r>t+a&&r>i+a||r<t-a&&r<i-a)return!1;if(t===i)return Math.abs(r-t)<=a/2;h=(e-n)/(t-i),l=(t*n-i*e)/(t-i);var c=h*r-s+l,u=c*c/(h*h+1);return u<=a/2*a/2}e.containStroke=i},function(t,e,i){function n(t,e,i,n,r,s,a,h,l,c,u){if(0===l)return!1;var d=l;if(u>e+d&&u>n+d&&u>s+d&&u>h+d||u<e-d&&u<n-d&&u<s-d&&u<h-d||c>t+d&&c>i+d&&c>r+d&&c>a+d||c<t-d&&c<i-d&&c<r-d&&c<a-d)return!1;var p=o.cubicProjectPoint(t,e,i,n,r,s,a,h,c,u,null);return p<=d/2}var o=i(31);e.containStroke=n},function(t,e,i){function n(t,e,i,n,o,s,a,h,l){if(0===a)return!1;var c=a;if(l>e+c&&l>n+c&&l>s+c||l<e-c&&l<n-c&&l<s-c||h>t+c&&h>i+c&&h>o+c||h<t-c&&h<i-c&&h<o-c)return!1;var u=r(t,e,i,n,o,s,h,l,null);return u<=c/2}var o=i(31),r=o.quadraticProjectPoint;e.containStroke=n},function(t,e,i){function n(t,e,i,n,o,a,h,l,c){if(0===h)return!1;var u=h;l-=t,c-=e;var d=Math.sqrt(l*l+c*c);if(d-u>i||d+u<i)return!1;if(Math.abs(n-o)%s<1e-4)return!0;if(a){var p=n;n=r(o),o=r(p)}else n=r(n),o=r(o);n>o&&(o+=s);var f=Math.atan2(c,l);return f<0&&(f+=s),f>=n&&f<=o||f+s>=n&&f+s<=o}var o=i(38),r=o.normalizeRadian,s=2*Math.PI;e.containStroke=n},function(t,e){function i(t){return t%=n,t<0&&(t+=n),t}var n=2*Math.PI;e.normalizeRadian=i},function(t,e){function i(t,e,i,n,o,r){if(r>e&&r>n||r<e&&r<n)return 0;if(n===e)return 0;var s=n<e?1:-1,a=(r-e)/(n-e);1!==a&&0!==a||(s=n<e?.5:-.5);var h=a*(i-t)+t;return h>o?s:0}t.exports=i},function(t,e){var i=function(t,e){this.image=t,this.repeat=e,this.type="pattern"};i.prototype.getCanvasPattern=function(t){return t.createPattern(this.image,this.repeat||"repeat")};var n=i;t.exports=n},function(t,e,i){function n(t,e){var i,n,o,r,u,d,p=t.data,f=a.M,g=a.C,v=a.L,y=a.R,m=a.A,x=a.Q;for(o=0,r=0;o<p.length;){switch(i=p[o++],r=o,n=0,i){case f:n=1;break;case v:n=1;break;case g:n=3;break;case x:n=2;break;case m:var _=e[4],b=e[5],w=l(e[0]*e[0]+e[1]*e[1]),P=l(e[2]*e[2]+e[3]*e[3]),C=c(-e[1]/P,e[0]/w);p[o]*=w,p[o++]+=_,p[o]*=P,p[o++]+=b,p[o++]*=w,p[o++]*=P,p[o++]+=C,p[o++]+=C,o+=2,r=o;break;case y:d[0]=p[o++],d[1]=p[o++],s(d,d,e),p[r++]=d[0],p[r++]=d[1],d[0]+=p[o++],d[1]+=p[o++],s(d,d,e),p[r++]=d[0],p[r++]=d[1]}for(u=0;u<n;u++){var d=h[u];d[0]=p[o++],d[1]=p[o++],s(d,d,e),p[r++]=d[0],p[r++]=d[1]}}}var o=i(30),r=i(15),s=r.applyTransform,a=o.CMD,h=[[],[],[]],l=Math.sqrt,c=Math.atan2;t.exports=n},function(t,e){var i=function(t){this.colorStops=t||[]};i.prototype={constructor:i,addColorStop:function(t,e){this.colorStops.push({offset:t,color:e})}};var n=i;t.exports=n},function(t,e){function i(){this.on("mousedown",this._dragStart,this),this.on("mousemove",this._drag,this),this.on("mouseup",this._dragEnd,this),this.on("globalout",this._dragEnd,this)}function n(t,e){return{target:t,topTarget:e&&e.topTarget}}i.prototype={constructor:i,_dragStart:function(t){var e=t.target;e&&e.draggable&&(this._draggingTarget=e,e.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.dispatchToElement(n(e,t),"dragstart",t.event))},_drag:function(t){var e=this._draggingTarget;if(e){var i=t.offsetX,o=t.offsetY,r=i-this._x,s=o-this._y;this._x=i,this._y=o,e.drift(r,s,t),this.dispatchToElement(n(e,t),"drag",t.event);var a=this.findHover(i,o,e).target,h=this._dropTarget;this._dropTarget=a,e!==a&&(h&&a!==h&&this.dispatchToElement(n(h,t),"dragleave",t.event),a&&a!==h&&this.dispatchToElement(n(a,t),"dragenter",t.event))}},_dragEnd:function(t){var e=this._draggingTarget;e&&(e.dragging=!1),this.dispatchToElement(n(e,t),"dragend",t.event),this._dropTarget&&this.dispatchToElement(n(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null}};var o=i;t.exports=o},function(t,e,i){var n=i(5),o=i(10),r=i(27),s=function(t){t=t||{},o.call(this,t);for(var e in t)t.hasOwnProperty(e)&&(this[e]=t[e]);this._children=[],this.__storage=null,this.__dirty=!0};s.prototype={constructor:s,isGroup:!0,type:"group",silent:!1,children:function(){return this._children.slice()},childAt:function(t){return this._children[t]},childOfName:function(t){for(var e=this._children,i=0;i<e.length;i++)if(e[i].name===t)return e[i]},childCount:function(){return this._children.length},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this},addBefore:function(t,e){if(t&&t!==this&&t.parent!==this&&e&&e.parent===this){var i=this._children,n=i.indexOf(e);n>=0&&(i.splice(n,0,t),this._doAdd(t))}return this},_doAdd:function(t){t.parent&&t.parent.remove(t),t.parent=this;var e=this.__storage,i=this.__zr;e&&e!==t.__storage&&(e.addToStorage(t),t instanceof s&&t.addChildrenToStorage(e)),i&&i.refresh()},remove:function(t){var e=this.__zr,i=this.__storage,o=this._children,r=n.indexOf(o,t);return r<0?this:(o.splice(r,1),t.parent=null,i&&(i.delFromStorage(t),t instanceof s&&t.delChildrenFromStorage(i)),e&&e.refresh(),this)},removeAll:function(){var t,e,i=this._children,n=this.__storage;for(e=0;e<i.length;e++)t=i[e],n&&(n.delFromStorage(t),t instanceof s&&t.delChildrenFromStorage(n)),t.parent=null;return i.length=0,this},eachChild:function(t,e){for(var i=this._children,n=0;n<i.length;n++){var o=i[n];t.call(e,o,n)}return this},traverse:function(t,e){for(var i=0;i<this._children.length;i++){var n=this._children[i];t.call(e,n),"group"===n.type&&n.traverse(t,e)}return this},addChildrenToStorage:function(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];t.addToStorage(i),i instanceof s&&i.addChildrenToStorage(t)}},delChildrenFromStorage:function(t){for(var e=0;e<this._children.length;e++){var i=this._children[e];t.delFromStorage(i),i instanceof s&&i.delChildrenFromStorage(t)}},dirty:function(){return this.__dirty=!0,this.__zr&&this.__zr.refresh(),this},getBoundingRect:function(t){for(var e=null,i=new r(0,0,0,0),n=t||this._children,o=[],s=0;s<n.length;s++){var a=n[s];if(!a.ignore&&!a.invisible){var h=a.getBoundingRect(),l=a.getLocalTransform(o);l?(i.copy(h),i.applyTransform(l),e=e||i.clone(),e.union(i)):(e=e||h.clone(),e.union(h))}}return e||i}},n.inherits(s,o);var a=s;t.exports=a},function(t,e,i){function n(t){o.call(this,t)}var o=i(8),r=i(27),s=i(5),a=i(28);n.prototype={constructor:n,type:"image",brush:function(t,e){var i=this.style,n=i.image;i.bind(t,this,e);var o=this._image=a.createOrUpdateImage(n,this._image,this,this.onload);if(o&&a.isImageReady(o)){var r=i.x||0,s=i.y||0,h=i.width,l=i.height,c=o.width/o.height;if(null==h&&null!=l?h=l*c:null==l&&null!=h?l=h/c:null==h&&null==l&&(h=o.width,l=o.height),this.setTransform(t),i.sWidth&&i.sHeight){var u=i.sx||0,d=i.sy||0;t.drawImage(o,u,d,i.sWidth,i.sHeight,r,s,h,l)}else if(i.sx&&i.sy){var u=i.sx,d=i.sy,p=h-u,f=l-d;t.drawImage(o,u,d,p,f,r,s,h,l)}else t.drawImage(o,r,s,h,l);this.restoreTransform(t),null!=i.text&&this.drawRectText(t,this.getBoundingRect())}},getBoundingRect:function(){var t=this.style;return this._rect||(this._rect=new r(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect}},s.inherits(n,o);var h=n;t.exports=h},function(t,e,i){var n=i(8),o=i(5),r=i(26),s=i(25),a=function(t){n.call(this,t)};a.prototype={constructor:a,type:"text",brush:function(t,e){var i=this.style;this.__dirty&&s.normalizeTextStyle(i,!0),i.fill=i.stroke=i.shadowBlur=i.shadowColor=i.shadowOffsetX=i.shadowOffsetY=null;var n=i.text;null!=n&&(n+=""),i.bind(t,this,e),s.needDrawText(n,i)&&(this.setTransform(t),s.renderText(this,t,n,i),this.restoreTransform(t))},getBoundingRect:function(){var t=this.style;if(this.__dirty&&s.normalizeTextStyle(t,!0),!this._rect){var e=t.text;null!=e?e+="":e="";var i=r.getBoundingRect(t.text+"",t.font,t.textAlign,t.textVerticalAlign,t.textPadding,t.rich);if(i.x+=t.x||0,i.y+=t.y||0,s.getStroke(t.textStroke,t.textStrokeWidth)){var n=t.textStrokeWidth;i.x-=n/2,i.y-=n/2,i.width+=n,i.height+=n}this._rect=i;
}return this._rect}},o.inherits(a,n);var h=a;t.exports=h},function(t,e,i){var n=i(7),o=n.extend({type:"circle",shape:{cx:0,cy:0,r:0},buildPath:function(t,e,i){i&&t.moveTo(e.cx+e.r,e.cy),t.arc(e.cx,e.cy,e.r,0,2*Math.PI,!0)}});t.exports=o},function(t,e,i){var n=i(7),o=i(49),r=n.extend({type:"sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:o(n.prototype.brush),buildPath:function(t,e){var i=e.cx,n=e.cy,o=Math.max(e.r0||0,0),r=Math.max(e.r,0),s=e.startAngle,a=e.endAngle,h=e.clockwise,l=Math.cos(s),c=Math.sin(s);t.moveTo(l*o+i,c*o+n),t.lineTo(l*r+i,c*r+n),t.arc(i,n,r,s,a,!h),t.lineTo(Math.cos(a)*o+i,Math.sin(a)*o+n),0!==o&&t.arc(i,n,o,a,s,h),t.closePath()}});t.exports=r},function(t,e,i){function n(t){return o.browser.ie&&o.browser.version>=11?function(){var e,i=this.__clipPaths,n=this.style;if(i)for(var o=0;o<i.length;o++){var s=i[o],a=s&&s.shape,h=s&&s.type;if(a&&("sector"===h&&a.startAngle===a.endAngle||"rect"===h&&(!a.width||!a.height))){for(var l=0;l<r.length;l++)r[l][2]=n[r[l][0]],n[r[l][0]]=r[l][1];e=!0;break}}if(t.apply(this,arguments),e)for(var l=0;l<r.length;l++)n[r[l][0]]=r[l][2]}:t}var o=i(50),r=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]];t.exports=n},function(t,e){function i(t){var e={},i={},n=t.match(/Firefox\/([\d.]+)/),o=t.match(/MSIE\s([\d.]+)/)||t.match(/Trident\/.+?rv:(([\d.]+))/),r=t.match(/Edge\/([\d.]+)/),s=/micromessenger/i.test(t);return n&&(i.firefox=!0,i.version=n[1]),o&&(i.ie=!0,i.version=o[1]),r&&(i.edge=!0,i.version=r[1]),s&&(i.weChat=!0),{browser:i,os:e,node:!1,canvasSupported:!!document.createElement("canvas").getContext,svgSupported:"undefined"!=typeof SVGRect,touchEventsSupported:"ontouchstart"in window&&!i.ie&&!i.edge,pointerEventsSupported:"onpointerdown"in window&&(i.edge||i.ie&&i.version>=11)}}var n={};n="undefined"==typeof navigator?{browser:{},os:{},node:!0,canvasSupported:!0,svgSupported:!0}:i(navigator.userAgent);var o=n;t.exports=o},function(t,e,i){var n=i(7),o=n.extend({type:"ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=2*Math.PI;t.moveTo(i+e.r,n),t.arc(i,n,e.r,0,o,!1),t.moveTo(i+e.r0,n),t.arc(i,n,e.r0,0,o,!0)}});t.exports=o},function(t,e,i){var n=i(7),o=i(53),r=n.extend({type:"polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(t,e){o.buildPath(t,e,!0)}});t.exports=r},function(t,e,i){function n(t,e,i){var n=e.points,s=e.smooth;if(n&&n.length>=2){if(s&&"spline"!==s){var a=r(n,s,i,e.smoothConstraint);t.moveTo(n[0][0],n[0][1]);for(var h=n.length,l=0;l<(i?h:h-1);l++){var c=a[2*l],u=a[2*l+1],d=n[(l+1)%h];t.bezierCurveTo(c[0],c[1],u[0],u[1],d[0],d[1])}}else{"spline"===s&&(n=o(n,i)),t.moveTo(n[0][0],n[0][1]);for(var l=1,p=n.length;l<p;l++)t.lineTo(n[l][0],n[l][1])}i&&t.closePath()}}var o=i(54),r=i(55);e.buildPath=n},function(t,e,i){function n(t,e,i,n,o,r,s){var a=.5*(i-t),h=.5*(n-e);return(2*(e-i)+a+h)*s+(-3*(e-i)-2*a-h)*r+a*o+e}function o(t,e){for(var i=t.length,o=[],r=0,a=1;a<i;a++)r+=s(t[a-1],t[a]);var h=r/2;h=h<i?i:h;for(var a=0;a<h;a++){var l,c,u,d=a/(h-1)*(e?i:i-1),p=Math.floor(d),f=d-p,g=t[p%i];e?(l=t[(p-1+i)%i],c=t[(p+1)%i],u=t[(p+2)%i]):(l=t[0===p?p:p-1],c=t[p>i-2?i-1:p+1],u=t[p>i-3?i-1:p+2]);var v=f*f,y=f*v;o.push([n(l[0],g[0],c[0],u[0],f,v,y),n(l[1],g[1],c[1],u[1],f,v,y)])}return o}var r=i(15),s=r.distance;t.exports=o},function(t,e,i){function n(t,e,i,n){var o,d,p,f,g=[],v=[],y=[],m=[];if(n){p=[1/0,1/0],f=[-(1/0),-(1/0)];for(var x=0,_=t.length;x<_;x++)r(p,p,t[x]),s(f,f,t[x]);r(p,p,n[0]),s(f,f,n[1])}for(var x=0,_=t.length;x<_;x++){var b=t[x];if(i)o=t[x?x-1:_-1],d=t[(x+1)%_];else{if(0===x||x===_-1){g.push(c(t[x]));continue}o=t[x-1],d=t[x+1]}u(v,d,o),a(v,v,e);var w=h(b,o),P=h(b,d),C=w+P;0!==C&&(w/=C,P/=C),a(y,v,-w),a(m,v,P);var T=l([],b,y),N=l([],b,m);n&&(s(T,T,p),r(T,T,f),s(N,N,p),r(N,N,f)),g.push(T),g.push(N)}return i&&g.push(g.shift()),g}var o=i(15),r=o.min,s=o.max,a=o.scale,h=o.distance,l=o.add,c=o.clone,u=o.sub;t.exports=n},function(t,e,i){var n=i(7),o=i(53),r=n.extend({type:"polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(t,e){o.buildPath(t,e,!1)}});t.exports=r},function(t,e,i){var n=i(7),o=i(29),r=n.extend({type:"rect",shape:{r:0,x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,n=e.y,r=e.width,s=e.height;e.r?o.buildPath(t,e):t.rect(i,n,r,s),t.closePath()}});t.exports=r},function(t,e,i){var n=i(7),o=n.extend({type:"line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.x1,n=e.y1,o=e.x2,r=e.y2,s=e.percent;0!==s&&(t.moveTo(i,n),s<1&&(o=i*(1-s)+o*s,r=n*(1-s)+r*s),t.lineTo(o,r))},pointAt:function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]}});t.exports=o},function(t,e,i){function n(t,e,i){var n=t.cpx2,o=t.cpy2;return null===n||null===o?[(i?d:c)(t.x1,t.cpx1,t.cpx2,t.x2,e),(i?d:c)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(i?u:l)(t.x1,t.cpx1,t.x2,e),(i?u:l)(t.y1,t.cpy1,t.y2,e)]}var o=i(7),r=i(15),s=i(31),a=s.quadraticSubdivide,h=s.cubicSubdivide,l=s.quadraticAt,c=s.cubicAt,u=s.quadraticDerivativeAt,d=s.cubicDerivativeAt,p=[],f=o.extend({type:"bezier-curve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.x1,n=e.y1,o=e.x2,r=e.y2,s=e.cpx1,l=e.cpy1,c=e.cpx2,u=e.cpy2,d=e.percent;0!==d&&(t.moveTo(i,n),null==c||null==u?(d<1&&(a(i,s,o,d,p),s=p[1],o=p[2],a(n,l,r,d,p),l=p[1],r=p[2]),t.quadraticCurveTo(s,l,o,r)):(d<1&&(h(i,s,c,o,d,p),s=p[1],c=p[2],o=p[3],h(n,l,u,r,d,p),l=p[1],u=p[2],r=p[3]),t.bezierCurveTo(s,l,c,u,o,r)))},pointAt:function(t){return n(this.shape,t,!1)},tangentAt:function(t){var e=n(this.shape,t,!0);return r.normalize(e,e)}});t.exports=f},function(t,e,i){var n=i(7),o=n.extend({type:"arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.cx,n=e.cy,o=Math.max(e.r,0),r=e.startAngle,s=e.endAngle,a=e.clockwise,h=Math.cos(r),l=Math.sin(r);t.moveTo(h*o+i,l*o+n),t.arc(i,n,o,r,s,!a)}});t.exports=o},function(t,e,i){var n=i(5),o=i(42),r=function(t,e,i,n,r,s){this.x=null==t?0:t,this.y=null==e?0:e,this.x2=null==i?1:i,this.y2=null==n?0:n,this.type="linear",this.global=s||!1,o.call(this,r)};r.prototype={constructor:r},n.inherits(r,o);var s=r;t.exports=s},function(t,e,i){var n=i(5),o=i(42),r=function(t,e,i,n,r){this.x=null==t?.5:t,this.y=null==e?.5:e,this.r=null==i?.5:i,this.type="radial",this.global=r||!1,o.call(this,n)};r.prototype={constructor:r},n.inherits(r,o);var s=r;t.exports=s},function(t,e,i){var n=i(5),o=i(9),r=i(15),s=r.copy,a=["position","rotation","scale","style","shape"],h=function(t){"string"==typeof t?this._fromStr(t):t&&(t.property&&(this.property=t.property),null!=t.duration&&(this.duration=t.duration),t.easing&&(this.easing=t.easing),t.delay&&(this.delay=t.delay)),"*"!==this.property?this.property=this.property.split(","):this.property=a};h.prototype={constructor:h,property:"*",easing:"Linear",duration:500,delay:0,_fromStr:function(t){var e=t.split(/\s+/g);this.property=e[0],this.duration=+e[1],this.delay=+e[2],this.easing=e[3]}};var l=function(t){t=t||{},this._states={},this._el=t.el,this._subStates=[],this._transitionAnimators=[],t.initialState&&(this._initialState=t.initialState);var e=t.states;if(e)for(var i in e)if(e.hasOwnProperty(i)){var n=e[i];this._addState(i,n)}this.setState(this._initialState)};l.prototype={constructor:l,_initialState:"normal",_currentState:"",el:function(){return this._el},_addState:function(t,e){if(this._states[t]=e,e.transition&&(e.transition=new h(e.transition)),t!==this._initialState)this._extendFromInitial(e);else{var i=this._el;n.merge(e.style,i.style,!1,!1),e.shape?n.merge(e.shape,i.shape,!1,!0):e.shape=n.clone(i.shape,!0);for(var t in this._states)this._states.hasOwnProperty(t)&&this._extendFromInitial(this._states[t])}},_extendFromInitial:function(t){var e=this._states[this._initialState];e&&t!==e&&n.merge(t,e,!1,!0)},setState:function(t,e){if(t!==this._currentState||this.transiting()){var i=this._states[t];if(i){if(this._stopTransition(),!e){var r=this._states[this._currentState];r&&r.onleave&&r.onleave.call(this),i.onenter&&i.onenter.call(this)}if(this._currentState=t,this._el){var a=this._el;if(null!=i.zlevel&&(a.zlevel=i.zlevel),null!=i.z&&(a.z=i.z),i.position&&s(a.position,i.position),i.scale&&s(a.scale,i.scale),null!=i.rotation&&(a.rotation=i.rotation),i.style){var h=this._states[this._initialState];a.style=new o,h&&a.style.extendFrom(h.style,!1),t!=this._initialState&&h.style!==i.style&&a.style.extendFrom(i.style,!0)}i.shape&&(a.shape=n.clone(i.shape,!0)),a.dirty()}}for(var l=0;l<this._subStates.length;l++)this._subStates.setState(t)}},getState:function(){return this._currentState},transitionState:function(t,e){if(t!==this._currentState||this.transiting()){var i=this._states[t],n=/$[style|shape]\./,o=this,r={};if(i){o._stopTransition();var s=o._el;if(i.transition&&s&&s.__zr){for(var a=i.transition,h=a.property,l=0,c=function(){l--,0===l&&(o.setState(t),e&&e())},u=0;u<h.length;u++){var d=h[u];if("style"===d||"shape"===d){if(i[d])for(var p in i[d])if(i[d].hasOwnProperty(p)){var f=d+"."+p;r[f]||(r[f]=1,l+=o._animProp(i,d,p,a,c))}}else{if(r[d])continue;if(r[d]=1,d.match(n)){var g=d.slice(0,5);d=d.slice(6),l+=o._animProp(i,g,d,a,c)}else l+=o._animProp(i,"",d,a,c)}}0===l&&(o.setState(t),e&&e())}else o.setState(t),e&&e()}for(var v=o._subStates,u=0;u<v.length;u++)v.transitionState(t)}},_animProp:function(t,e,i,o,r){var s=this._el,a=e?t[e]:t,h=e?s[e]:s,l=a&&i in a&&h&&i in h,c=this._transitionAnimators;if(l){var u={};if(a[i]===h[i])return 0;u[i]=a[i];var d=s.animate(e).when(o.duration,u).delay(o.dealy).done(function(){var t=n.indexOf(c,1);t>0&&c.splice(t,1),r()}).start(o.easing);return c.push(d),1}return 0},_stopTransition:function(){for(var t=this._transitionAnimators,e=0;e<t.length;e++)t[e].stop();t.length=0},transiting:function(){return this._transitionAnimators.length>0},addSubStates:function(t){this._subStates.push(t)},removeSubStates:function(t){var e=n.indexOf(this._subStates,t);e>=0&&this._subStates.splice(t,1)}};var c=l;t.exports=c},function(t,e,i){function n(t,e,i,n,r,s){this.bigCanvas=t,this.eagleEyeNode=n,this.distance=r,this.imgSrc=s,this.ratio,this.groupRatio,this.group=i,this.img=document.createElement("img"),this.selection=document.createElement("div"),this.groupPosition=o.clone(e),this.selectPosition=[0,0],this.render()}var o=i(5);i(27);n.prototype.render=function(){var t=this;t.ratio=.12;var e=t.group.width*t.ratio,i=t.group.height*t.ratio;t.eagleEyeNode.style.width=e+"px",t.eagleEyeNode.style.height=i+"px",t.eagleEyeNode.style.marginTop=-i+"px",t.eagleEyeNode.style.marginLeft=t.bigCanvas.getWidth()-e+"px",t.eagleEyeNode.style.position="relative",t.eagleEyeNode.style.background="url("+t.imgSrc+") no-repeat",t.eagleEyeNode.style.backgroundSize=e/(t.group.width*t.distance[2]/t.bigCanvas.getWidth())+"px",t.backgroundSize=o.clone(t.eagleEyeNode.style.backgroundSize),t.eagleEyeNode.innerHTML="",t.selection.style.border="1px solid #ff0000",t.selection.style.cursor="pointer",t.selection.style.width=t.bigCanvas.getWidth()/t.group.width*e+"px",t.selection.style.height=t.bigCanvas.getHeight()/t.group.height*i+"px",t.selectWidth=t.selection.style.width,t.selectHeight=t.selection.style.height,t.selection.style.position="absolute",t.selection.style.top="0px",t.selection.style.left="0px",t.eagleEyeNode.appendChild(this.selection)},n.prototype.updataSelection=function(t,e,i,n){var r=this;r.zoomScale=i,this.selection.style.width=this.selection.style.width.replace("px","")/i+"px",this.selection.style.height=this.selection.style.height.replace("px","")/i+"px",r.selectPosition[0]=o.clone(t)*r.ratio/n,r.selectPosition[1]=o.clone(e)*r.ratio/n,this.selection.style.left=-r.selectPosition[0]+"px",this.selection.style.top=-r.selectPosition[1]+"px"},n.prototype.updataMap=function(t,e){var i=this;i.eagleEyeNode.style.backgroundImage="url("+t+")";var n=e.width*i.ratio,o=e.height*i.ratio;i.eagleEyeNode.style.width=n+"px",i.eagleEyeNode.style.height=o+"px",i.eagleEyeNode.style.marginTop=-o+"px",i.eagleEyeNode.style.marginLeft=i.bigCanvas.getWidth()-n+"px"},n.prototype.updataSelectionPosition=function(t,e){var i=this;i.selectPosition[0]=o.clone(t[0])*i.ratio/e,i.selectPosition[1]=o.clone(t[1])*i.ratio/e,this.selection.style.left=-i.selectPosition[0]+"px",this.selection.style.top=-i.selectPosition[1]+"px"},n.prototype.updataGroupPosition=function(t,e){var i=this,n=-Number(i.selection.style.left.substring(0,i.selection.style.left.length-2))/i.ratio*e,o=-Number(i.selection.style.top.substring(0,i.selection.style.top.length-2))/i.ratio*e;t.attr("position",[n,o])},t.exports=n},function(t,e,i){function n(t,e){function i(){}var n=t.prototype;i.prototype=e.prototype,t.prototype=new i;for(var o in n)t.prototype[o]=n[o];t.prototype.constructor=t,t.superClass=e}function o(){for(var t,e="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz".split(""),i=new Array(36),n=0,o=0;o<36;o++)8==o||13==o||18==o||23==o?i[o]="-":14==o?i[o]="4":(n<=2&&(n=33554432+16777216*Math.random()|0),t=15&n,n>>=4,i[o]=e[19==o?3&t|8:t]);return"sid-"+i.join("")}function r(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function s(t){for(var e=r(t[0],t[1]),i=[t[0],t[1]],n=1;n<t.length-1;n++)e<r(t[n],t[n+1])&&(e=r(t[n],t[n+1]),i=[t[n],t[n+1]]);return i}function a(t){for(var e=0,i=0;i<t.length-1;i++)e+=r(t[i],t[i+1]);return e}function h(t){if(0==t.lenght)return NaN;for(var e=t[0],i=0;i<t.length;i++)e<t[i]&&(e=t[i]);return e}function l(t){if(0==t.lenght)return NaN;for(var e=t[0],i=0;i<t.length;i++)e>t[i]&&(e=t[i]);return e}function c(t){if(t.length<=1)return!0;for(var e=0;e<t.length-1;e++)if(t[e].x!=t[e+1].x&&t[e].y!=t[e+1].y)return!1;return!0}function u(t,e){if(t.startPoint.x==t.endPoint.x&&e.startPoint.x==e.endPoint.x)return t.startPoint.x==e.startPoint.x&&(t.contains(e.startPoint.x,e.startPoint.y)||t.contains(e.endPoint.x,e.endPoint.y));if(t.startPoint.x==t.endPoint.x||e.startPoint.x==e.endPoint.x){if(t.startPoint.x==t.endPoint.x){var i=t;t=e,e=i}var n=(t.endPoint.y-t.startPoint.y)/(t.endPoint.x-t.startPoint.x),o=t.startPoint.y-n*t.startPoint.x,r=e.startPoint.x,s=n*r+o;return t.contains(r,s)&&e.contains(r,s)}var a=(t.endPoint.y-t.startPoint.y)/(t.endPoint.x-t.startPoint.x),h=t.startPoint.y-a*t.startPoint.x,l=(e.endPoint.y-e.startPoint.y)/(e.endPoint.x-e.startPoint.x),c=e.startPoint.y-l*e.startPoint.x;return a==l?h==c&&(t.contains(e.startPoint.x,e.startPoint.y)||t.contains(e.endPoint.x,e.endPoint.y)):(r=(c-h)/(a-l),s=a*r+h,t.contains(r,s)&&e.contains(r,s))}function d(t,e,i){var n=[];n.push(new H(new D(e[0],e[1]),new D(e[2],e[1]))),n.push(new H(new D(e[2],e[1]),new D(e[2],e[3]))),n.push(new H(new D(e[2],e[3]),new D(e[0],e[3]))),n.push(new H(new D(e[0],e[3]),new D(e[0],e[1])));for(var o=0;o<t.length-1;o++)for(var r=new H(t[o],t[o+1]),s=0;s<n.length;s++)if(u(r,n[s]))return!0;if(i)for(var a=new H(t[t.length-1],t[0]),h=0;h<n.length;h++)if(u(a,n[h]))return!0;return!1}function p(t){if(t.length<=2)return-1;for(var e=0,i=1;i<t.length-1;i++)if(t[i-1].x==t[i].x&&t[i].x==t[i+1].x){if(f(t[i+1].y-t[i].y)!=f(t[i].y-t[i-1].y))return-1;e++}else if(t[i-1].y==t[i].y&&t[i].y==t[i+1].y){if(f(t[i+1].x-t[i].x)!=f(t[i].x-t[i-1].x))return-1;e++}else e--;return e}function f(t){return t>0?1:t<0?-1:0}function g(t){if(t.length<=2)return!0;for(var e=0;e<t.length-2;e++)if(t[e].x==t[e+1].x&&t[e+1].x==t[e+2].x){if(0!=f(t[e+1].y-t[e].y)&&f(t[e+1].y-t[e].y)==-1*f(t[e+2].y-t[e+1].y))return!1}else if(t[e].y==t[e+1].y&&t[e+1].y==t[e+2].y&&0!=f(t[e+1].x-t[e].x)&&f(t[e+1].x-t[e].x)==-1*f(t[e+2].x-t[e+1].x))return!1;return!0}function v(t,e){var i=[];if(e){for(var n=0;n<t.length;n++){var o=t[n];i.push(new D(o[0],o[1]))}return i}for(var r=0;r<t.length;r++){var s=t[r];i.push([s.x,s.y])}return i}function y(t){var e=[[Math.cos(t),-Math.sin(t),0],[Math.sin(t),Math.cos(t),0],[0,0,1]];return e}function m(t,e){return[[1,0,t],[0,1,e],[0,0,1]]}function x(t,e){return null==e&&(e=t),[[t,0,0],[0,e,0],[0,0,1]]}function _(t,e,i){var n=t.clone();return n.transform(m(-t.x,-t.y)),n.y-=e,n.transform(y(i)),n.transform(m(t.x,t.y)),n}function b(t,e){e=e||{};var i=G.clone(t.boundingRect||t),n=e.rotation,o={left:new D(i.x,i.y+i.height/2),top:new D(i.x+i.width/2,i.y),right:new D(i.x+i.width,i.y+i.height/2),bottom:new D(i.x+i.width/2,i.y+i.height),center:new D(i.x+i.width/2,i.y+i.height/2)};if(Object.keys(e).length>0&&Math.abs(n)>0){var r=t.boundingRect?t:E(e),s={x:r.x,y:r.y};Object.keys(o).forEach(function(t){var e=o[t],i=s.x-e.x,r=s.y-e.y,a=Math.sin(-n),h=Math.cos(-n),l=s.x-(i*h-r*a),c=s.y-(i*a+r*h);o[t].x=l,o[t].y=c})}return o}function w(t,e){e=e||{};var i=G.clone(t.boundingRect),n=e.rotation,o={tl:new D(i.x,i.y),tc:new D(i.x+i.width/2,i.y-4),tr:new D(i.x+i.width,i.y),bl:new D(i.x,i.y+i.height),br:new D(i.x+i.width,i.y+i.height),mtr:new D(i.x+i.width/2,i.y-20)};if(Object.keys(e).length>0&&Math.abs(n)>0){var r=t,s={x:r.x,y:r.y};Object.keys(o).forEach(function(t){var e=o[t],i=s.x-e.x,r=s.y-e.y,a=Math.sin(-n),h=Math.cos(-n),l=s.x-(i*h-r*a),c=s.y-(i*a+r*h);o[t].x=l,o[t].y=c})}return o}function P(t,e,i){var n=Array.isArray(t)?t[0]:t.x,o=Array.isArray(t)?t[1]:t.y,r=e.x-n,s=e.y-o,a=Math.sin(-i),h=Math.cos(-i),l=e.x-(r*h-s*a),c=e.y-(r*a+s*h);return Array.isArray(t)?[l,c]:{x:l,y:c}}function C(t){return[[10*Math.round(t.getRect().width/3/10),0],[10*Math.round(2*t.getRect().width/3/10),0],[t.getRect().width,10*Math.round(t.getRect().height/3/10)],[t.getRect().width,10*Math.round(2*t.getRect().height/3/10)],[10*Math.round(t.getRect().width/3/10),t.getRect().height],[10*Math.round(2*t.getRect().width/3/10),t.getRect().height],[0,10*Math.round(t.getRect().height/3/10)],[0,10*Math.round(2*t.getRect().height/3/10)]]}function T(t,e){return-Math.PI/2-Math.atan2(e.y-t.y,e.x-t.x)}function N(t,e,i,n){var o=t.x*e.y+t.y*i.x+e.x*i.y-(e.y*i.x+t.y*e.x+t.x*i.y);return n?Math.abs(o)<=n:0===o}function S(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function M(t,e){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}function A(t,e,i){t.x=S(t.x,5),t.y=S(t.y,5),e.x=S(e.x,5),e.y=S(e.y,5);var n=Math.atan((e.x-t.x)/(e.y-t.y));for(n=-n,e.x>=t.x&&e.y>=t.y?n+=Math.PI:e.x<=t.x&&e.y>=t.y?n+=Math.PI:e.x<=t.x&&e.y<=t.y&&(n+=2*Math.PI);n>=2*Math.PI;)n-=2*Math.PI;return isNaN(n)&&(n=0),i&&(n=Math.round(n/i)*i),n}function E(t,e){var i=t.clipPath,n=t.getBoundingRect();i&&(n=i.getBoundingRect());var o=[];o[0]=[-n.width/2,-n.height/2],o[1]=[n.width/2,-n.height/2],o[2]=[n.width/2,n.height/2],o[3]=[-n.width/2,n.height/2],o[4]=[-n.width/2,-n.height/2];var r=t.position[0],s=t.position[1];t.parent&&"GroupNode"===t.parent.type&&e&&(r+=t.parent.position[0],s+=t.parent.position[1]);var a=new F(Number(r+n.x),Number(s+n.y),Number(n.width),Number(n.height)),h=Number(r)+Number(n.width)/2+Number(n.x),l=Number(s)+Number(n.height)/2+Number(n.y);return{x:Number(h),y:Number(l),width:Number(n.width),height:Number(n.height),points:o,boundingRect:a}}function R(){for(var t,e=["0","2","3","4","5","6","7","8","9","a","b","c","d"],i="#",n=0;n<6;n++)t=Math.round(15*Math.random()),i+=e[t];return i}function L(t){return void 0===t}function k(t){var e=[];if(t.length<3)return D.cloneArray(t);e.push(t[0].clone());for(var i=1;i<t.length-1;i++)t[i-1].x==t[i].x&&t[i].x==t[i+1].x||t[i-1].y==t[i].y&&t[i].y==t[i+1].y||e.push(t[i].clone());return e.push(t[t.length-1].clone()),e}function O(t,e,i){!e&&i&&(e=i),e=e||{},e=G.defaults(e,W,!0);var n=RegExp([(e.escape||V).source,(e.interpolate||V).source,(e.evaluate||V).source].join("|")+"|$","g"),o=0,r="__p+='";t.replace(n,function(e,i,n,s,a){return r+=t.slice(o,a).replace(q,j),o=a+e.length,i?r+="'+\n((__t=("+i+"))==null?'':_.escape(__t))+\n'":n?r+="'+\n((__t=("+n+"))==null?'':__t)+\n'":s&&(r+="';\n"+s+"\n__p+='"),e}),r+="';\n",e.variable||(r="with(obj||{}){\n"+r+"}\n"),r="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+r+"return __p;\n";try{var s=new Function(e.variable||"obj",r)}catch(a){throw a.source=r,a}var h=function(t){return s.call(this,t)},l=e.variable||"obj";return h.source="function("+l+"){\n"+r+"}",h}function I(t){return null==t||(G.isArrayLike(t)&&(G.isArray(t)||G.isString(t))?0===t.length:void 0)}function z(t,e,i,n){if(!G.isObject(e)||!G.isObject(t))return i?G.clone(e):t;for(var o in e)if(e.hasOwnProperty(o)){var r=t[o],s=e[o];!G.isObject(s)||!G.isObject(r)||G.isArray(s)||G.isArray(r)||G.isDom(s)||G.isDom(r)||G.isBuiltInObject(s)||G.isBuiltInObject(r)||G.isPrimitive(s)||G.isPrimitive(r)?!i&&o in t||o!==n&&(t[o]=G.clone(e[o],!0)):z(r,s,i,n)}return t}function B(){}var D=i(66),H=i(67),F=i(27),G=i(5),Y={createNew:function(){var t=[];return{add:function(t,e){var i=this.get(t);i.push(e)},get:function(e){for(var i=0;i<t.length;i++)if(e==t[i].key)return t[i].value;var n=[];return t.push({key:e,value:n}),n},keys:function(){for(var e=[],i=0;i<t.length;i++)e.push(t[i].key);return e},top:function(){return t[t.length-1]},remove:function(e){for(var i=-1,n=0;n<t.length;n++)if(e==t[n].key){i=n;break}return t.splice(i,1)[0]},removeItem:function(t,e){var i=this.get(t),n=G.indexOf(i,e);i.splice(n,1)},removeTop:function(){return t.splice(t.length-1,1)[0]},length:function(){return t.length},clear:function(){t.splice(0,t.length)}}}},W={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},V=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},q=/\\|'|\r|\n|\u2028|\u2029/g,j=function(t){return"\\"+U[t]};B.extend=function(t){var e,i,n=function(){},o=this,r=t&&t.init?t.init:function(){o.apply(this,arguments)};n.prototype=o.prototype,i=r.fn=r.prototype=new n;for(e in t)null!=t[e]&&t[e].constructor===Object?i[e]=G.mergeAll([{},n.prototype[e],t[e]],!0):i[e]=t[e];return i.constructor=r,r.extend=o.extend,r},t.exports={inherits:n,getUUID:o,distance:r,getPolylineLength:a,max:h,min:l,isEmpty:I,mergeOpt:z,orthogonalPath:c,polylineIntersectsRectangle:d,scorePath:p,forwardPath:g,traslatePoints:v,getEndPoint:_,getConnectorPoints:b,getConnectorControls:w,calculatePoints:P,tangentRotation:T,collinearity:N,translationMatrix:m,scaleMatrix:x,round:S,getLength:M,getAngle:A,getRect:E,StackedMap:Y,getMaxLineLength:s,randomColor:R,template:O,isUndefined:L,getSoltPoints:C,collinearReduction:k,Class:B}},function(t,e){function i(t,e){this.x=t,this.y=e}i.load=function(t){var e=new i(Number(t.x),Number(t.y));return e},i.loadArray=function(t){for(var e=[],n=0;n<t.length;n++)e.push(i.load(t[n]));return e},i.cloneArray=function(t){for(var e=[],i=0;i<t.length;i++)e.push(t[i].clone());return e},i.prototype={constructor:i,transform:function(t){var e=this.x,i=this.y;this.x=t[0][0]*e+t[0][1]*i+t[0][2],this.y=t[1][0]*e+t[1][1]*i+t[1][2]},equals:function(t){return t instanceof i&&(this.x==t.x&&this.y==t.y)},clone:function(){var t=new i(this.x,this.y);return t},add:function(t){return this.x=this.x+t.x,this.y=this.y+t.y,this},near:function(t,e,i){var n=Math.sqrt(Math.pow(this.x-t,2)+Math.pow(this.y-e,2));return n<=i},contains:function(t,e){return this.x==t&&this.y==e},toString:function(){return"["+this.x+","+this.y+"]"},getPoints:function(){return[this]}},t.exports=i},function(t,e){function i(t,e){this.startPoint=t,this.endPoint=e,this.oType="Line"}i.load=function(t){var e=new i(Point.load(t.startPoint),Point.load(t.endPoint));return e},i.prototype={contructor:i,clone:function(){var t=new i(this.startPoint.clone(),this.endPoint.clone());return t},equals:function(t){return!(!t instanceof i)&&(this.startPoint.equals(t.startPoint)&&this.endPoint.equals(t.endPoint))},contains:function(t,e){if(Math.min(this.startPoint.x,this.endPoint.x)<=t&&t<=Math.max(this.startPoint.x,this.endPoint.x)&&Math.min(this.startPoint.y,this.endPoint.y)<=e&&e<=Math.max(this.startPoint.y,this.endPoint.y)){if(this.startPoint.x==this.endPoint.x)return t==this.startPoint.x;var i=(this.endPoint.y-this.startPoint.y)/(this.endPoint.x-this.startPoint.x),n=this.startPoint.y-i*this.startPoint.x;return e==i*t+n}return!1},near:function(t,e,i){if(this.endPoint.x===this.startPoint.x)return(this.startPoint.y-i<=e&&this.endPoint.y+i>=e||this.endPoint.y-i<=e&&this.startPoint.y+i>=e)&&t>this.startPoint.x-i&&t<this.startPoint.x+i;if(this.startPoint.y===this.endPoint.y)return(this.startPoint.x-i<=t&&this.endPoint.x+i>=t||this.endPoint.x-i<=t&&this.startPoint.x+i>=t)&&e>this.startPoint.y-i&&e<this.startPoint.y+i;var n=Math.min(this.endPoint.x,this.startPoint.x),o=Math.min(this.endPoint.y,this.startPoint.y),r=Math.max(this.endPoint.x,this.startPoint.x),s=Math.max(this.endPoint.y,this.startPoint.y),a=this.endPoint.y-this.startPoint.y,h=this.startPoint.x-this.endPoint.x,l=-(this.startPoint.x*this.endPoint.y-this.endPoint.x*this.startPoint.y),c=Math.abs((a*t+h*e+l)/Math.sqrt(Math.pow(a,2)+Math.pow(h,2))),u=(h*(h*t-a*e)-a*l)/(Math.pow(a,2)+Math.pow(h,2)),d=(a*(-h*t+a*e)-h*l)/(Math.pow(a,2)+Math.pow(h,2)),p=c<=i&&r>=u&&u>=n&&s>=d&&d>=o||this.startPoint.near(t,e,i)||this.endPoint.near(t,e,i);return p},getPoints:function(){var t=[];return t.push(this.startPoint),t.push(this.endPoint),t},getPoint:function(t){var e=t*(this.endPoint.x-this.startPoint.x)+this.startPoint.x,i=t*(this.endPoint.y-this.startPoint.y)+this.startPoint.y;return new Point(e,i)},toString:function(){return"line("+this.startPoint+","+this.endPoint+")"}},t.exports=i},function(t,e,i){"use strict";function n(t){o.each(r,function(e){this[e]=o.bind(t[e],t)},this)}var o=i(5),r=["getDom","getZr","getWidth","getHeight","dispatchAction","on","off","trigger","getDataURL","getConnectedDataURL","getModel","getOption","remove","_getParentZr","changeSelectConnectorType","_addGroupNode"];t.exports=n},function(t,e,i){function n(t,e){var i=new _(h(),t,e);return m[i.id]=i,i}function o(t){if(t)t.dispose();else{for(var e in m)m.hasOwnProperty(e)&&m[e].dispose();m={}}return this}function r(t){return m[t]}function s(t,e){y[t]=e}function a(t){delete m[t]}var h=i(11),l=i(50),c=i(5),u=i(70),d=i(71),p=i(73),f=i(76),g=i(78),v=!l.canvasSupported,y={canvas:p},m={},x="3.7.4",_=function(t,e,i){i=i||{},this.dom=e,this.id=t;var n=this,o=new d,r=i.renderer;if(v){if(!y.vml)throw new Error("You need to require 'zrender/vml/vml' to support IE8");r="vml"}else r&&y[r]||(r="canvas");var s=new y[r](e,o,i);this.storage=o,this.painter=s;var a=l.node?null:new g(s.getViewportRoot());this.handler=new u(o,s,a,s.root),this.animation=new f({stage:{update:c.bind(this.flush,this)}}),this.animation.start(),this._needsRefresh;var h=o.delFromStorage,p=o.addToStorage;o.delFromStorage=function(t){h.call(o,t),t&&t.removeSelfFromZr(n)},o.addToStorage=function(t){p.call(o,t),t.addSelfToZr(n)}};_.prototype={constructor:_,getId:function(){return this.id},add:function(t){this.storage.addRoot(t),this._needsRefresh=!0},remove:function(t){this.storage.delRoot(t),this._needsRefresh=!0},configLayer:function(t,e){this.painter.configLayer(t,e),this._needsRefresh=!0},refreshImmediately:function(){this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1},refresh:function(){this._needsRefresh=!0},flush:function(){this._needsRefresh&&this.refreshImmediately(),this._needsRefreshHover&&this.refreshHoverImmediately()},addHover:function(t,e){this.painter.addHover&&(this.painter.addHover(t,e),this.refreshHover())},removeHover:function(t){this.painter.removeHover&&(this.painter.removeHover(t),this.refreshHover())},clearHover:function(){this.painter.clearHover&&(this.painter.clearHover(),this.refreshHover())},refreshHover:function(){this._needsRefreshHover=!0},refreshHoverImmediately:function(){this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.refreshHover()},resize:function(t){t=t||{},this.painter.resize(t.width,t.height),this.handler.resize()},clearAnimation:function(){this.animation.clear()},getWidth:function(){return this.painter.getWidth()},getHeight:function(){return this.painter.getHeight()},pathToImage:function(t,e){return this.painter.pathToImage(t,e)},setCursorStyle:function(t){this.handler.setCursorStyle(t)},findHover:function(t,e){return this.handler.findHover(t,e)},on:function(t,e,i){this.handler.on(t,e,i)},off:function(t,e){this.handler.off(t,e)},trigger:function(t,e){this.handler.trigger(t,e)},clear:function(){this.storage.delRoot(),this.painter.clear()},dispose:function(){this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,a(this.id)}},e.version=x,e.init=n,e.dispose=o,e.getInstance=r,e.registerPainter=s},function(t,e,i){function n(t,e,i){return{type:t,event:i,target:e.target,topTarget:e.topTarget,cancelBubble:!1,offsetX:i.zrX,offsetY:i.zrY,gestureEvent:i.gestureEvent,pinchX:i.pinchX,pinchY:i.pinchY,pinchScale:i.pinchScale,wheelDelta:i.zrDelta,zrByTouch:i.zrByTouch,which:i.which}}function o(){}function r(t,e,i){if(t[t.rectHover?"rectContain":"contain"](e,i)){for(var n,o=t;o;){if(o.clipPath&&!o.clipPath.contain(e,i))return!1;o.silent&&(n=!0),o=o.parent}return!n||c}return!1}var s=i(5),a=i(15),h=i(43),l=i(12),c="silent";o.prototype.dispose=function(){};var u=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],d=function(t,e,i,n){l.call(this),this.storage=t,this.painter=e,this.painterRoot=n,i=i||new o,this.proxy=i,i.handler=this,this._hovered={},this._lastTouchMoment,this._lastX,this._lastY,h.call(this),s.each(u,function(t){i.on&&i.on(t,this[t],this)},this)};d.prototype={constructor:d,mousemove:function(t){var e=t.zrX,i=t.zrY,n=this._hovered,o=n.target;o&&!o.__zr&&(n=this.findHover(n.x,n.y),o=n.target);var r=this._hovered=this.findHover(e,i),s=r.target,a=this.proxy;a.setCursor&&a.setCursor(s?s.cursor:"default"),o&&s!==o&&this.dispatchToElement(n,"mouseout",t),this.dispatchToElement(r,"mousemove",t),s&&s!==o&&this.dispatchToElement(r,"mouseover",t)},mouseout:function(t){this.dispatchToElement(this._hovered,"mouseout",t);var e,i=t.toElement||t.relatedTarget;do i=i&&i.parentNode;while(i&&9!=i.nodeType&&!(e=i===this.painterRoot));!e&&this.trigger("globalout",{event:t})},resize:function(t){this._hovered={}},dispatch:function(t,e){var i=this[t];i&&i.call(this,e)},dispose:function(){this.proxy.dispose(),this.storage=this.proxy=this.painter=null},setCursorStyle:function(t){var e=this.proxy;e.setCursor&&e.setCursor(t)},dispatchToElement:function(t,e,i){t=t||{};var o=t.target;if(!o||!o.silent){for(var r="on"+e,s=n(e,t,i);o&&(o[r]&&(s.cancelBubble=o[r].call(o,s)),o.trigger(e,s),o=o.parent,!s.cancelBubble););s.cancelBubble||(this.trigger(e,s),this.painter&&this.painter.eachOtherLayer(function(t){"function"==typeof t[r]&&t[r].call(t,s),t.trigger&&t.trigger(e,s)}))}},findHover:function(t,e,i){for(var n=this.storage.getDisplayList(),o={x:t,y:e},s=n.length-1;s>=0;s--){var a;if(n[s]!==i&&!n[s].ignore&&(a=r(n[s],t,e))&&(!o.topTarget&&(o.topTarget=n[s]),a!==c)){o.target=n[s];break}}return o}},s.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){d.prototype[t]=function(e){var i=this.findHover(e.zrX,e.zrY),n=i.target;if("mousedown"===t)this._downEl=n,this._downPoint=[e.zrX,e.zrY],this._upEl=n;else if("mosueup"===t)this._upEl=n;else if("click"===t){if(this._downEl!==this._upEl||!this._downPoint||a.dist(this._downPoint,[e.zrX,e.zrY])>4)return;this._downPoint=null}this.dispatchToElement(i,t,e)}}),s.mixin(d,l),s.mixin(d,h);var p=d;t.exports=p},function(t,e,i){function n(t,e){return t.zlevel===e.zlevel?t.z===e.z?t.z2-e.z2:t.z-e.z:t.zlevel-e.zlevel}var o=i(5),r=i(50),s=i(44),a=i(72),h=function(){this._roots=[],this._displayList=[],this._displayListLen=0};h.prototype={constructor:h,traverse:function(t,e){for(var i=0;i<this._roots.length;i++)this._roots[i].traverse(t,e)},getDisplayList:function(t,e){return e=e||!1,t&&this.updateDisplayList(e),this._displayList},updateDisplayList:function(t){this._displayListLen=0;for(var e=this._roots,i=this._displayList,o=0,s=e.length;o<s;o++)this._updateAndAddDisplayable(e[o],null,t);i.length=this._displayListLen,r.canvasSupported&&a(i,n)},_updateAndAddDisplayable:function(t,e,i){if(!t.ignore||i){
t.beforeUpdate(),t.__dirty&&t.update(),t.afterUpdate();var n=t.clipPath;if(n){e=e?e.slice():[];for(var o=n,r=t;o;)o.parent=r,o.updateTransform(),e.push(o),r=o,o=o.clipPath}if(t.isGroup){for(var s=t._children,a=0;a<s.length;a++){var h=s[a];t.__dirty&&(h.__dirty=!0),this._updateAndAddDisplayable(h,e,i)}t.__dirty=!1}else t.__clipPaths=e,this._displayList[this._displayListLen++]=t}},addRoot:function(t){t.__storage!==this&&(t instanceof s&&t.addChildrenToStorage(this),this.addToStorage(t),this._roots.push(t))},delRoot:function(t){if(null==t){for(var e=0;e<this._roots.length;e++){var i=this._roots[e];i instanceof s&&i.delChildrenFromStorage(this)}return this._roots=[],this._displayList=[],void(this._displayListLen=0)}if(t instanceof Array)for(var e=0,n=t.length;e<n;e++)this.delRoot(t[e]);else{var r=o.indexOf(this._roots,t);r>=0&&(this.delFromStorage(t),this._roots.splice(r,1),t instanceof s&&t.delChildrenFromStorage(this))}},addToStorage:function(t){return t.__storage=this,t.dirty(!1),this},delFromStorage:function(t){return t&&(t.__storage=null),this},dispose:function(){this._renderList=this._roots=null},displayableSortFunc:n};var l=h;t.exports=l},function(t,e){function i(t){for(var e=0;t>=c;)e|=1&t,t>>=1;return t+e}function n(t,e,i,n){var r=e+1;if(r===i)return 1;if(n(t[r++],t[e])<0){for(;r<i&&n(t[r],t[r-1])<0;)r++;o(t,e,r)}else for(;r<i&&n(t[r],t[r-1])>=0;)r++;return r-e}function o(t,e,i){for(i--;e<i;){var n=t[e];t[e++]=t[i],t[i--]=n}}function r(t,e,i,n,o){for(n===e&&n++;n<i;n++){for(var r,s=t[n],a=e,h=n;a<h;)r=a+h>>>1,o(s,t[r])<0?h=r:a=r+1;var l=n-a;switch(l){case 3:t[a+3]=t[a+2];case 2:t[a+2]=t[a+1];case 1:t[a+1]=t[a];break;default:for(;l>0;)t[a+l]=t[a+l-1],l--}t[a]=s}}function s(t,e,i,n,o,r){var s=0,a=0,h=1;if(r(t,e[i+o])>0){for(a=n-o;h<a&&r(t,e[i+o+h])>0;)s=h,h=(h<<1)+1,h<=0&&(h=a);h>a&&(h=a),s+=o,h+=o}else{for(a=o+1;h<a&&r(t,e[i+o-h])<=0;)s=h,h=(h<<1)+1,h<=0&&(h=a);h>a&&(h=a);var l=s;s=o-h,h=o-l}for(s++;s<h;){var c=s+(h-s>>>1);r(t,e[i+c])>0?s=c+1:h=c}return h}function a(t,e,i,n,o,r){var s=0,a=0,h=1;if(r(t,e[i+o])<0){for(a=o+1;h<a&&r(t,e[i+o-h])<0;)s=h,h=(h<<1)+1,h<=0&&(h=a);h>a&&(h=a);var l=s;s=o-h,h=o-l}else{for(a=n-o;h<a&&r(t,e[i+o+h])>=0;)s=h,h=(h<<1)+1,h<=0&&(h=a);h>a&&(h=a),s+=o,h+=o}for(s++;s<h;){var c=s+(h-s>>>1);r(t,e[i+c])<0?h=c:s=c+1}return h}function h(t,e){function i(t,e){c[m]=t,p[m]=e,m+=1}function n(){for(;m>1;){var t=m-2;if(t>=1&&p[t-1]<=p[t]+p[t+1]||t>=2&&p[t-2]<=p[t]+p[t-1])p[t-1]<p[t+1]&&t--;else if(p[t]>p[t+1])break;r(t)}}function o(){for(;m>1;){var t=m-2;t>0&&p[t-1]<p[t+1]&&t--,r(t)}}function r(i){var n=c[i],o=p[i],r=c[i+1],u=p[i+1];p[i]=o+u,i===m-3&&(c[i+1]=c[i+2],p[i+1]=p[i+2]),m--;var d=a(t[r],t,n,o,0,e);n+=d,o-=d,0!==o&&(u=s(t[n+o-1],t,r,u,u-1,e),0!==u&&(o<=u?h(n,o,r,u):l(n,o,r,u)))}function h(i,n,o,r){var h=0;for(h=0;h<n;h++)x[h]=t[i+h];var l=0,c=o,d=i;if(t[d++]=t[c++],0!==--r){if(1===n){for(h=0;h<r;h++)t[d+h]=t[c+h];return void(t[d+r]=x[l])}for(var p,g,v,y=f;;){p=0,g=0,v=!1;do if(e(t[c],x[l])<0){if(t[d++]=t[c++],g++,p=0,0===--r){v=!0;break}}else if(t[d++]=x[l++],p++,g=0,1===--n){v=!0;break}while((p|g)<y);if(v)break;do{if(p=a(t[c],x,l,n,0,e),0!==p){for(h=0;h<p;h++)t[d+h]=x[l+h];if(d+=p,l+=p,n-=p,n<=1){v=!0;break}}if(t[d++]=t[c++],0===--r){v=!0;break}if(g=s(x[l],t,c,r,0,e),0!==g){for(h=0;h<g;h++)t[d+h]=t[c+h];if(d+=g,c+=g,r-=g,0===r){v=!0;break}}if(t[d++]=x[l++],1===--n){v=!0;break}y--}while(p>=u||g>=u);if(v)break;y<0&&(y=0),y+=2}if(f=y,f<1&&(f=1),1===n){for(h=0;h<r;h++)t[d+h]=t[c+h];t[d+r]=x[l]}else{if(0===n)throw new Error;for(h=0;h<n;h++)t[d+h]=x[l+h]}}else for(h=0;h<n;h++)t[d+h]=x[l+h]}function l(i,n,o,r){var h=0;for(h=0;h<r;h++)x[h]=t[o+h];var l=i+n-1,c=r-1,d=o+r-1,p=0,g=0;if(t[d--]=t[l--],0!==--n){if(1===r){for(d-=n,l-=n,g=d+1,p=l+1,h=n-1;h>=0;h--)t[g+h]=t[p+h];return void(t[d]=x[c])}for(var v=f;;){var y=0,m=0,_=!1;do if(e(x[c],t[l])<0){if(t[d--]=t[l--],y++,m=0,0===--n){_=!0;break}}else if(t[d--]=x[c--],m++,y=0,1===--r){_=!0;break}while((y|m)<v);if(_)break;do{if(y=n-a(x[c],t,i,n,n-1,e),0!==y){for(d-=y,l-=y,n-=y,g=d+1,p=l+1,h=y-1;h>=0;h--)t[g+h]=t[p+h];if(0===n){_=!0;break}}if(t[d--]=x[c--],1===--r){_=!0;break}if(m=r-s(t[l],x,0,r,r-1,e),0!==m){for(d-=m,c-=m,r-=m,g=d+1,p=c+1,h=0;h<m;h++)t[g+h]=x[p+h];if(r<=1){_=!0;break}}if(t[d--]=t[l--],0===--n){_=!0;break}v--}while(y>=u||m>=u);if(_)break;v<0&&(v=0),v+=2}if(f=v,f<1&&(f=1),1===r){for(d-=n,l-=n,g=d+1,p=l+1,h=n-1;h>=0;h--)t[g+h]=t[p+h];t[d]=x[c]}else{if(0===r)throw new Error;for(p=d-(r-1),h=0;h<r;h++)t[p+h]=x[h]}}else for(p=d-(r-1),h=0;h<r;h++)t[p+h]=x[h]}var c,p,f=u,g=0,v=d,y=0,m=0;g=t.length,g<2*d&&(v=g>>>1);var x=[];y=g<120?5:g<1542?10:g<119151?19:40,c=[],p=[],this.mergeRuns=n,this.forceMergeRuns=o,this.pushRun=i}function l(t,e,o,s){o||(o=0),s||(s=t.length);var a=s-o;if(!(a<2)){var l=0;if(a<c)return l=n(t,o,s,e),void r(t,o,s,o+l,e);var u=new h(t,e),d=i(a);do{if(l=n(t,o,s,e),l<d){var p=a;p>d&&(p=d),r(t,o,o+p,o+l,e),l=p}u.pushRun(o,l),u.mergeRuns(),a-=l,o+=l}while(0!==a);u.forceMergeRuns()}}var c=32,u=7,d=256;t.exports=l},function(t,e,i){function n(t){return parseInt(t,10)}function o(t){return!!t&&(!!t.__builtin__||"function"==typeof t.resize&&"function"==typeof t.refresh)}function r(t){t.__unusedCount++}function s(t){1==t.__unusedCount&&t.clear()}function a(t,e,i){return b.copy(t.getBoundingRect()),t.transform&&b.applyTransform(t.transform),w.width=e,w.height=i,!b.intersect(w)}function h(t,e){if(t==e)return!1;if(!t||!e||t.length!==e.length)return!0;for(var i=0;i<t.length;i++)if(t[i]!==e[i])return!0}function l(t,e){for(var i=0;i<t.length;i++){var n=t[i];n.setTransform(e),e.beginPath(),n.buildPath(e,n.shape),e.clip(),n.restoreTransform(e)}}function c(t,e){var i=document.createElement("div");return i.style.cssText=["position:relative","overflow:hidden","width:"+t+"px","height:"+e+"px","padding:0","margin:0","border-width:0"].join(";")+";",i}var u=i(23),d=u.devicePixelRatio,p=i(5),f=i(22),g=i(27),v=i(72),y=i(74),m=i(75),x=i(45),_=5,b=new g(0,0,0,0),w=new g(0,0,0,0),P=function(t,e,i){this.type="canvas";var n=!t.nodeName||"CANVAS"===t.nodeName.toUpperCase();this._opts=i=p.extend({},i||{}),this.dpr=i.devicePixelRatio||d,this._singleCanvas=n,this.root=t;var o=t.style;o&&(o["-webkit-tap-highlight-color"]="transparent",o["-webkit-user-select"]=o["user-select"]=o["-webkit-touch-callout"]="none",t.innerHTML=""),this.storage=e;var r=this._zlevelList=[],s=this._layers={};if(this._layerConfig={},n){null!=i.width&&(t.width=i.width),null!=i.height&&(t.height=i.height);var a=t.width,h=t.height;this._width=a,this._height=h;var l=new y(t,this,1);l.initContext(),s[0]=l,r.push(0),this._domRoot=t}else{this._width=this._getSize(0),this._height=this._getSize(1);var u=this._domRoot=c(this._width,this._height);t.appendChild(u)}this._progressiveLayers=[],this._hoverlayer,this._hoverElements=[]};P.prototype={constructor:P,getType:function(){return"canvas"},isSingleCanvas:function(){return this._singleCanvas},getViewportRoot:function(){return this._domRoot},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(t){var e=this.storage.getDisplayList(!0),i=this._zlevelList;this._paintList(e,t);for(var n=0;n<i.length;n++){var o=i[n],r=this._layers[o];!r.__builtin__&&r.refresh&&r.refresh()}return this.refreshHover(),this._progressiveLayers.length&&this._startProgessive(),this},addHover:function(t,e){if(!t.__hoverMir){var i=new t.constructor({style:t.style,shape:t.shape});i.__from=t,t.__hoverMir=i,i.setStyle(e),this._hoverElements.push(i)}},removeHover:function(t){var e=t.__hoverMir,i=this._hoverElements,n=p.indexOf(i,e);n>=0&&i.splice(n,1),t.__hoverMir=null},clearHover:function(t){for(var e=this._hoverElements,i=0;i<e.length;i++){var n=e[i].__from;n&&(n.__hoverMir=null)}e.length=0},refreshHover:function(){var t=this._hoverElements,e=t.length,i=this._hoverlayer;if(i&&i.clear(),e){v(t,this.storage.displayableSortFunc),i||(i=this._hoverlayer=this.getLayer(1e5));var n={};i.ctx.save();for(var o=0;o<e;){var r=t[o],s=r.__from;s&&s.__zr?(o++,s.invisible||(r.transform=s.transform,r.invTransform=s.invTransform,r.__clipPaths=s.__clipPaths,this._doPaintEl(r,i,!0,n))):(t.splice(o,1),s.__hoverMir=null,e--)}i.ctx.restore()}},_startProgessive:function(){function t(){i===e._progressiveToken&&e.storage&&(e._doPaintList(e.storage.getDisplayList()),e._furtherProgressive?(e._progress++,m(t)):e._progressiveToken=-1)}var e=this;if(e._furtherProgressive){var i=e._progressiveToken=+new Date;e._progress++,m(t)}},_clearProgressive:function(){this._progressiveToken=-1,this._progress=0,p.each(this._progressiveLayers,function(t){t.__dirty&&t.clear()})},_paintList:function(t,e){null==e&&(e=!1),this._updateLayerStatus(t),this._clearProgressive(),this.eachBuiltinLayer(r),this._doPaintList(t,e),this.eachBuiltinLayer(s)},_doPaintList:function(t,e){function i(t){var e=r.dpr||1;r.save(),r.globalAlpha=1,r.shadowBlur=0,n.__dirty=!0,r.setTransform(1,0,0,1,0,0),r.drawImage(t.dom,0,0,c*e,u*e),r.restore()}for(var n,o,r,s,a,h,l=0,c=this._width,u=this._height,d=this._progress,g=0,v=t.length;g<v;g++){var y=t[g],m=this._singleCanvas?0:y.zlevel,x=y.__frame;if(x<0&&a&&(i(a),a=null),o!==m&&(r&&r.restore(),s={},o=m,n=this.getLayer(o),n.__builtin__||f("ZLevel "+o+" has been used by unkown layer "+n.id),r=n.ctx,r.save(),n.__unusedCount=0,(n.__dirty||e)&&n.clear()),n.__dirty||e){if(x>=0){if(!a){if(a=this._progressiveLayers[Math.min(l++,_-1)],a.ctx.save(),a.renderScope={},a&&a.__progress>a.__maxProgress){g=a.__nextIdxNotProg-1;continue}h=a.__progress,a.__dirty||(d=h),a.__progress=d+1}x===d&&this._doPaintEl(y,a,!0,a.renderScope)}else this._doPaintEl(y,n,e,s);y.__dirty=!1}}a&&i(a),r&&r.restore(),this._furtherProgressive=!1,p.each(this._progressiveLayers,function(t){t.__maxProgress>=t.__progress&&(this._furtherProgressive=!0)},this)},_doPaintEl:function(t,e,i,n){var o=e.ctx,r=t.transform;if((e.__dirty||i)&&!t.invisible&&0!==t.style.opacity&&(!r||r[0]||r[3])&&(!t.culling||!a(t,this._width,this._height))){var s=t.__clipPaths;(n.prevClipLayer!==e||h(s,n.prevElClipPaths))&&(n.prevElClipPaths&&(n.prevClipLayer.ctx.restore(),n.prevClipLayer=n.prevElClipPaths=null,n.prevEl=null),s&&(o.save(),l(s,o),n.prevClipLayer=e,n.prevElClipPaths=s)),t.beforeBrush&&t.beforeBrush(o),t.brush(o,n.prevEl||null),n.prevEl=t,t.afterBrush&&t.afterBrush(o)}},getLayer:function(t){if(this._singleCanvas)return this._layers[0];var e=this._layers[t];return e||(e=new y("zr_"+t,this,this.dpr),e.__builtin__=!0,this._layerConfig[t]&&p.merge(e,this._layerConfig[t],!0),this.insertLayer(t,e),e.initContext()),e},insertLayer:function(t,e){var i=this._layers,n=this._zlevelList,r=n.length,s=null,a=-1,h=this._domRoot;if(i[t])return void f("ZLevel "+t+" has been used already");if(!o(e))return void f("Layer of zlevel "+t+" is not valid");if(r>0&&t>n[0]){for(a=0;a<r-1&&!(n[a]<t&&n[a+1]>t);a++);s=i[n[a]]}if(n.splice(a+1,0,t),i[t]=e,!e.virtual)if(s){var l=s.dom;l.nextSibling?h.insertBefore(e.dom,l.nextSibling):h.appendChild(e.dom)}else h.firstChild?h.insertBefore(e.dom,h.firstChild):h.appendChild(e.dom)},eachLayer:function(t,e){var i,n,o=this._zlevelList;for(n=0;n<o.length;n++)i=o[n],t.call(e,this._layers[i],i)},eachBuiltinLayer:function(t,e){var i,n,o,r=this._zlevelList;for(o=0;o<r.length;o++)n=r[o],i=this._layers[n],i.__builtin__&&t.call(e,i,n)},eachOtherLayer:function(t,e){var i,n,o,r=this._zlevelList;for(o=0;o<r.length;o++)n=r[o],i=this._layers[n],i.__builtin__||t.call(e,i,n)},getLayers:function(){return this._layers},_updateLayerStatus:function(t){var e=this._layers,i=this._progressiveLayers,n={},o={};this.eachBuiltinLayer(function(t,e){n[e]=t.elCount,t.elCount=0,t.__dirty=!1}),p.each(i,function(t,e){o[e]=t.elCount,t.elCount=0,t.__dirty=!1});for(var r,s,a=0,h=0,l=0,c=t.length;l<c;l++){var u=t[l],d=this._singleCanvas?0:u.zlevel,f=e[d],g=u.progressive;if(f&&(f.elCount++,f.__dirty=f.__dirty||u.__dirty),g>=0){s!==g&&(s=g,h++);var v=u.__frame=h-1;if(!r){var m=Math.min(a,_-1);r=i[m],r||(r=i[m]=new y("progressive",this,this.dpr),r.initContext()),r.__maxProgress=0}r.__dirty=r.__dirty||u.__dirty,r.elCount++,r.__maxProgress=Math.max(r.__maxProgress,v),r.__maxProgress>=r.__progress&&(f.__dirty=!0)}else u.__frame=-1,r&&(r.__nextIdxNotProg=l,a++,r=null)}r&&(a++,r.__nextIdxNotProg=l),this.eachBuiltinLayer(function(t,e){n[e]!==t.elCount&&(t.__dirty=!0)}),i.length=Math.min(a,_),p.each(i,function(t,e){o[e]!==t.elCount&&(u.__dirty=!0),t.__dirty&&(t.__progress=0)})},clear:function(){return this.eachBuiltinLayer(this._clearLayer),this},_clearLayer:function(t){t.clear()},configLayer:function(t,e){if(e){var i=this._layerConfig;i[t]?p.merge(i[t],e,!0):i[t]=e;var n=this._layers[t];n&&p.merge(n,i[t],!0)}},delLayer:function(t){var e=this._layers,i=this._zlevelList,n=e[t];n&&(n.dom.parentNode.removeChild(n.dom),delete e[t],i.splice(p.indexOf(i,t),1))},resize:function(t,e){var i=this._domRoot;i.style.display="none";var n=this._opts;if(null!=t&&(n.width=t),null!=e&&(n.height=e),t=this._getSize(0),e=this._getSize(1),i.style.display="",this._width!=t||e!=this._height){i.style.width=t+"px",i.style.height=e+"px";for(var o in this._layers)this._layers.hasOwnProperty(o)&&this._layers[o].resize(t,e);p.each(this._progressiveLayers,function(i){i.resize(t,e)}),this.refresh(!0)}return this._width=t,this._height=e,this},clearLayer:function(t){var e=this._layers[t];e&&e.clear()},dispose:function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},getRenderedCanvas:function(t){function e(t,e){var n=s._zlevelList;null==t&&(t=-(1/0));for(var o,r=0;r<n.length;r++){var a=n[r],h=s._layers[a];if(!h.__builtin__&&a>t&&a<e){o=h;break}}o&&o.renderToCanvas&&(i.ctx.save(),o.renderToCanvas(i.ctx),i.ctx.restore())}if(t=t||{},this._singleCanvas)return this._layers[0].dom;var i=new y("image",this,t.pixelRatio||this.dpr);i.initContext(),i.clearColor=t.backgroundColor,i.clear();for(var n,o=this.storage.getDisplayList(!0),r={},s=this,a=0;a<o.length;a++){var h=o[a];h.zlevel!==n&&(e(n,h.zlevel),n=h.zlevel),this._doPaintEl(h,i,!0,r)}return e(n,1/0),i.dom},getWidth:function(){return this._width},getHeight:function(){return this._height},_getSize:function(t){var e=this._opts,i=["width","height"][t],o=["clientWidth","clientHeight"][t],r=["paddingLeft","paddingTop"][t],s=["paddingRight","paddingBottom"][t];if(null!=e[i]&&"auto"!==e[i])return parseFloat(e[i]);var a=this.root,h=document.defaultView.getComputedStyle(a);return(a[o]||n(h[i])||n(a.style[i]))-(n(h[r])||0)-(n(h[s])||0)|0},pathToImage:function(t,e){e=e||this.dpr;var i=document.createElement("canvas"),n=i.getContext("2d"),o=t.getBoundingRect(),r=t.style,s=r.shadowBlur,a=r.shadowOffsetX,h=r.shadowOffsetY,l=r.hasStroke()?r.lineWidth:0,c=Math.max(l/2,-a+s),u=Math.max(l/2,a+s),d=Math.max(l/2,-h+s),p=Math.max(l/2,h+s),f=o.width+c+u,g=o.height+d+p;i.width=f*e,i.height=g*e,n.scale(e,e),n.clearRect(0,0,f,g),n.dpr=e;var v={position:t.position,rotation:t.rotation,scale:t.scale};t.position=[c-o.x,d-o.y],t.rotation=0,t.scale=[1,1],t.updateTransform(),t&&t.brush(n);var y=x,m=new y({style:{x:0,y:0,image:i}});return null!=v.position&&(m.position=t.position=v.position),null!=v.rotation&&(m.rotation=t.rotation=v.rotation),null!=v.scale&&(m.scale=t.scale=v.scale),m}};var C=P;t.exports=C},function(t,e,i){function n(){return!1}function o(t,e,i){var n=r.createCanvas(),o=e.getWidth(),s=e.getHeight(),a=n.style;return a.position="absolute",a.left=0,a.top=0,a.width=o+"px",a.height=s+"px",n.width=o*i,n.height=s*i,n.setAttribute("data-zr-dom-id",t),n}var r=i(5),s=i(23),a=s.devicePixelRatio,h=i(9),l=i(40),c=function(t,e,i){var s;i=i||a,"string"==typeof t?s=o(t,e,i):r.isObject(t)&&(s=t,t=s.id),this.id=t,this.dom=s;var h=s.style;h&&(s.onselectstart=n,h["-webkit-user-select"]="none",h["user-select"]="none",h["-webkit-touch-callout"]="none",h["-webkit-tap-highlight-color"]="rgba(0,0,0,0)",h.padding=0,h.margin=0,h["border-width"]=0),this.domBack=null,this.ctxBack=null,this.painter=e,this.config=null,this.clearColor=0,this.motionBlur=!1,this.lastFrameAlpha=.7,this.dpr=i};c.prototype={constructor:c,elCount:0,__dirty:!0,initContext:function(){this.ctx=this.dom.getContext("2d"),this.ctx.__currentValues={},this.ctx.dpr=this.dpr},createBackBuffer:function(){var t=this.dpr;this.domBack=o("back-"+this.id,this.painter,t),this.ctxBack=this.domBack.getContext("2d"),this.ctxBack.__currentValues={},1!=t&&this.ctxBack.scale(t,t)},resize:function(t,e){var i=this.dpr,n=this.dom,o=n.style,r=this.domBack;o.width=t+"px",o.height=e+"px",n.width=t*i,n.height=e*i,r&&(r.width=t*i,r.height=e*i,1!=i&&this.ctxBack.scale(i,i))},clear:function(t){var e=this.dom,i=this.ctx,n=e.width,o=e.height,r=this.clearColor,s=this.motionBlur&&!t,a=this.lastFrameAlpha,c=this.dpr;if(s&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(e,0,0,n/c,o/c)),i.clearRect(0,0,n,o),r){var u;r.colorStops?(u=r.__canvasGradient||h.getGradient(i,r,{x:0,y:0,width:n,height:o}),r.__canvasGradient=u):r.image&&(u=l.prototype.getCanvasPattern.call(r,i)),i.save(),i.fillStyle=u||r,i.fillRect(0,0,n,o),i.restore()}if(s){var d=this.domBack;i.save(),i.globalAlpha=a,i.drawImage(d,0,0,n,o),i.restore()}}};var u=c;t.exports=u},function(t,e){var i="undefined"!=typeof window&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(t){setTimeout(t,16)};t.exports=i},function(t,e,i){var n=i(5),o=i(77),r=o.Dispatcher,s=i(75),a=i(17),h=function(t){t=t||{},this.stage=t.stage||{},this.onframe=t.onframe||function(){},this._clips=[],this._running=!1,this._time,this._pausedTime,this._pauseStart,this._paused=!1,r.call(this)};h.prototype={constructor:h,addClip:function(t){this._clips.push(t)},addAnimator:function(t){t.animation=this;for(var e=t.getClips(),i=0;i<e.length;i++)this.addClip(e[i])},removeClip:function(t){var e=n.indexOf(this._clips,t);e>=0&&this._clips.splice(e,1)},removeAnimator:function(t){for(var e=t.getClips(),i=0;i<e.length;i++)this.removeClip(e[i]);t.animation=null},_update:function(){for(var t=(new Date).getTime()-this._pausedTime,e=t-this._time,i=this._clips,n=i.length,o=[],r=[],s=0;s<n;s++){var a=i[s],h=a.step(t,e);h&&(o.push(h),r.push(a))}for(var s=0;s<n;)i[s]._needsRemove?(i[s]=i[n-1],i.pop(),n--):s++;n=o.length;for(var s=0;s<n;s++)r[s].fire(o[s]);this._time=t,this.onframe(e),this.trigger("frame",e),this.stage.update&&this.stage.update()},_startLoop:function(){function t(){e._running&&(s(t),!e._paused&&e._update())}var e=this;this._running=!0,s(t)},start:function(){this._time=(new Date).getTime(),this._pausedTime=0,this._startLoop()},stop:function(){this._running=!1},pause:function(){this._paused||(this._pauseStart=(new Date).getTime(),this._paused=!0)},resume:function(){this._paused&&(this._pausedTime+=(new Date).getTime()-this._pauseStart,this._paused=!1)},clear:function(){this._clips=[]},animate:function(t,e){e=e||{};var i=new a(t,e.loop,e.getter,e.setter);return this.addAnimator(i),i}},n.mixin(h,r);var l=h;t.exports=l},function(t,e,i){function n(t){return t.getBoundingClientRect?t.getBoundingClientRect():{left:0,top:0}}function o(t,e,i,n){return i=i||{},n||!u.canvasSupported?r(t,e,i):u.browser.firefox&&null!=e.layerX&&e.layerX!==e.offsetX?(i.zrX=e.layerX,i.zrY=e.layerY):null!=e.offsetX?(i.zrX=e.offsetX,i.zrY=e.offsetY):r(t,e,i),i}function r(t,e,i){var o=n(t);i.zrX=e.clientX-o.left,i.zrY=e.clientY-o.top}function s(t,e,i){if(e=e||window.event,null!=e.zrX)return e;var n=e.type,r=n&&n.indexOf("touch")>=0;if(r){var s="touchend"!=n?e.targetTouches[0]:e.changedTouches[0];s&&o(t,s,e,i)}else o(t,e,e,i),e.zrDelta=e.wheelDelta?e.wheelDelta/120:-(e.detail||0)/3;var a=e.button;return null==e.which&&void 0!==a&&p.test(e.type)&&(e.which=1&a?1:2&a?3:4&a?2:0),e}function a(t,e,i){d?t.addEventListener(e,i):t.attachEvent("on"+e,i)}function h(t,e,i){d?t.removeEventListener(e,i):t.detachEvent("on"+e,i)}function l(t){return t.which>1}var c=i(12);e.Dispatcher=c;var u=i(50),d="undefined"!=typeof window&&!!window.addEventListener,p=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,f=d?function(t){t.preventDefault(),t.stopPropagation(),t.cancelBubble=!0}:function(t){t.returnValue=!1,t.cancelBubble=!0};e.clientToLocal=o,e.normalizeEvent=s,e.addEventListener=a,e.removeEventListener=h,e.stop=f,e.notLeftMouse=l},function(t,e,i){function n(t){return"mousewheel"===t&&g.browser.firefox?"DOMMouseScroll":t}function o(t,e,i){var n=t._gestureMgr;"start"===i&&n.clear();var o=n.recognize(e,t.handler.findHover(e.zrX,e.zrY,null).target,t.dom);if("end"===i&&n.clear(),o){var r=o.type;e.gestureEvent=r,t.handler.dispatchToElement({target:o.target},r,o.event)}}function r(t){t._touching=!0,clearTimeout(t._touchTimer),t._touchTimer=setTimeout(function(){t._touching=!1},700)}function s(t){var e=t.pointerType;return"pen"===e||"touch"===e}function a(t){function e(t,e){return function(){if(!e._touching)return t.apply(e,arguments)}}p.each(x,function(e){t._handlers[e]=p.bind(w[e],t)}),p.each(b,function(e){t._handlers[e]=p.bind(w[e],t)}),p.each(m,function(i){t._handlers[i]=e(w[i],t)})}function h(t){function e(e,i){p.each(e,function(e){c(t,n(e),i._handlers[e])},i)}f.call(this),this.dom=t,this._touching=!1,this._touchTimer,this._gestureMgr=new v,this._handlers={},a(this),g.pointerEventsSupported?e(b,this):(g.touchEventsSupported&&e(x,this),e(m,this))}var l=i(77),c=l.addEventListener,u=l.removeEventListener,d=l.normalizeEvent,p=i(5),f=i(12),g=i(50),v=i(79),y=300,m=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],x=["touchstart","touchend","touchmove"],_={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},b=p.map(m,function(t){var e=t.replace("mouse","pointer");return _[e]?e:t}),w={mousemove:function(t){t=d(this.dom,t),this.trigger("mousemove",t)},mouseout:function(t){t=d(this.dom,t);var e=t.toElement||t.relatedTarget;if(e!=this.dom)for(;e&&9!=e.nodeType;){if(e===this.dom)return;e=e.parentNode}this.trigger("mouseout",t)},touchstart:function(t){t=d(this.dom,t),t.zrByTouch=!0,this._lastTouchMoment=new Date,o(this,t,"start"),w.mousemove.call(this,t),w.mousedown.call(this,t),r(this)},touchmove:function(t){t=d(this.dom,t),t.zrByTouch=!0,o(this,t,"change"),w.mousemove.call(this,t),r(this)},touchend:function(t){t=d(this.dom,t),t.zrByTouch=!0,o(this,t,"end"),w.mouseup.call(this,t),+new Date-this._lastTouchMoment<y&&w.click.call(this,t),r(this)},pointerdown:function(t){w.mousedown.call(this,t)},pointermove:function(t){s(t)||w.mousemove.call(this,t)},pointerup:function(t){w.mouseup.call(this,t)},pointerout:function(t){s(t)||w.mouseout.call(this,t)}};p.each(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(t){w[t]=function(e){e=d(this.dom,e),this.trigger(t,e)}});var P=h.prototype;P.dispose=function(){for(var t=m.concat(x),e=0;e<t.length;e++){var i=t[e];u(this.dom,n(i),this._handlers[i])}},P.setCursor=function(t){this.dom.style.cursor=t||"default"},p.mixin(h,f);var C=h;t.exports=C},function(t,e,i){function n(t){var e=t[1][0]-t[0][0],i=t[1][1]-t[0][1];return Math.sqrt(e*e+i*i)}function o(t){return[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2]}var r=i(77),s=function(){this._track=[]};s.prototype={constructor:s,recognize:function(t,e,i){return this._doTrack(t,e,i),this._recognize(t)},clear:function(){return this._track.length=0,this},_doTrack:function(t,e,i){var n=t.touches;if(n){for(var o={points:[],touches:[],target:e,event:t},s=0,a=n.length;s<a;s++){var h=n[s],l=r.clientToLocal(i,h,{});o.points.push([l.zrX,l.zrY]),o.touches.push(h)}this._track.push(o)}},_recognize:function(t){for(var e in a)if(a.hasOwnProperty(e)){var i=a[e](this._track,t);if(i)return i}}};var a={pinch:function(t,e){var i=t.length;if(i){var r=(t[i-1]||{}).points,s=(t[i-2]||{}).points||r;if(s&&s.length>1&&r&&r.length>1){var a=n(r)/n(s);!isFinite(a)&&(a=1),e.pinchScale=a;var h=o(r);return e.pinchX=h[0],e.pinchY=h[1],{type:"pinch",target:t[0].target,event:e}}}}},h=s;t.exports=h},function(t,e,i){function n(t,e,i,n){o.call(this),this.node=t,this.zr=e,this.forbidEdit=n,this._api=i,this.render()}var o=i(81),r=i(5),s=i(65),a=i(4),h=i(82),l=(i(50),i(89)),c=i(83);n.ARROW_DRAGEND="OperationNode:dragendArrow",n.ARROW_DRAG="OperationNode:dragArrow",n.ARROW_DRAGSTART="OperationNode:dragstartArrow",n.DELETE_CLICK="OperationNode:deleteClick",n.DEL="DEL",n.COMMENT_CLICK="OperationNode:commentClick",n.COMMENT="COMMENT",n.opicons={STRAIGHT:l.STRAIGHT_SVG,JAGGED:l.JAGGED_SVG,CURVE:l.CURVE_SVG,DEL:l.DEL_SVG,COMMENT:l.COMMENT_SVG},n.prototype.render=function(){this.renderBase(),this.forbidEdit||this.renderOther()},n.prototype.renderBase=function(){this.createOperation()},n.prototype.createOperation=function(){var t=this,e=this.node.operationIcons;this.node.parent&&"dragSelect"===this.node.parent.type&&(e=!1),this.node.selectStyle?"ZPath"===this.node.type?(this.node._zCloneStyle=this.node.style.clone(),this.node.setStyle(this.node.selectStyle)):this.node.setOrCancelSelectStyle?this.node.setOrCancelSelectStyle(!0):this._api.getZr().addHover(this.node,this.node.selectStyle):(this.virtualRect=new a.Polyline({style:{lineDash:[2]}}),this.virtualRect.isSelfComputePos=!0,this.add(this.virtualRect)),e&&r.each(this.node.operationIcons,function(e){var i=null,o=n.opicons[e.name.toUpperCase()+""];if(o){if(this.forbidEdit)return;if(e.hidden)return;if(e.name==n.DEL)i=a.makePath(o,{style:{fill:"#aaaaac"},z:t.node.z+1,rectHover:!0},{x:0,y:0,width:10,height:15}),e.callback?i.on("click",function(i){i.data=e,i.node=t.node,e.callback&&e.callback(i)}):i.on("click",function(e){var i={};i.event=e,i.target=this,i.type=n.DELETE_CLICK,t.trigger(i.type,i)});else if(e.name==n.COMMENT){var s={x:0,y:0,width:16,height:16};i=a.makePath(o,{style:{fill:"#aaaaac"},z:t.node.z+2,rectHover:!0},s),i.on("click",function(e){var i={};i.event=e,i.target=this,i.type=n.COMMENT_CLICK,t.trigger(i.type,i)})}else{var l={x:0,y:0,width:15,height:15};i=a.makePath(o,{style:{fill:"#aaaaac"},draggable:!0,z:t.node.z+2,lineType:h["TYPE_"+e.name.toUpperCase()],rectHover:!0},l);var u=["dragstart","drag","dragend"];r.each(u,function(n){i.on(n,function(i){var o={};o.event=i,o.data=e.options,o.type="OperationNode:"+n+"Arrow",t.trigger(o.type,o)})})}}else i=c.createSymbol(e.iconPath,0,0,e.width||15,e.height||15,t.node.z+1,e.color||"#000"),i.on("click",function(i){i.data=e,i.node=t.node,e.callback&&e.callback(i);var n={event:i,type:"OperationNode:"+e.name+"Click"};t._api.trigger(n.type,n)});i.name=e.name,t.add(i)})},n.prototype.refreshPostion=function(t,e){var i=0,n=r.clone(e.points[2]),o=t.rotation,a=o/(Math.PI/180);if(Math.abs(o)>0){var h=s.getConnectorControls(e,t),l=h.br;n=[l.x-e.x,l.y-e.y]}this.virtualRect&&(this.virtualRect.setShape({points:e.points}),this.virtualRect.attr("rotation",o)),this.eachChild(function(t){t.isSelfComputePos||t.attr("position",[a>=0?n[0]+8+20*i++:n[0]-20-20*i++,n[1]-10])}),this.refreshPositionOther(t,e)},n.prototype.renderOther=function(){},n.prototype.refreshPositionOther=function(t,e){if(t.parent&&t.parent.isBg&&1==t.parent.isBg||"GroupNode"===t.parent.type)this.attr("position",[e.x,e.y]);else{var i=t.shape?t.shape.x:0,n=t.shape?t.shape.y:0;this.attr("position",[e.x+t.parent.position[0]+i,e.y+t.parent.position[1]+n])}},n.prototype.cleanup=function(){this.node.selectStyle&&("ZPath"===this.node.type?this.node.setStyle(this.node._zCloneStyle):this.node.setOrCancelSelectStyle?this.node.setOrCancelSelectStyle(!1):this._api.getZr().removeHover(this.node))},r.inherits(n,o),t.exports=n},function(t,e,i){function n(){this.resourceId=r.getUUID(),o.Group.call(this)}var o=i(4),r=i(65);n.prototype.render=function(){},n.prototype.getRect=function(t){},n.prototype.drawText=function(t,e,i){var n,r,s=this.bpmnInfo.name;null!=t&&(s=t);var a=new o.Text({style:{text:s,color:e?e:this.options.text.color,textFont:"12px Microsoft YaHei"},zlevel:20});switch(i=i?i:"init"){case"init":n=this.getRect().x-this.position[0]-a.getBoundingRect().width/2,r=this.getRect().y-this.position[1]+this.getBoundingRect().height/2+6;break;case"center":n=this.getRect().x-this.position[0]-a.getBoundingRect().width/2,r=this.getRect().y-this.position[1]-6;break;case"left":n=this.getRect().x-this.position[0]-a.getBoundingRect().width+6,r=this.getRect().y-this.position[1]-6}return a.attr("style",{x:n,y:r}),{text:a,rect:a.getBoundingRect()}},n.prototype.refreshText=function(t){var e,i,n=this.childOfName("Title");switch(t=t?t:"init"){case"init":e=this.getRect().x-this.position[0]-n.getBoundingRect().width/2,i=this.getRect().y-this.position[1]+this.getBoundingRect().height/2+6;break;case"center":e=this.getRect().x-this.position[0]-n.getBoundingRect().width/2,i=this.getRect().y-this.position[1]-6;break;case"left":e=2,i=this.getRect().y-this.position[1]-6}n.attr("style",{x:e,y:i})},n.prototype.toJSON=function(){},o.Util.inherits(n,o.Group),t.exports=n},function(t,e,i){function n(t){h.call(this),this.opt=t||{},this.opt.model?(this.resourceId=this.opt.model.get("resourceId"),this.model=this.opt.model,this.opt=this.opt.model.option):(this.resourceId=o.getUUID(),this.model=new f({}));var e={symbol:{type:"arrow",size:10,color:n.NORMAL_COLOR,both:!1,offset:0},style:{lineWidth:1,stroke:n.NORMAL_COLOR,lineType:n.TYPE_STRAIGHT},hoverStyle:{lineWidth:2,stroke:n.SELECTED_COLOR},arrowHoverStyle:{fill:n.SELECTED_COLOR},shape:{points:null,smooth:!1,smoothConstraint:null},position:{startPos:null,endPos:null,startOffset:[0,0],endOffset:[0,0],escapeDistance:[30,30],points:null},autoChangePosition:!1,textContextMenu:null,isEdit:!0,text:{text:null,textFill:"#000000",textFont:"12px Microsoft YaHei",textPos:"center",textRotateable:!0},z:0};this.options=o.mergeOpt(e,this.opt,!0,"textContextMenu"),this.handles=[],this.conPointsGroup=new a.Group,this.startNode=null,this.endNode=null,this.line=null,this.groupCurve=new a.Group,this.icons=[],this.render()}var o=i(65),r=i(5),s=i(15),a=i(4),h=i(81),l=i(83),c=i(84),u=i(85),d=i(86),p=i(66),f=i(87);n.TYPE_STRAIGHT="straight",n.TYPE_JAGGED="jagged",n.TYPE_CURVE="curve",n.TYPE_CHAIN="chain",n.RADIUS=3,n.START_NODE="startNode",n.END_NODE="endNode",n.LEFT="left",n.RIGHT="right",n.TOP="top",n.BOTTOM="bottom",n.BOTTOM="bottom",n.SEPERATOR="-",n.NORMAL_COLOR="#000",n.SELECTED_COLOR="#74B7E0",n.prototype.refresh=function(t){t&&(this.turningPoints=t);var e=o.traslatePoints(this.turningPoints);this.options.style.lineType==n.TYPE_CURVE&&e.length>2?this.modifyCurve(this.turningPoints):this.line.attr("shape",{points:e});var i=this.childOfName("lineText"),s=this,a=[];if(this.options.style.lineType==n.TYPE_CHAIN&&r.isArray(this.options.text.text))this.options.text.text.forEach(function(t,e){a.push(s.childOfName("lineText-"+e))});else if(!i&&this.options.text.text){var h=this.drawText("lineText",this.options.text.text,0,0);this.add(h.text),i=this.childOfName("lineText")}if(a.length>0){var l=a.length,c=this.turningPoints[1].x-this.turningPoints[0].x,u=parseInt(c/l),d=-u*parseInt(l/2);a.forEach(function(t,e){var i=s.getTextPostion(s.options.text),n="",o=s.getTextRotation(i);o===-0||0===o?o=0:n=o>0?"plus":"minus",o=Math.abs(o);var a=180*o/Math.PI,h=null,l=null;t.setStyle("text",r.isString(s.options.text.text[e])?s.options.text.text[e]:s.options.text.text[e].text),n?(h=a>90?(a-45)*Math.PI/180:(45+a)*Math.PI/180,h="minus"===n?-h:h):h=45*Math.PI/180,t.attr("rotation",h),90===a?i[1]-=d:(i[0]+=d,0!==o&&(l=Math.tan(a*Math.PI/180)*d,d>0?i[1]-="plus"===n?l:-l:i[1]+="plus"===n?-l:l)),t.attr("position",i),d+=u})}if(i){i.setStyle("text",this.options.text.text);var p=this.getTextPostion(this.options.text);this.options.style.lineType==n.TYPE_STRAIGHT&&this.options.text.textRotateable&&i.attr("rotation",this.getTextRotation(p)),i.attr("position",p)}this.refreshFromToSymbol(e)},n.prototype.render=function(){var t=this;this.renderFromToSymbol(),this.curveLine=new a.BezierCurve({style:this.options.style,z:this.options.z}),this.groupCurve.add(this.curveLine),this.add(this.groupCurve),this.add(this.conPointsGroup),this.polyLine=new a.Polyline({shape:this.options.shape,
style:this.options.style,z:this.options.z}),this.add(this.polyLine),this.options.style.lineType==n.TYPE_CURVE?(this.line=this.groupCurve,this.createHoverStyle(this.curveLine),this.polyLine.hide()):(this.line=this.polyLine,this.createHoverStyle(this.polyLine),this.curveLine.hide());var e=["dblclick","click"];if(r.each(e,function(e){this.line.on(e,r.bind(function(i){i.cancelBubble=!0;var o={};o.event=i,o.type="Connector:"+e,o.target=t,this.trigger(o.type,o),this.setStyle({color:n.SELECTED_COLOR},!0),0!=this.options.isEdit&&(this.options.isEdit&&this.turningPoints.length>=2&&this.createAllconnectionPoint(),this.handles.length<1&&this.shapeSetHandle())},this))},this),this.options.text.text){var i=null;if(r.isArray(this.options.text.text)&&this.options.style.lineType==n.TYPE_CHAIN?this.options.text.text.forEach(function(e,i){var n=t.drawText("lineText-"+i,e,0,0);if(r.isString(e)){var o={};o.text=e,o.textId=n.text.id,t.options.text.text[i]=o}else t.options.text.text[i].textId=n.text.id;if(t.add(n.text),n&&t.opt.textContextMenu){var s=t.opt.textContextMenu;n.text.on("contextmenu",function(t){t.event.preventDefault(),t.event.stopPropagation(),s.buildMenu(t.event,this)})}}):(i=this.drawText("lineText",this.options.text.text,0,0),this.add(i.text)),i&&this.opt.textContextMenu){var o=this.opt.textContextMenu;i.text.on("contextmenu",function(t){t.event.preventDefault(),t.event.stopPropagation(),o.buildMenu(t.event,this)})}}},n.prototype.renderFromToSymbol=function(t){var e=this.createSymbol("toSymbol",this.options);if(e&&this.add(e),this.options.symbol.both){var i=this.createSymbol("fromSymbol",this.options);i&&this.add(i)}},n.prototype.refreshFromToSymbol=function(t){var e=this.childOfName("toSymbol"),i=this.childOfName("fromSymbol"),r=[],a=this.options.symbol.offset;if(e)if(this.options.effect&&this.options.effect.show)new u(e,this.options,this.groupCurve,this.polyLine);else{if(r=t[t.length-1],this.options.style.lineType!==n.TYPE_CURVE){var h=s.distance(t[t.length-1],t[t.length-2]);r=a<=h?s.lerp([],t[t.length-1],t[t.length-2],a/h):t[t.length-1]}e.attr("position",r),e.attr("rotation",o.tangentRotation(this.turningPoints[this.turningPoints.length-2],this.turningPoints[this.turningPoints.length-1]))}if(i){if(r=t[0],this.options.style.lineType!==n.TYPE_CURVE){var l=s.distance(t[0],t[1]);r=a<=l?s.lerp([],t[0],t[1],a/l):t[0]}i.attr("position",r),i.attr("rotation",o.tangentRotation(this.turningPoints[1],this.turningPoints[0]))}},n.prototype.setStyle=function(t,e){var i=null;if(t.color&&(this.options.style.lineType==n.TYPE_CURVE?this.groupCurve.eachChild(function(e){e.attr("style",{stroke:t.color}),a.setNormalStyle(e,{stroke:t.color})}):(this.polyLine.attr("style",{stroke:t.color}),a.setNormalStyle(this.polyLine,{stroke:t.color})),i=this.childOfName("toSymbol"),i&&(i.attr("style",{fill:t.color}),a.setNormalStyle(i,{fill:t.color})),e||(this.options.style.stroke=t.color,this.model.set("options.style.stroke",t.color),this.model.set("options.symbol.color",t.color),this.options.symbol.color=t.color)),t.text){var o=this.childOfName("lineText");if(!o&&t.text.text){var r=this.drawText("lineText",t.text.text,0,0);this.add(r.text),o=this.childOfName("lineText")}(t.text.text||""==t.text.text)&&(o.setStyle("text",t.text.text),this.options.text.text=t.text.text);var s=this.getTextPostion(t.text);o.attr("position",s),t.text.textPos&&(this.options.text.textPos=t.text.textPos),t.text.offset&&(this.options.text.offset=t.text.offset),t.text.color&&(o.attr("style",{textFill:t.text.color}),this.options.text.textFill=t.text.color),t.text.textFont&&(o.attr("style",{textFont:t.text.textFont}),this.options.text.textFont=t.text.textFont),t.text.textFill&&(o.attr("style",{textFill:t.text.textFill}),this.options.text.textFill=t.text.textFill),this.model.set("options.text",t.text)}if(t.symbol){t.symbol.type&&(this.options.symbol.type=t.symbol.type,this.model.set("options.symbol.type",t.symbol.type)),t.symbol.size&&(this.options.symbol.size=t.symbol.size,this.model.set("options.symbol.size",t.symbol.size)),t.symbol.color&&(this.options.symbol.color=t.symbol.color,this.model.set("options.symbol.color",t.symbol.color)),t.symbol.z&&(this.options.symbol.z=t.symbol.z,this.model.set("options.symbol.z",t.symbol.z)),i=this.childOfName("toSymbol"),i&&this.remove(i);var h=this.createSymbol("toSymbol",this.model.get("options"));h&&this.add(h),this.refresh()}},n.prototype.getTextPostion=function(t){var e=[],i=a.textContain.getWidth(t.text,t.textFont);if(t&&t.textPos){var n=t.offset||0,s=n;if(r.isArray(n)||(s=[n,0]),"start"==t.textPos)e=[this.turningPoints[0].x+s[0],this.turningPoints[0].y+s[1]];else if("end"==t.textPos){var h=o.getMaxLineLength([this.turningPoints[this.turningPoints.length-2],this.turningPoints[this.turningPoints.length-1]]),l=o.getAngle(h[0],h[1]),c=o.distance(h[0],h[1])-i,u=o.getEndPoint(h[0],c,l);e=[u.x+s[0],u.y+s[1]]}else{var d=this.middle(t);e=[d[0]+s[0],d[1]+s[1]]}}else{var p=this.middle(t);e=[p[0]-i/2,p[1]]}return e},n.prototype.getTextRotation=function(t){var e=o.getMaxLineLength(this.turningPoints),i=-Math.atan2(e[1].y-t[1],e[1].x-t[0]);return i},n.prototype.createHoverStyle=function(t){if(this.options.hoverStyle){a.setElementHoverStl(t,this.options.hoverStyle);var e=this.childOfName("toSymbol");e&&a.setElementHoverStl(e,this.options.arrowHoverStyle),t.on("mouseover",r.bind(function(){a.doEnterHover(t),e&&a.doEnterHover(e),this.groupCurve.eachChild(function(t){a.doEnterHover(t)})},this)).on("mouseout",r.bind(function(){a.doLeaveHover(t),e&&a.doLeaveHover(e),this.groupCurve.eachChild(function(t){a.doLeaveHover(t)})},this))}},n.prototype.createAllconnectionPoint=function(){this.connectionPointCreate(this,this.turningPoints[0].clone(),d.TYPE_CONNECTOR),this.connectionPointCreate(this,this.turningPoints[this.turningPoints.length-1].clone(),d.TYPE_CONNECTOR)},n.prototype.connectionPointCreate=function(t,e,i){var n=new d(this,e,i,this.options);this.conPointsGroup.add(n.shape)},n.prototype.clearHandles=function(){for(var t=0;t<this.handles.length;t++)this.remove(this.handles[t].handleShape);this.handles=[],this.conPointsGroup&&this.conPointsGroup.removeAll(),this.setStyle({color:this.options.style.stroke},!0)},n.prototype.shapeSetHandle=function(){for(var t=1;t<this.turningPoints.length-2;t++){var e,i,n,r=o.collinearity(this.turningPoints[t-1],this.turningPoints[t],this.turningPoints[t+1]),s=o.collinearity(this.turningPoints[t],this.turningPoints[t+1],this.turningPoints[t+2]);(r||s&&!this.turningPoints[t+1].equals(this.turningPoints[t+2]))&&(r&&!this.turningPoints[t-1].equals(this.turningPoints[t])||s)||(this.turningPoints[t].x===this.turningPoints[t+1].x?(i=this.turningPoints[t].x,n=(this.turningPoints[t].y+this.turningPoints[t+1].y)/2,e=new c("h",i,n,this)):this.turningPoints[t].y===this.turningPoints[t+1].y&&(i=(this.turningPoints[t].x+this.turningPoints[t+1].x)/2,n=this.turningPoints[t].y,e=new c("v",i,n,this)),e&&(this.add(e.handleShape),this.handles.push(e)))}},n.prototype.createSymbol=function(t,e){var i=e.symbol.type,n=e.symbol.size;if("none"!==i){r.isArray(n)||(n=[n,n]);var o=e.z;e.symbol.z&&(o=e.symbol.z);var s=l.createSymbol(i,-n[0]/2,-n[1]/2,n[0],n[1],o,e.symbol.color);return s.name=t,s}},n.prototype.drawText=function(t,e,i,n,o){var s=r.isString(e)?{text:e,x:i,y:n,fill:o}:r.defaults({x:i,y:n,fill:o},e,!0),h=r.defaults(r.clone(this.options.text),s,!0),l=new a.Text({style:h,zlevel:20,name:t});return{text:l,rect:l.getBoundingRect()}},n.prototype.middle=function(){if(this.options.style.lineType==n.TYPE_STRAIGHT||this.options.style.lineType==n.TYPE_CHAIN){var t=o.getMaxLineLength(this.turningPoints),e=(t[0].x+t[1].x)/2,i=(t[0].y+t[1].y)/2;return[e,i]}if(this.options.style.lineType==n.TYPE_JAGGED){for(var r=this.getLength(),s=-1,a=0,h=0;h<this.turningPoints.length-1;h++){s=h;var l=o.getLength(this.turningPoints[h],this.turningPoints[h+1]);if(!(a+l<r/2))break;a+=l}if(s!=-1){var c=r/2-a;if(o.round(this.turningPoints[s].x,3)==o.round(this.turningPoints[s+1].x,3))return[this.turningPoints[s].x,Math.min(this.turningPoints[s].y,this.turningPoints[s+1].y)+c];if(o.round(this.turningPoints[s].y,3)==o.round(this.turningPoints[s+1].y,3))return[Math.min(this.turningPoints[s].x,this.turningPoints[s+1].x)+c,this.turningPoints[s].y];console.error("Connector:middle() - this should never happen "+this.turningPoints[s]+" "+this.turningPoints[s+1]+" nr of points "+this.turningPoints.length)}}else if(this.options.style.lineType==n.TYPE_CURVE){for(var u=.5,d=this.getLength(),p=0,f=0;f<this.turningPoints.length-1&&!(p+o.distance(this.turningPoints[f],this.turningPoints[f+1])>d*u);f++)p+=o.distance(this.turningPoints[f],this.turningPoints[f+1]);var g=d*u-p,v=o.distance(this.turningPoints[f],this.turningPoints[f+1]),y=g/v,m=y*(this.turningPoints[f+1].x-this.turningPoints[f].x)+this.turningPoints[f].x,x=y*(this.turningPoints[f+1].y-this.turningPoints[f].y)+this.turningPoints[f].y;return[m,x]}return null},n.prototype.getLength=function(){for(var t=0,e=0;e<this.turningPoints.length-1;e++)t+=o.getLength(this.turningPoints[e],this.turningPoints[e+1]);return t},n.prototype.toJSON=function(){return this.model.set("resourceId",this.resourceId),this.model.set("properties.type",14),this.model.set("bounds.upperLeft.x",this.position[0]),this.model.set("bounds.upperLeft.y",this.position[1]),this.model.set("bounds.lowerRight.x",parseInt(this.position[0]+this.getBoundingRect().width)),this.model.set("bounds.lowerRight.y",parseInt(this.position[1]+this.getBoundingRect().height)),this.model.set("style.sPos",this.options.position.startPos),this.model.set("style.ePos",this.options.position.endPos),this.model.set("style.lineDash",this.options.style.lineDash),this.model.set("style.stroke",this.options.style.stroke),this.model.set("symbol.type",this.options.symbol.type),this.model.set("dockers",this.turningPoints),this.model.option},n.prototype.refreshModel=function(){this.model.set("options",r.clone(this.options)),this.model.set("options.dockers",this.turningPoints);for(var t=[],e=0;e<this.icons.length;e++){var i=this.icons[e],n=[i.key,{icon:i.style.image,width:i.style.width,height:i.style.height}];t.push(n)}this.model.set("icons",t)},n.prototype.modifyCurve=function(t){for(var e=this.getCurvePoint(t),i=[],n=e.length,o=this.groupCurve.childCount();n<o;n++)i.push(this.groupCurve.childAt(n));r.each(i,function(t){this.groupCurve.remove(t)},this);for(var s=0;s<e.length;s++){var h=this.groupCurve.childAt(s);if(h)h.attr("shape",e[s]);else{var l=new a.BezierCurve({style:this.options.style,shape:e[s],z:this.options.z});this.groupCurve.add(l),this.createHoverStyle(l)}}},n.prototype.getCurvePoint=function(t){function e(t,e){return new p(t.x+e.x,t.y+e.y)}function i(t,e){if(0==e)throw"Division by zero not allowed (yet :) "+this.callee;return new p(t.x/e,t.y/e)}function n(t,e){return new p(t.x*e,t.y*e)}var o=t.length,r=[];if(3===o)return r.push({x1:t[0].x,y1:t[0].y,cpx1:t[1].x,cpy1:t[1].y,x2:t[2].x,y2:t[2].y}),r;if(4===o)return r.push({x1:t[0].x,y1:t[0].y,cpx1:t[1].x,cpy1:t[1].y,cpx2:t[2].x,cpy2:t[2].y,x2:t[3].x,y2:t[3].y}),r;var s,a=[0,0,0];for(s=0;s<=o-3;s++)a.push(s);a.push(o-3,o-3);for(var h=1;h<=o-3;h++){var l=i(e(n(t[h],a[h+4]-a[h+2]),n(t[h+1],a[h+2]-a[h+1])),a[h+4]-a[h+1]),c=(a[h+3]-a[h+2])/(a[h+3]-a[h+1]),u=i(e(n(t[h-1],a[h+3]-a[h+2]),n(t[h],a[h+2]-a[h])),a[h+3]-a[h]),d=n(l,(a[h+2]-a[h+1])/(a[h+3]-a[h+1])),f=e(n(u,c),d),g=i(e(n(t[h],a[h+4]-a[h+3]),n(t[h+1],a[h+3]-a[h+1])),a[h+4]-a[h+1]),v=(a[h+3]-a[h+2])/(a[h+4]-a[h+2]),y=i(e(n(t[h+1],a[h+5]-a[h+3]),n(t[h+2],a[h+3]-a[h+2])),a[h+5]-a[h+2]),m=n(g,(a[h+4]-a[h+3])/(a[h+4]-a[h+2])),x=e(n(y,v),m);r.push({x1:f.x,y1:f.y,cpx1:l.x,cpy1:l.y,cpx2:g.x,cpy2:g.y,x2:x.x,y2:x.y})}return r},o.inherits(n,h),t.exports=n},function(t,e,i){"use strict";var n=i(4),o=i(27),r=n.extendShape({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=e.width/2,r=e.height/2;t.moveTo(i,n-r),t.lineTo(i+o,n+r),t.lineTo(i-o,n+r),t.closePath()}}),s=n.extendShape({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=e.width/2,r=e.height/2;t.moveTo(i,n-r),t.lineTo(i+o,n),t.lineTo(i,n+r),t.lineTo(i-o,n),t.closePath()}}),a=n.extendShape({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.x,n=e.y,o=e.width/5*3,r=Math.max(o,e.height),s=o/2,a=s*s/(r-s),h=n-r+s+a,l=Math.asin(a/s),c=Math.cos(l)*s,u=Math.sin(l),d=Math.cos(l);t.arc(i,h,s,Math.PI-l,2*Math.PI+l);var p=.6*s,f=.7*s;t.bezierCurveTo(i+c-u*p,h+a+d*p,i,n-f,i,n),t.bezierCurveTo(i,n-f,i-c+u*p,h+a+d*p,i-c,h+a),t.closePath()}}),h=n.extendShape({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(t,e){var i=e.height,n=e.width,o=e.x,r=e.y,s=n/3*2;t.moveTo(o,r),t.lineTo(o+s,r+i),t.lineTo(o,r+i/4*3),t.lineTo(o-s,r+i),t.lineTo(o,r),t.closePath()}}),l={line:n.Line,rect:n.Rect,roundRect:n.Rect,square:n.Rect,circle:n.Circle,diamond:s,pin:a,arrow:h,triangle:r},c={line:function(t,e,i,n,o){o.x1=t,o.y1=e+n/2,o.x2=t+i,o.y2=e+n/2},rect:function(t,e,i,n,o){o.x=t,o.y=e,o.width=i,o.height=n},roundRect:function(t,e,i,n,o){o.x=t,o.y=e,o.width=i,o.height=n,o.r=Math.min(i,n)/4},square:function(t,e,i,n,o){var r=Math.min(i,n);o.x=t,o.y=e,o.width=r,o.height=r},circle:function(t,e,i,n,o){o.cx=t+i/2,o.cy=e+n/2,o.r=Math.min(i,n)/2},diamond:function(t,e,i,n,o){o.cx=t+i/2,o.cy=e+n/2,o.width=i,o.height=n},pin:function(t,e,i,n,o){o.x=t+i/2,o.y=e+n/2,o.width=i,o.height=n},arrow:function(t,e,i,n,o){o.x=t+i/2,o.y=e+n/2,o.width=i,o.height=n},triangle:function(t,e,i,n,o){o.cx=t+i/2,o.cy=e+n/2,o.width=i,o.height=n}},u={};for(var d in l)u[d]=new l[d];var p=n.extendShape({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},beforeBrush:function(){var t=this.style,e=this.shape;"pin"===e.symbolType&&"inside"===t.textPosition&&(t.textPosition=["50%","40%"],t.textAlign="center",t.textVerticalAlign="middle")},buildPath:function(t,e){var i=e.symbolType,n=u[i];"none"!==e.symbolType&&(n||(i="rect",n=u[i]),c[i](e.x,e.y,e.width,e.height,n.shape),n.buildPath(t,n.shape))}}),f=function(t){if("image"!==this.type){var e=this.style,i=this.shape;i&&"line"===i.symbolType?e.stroke=t:this.__isEmptyBrush?(e.stroke=t,e.fill="#fff"):(e.fill&&(e.fill=t),e.stroke&&(e.stroke=t)),this.dirty()}},g={createSymbol:function(t,e,i,r,s,a,h){var l=0===t.indexOf("empty");l&&(t=t.substr(5,1).toLowerCase()+t.substr(6));var c;return c=0===t.indexOf("image://")?new n.Image({style:{image:t.slice(8),x:e,y:i,width:r,height:s},z:a}):0===t.indexOf("path://")?n.makePath(t.slice(7),{z:a,rectHover:!0},new o(e,i,r,s)):new p({shape:{symbolType:t,x:e,y:i,width:r,height:s},z:a}),c.__isEmptyBrush=l,c.setColor=f,c.setColor(h),c}};t.exports=g},function(t,e,i){function n(t,e,i,r){this.type=t,this.x=e,this.y=i,this.visible=!0,this.connector=r,this.handleShape=new o.Circle({shape:{cx:e,cy:i,r:n.RADIUS},style:{fill:"rgb(0,255,0)",stroke:"rgb(0,0,0)"},z:r.options.z+2,draggable:!0});var s=this;this.handleShape.on("drag",function(t){s.actionConnector(t.offsetX,t.offsetY)})}var o=i(4),r=i(65);n.RADIUS=4,n.prototype={constructor:n,equals:function(t){return!(!t instanceof n)&&(this.type==t.type&&this.x==t.x&&this.y==t.y&&this.visible==t.visible)},actionConnector:function(t,e){switch(this.type){case"v":for(var i,n=1;n<this.connector.turningPoints.length-1;n++)this.connector.turningPoints[n-1].y==this.connector.turningPoints[n].y&&this.connector.turningPoints[n].y==this.y&&Math.min(this.connector.turningPoints[n].x,this.connector.turningPoints[n-1].x)<=this.x&&Math.max(this.connector.turningPoints[n].x,this.connector.turningPoints[n-1].x)>=this.x&&(i=n);var o=e-this.y,s=r.translationMatrix(0,o);this.connector.turningPoints[i-1].transform(s),this.connector.turningPoints[i].transform(s),this.connector.refresh(),this.y=e;break;case"h":for(var i,n=1;n<this.connector.turningPoints.length-1;n++)this.connector.turningPoints[n-1].x==this.connector.turningPoints[n].x&&this.connector.turningPoints[n].x==this.x&&Math.min(this.connector.turningPoints[n].y,this.connector.turningPoints[n-1].y)<=this.y&&Math.max(this.connector.turningPoints[n].y,this.connector.turningPoints[n-1].y)>=this.y&&(i=n);var a=t-this.x,s=r.translationMatrix(a,0);this.connector.turningPoints[i-1].transform(s),this.connector.turningPoints[i].transform(s),this.connector.refresh(),this.x=t}}},t.exports=n},function(t,e,i){function n(t,e,i,n){this._lastFrame=0,this._lastFramePercent=0,this.symbol=t,this.groupCurve=i,this.initSymbol(e,n)}var o=(i(5),i(15)),r=i(31),s=(i(83),n.prototype);s.initSymbol=function(t,e){var i=this;this.symbol.z2=100,this.symbol.culling=!0;var n=1e3*t.effect.period;if(this.symbol.__t=0,this.symbol.stopAnimation(),"curve"==t.style.lineType){if(this.groupCurve){var o=0;n/=this.groupCurve._children.length,this.groupCurveAnimate(this.groupCurve._children[0],o,n)}}else this.symbol.animate("",!0).when(n,{__t:1}).delay(0).during(function(){i.updateSymbolPositionPolyline()}).start(),this.setAnimationPointsPolyline(e.shape.points)},s.groupCurveAnimate=function(t,e,i){var n=this;void 0==t&&(t=this.groupCurve._children[0],e=0);var o,r=t.shape;o=[[r.x1,r.y1],[r.x2,r.y2],[r.cpx1,r.cpy1],[r.cpx2,r.cpy2]],this.setAnimationPointsBezierCurve(o),this.symbol.animate("").when(i,{__t:1}).delay(0).during(function(){n.updateSymbolPositionBezierCurve()}).done(function(){n.symbol.__t=0,n.groupCurveAnimate(n.groupCurve._children[e+1],e+1,i)}).start()},s.setAnimationPointsBezierCurve=function(t){this.symbol.__p1=t[0],this.symbol.__p2=t[1],this.symbol.__cp1=t[2]||[(t[0][0]+t[1][0])/2,(t[0][1]+t[1][1])/2],this.symbol.__cp2=t[3]},s.updateSymbolPositionBezierCurve=function(){var t,e,i=this.symbol.__p1,n=this.symbol.__p2,o=this.symbol.__cp1,s=this.symbol.__cp2,a=this.symbol.__t,h=this.symbol.position;if(void 0!=s[0]){var l=r.cubicAt,c=r.cubicDerivativeAt;h[0]=l(i[0],o[0],s[0],n[0],a),h[1]=l(i[1],o[1],s[1],n[1],a),t=c(i[0],o[0],s[0],n[0],a),e=c(i[1],o[1],s[1],n[1],a)}else{var u=r.quadraticAt,d=r.quadraticDerivativeAt;h[0]=u(i[0],o[0],n[0],a),h[1]=u(i[1],o[1],n[1],a),t=d(i[0],o[0],n[0],a),e=d(i[1],o[1],n[1],a)}this.symbol.rotation=-Math.atan2(e,t)-Math.PI/2,this.symbol.ignore=!1},s.setAnimationPointsPolyline=function(t){this._points=t;for(var e=[0],i=0,n=1;n<t.length;n++){var r=t[n-1],s=t[n];i+=o.dist(r,s),e.push(i)}if(0!==i){for(var a=0;a<e.length;a++)e[a]/=i;this._offsets=e,this._length=i,this.symbol._lastFrame=0,this.symbol.__lastFramePercent=0}},s.updateSymbolPositionPolyline=function(){var t=this.symbol.__t,e=this._points,i=this._offsets,n=e.length;if(i){var r,s=this._lastFrame;if(t<this._lastFramePercent){var a=Math.min(s+1,n-1);for(r=a;r>=0&&!(i[r]<=t);r--);r=Math.min(r,n-2)}else{for(var r=s;r<n&&!(i[r]>t);r++);r=Math.min(r-1,n-2)}o.lerp(this.symbol.position,e[r],e[r+1],(t-i[r])/(i[r+1]-i[r])),this._lastFrame=r,this._lastFramePercent=t;var h=-Math.atan2(e[r+1][1]-e[r][1],e[r+1][0]-e[r][0]);this.symbol.rotation=h-Math.PI/2,this.symbol.ignore=!1}},t.exports=n},function(t,e,i){function n(t,e,i,r){this.connector=t,this.point=e.clone(),this.type=i,this.color=n.NORMAL_COLOR,this.oType="ConnectionPoint",this.shape=new o.Circle({shape:{cx:this.point.x,cy:this.point.y,r:n.RADIUS},style:{fill:this.color,stroke:"#000000"},z:r.z+2}),this.shape.type=this.type,this.shape.connector=t}var o=i(4);n.NORMAL_COLOR="#FFFF33",n.OVER_COLOR="#FF9900",n.CONNECTED_COLOR="#ff0000",n.RADIUS=4,n.TYPE_FIGURE="figure",n.TYPE_CONNECTOR="connector",n.prototype={constructor:n,equals:function(t){return this.point.equals(t.point)&&this.connector==t.connector&&this.type==t.type&&this.color==t.color&&this.radius==t.radius}},t.exports=n},function(t,e,i){function n(t,e,i){this.parentModel=e,this.option=t,this.init&&(arguments.length<=3?this.init(t,e,i):this.init.apply(this,arguments))}var o=i(5),r=i(88);n.prototype={constructor:n,init:function(t){o.merge(t,this.getDefaultOption())},getDefaultOption:function(){if(!this.hasOwnProperty("__defaultOption")){for(var t=[],e=this.constructor;e;){var i=e.prototype.defaultOption;i&&t.push(i),e=e.superClass}for(var n={},r=t.length-1;r>=0;r--)n=o.merge(n,t[r],!0);this.__defaultOption=n}return this.__defaultOption},mergeOption:function(t){o.merge(this.option,t,!0)},get:function(t,e){if(!t)return this.option;"string"==typeof t&&(t=t.split("."));for(var i=this.option,n=this.parentModel,o=0;o<t.length&&(i=i&&"object"==typeof i?i[t[o]]:null,null!=i);o++);return null==i&&n&&!e&&(i=n.get(t)),i},set:function(t,e){var i=this.option;if(t.indexOf(".")==-1)i[t]=e;else{for(var n,o=t.split("."),r=o.length,s=i,a=0;a<r-1;a++)n=o[a],null==s[n]&&(s[n]={}),s=s[n];n=o[r-1],s[n]=e}},getShallow:function(t,e){var i=this.option,n=i&&i[t],o=this.parentModel;return null==n&&o&&!e&&(n=o.getShallow(t)),n},getModel:function(t,e){var i=this.get(t,!0),o=this.parentModel,r=new n(i,e||o&&o.getModel(t));return r},isEmpty:function(){return null==this.option},restoreData:function(){},clone:function(){var t=this.constructor;return new t(o.clone(this.option))}},r.enableClassExtend(n),t.exports=n},function(t,e,i){function n(t,e){var i=r.slice(arguments,2);return this.superClass.prototype[e].apply(t,i)}function o(t,e,i){return this.superClass.prototype[e].apply(t,i)}var r=i(5),s={},a=".",h="___FT__COMPONENT__CONTAINER___",l=s.parseClassType=function(t){var e={main:"",sub:""};return t&&(t=t.split(a),e.main=t[0]||"",e.sub=t[1]||""),e};s.enableClassExtend=function(t,e){t.extend=function(i){var s=function(){e&&e.apply(this,arguments),t.apply(this,arguments)};return r.extend(s.prototype,i),s.extend=this.extend,s.superCall=n,s.superApply=o,r.inherits(s,this),s.superClass=this,s}},s.enableClassManagement=function(t,e){function i(t){var e=n[t.main];return e&&e[h]||(e=n[t.main]={},e[h]=!0),e}e=e||{};var n={};if(t.registerClass=function(t,e){if(e)if(e=l(e),e.sub){if(e.sub!==h){var o=i(e);o[e.sub]=t}}else{if(n[e.main])return;n[e.main]=t}return t},t.getClass=function(t,e,i){var o=n[t];if(o&&o[h]&&(o=e?o[e]:null),i&&!o)throw new Error("Component "+t+"."+(e||"")+" not exists. Load it first.");return o},t.getClassesByMainType=function(t){t=l(t);var e=[],i=n[t.main];return i&&i[h]?r.each(i,function(t,i){i!==h&&e.push(t)}):e.push(i),e},t.hasClass=function(t){return t=l(t),!!n[t.main]},t.getAllClassMainTypes=function(){var t=[];return r.each(n,function(e,i){t.push(i)}),t},t.hasSubTypes=function(t){t=l(t);var e=n[t.main];return e&&e[h]},t.parseClassType=l,e.registerWhenExtend){var o=t.extend;o&&(t.extend=function(e){var i=o.call(this,e);return t.registerClass(i,e.type)})}return t},t.exports=s},function(t,e){var i={STRAIGHT_SVG:"M937.353846 724.676923C882.215385 669.538462 795.569231 661.661538 732.553846 701.046154L362.338462 330.830769C401.723077 267.815385 393.846154 181.169231 338.707692 126.030769 267.815385 55.138462 165.415385 55.138462 94.523077 126.030769 23.630769 196.923077 23.630769 299.323077 94.523077 370.215385 149.661538 425.353846 236.307692 433.230769 299.323077 393.846154L669.538462 764.061538C630.153846 827.076923 638.030769 913.723077 693.169231 968.861538 764.061538 1039.753846 866.461538 1039.753846 937.353846 968.861538 1000.369231 897.969231 1000.369231 795.569231 937.353846 724.676923L937.353846 724.676923ZM275.692308 307.2C244.184615 338.707692 189.046154 338.707692 157.538462 307.2 126.030769 275.692308 126.030769 220.553846 157.538462 189.046154 189.046154 157.538462 244.184615 157.538462 275.692308 189.046154 307.2 220.553846 307.2 267.815385 275.692308 307.2L275.692308 307.2ZM874.338462 913.723077C842.830769 945.230769 787.692308 945.230769 756.184615 913.723077 724.676923 882.215385 724.676923 827.076923 756.184615 795.569231 787.692308 764.061538 842.830769 764.061538 874.338462 795.569231 905.846154 827.076923 905.846154 874.338462 874.338462 913.723077L874.338462 913.723077Z",JAGGED_SVG:"M204.8 819.2l-51.2-102.4 204.8-307.2 51.2 102.4-204.8 307.2zM409.6 512l51.2-102.4 153.6 204.8-51.2 102.4-153.6-204.8zM819.2 204.8l51.2 102.4-204.8 409.6-51.2-102.4 204.8-409.6z                                    M153.6 716.8c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8H102.4v-102.4h102.4v102.4zM409.6 204.8C322.56 204.8 256 271.36 256 358.4s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8H358.4V307.2h102.4v102.4zM614.4 614.4c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8h-102.4v-102.4h102.4v102.4zM870.4 0c-87.04 0-153.6 66.56-153.6 153.6s66.56 153.6 153.6 153.6 153.6-66.56 153.6-153.6-66.56-153.6-153.6-153.6z m51.2 204.8h-102.4V102.4h102.4v102.4z",CURVE_SVG:"M1014.285039 824.024234l-145.168428-144.37205c-12.969593-12.855825-37.543559-14.505466-44.597197 2.332252-1.877178 4.550734-2.275367 17.179022-2.275368 17.179022v97.556369H330.935383a118.319095 118.319095 0 0 1-118.546632-117.920905A118.319095 118.319095 0 0 1 330.992267 560.878016h445.516899c121.561493 0 220.426198-98.352747 220.426198-219.23163s-98.864705-219.174746-220.426198-219.174746H340.491925A174.236244 174.236244 0 0 0 174.105698 0 173.78117 173.78117 0 0 0 0.040107 173.09856a173.78117 173.78117 0 0 0 174.065591 173.09856 174.236244 174.236244 0 0 0 166.386227-122.471639h436.017241c65.416807 0 118.603516 52.902288 118.603515 117.920905A118.319095 118.319095 0 0 1 776.509166 459.624176H330.992267c-121.504609 0-220.369314 98.352747-220.369314 219.23163s98.864705 219.174746 220.369314 219.174746h491.194895v92.550561s0 14.221045 2.332252 19.795695c7.053638 16.894602 31.627604 17.577212 44.597197 4.664502l145.111543-144.315165a32.879056 32.879056 0 0 0 0-46.645027zM174.105698 244.94328c-39.818926 0-72.242909-32.25333-72.242909-71.84472s32.423983-71.787835 72.242909-71.787835c39.818926 0 72.186025 32.196446 72.186025 71.787835 0 39.591389-32.423983 71.787835-72.242909 71.787836z",DEL_SVG:"M980.992 256h-84.992v683.008c0 47.104-37.888 84.992-84.992 84.992H212.992c-47.104 0-84.992-37.888-84.992-84.992V256H43.008C19.456 256 0 236.544 0 212.992c0-23.552 19.456-43.008 43.008-43.008H256V84.992C256 37.888 293.888 0 340.992 0h340.992C730.112 0 768 37.888 768 84.992v84.992h214.016c23.552 0 43.008 19.456 43.008 43.008-1.024 23.552-20.48 43.008-44.032 43.008zM683.008 84.992H340.992v84.992h340.992V84.992zM212.992 939.008h596.992V256H212.992v683.008z m171.008-470.016v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-23.552 19.456-43.008 43.008-43.008 23.552 1.024 43.008 19.456 43.008 43.008zM512 427.008c23.552 0 43.008 19.456 43.008 43.008v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-24.576 19.456-43.008 43.008-43.008z m171.008 0c23.552 0 43.008 19.456 43.008 43.008v256c0 23.552-19.456 43.008-43.008 43.008-23.552 0-43.008-19.456-43.008-43.008v-256c0-24.576 19.456-43.008 43.008-43.008z",COMMENT_SVG:"M209.92 152.064l572.416 1.536c12.8 0 23.04 10.24 23.04 23.04v237.568c0 12.8 10.24 23.04 23.04 23.04s23.04-10.24 23.04-23.04V125.44c0-12.8-10.24-23.04-23.04-23.04H158.72c-12.8 0-23.04 10.24-23.04 23.04v773.12c0 12.8 10.24 23.04 23.04 23.04h236.032c12.8 0 23.04-10.24 23.04-23.04s-10.24-22.528-22.528-23.04l-185.856-1.536c-12.8 0-22.528-10.24-22.528-23.04V174.592c0-12.288 10.24-22.528 23.04-22.528z                                            M268.8 570.368h159.232c13.312 0 24.064 10.752 24.576 24.064v2.56c0 13.312-10.752 24.576-24.576 24.576H268.8c-13.312 0-24.064-10.752-24.576-24.064v-2.56c0.512-13.312 11.264-24.576 24.576-24.576z m0-312.32h441.344c13.312 0 24.576 10.752 24.576 24.576v2.56c0 13.312-10.752 24.576-24.576 24.576H268.8c-13.312 0-24.576-10.752-24.576-24.576v-2.56c0.512-13.312 11.264-24.576 24.576-24.576z m0.512 155.648h269.312c13.312 0 24.576 10.752 24.576 24.064v2.56c0 13.312-10.752 24.576-24.576 24.576H269.312c-13.312 0-24.576-10.752-24.576-24.064v-2.56c0-13.824 10.752-24.576 24.576-24.576z m471.04 13.312l-246.784 339.456c-1.536 2.56-2.56 5.632-2.56 8.704l-1.536 132.096c0 9.728 9.728 16.896 18.944 14.336l122.88-37.888c3.072-1.024 5.632-3.072 7.68-5.632l246.784-338.944c4.608-6.144 3.584-15.36-2.56-19.968l-121.344-94.72c-7.168-5.632-16.896-4.096-21.504 2.56z m23.04 67.584l51.2 39.936c2.048 1.536 2.56 5.12 1.024 7.168l-26.112 35.84c-1.536 2.56-5.12 3.072-7.68 1.024l-51.712-38.912c-2.048-1.536-2.56-4.608-1.024-7.168l26.624-37.376c2.048-1.536 5.632-2.048 7.68-0.512z m-165.888 341.504l-35.328 10.752c-9.216 3.072-18.944-4.096-18.944-13.824l0.512-40.96c0-3.072 1.024-6.144 2.56-8.704l137.216-187.904c1.536-2.56 5.12-2.56 7.168-1.024l51.2 38.4c2.56 2.048 3.072 5.12 1.024 7.68l-137.728 189.952c-2.048 2.56-4.608 4.608-7.68 5.632z",CHANGE_LINE_TYPE_SVG:"M1008 335.2 1008 335.2l-160 144 0 0c-8.8 8-20 12.8-32 12.8-26.4 0-48-21.6-48-48 0-14.4 6.4-26.4 16-35.2l0 0 67.2-60L560 348.8c0 0 0 0 0 0L464 348.8l0 0L352 348.8 48 348.8c-26.4 0-48-21.6-48-48 0-26.4 21.6-48 48-48l124.8 0 0 0L416 252.8l0 0 208 0 0 0 227.2 0L784 192l0 0c-9.6-8.8-16-21.6-16-35.2 0-26.4 21.6-48 48-48 12 0 23.2 4.8 32 12.8l0 0 160 144 0 0c9.6 8.8 16 21.6 16 35.2C1024 314.4 1017.6 326.4 1008 335.2zM16 680.8 16 680.8l160-144 0 0c8.8-8 20-12.8 32-12.8 26.4 0 48 21.6 48 48 0 14.4-6.4 26.4-16 35.2l0 0-67.2 60L400 667.2l0 0 208 0 0 0 243.2 0 0 0L976 667.2c26.4 0 48 21.6 48 48 0 26.4-21.6 48-48 48L672 763.2 560 763.2c0 0 0 0 0 0L464 763.2l0 0L172.8 763.2 240 824l0 0c9.6 8.8 16 21.6 16 35.2 0 26.4-21.6 48-48 48-12 0-23.2-4.8-32-12.8l0 0L16 752l0 0c-9.6-8.8-16-21.6-16-35.2C0 701.6 6.4 689.6 16 680.8z"};t.exports=i},function(t,e,i){function n(t){r.call(this),this.bundleOffset=30,this.bundleGap=20,this.connectorMap=a.StackedMap.createNew(),this._api=t}var o=i(5),r=i(91),s=i(82),a=i(65),h=i(66),l=i(93);n.prototype.add=function(t){if(this.connectors.push(t),this.handleConnectorEvent(t),t.startNode&&t.endNode){var e=this.getTwoNodeId(t.startNode,t.endNode,t.options.position);this.connectorMap.add(e,t),this.handleConnectorShrink(t),this.bundleOffset=t.options.bundleOffset||this.bundleOffset,this.bundleGap=t.options.bundleGap||this.bundleGap;var i=this.connectorMap.get(e);if(1==i.length){var n=t.options.dockers,o=[];if(n&&n.length>=2)o=h.loadArray(n),t.refresh(o);else if(t.options.position.points){var r=this.getStartEndPoint(t);o=t.options.position.points,o.unshift(r[0]),o.push(r[1]),t.refresh(o)}else this.refreshConnector(i[0],!0)}else i.length>1&&this.refreshCons(i)}else this.handleConnectorPoints(t);return this.handleConnectorModel(t),t},n.prototype.handleConnectorEvent=function(t){t.conPointsGroup&&t.conPointsGroup.on("click",function(t){var e=t.target.type.split(s.SEPERATOR),i=t.target.connector;e[0]===s.START_NODE?i.options.position.startPos=e[1]:e[0]===s.END_NODE&&(i.options.position.endPos=e[1]),this.refreshConnector(i,!0),t.cancelBubble=!0;var n={};n.event=t,n.type="conPointsGroup:click",n.lineNode=this.selConnector,this._api.trigger(n.type,n)}.bind(this));var e=["click","dblclick"];o.each(e,function(e){t.on("Connector:"+e,function(t){var i=t.target;this.selConnector!==i&&(this.selConnector&&this.refreshConnector(this.selConnector),this.selConnector=i),t.cancelBubble=!0;var n={};n.event=t,n.type=e,n.target=this.selConnector,this._api.trigger(n.type,n)}.bind(this))}.bind(this))},n.prototype.handleConnectorModel=function(t){t.model.set(l.ELEMENT_TYPE,l.CONNECTION),t.startNode&&t.endNode&&(t.model.set(l.START_ID,t.startNode.id),t.model.set(l.END_ID,t.endNode.id)),t.model.set(l.OPTIONS,o.clone(t.options))},n.prototype.handleConnectorShrink=function(t){var e=this;t.line.on("dblclick",function(){if(0!=t.options.isShrink){var i=this.parent,n=i.startNode,o=i.endNode,r=e.getTwoNodeId(n,o,t.options.position),s=e.connectorMap.get(r);if(1!=s.length)for(var a=parseInt(s.length/2),h=0;h<s.length;h++)h!=a&&(s[h].ignore?s[h].show():s[h].hide())}})},n.prototype.handleConnectorPoints=function(t){var e=t.options,i=t.options.dockers;if(i&&i.length>=2){var n=h.loadArray(i);t.refresh(n)}else if(e.position&&e.position.points){var o=e.position.points;t.refresh(o)}},n.prototype.getTwoNodeId=function(t,e,i){return t.id+"-"+i.startPos+","+e.id+"-"+i.endPos},n.prototype.refreshCons=function(t){if(t[0].options.style.lineType==s.TYPE_JAGGED)for(var e=0;e<t.length;e++)this.refreshConnector(t[e],!0);else this.refreshConsStraight(t);
},n.prototype.refreshConsStraight=function(t){var e=parseInt(t.length/2),i=[],n=t[0].startNode,o=t[0].endNode,r=a.getRect(n),s=a.getRect(o).boundingRect,h=a.getConnectorPoints(r,n),l=a.getConnectorPoints(s,o),c=t[0].options.position;c.startPos&&c.endPos||(r.x<s.x?(c.startPos="right",c.endPos="left"):(c.startPos="left",c.endPos="right"));for(var u=h[c.startPos],d=l[c.endPos],p=Math.atan2(d.y-u.y,d.x-u.x),f=[],g=e;g>=1;g--){f=[],f.push(u);var v=u.clone();v.transform(a.translationMatrix(0,this.bundleGap*g)),v.x=v.x+this.bundleOffset*Math.cos(p),v.y=v.y+this.bundleOffset*Math.sin(p),f.push(v);var y=d.clone();y.transform(a.translationMatrix(0,this.bundleGap*g)),y.x=y.x-this.bundleOffset*Math.cos(p),y.y=y.y-this.bundleOffset*Math.sin(p),f.push(y),f.push(d),i.push(f)}i.push([u,d]);var m=Math.ceil(t.length/2);for(g=1;g<m;g++){f=[],f.push(u);var x=u.clone();x.transform(a.translationMatrix(0,-this.bundleGap*g)),x.x=x.x+this.bundleOffset*Math.cos(p),x.y=x.y+this.bundleOffset*Math.sin(p),f.push(x);var _=d.clone();_.transform(a.translationMatrix(0,-this.bundleGap*g)),_.x=_.x-this.bundleOffset*Math.cos(p),_.y=_.y-this.bundleOffset*Math.sin(p),f.push(_),f.push(d),i.push(f)}for(g=0;g<i.length;g++)t[g].refresh(i[g])},n.prototype.boundOffsetXY=function(t,e){var i=t.clone(),n=Math.atan2(i.y,i.x),o=Math.sqrt(Math.pow(i.x,2)+Math.pow(i.y,2));return e?o+=this.bundleOffset:o-=this.bundleOffset,i.x=o*Math.cos(n),i.y=o*Math.sin(n),i},n.prototype.setModel=function(t,e){var i=t.model.get("style.lineType");t.model.mergeOption(e),o.merge(t.model.get("options"),e,!0),i!==e.style.lineType&&this.refreshConnector(t,!0)},r.prototype.deleteByLine=function(t,e){if(t.startNode){var i=t.startNode.model.get("outgoing");if(r=o.indexOf(i,t.resourceId),r!=-1&&i.splice(r,1),this.connectorMap){var n=this.getTwoNodeId(t.startNode,t.endNode,t.options.position);this.connectorMap.removeItem(n,t)}}e.remove(t);var r=o.indexOf(this.connectors,t);r!=-1&&this.connectors.splice(r,1),this.selConnector===t&&(this.selConnector=null)},n.prototype.refreshLineByNode=function(t){for(var e=this.connectorMap.keys(),i=0;i<e.length;i++){var n=e[i];if(n.indexOf(t.id)!=-1){var o=this.connectorMap.get(n);this.countLinePos(o),1==o.length?this.refreshConnector(o[0],!0):o.length>1&&this.refreshCons(o)}}},n.prototype.toggleLineByNode=function(t,e){for(var i=this.connectorMap.keys(),n=0;n<i.length;n++){var r=i[n];if(r.indexOf(t.id)!=-1){var s=this.connectorMap.get(r);o.each(s,function(t){e?t.show():t.hide()})}}},n.prototype.countLinePos=function(t){o.each(t,function(t){var e=t.options;if(1==e.autoChangePosition){var i=a.getRect(t.startNode).boundingRect,n=a.getRect(t.endNode).boundingRect,o=e.position.startPos,r=e.position.endPos,s=this.posIsChange(o,i,n,"startNode"),h=this.posIsChange(r,i,n,"endNode");o==s&&r==h||(e.position.startPos=s,e.position.endPos=h)}},this)},n.prototype.posIsChange=function(t,e,i,n){var o;return o=t.indexOf("top")!=-1||t.indexOf("bottom")!=-1?e.y+e.height<i.y?"startNode"==n?t.replace(/(top|bottom)/g,"bottom"):t.replace(/(top|bottom)/g,"top"):i.y+i.height<e.y?"endNode"==n?t.replace(/(top|bottom)/g,"bottom"):t.replace(/(top|bottom)/g,"top"):e.x+e.width<i.x?"startNode"==n?t.replace(/(top|bottom)/g,"right"):t.replace(/(top|bottom)/g,"left"):i.x+i.width<e.x?"endNode"==n?t.replace(/(top|bottom)/g,"right"):t.replace(/(top|bottom)/g,"left"):t:t.indexOf("left")!=-1||t.indexOf("right")!=-1?e.x+e.width<i.x?"startNode"==n?t.replace(/(right|left)/g,"right"):t.replace(/(right|left)/g,"left"):i.x+i.width<e.x?"endNode"==n?t.replace(/(right|left)/g,"right"):t.replace(/(right|left)/g,"left"):e.y+e.height<i.y?"startNode"==n?t.replace(/(right|left)/g,"bottom"):t.replace(/(right|left)/g,"top"):i.y+i.height<e.y?"endNode"==n?t.replace(/(right|left)/g,"bottom"):t.replace(/(right|left)/g,"top"):t:t},o.inherits(n,r),t.exports=n},function(t,e,i){function n(){this.connectors=[],this.selConnector=null,this.tempConnector=null}var o=i(65),r=i(66),s=i(82),a=i(92),h=i(5);n.prototype.connectorForbidEdit=function(t){for(var e=0;e<this.connectors.length;e++)this.connectors[e].options.isEdit=!t},n.prototype.clearSelectCon=function(){null!=this.selConnector&&this.refreshConnector(this.selConnector)},n.prototype.deleteSelectCon=function(t,e){for(var i=0;i<this.connectors.length;i++)if(this.connectors[i].startNode==t||this.connectors[i].endNode==t){var n=this.connectors[i].startNode.model.get("outgoing"),o=h.indexOf(n,this.connectors[i].resourceId);o!=-1&&n.splice(o,1),e.remove(this.connectors[i]),this.connectors.splice(i,1),i--,this.selConnector=null}},n.prototype.removeLine=function(t,e){this.selConnector=t,this.deleteLine(e)},n.prototype.deleteLine=function(t){if(this.selConnector.startNode){var e=this.selConnector.startNode.model.get("outgoing");if(n=h.indexOf(e,this.selConnector.resourceId),n!=-1&&e.splice(n,1),this.connectorMap){var i=this.getTwoNodeId(this.selConnector.startNode,this.selConnector.endNode,this.selConnector.options.position);this.connectorMap.removeItem(i,this.selConnector)}}t.remove(this.selConnector);var n=h.indexOf(this.connectors,this.selConnector);n!=-1&&this.connectors.splice(n,1),this.selConnector=null},n.prototype.refreshConnector=function(t,e){if(e||!t.turningPoints||t.turningPoints.length<2){t.model&&t.model.get("style.lineType")&&(t.options.style.lineType=t.model.get("style.lineType"));var i=this.getStartEndPoint(t),n=null;t.options.position&&t.options.position.escapeDistance&&(n=t.options.position.escapeDistance);var o=this.connector2Points(t.options.style.lineType,i[0],i[1],i[2],i[3],n);t.refresh(o[0][2])}t.clearHandles()},n.prototype.getStartEndPoint=function(t){var e=t.startNode,i=t.endNode,n=!0;n=e.parent!==i.parent;var s=e.getRect?e.getRect().boundingRect:o.getRect(e,n).boundingRect,a=[Number(s.x),Number(s.y),Number(s.x)+Number(s.width),Number(s.y)+Number(s.height)],h=i.getRect?i.getRect().boundingRect:o.getRect(i,n).boundingRect,l=[Number(h.x),Number(h.y),Number(h.x)+Number(h.width),Number(h.y)+Number(h.height)],c=o.getConnectorPoints(s,e),u=o.getConnectorPoints(h,i),d=t.options.position;if(d.direction){var p=d.direction.split(",");d.startPos=p[0],d.endPos=p[1]}d.startPos&&d.endPos||(s.x<h.x?(d.startPos="right",d.endPos="left"):(d.startPos="left",d.endPos="right"));var f=this.calcPointExpression(d.startPos,c),g=this.calcPointExpression(d.endPos,u);return f.add(new r(d.startOffset[0],d.startOffset[1])),g.add(new r(d.endOffset[0],d.endOffset[1])),[f,g,a,l]},n.prototype.calcPointExpression=function(t,e){var i={top:e.top.x,left:e.left.y,right:e.right.y,bottom:e.bottom.x,center:e.center.x},n="<% print("+t+") %>",s=parseInt(o.template(n)(i));if(t.indexOf("top")!=-1)return new r(s,e.top.y);if(t.indexOf("left")!=-1)return new r(e.left.x,s);if(t.indexOf("right")!=-1)return new r(e.right.x,s);if(t.indexOf("bottom")!=-1)return new r(s,e.bottom.y);if(t.indexOf("center")!=-1)return new r(s,e.bottom.y);throw new Error("pos")},n.prototype.manageTempConnector=function(t,e,i,n,r,a){var h=null,l=null,c=t.getRect?t.getRect().boundingRect:o.getRect(t,!0).boundingRect,u=[Number(c.x),Number(c.y),Number(c.x)+Number(c.width),Number(c.y)+Number(c.height)],d=o.getConnectorPoints(c,t);this.tempConnector||(this.tempConnector=new s({isEdit:!1,style:{lineType:i}}));var p=this.tempConnector,f=p.options.position;f.startPos=n?n:c.x<e.x?"right":"left",f.endPos=r?r:c.x<e.x?"left":"right",p.options.style.lineType=i,a&&(h=a.getRect?a.getRect().boundingRect:o.getRect(a,!0).boundingRect,l=[Number(h.x),Number(h.y),Number(h.x)+Number(h.width),Number(h.y)+Number(h.height)]);var g=this.connector2Points(i,d[f.startPos],e,u,l);return p.refresh(g[0][2]),p},n.prototype.manageReverseTempConnector=function(t,e,i,n,r,a){var h=null,l=null,c=e.getRect?e.getRect().boundingRect:o.getRect(e,!0).boundingRect,u=[Number(c.x),Number(c.y),Number(c.x)+Number(c.width),Number(c.y)+Number(c.height)],d=o.getConnectorPoints(c,e);this.tempConnector||(this.tempConnector=new s({isEdit:!1,style:{lineType:i}}));var p=this.tempConnector,f=p.options.position;f.endPos=n?n:c.x<t.x?"right":"left",f.startPos=r?r:c.x<t.x?"left":"right",p.options.style.lineType=i,a&&(h=a.getRect?a.getRect().boundingRect:o.getRect(a,!0).boundingRect,l=[Number(h.x),Number(h.y),Number(h.x)+Number(h.width),Number(h.y)+Number(h.height)]);var g=this.connector2Points(i,t,d[f.endPos],l,u);return p.refresh(g[0][2]),p},n.prototype.removeTempConnector=function(t){this.tempConnector&&(t.remove(this.tempConnector),this.tempConnector=null)},n.prototype.connector2Points=function(t,e,i,n,l,c){var u=[30,30];c&&(u=h.isArray(c)?c:[c,c]),a.group("connectionManager: connector2Points"),a.info("ConnectionManager: connector2Points ("+t+", "+e+", "+i+", "+n+", "+l+")");var d=[];switch(t){case s.TYPE_CHAIN:case s.TYPE_STRAIGHT:var p=[e.clone(),i.clone()];d.push(["straight","straight",p]);break;case s.TYPE_CURVE:case s.TYPE_JAGGED:var f=null,g=null;if(null!=n){var v=[];v.push(new r(e.x,n[1]-u[0])),v.push(new r(n[2]+u[0],e.y)),v.push(new r(e.x,n[3]+u[0])),v.push(new r(n[0]-u[0],e.y)),f=v[0];for(var y=1;y<v.length;y++)o.distance(e,v[y])<o.distance(e,f)&&(f=v[y])}if(null!=l){var v=[];v.push(new r(i.x,l[1]-u[1])),v.push(new r(l[2]+u[1],i.y)),v.push(new r(i.x,l[3]+u[1])),v.push(new r(l[0]-u[1],i.y)),g=v[0];for(var y=1;y<v.length;y++)o.distance(i,v[y])<o.distance(i,g)&&(g=v[y])}var m=[e],x=0;f&&(m.push(f),x=1),g&&m.push(g),m.push(i);var _=r.cloneArray(m);d.push(["s0","s0",_]);var b=r.cloneArray(m),w=r.cloneArray(b);w.splice(x+1,0,new r(w[x].x,w[x+1].y)),d.push(["s1","s1_1",w]);var P=r.cloneArray(b);P.splice(x+1,0,new r(P[x+1].x,P[x].y)),d.push(["s1","s1_2",P]);var C=r.cloneArray(m),T=new r((C[x].x+C[x+1].x)/2,C[x].y),N=new r((C[x].x+C[x+1].x)/2,C[x+1].y);C.splice(x+1,0,T,N),d.push(["s2","s2_1",C]);var S=r.cloneArray(m),M=new r(S[x].x,(S[x].y+S[x+1].y)/2),A=new r(S[x+1].x,(S[x].y+S[x+1].y)/2);S.splice(x+1,0,M,A),d.push(["s2","s2_2",S]);var E=r.cloneArray(m),R=[E[x].x+20,E[x+1].x+20];n&&R.push(n[2]+20),l&&R.push(l[2]+20);var L=o.max(R),k=new r(L,E[x].y),O=new r(L,E[x+1].y);E.splice(x+1,0,k,O),d.push(["s2","s2_3",E]);var I=r.cloneArray(m),z=[I[x].y-20,I[x+1].y-20];n&&z.push(n[1]-20),l&&z.push(l[1]-20);var B=o.min(z),D=new r(I[x].x,B),H=new r(I[x+1].x,B);I.splice(x+1,0,D,H),d.push(["s2","s2_4",I]);var F=r.cloneArray(m),G=[F[x].x-20,F[x+1].x-20];n&&G.push(n[0]-20),l&&G.push(l[0]-20);var Y=o.min(G),W=new r(Y,F[x].y),V=new r(Y,F[x+1].y);F.splice(x+1,0,W,V),d.push(["s2","s2_5",F]);var U=r.cloneArray(m),q=[U[x].y+20,U[x+1].y+20];n&&q.push(n[3]+20),l&&q.push(l[3]+20);var j=o.max(q),Z=new r(U[x].x,j),X=new r(U[x+1].x,j);U.splice(x+1,0,Z,X),d.push(["s2","s2_6",U]),a.info("Filter orthogonal solutions. Initial number of solutions = "+d.length);for(var Q=[],J=0;J<d.length;J++){var K=d[J][2];o.orthogonalPath(K)&&Q.push(d[J])}if(d=Q,a.info("\n\tOrthogonalSolutions = "+d.length),e.equals(i))a.info("Start and end point coincide...skip backward solution. I think we will just fall on s0 :)");else{a.info("Filter backward solutions. Initial number of solutions = "+d.length);for(var $=[],tt="",J=0;J<d.length;J++){var K=d[J][2];o.forwardPath(K)?$.push(d[J]):tt=tt+"\n\t"+K}d=$,a.info("\n\t ForwardSolutions = "+d.length),0==d.length&&a.info("Discarded solutions: "+tt)}a.info("Filter non intersecting solutions. Initial number of solutions = "+d.length);for(var et=[],J=0;J<d.length;J++){var K=d[J][2],it=!1,nt=K.slice();(l||n)&&(nt=nt.slice(1,nt.length-1)),n&&(it=it||o.polylineIntersectsRectangle(nt,n)),l&&(it=it||o.polylineIntersectsRectangle(nt,l)),it||et.push(d[J])}0!=et.length&&(d=et),a.info("\n\t nonIntersectionSolutions = "+d.length),a.info("Get first class of solutions with same nr of points"),0==d.length&&a.info("This is not possible");for(var ot=d[0][2],rt=ot.length,st=[],J=0;J<d.length;J++){var K=d[J][2];K.length==rt&&st.push(d[J])}d=st,a.info("pick the first solution with 90 degree angles (less turnarounds)");for(var at=0,J=0;J<d.length;J++){var K=d[J][2];o.scorePath(d[at][2])<o.scorePath(d[J][2])&&(at=J)}d=[d[at]]}return t===s.TYPE_CURVE&&this.smoothCurve(d),a.groupEnd(),d},n.prototype.smoothCurve=function(t){var e=3;switch(e){case 0:break;case 1:for(var i=0;i<t.length;i++){var n=t[i][2],r=n[0],s=n[1],a=o.getMiddle(r,s);n.splice(1,0,a);var l=n[n.length-2],c=n[n.length-1],u=o.getMiddle(l,c);n.splice(n.length-1,0,u)}break;case 2:h.each(t,function(t){var e=t[0];if("s1"==e||"s2"==e){var i=t[2];i.splice(1,1),i.splice(i.length-2,1)}});break;case 3:h.each(t,function(t){var e=t[0];if("s1"==e){var i=t[2],n=o.collinearReduction(i);t[2]=n}})}},t.exports=n},function(t,e){var i={LOG_LEVEL_NONE:0,LOG_LEVEL_DEBUG:1,LOG_LEVEL_INFO:2,LOG_LEVEL_ERROR:3,level:this.LOG_LEVEL_ERROR,debug:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_DEBUG&&"function"==typeof console.debug&&console.debug(t)},info:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_INFO&&console.info(t)},error:function(t){"undefined"!=typeof console&&this.level<=this.LOG_LEVEL_ERROR&&console.error(t)},group:function(t){this.level<=this.LOG_LEVEL_INFO&&"undefined"!=typeof console&&"function"==typeof console.group&&console.group(t)},groupEnd:function(){this.level<=this.LOG_LEVEL_INFO&&"undefined"!=typeof console&&"function"==typeof console.groupEnd&&console.groupEnd()}};i.level=i.LOG_LEVEL_ERROR,t.exports=i},function(t,e){t.exports={ELEMENT_TYPE:"elementType",MODE:"mode",BACKGROUND:"backgroud",OPTIONS:"options",USERDATA:"userData",ID:"id",START_ID:"startNodeId",END_ID:"endNodeId",ALARM:"Alarm",RELATIONID:"relationId",RELATION_IMAGE:"relationImage",GROUP:"Group",GROUP_NODE:"GroupNode",CONNECTION:"connection",CHILDS:"childs",TREE_ROOT:"treeRoot",DOCKERS:"options.dockers",STYLE_LINETYPE:"style.lineType",LINEOPERATIONICON:"LineOperationIcon",DEL:"DEL",LINK:"straight",FOLD:"jagged",CURVE:"curve"}},function(t,e,i){function n(t,e){var i=[];return e.eachChild(function(t){if(t.model){if(t instanceof y){var e=[];t.eachChild(function(t){t.model&&(t instanceof D?t.refreshModel():t.model.set("options.position",t.position),e.push(t.model.option))}),t.model.set(g.CHILDS,e)}t instanceof D&&t.refreshModel(),i.push(t.model.option)}}),t.set(g.CHILDS,i),t.option}function o(t,e,i,n,s,a){for(var h=[],l=0;l<i.length;l++){var c=i[l];if(c.elementType===g.CONNECTION)h.push(c);else if(c.elementType===g.ALARM){var u=r(t.allNodes,c.relationId);t.createAlarm(u,c.options)}else if(c.elementType===g.GROUP_NODE||c.elementType===g.GROUP){var d=t.createNode(g.GROUP,c.options,c.userData);c.childs&&o(t,d,c.childs,!0,s,a),n?e.add(d):t.addNode(d,{},a)}else{var p=t.createNode(c.elementType,c.options,c.userData);if(n?e.add(p):t.addNode(p,{},a),c.options.layout&&c.options.layout.layout===g.TREE_ROOT){var f=r(t.allNodes,c.id);s.push(f)}}}v.each(h,function(i){var o=r(t.allNodes,i.startNodeId),s=r(t.allNodes,i.endNodeId);if(o&&s){var h=t.createLink(o,s,i.options,i.userData);n?e.add(h):t.addNode(h,{},a)}else{var l=H.Link.createByPoint(i.options,i.userData);n?e.add(l):t.addNode(l,{},a)}})}function r(t,e){var i=null;return t.forEach(function(t){t.id===e&&(i=t)}),i}function s(t,e){e=e||{},e.pixelRatio=e.pixelRatio||1,e.backgroundColor=e.backgroundColor||"#FFFFFF";var i=t.storage.getDisplayList();return v.each(i,function(t){for(var e=t.animators,i=e.length,n=0;n<i;n++)e[n].stop(!1)}),t.painter.getRenderedCanvas(e)}function a(t,e){e=e||{};var i=s(t,e).toDataURL("image/"+(e&&e.type||"png")),n=t.storage.getDisplayList();return v.each(n,function(t){for(var e=t.animators,i=e.length,n=0;n<i;n++)e[n].start()}),i}function h(t){var e=parseInt(t[0],10),i=parseInt(t[1],10);return e<0&&(e=0),i<0&&(i=0),[e,i]}function l(t){var e={Rect:m,Circle:x,Image:_,Text:b,Sector:w,Ring:P,Ellipse:C,Heart:T,Droplet:N,Rose:S,Isogon:M,Polygon:A,Line:E,Polyline:R,BezierCurve:L,Arc:k,Star:O,Trochoid:I,Path:z,Group:y,IconButton:B};for(var i in e)t[i]=e[i];return t}function c(t){var e=t.length;return"number"==typeof t?[t,t,t,t]:2===e?[t[0],t[1],t[0],t[1]]:3===e?[t[0],t[1],t[2],t[1]]:t}function u(t){return t.replace(/^\s+/,"").replace(/\s+$/,"")}function d(t,e){switch(t){case"center":case"middle":t="50%";break;case"left":case"top":t="0%";break;case"right":case"bottom":t="100%"}return"string"==typeof t?u(t).match(/%$/)?parseFloat(t)/100*e:parseFloat(t):null==t?NaN:+t}function p(t,e){return t=(t||"").toLowerCase().replace(/-(.)/g,function(t,e){return e.toUpperCase()}),e&&t&&(t=t.charAt(0).toUpperCase()+t.slice(1)),t}function f(t,e,i){v.isArray(e)||(e=[e]);var n=e.length;if(!n)return"";for(var o=e[0].$vars||[],r=0;r<o.length;r++){var s=Y[r],a=W(s,0);t=t.replace(W(s),i?G(a):a)}for(var h=0;h<n;h++)for(var l=0;l<o.length;l++){var c=e[h][o[l]];t=t.replace(W(Y[l],h),i?G(c):c)}return t}var g=i(93),v=i(5),y=i(95),m=i(97),x=i(98),_=i(99),b=i(100),w=i(101),P=i(102),C=i(103),T=i(104),N=i(105),S=i(106),M=i(107),A=i(108),E=i(109),R=i(110),L=i(111),k=i(112),O=i(113),I=i(114),z=i(115),B=i(116),D=i(82),H=i(117),F=function(){var t=0;return function(){var e="\0__topo_prop_getter_"+t++;return function(t){return t[e]||(t[e]={})}}}(),G=function(t){return String(t).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")},Y=["a","b","c","d","e","f","g"],W=function(t,e){return"{"+t+(null==e?"":e)+"}"};t.exports={toJson:n,fromJson:o,toDataURL:a,truncPosition:h,registerFlowNode:l,normalizeCssArray:c,parsePercent:d,toCamelCase:p,makeGetter:F,formatTpl:f,findNodeById:r}},function(t,e,i){function n(t){this.model=l.genModel("GroupNode",t),s.Group.call(this,t);var e={shape:{width:5,height:5,r:5},style:{fill:"rgba(0,0,0,0)",stroke:"rgba(0,0,0,0)"},position:[0,0]};this.options=o.merge(e,t,!0),this.options.layout=t.layout,this.max=[1024,960],this.render(this.options)}var o=i(5),r=i(27),s=i(4),a=i(65),h=i(82),l=i(96);n.RECT_NAME="GROUP_RECT_NAME",n.prototype={constructor:n,type:"GroupNode",render:function(t){var e=new s.Rect({shape:t.shape,style:t.style,z:1});e.name=n.RECT_NAME,this.add(e),this.position=t.position,this.mergedImage=t.mergedImage},rectContain:function(t,e){var i=a.getRect(this);return i.boundingRect.contain(t,e)},add:function(t){return t&&t!==this&&t.parent!==this&&(this._children.push(t),this._doAdd(t)),this._api&&this._api._addGroupNode(this,t),this},each:function(t,e){for(var i=this._children,o=0;o<i.length;o++){var r=i[o];r.name!=n.RECT_NAME&&t.call(e,r,o)}return this},willRender:function(t){this.options.layout&&this.setLayout(this.options.layout),this.setProperties({shape:{width:this.getBoundingRect().width,height:this.getBoundingRect().height}}),this._api=t},setLayout:function(t){t.run(this)},getRect:function(){var t=this.getBoundingRect(),e=this.clipPath;e&&(t=e.getBoundingRect());var i=[];i[0]=[-t.width/2,-t.height/2],i[1]=[t.width/2,-t.height/2],i[2]=[t.width/2,t.height/2],i[3]=[-t.width/2,t.height/2],i[4]=[-t.width/2,-t.height/2];var n=new r(this.position[0],this.position[1],t.width,t.height);return{x:this.position[0]+t.width/2,y:this.position[1]+t.height/2,width:t.width,height:t.height,points:i,boundingRect:n}},modifyGroupRect:function(t){var e=this.options.shape.r;this.setProperties({shape:{width:e,height:e,r:e}});for(var i=this.childOfName(n.RECT_NAME),r=this.getBoundingRect(),s=r.width,a=r.height,l=i.position[0],c=i.position[1],u=this._children[1].position[0],d=this._children[1].position[1],p=this._children[1].position[0],f=this._children[1].position[1],g=o.clone(t.position),v=1;v<this._children.length;v++)this._children[v]instanceof h||1==this._children[v].isIcon||(u>this._children[v].position[0]&&(u=this._children[v].position[0]),p<this._children[v].position[0]&&(p=this._children[v].position[0]),d>this._children[v].position[1]&&(d=this._children[v].position[1]),f<this._children[v].position[1]&&(f=this._children[v].position[1]));if(s>this.max[0]?(s=this.max[0]-2,t.position[0]>u?g[0]=u+this.max[0]-t.width:g[0]=p-this.max[0]+t.width):(l=i.position[0]+t.position[0],l>u&&(l=u),t.isMove?g[0]=t.movePosition[0]+t.moveX:g[0]=t.position,t.position[0]>u?g[0]>u+this.max[0]-t.width&&(g[0]=u+this.max[0]-t.width):g[0]<p-this.max[0]+t.width&&(g[0]=p-this.max[0]+t.width)),a>this.max[1]?(a=this.max[1]-2,t.position[1]>d?g[1]=d+this.max[1]-t.height:g[1]=f-this.max[1]+t.height):(c=i.position[1]+t.position[1],c>d&&(c=d),t.isMove?g[1]=t.movePosition[1]+t.moveY:g[1]=t.position[1],t.position[1]>d?g[1]>d+this.max[1]-t.height&&(g[1]=d+this.max[1]-t.height):g[1]<f-this.max[1]+t.height&&(g[1]=f-this.max[1]+t.height)),t.node.alarm){var y=[g[0]+t.node.getBoundingRect().width-(t.node.alarm.getBoundingRect().width-6),g[1]-t.node.alarm.getBoundingRect().height-3];t.node.alarm.attr("position",y)}this.setProperties({shape:{width:s,height:a,x:l,y:c}})},setProperties:function(t){var e=this.childOfName(n.RECT_NAME);e.setShape(t.shape),this.attr("position",t.position)},merged:function(){var t=this,e=o.clone(this.position),i=this._relationImage.getBoundingRect().width,r=this._relationImage.getBoundingRect().height,s=[this.position[0]+this.childOfName(n.RECT_NAME).shape.x+(this.getBoundingRect().width/2-i/2),this.position[1]+this.childOfName(n.RECT_NAME).shape.y+(this.getBoundingRect().height/2-r/2)],a=o.clone(s);return this._relationImage.attr("style",{image:this.mergedImage,width:i,height:r}),this._relationImage.attr("position",s),i>0&&r>0&&(this.hide(),this._relationImage.show()),this._relationImage.on("dblclick",function(){t.attr("position",[e[0]+(this.position[0]-a[0]),e[1]+(this.position[1]-a[1])]),this.hide(),t.show()}),this._relationImage},updateShape:function(t,e){var i=Number(t),o=this.options.shape,r=Number(o.width*i),s=Number(r*o.height/o.width);e&&(r=parseInt(r,10),s=parseInt(s,10)),this.setProperties({shape:{width:r,height:s}}),this.children().forEach(function(o){var r=o.position;if(o.name===n.RECT_NAME||o instanceof h||"ZPath"===o.type){if("ZPath"===o.type){var s=o.rect;s.height=s.height*i,s.width=s.width*i,o.attr({position:[r[0]*i,r[1]*i],rect:s})}}else o.updateShape(t,e),o.attr("position",[r[0]*i,r[1]*i])})}},o.inherits(n,s.Group),t.exports=n},function(t,e,i){"use strict";var n=i(7),o=i(93),r=i(5),s=i(65),a=i(87),h={};h.genModel=function(t,e){var i=new a({});return e.id||(e.id=s.getUUID()),e.style&&0!==e.style.textLineHeight&&!e.style.rich&&(e.style.rich={}),i.set(o.ELEMENT_TYPE,t),e.style&&e.style.host&&delete e.style.host,i.set(o.OPTIONS,r.clone(e)),"draggable"in e&&(e.isdraggable=e.draggable,delete e.draggable),e.z||(e.z=1),s.isUndefined(e.hoverAnimation)&&(e.hoverAnimation=!1),s.isUndefined(e.selectable)&&(e.selectable=!0),i},h.addHoverAnimation=function(t){var e=r.clone(t.scale)||[1,1],i=function(){this.animateTo({scale:[1.1*e[0],1.1*e[1]]},400,"elasticOut")},n=function(){this.animateTo({scale:e},400,"elasticOut")};t.on("mouseover",i).on("mouseout",n).on("emphasis",i).on("normal",n)},h.extend=function(t){var e=function(e){this.model=h.genModel(t.type,e),n.call(this,e),t.style&&this.style.extendFrom(t.style,!1);var i=t.shape;if(i){this.shape=this.shape||{};var o=this.shape;for(var r in i)!o.hasOwnProperty(r)&&i.hasOwnProperty(r)&&(o[r]=i[r])}t.init&&t.init.call(this,e)};r.inherits(e,n);for(var i in t)"style"!==i&&"shape"!==i&&(e.prototype[i]=t[i]);return e.prototype.setStyle=function(t,e){return this.style.set(t,e),this.dirty(!1),r.merge(this.model.get("options.style"),t,!0),this},e},t.exports=h},function(t,e,i){var n=i(29);t.exports=i(96).extend({type:"Rect",shape:{x:0,y:0,r:0,width:50,height:50},buildPath:function(t,e){var i=0,o=0,r=e.width,s=e.height;e.r?n.buildPath(t,e):t.rect(i,o,r,s),t.closePath()},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.width*i),r=Number(o*n.height/n.width);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({width:o,height:r})}})},function(t,e,i){"use strict";t.exports=i(96).extend({type:"Circle",shape:{r:20},buildPath:function(t,e,i){i&&t.moveTo(e.r,0),t.arc(0,0,e.r,0,2*Math.PI,!0)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i);e&&(o=parseInt(o,10)),this.setShape({r:o})}})},function(t,e,i){function n(t){this.model=a.genModel("Image",t),o.call(this,t),window.jQuery&&(this.resultDeferrd=jQuery.Deferred(),this.result=this.resultDeferrd.promise())}var o=i(8),r=i(27),s=i(5),a=i(96),h=i(21),l=new h(50);n.prototype={constructor:n,type:"Image",brush:function(t,e){var i,n=this.style,o=n.image;if(n.bind(t,this,e),"string"==typeof o?(i=this._image,i&&i.src!==o&&(i=null)):(i=o,i.isLoaded=!0),!i&&o){var r=l.get(o);if(!r)return i=new Image,i.isLoaded=!1,i.onload=function(){i.isLoaded=!0,i.onload=null;for(var t=0;t<r.pending.length;t++)r.pending[t].dirty()},r={image:i,pending:[this]},i.src=o,l.put(o,r),void(this._image=i);if(i=r.image,this._image=i,!(i.width&&i.height||i.src.endsWith("svg")))return void r.pending.push(this)}if(i){var s=n.x||0,a=n.y||0;if(!i.isLoaded)return void(window.jQuery&&this.resultDeferrd.reject(i));var h=n.width,c=n.height,u=i.width/i.height;if(null==h&&null!=c?h=c*u:null==c&&null!=h?c=h/u:null==h&&null==c&&(h=i.width,c=i.height),this.setTransform(t),n.sWidth&&n.sHeight){var d=n.sx||0,p=n.sy||0;t.drawImage(i,d,p,n.sWidth,n.sHeight,s,a,h,c)}else if(n.sx&&n.sy){var f=n.sx,g=n.sy,v=h-f,y=c-g;t.drawImage(i,f,g,v,y,s,a,h,c)}else t.drawImage(i,s,a,h,c);null==n.width&&(n.width=h),null==n.height&&(n.height=c),this.restoreTransform(t),null!=n.text&&this.drawRectText(t,this.getBoundingRect()),window.jQuery&&this.resultDeferrd.resolve(i)}},getBoundingRect:function(){var t=this.style;return this._rect||(this._rect=new r(t.x||0,t.y||0,t.width||0,t.height||0)),this._rect},updateShape:function(t,e){var i=Number(t),n=this.style,o=Number(n.width*i),r=Number(o*n.height/n.width);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setStyle({width:o,height:r})}},s.inherits(n,o),t.exports=n},function(t,e,i){function n(t){var e={style:{textBaseline:"top"}},i=r.merge(e,t,!0);this.model=s.genModel("Text",i),o.call(this,i)}var o=i(46),r=i(5),s=i(96);n.prototype={constructor:n,type:"Text",updateShape:function(){}},r.inherits(n,o),t.exports=n},function(t,e,i){var n=i(50),o=i(7),r=[["shadowBlur",0],["shadowColor","#000"],["shadowOffsetX",0],["shadowOffsetY",0]];t.exports=i(96).extend({type:"Sector",shape:{cx:0,cy:0,r0:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},brush:n.browser.ie&&n.browser.version>=11?function(){var t,e=this.__clipPaths,i=this.style;if(e)for(var n=0;n<e.length;n++){var s=e[n]&&e[n].shape;if(s&&s.startAngle===s.endAngle){for(var a=0;a<r.length;a++)r[a][2]=i[r[a][0]],i[r[a][0]]=r[a][1];t=!0;break}}if(o.prototype.brush.apply(this,arguments),t)for(var h=0;h<r.length;h++)i[r[h][0]]=r[h][2]}:o.prototype.brush,buildPath:function(t,e){var i=e.cx,n=e.cy,o=Math.max(e.r0||0,0),r=Math.max(e.r,0),s=e.startAngle,a=e.endAngle,h=e.clockwise,l=Math.cos(s),c=Math.sin(s);t.moveTo(l*o+i,c*o+n),t.lineTo(l*r+i,c*r+n),t.arc(i,n,r,s,a,!h),t.lineTo(Math.cos(a)*o+i,Math.sin(a)*o+n),0!==o&&t.arc(i,n,o,a,s,h),t.closePath()},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i),r=Number(n.r0*i);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({r:o,r0:r})}})},function(t,e,i){t.exports=i(96).extend({type:"Ring",shape:{cx:0,cy:0,r:0,r0:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=2*Math.PI;t.moveTo(i+e.r,n),t.arc(i,n,e.r,0,o,!1),t.moveTo(i+e.r0,n),t.arc(i,n,e.r0,0,o,!0)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i),r=Number(n.r0*i);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({r:o,r0:r})}})},function(t,e,i){"use strict";t.exports=i(96).extend({type:"Ellipse",shape:{rx:0,ry:0},buildPath:function(t,e){var i=.5522848,n=0,o=0,r=e.rx,s=e.ry,a=r*i,h=s*i;t.moveTo(n-r,o),t.bezierCurveTo(n-r,o-h,n-a,o-s,n,o-s),t.bezierCurveTo(n+a,o-s,n+r,o-h,n+r,o),t.bezierCurveTo(n+r,o+h,n+a,o+s,n,o+s),t.bezierCurveTo(n-a,o+s,n-r,o+h,n-r,o),t.closePath()},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.rx*i),r=Number(o*n.ry/n.rx);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({rx:o,ry:r})}})},function(t,e,i){t.exports=i(96).extend({type:"Heart",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=e.width,r=e.height;t.moveTo(i,n),t.bezierCurveTo(i+o/2,n-2*r/3,i+2*o,n+r/3,i,n+r),t.bezierCurveTo(i-2*o,n+r/3,i-o/2,n-2*r/3,i,n)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.width*i),r=Number(o*n.height/n.width);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({width:o,height:r})}})},function(t,e,i){"use strict";t.exports=i(96).extend({type:"Droplet",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(t,e){var i=e.cx,n=e.cy,o=e.width,r=e.height;t.moveTo(i,n+o),t.bezierCurveTo(i+o,n+o,i+3*o/2,n-o/3,i,n-r),t.bezierCurveTo(i-3*o/2,n-o/3,i-o,n+o,i,n+o),t.closePath()},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.width*i),r=Number(o*n.height/n.width);e&&(o=parseInt(o,10),r=parseInt(r,10)),this.setShape({width:o,height:r})}})},function(t,e,i){var n=Math.sin,o=Math.cos,r=Math.PI/180;t.exports=i(96).extend({type:"Rose",shape:{cx:0,cy:0,r:[],k:0,n:1},style:{stroke:"#000",fill:null,lineWidth:2},buildPath:function(t,e){var i,s,a,h=e.r,l=e.k,c=e.n,u=e.cx,d=e.cy;t.moveTo(u,d);for(var p=0,f=h.length;p<f;p++){a=h[p];for(var g=0;g<=360*c;g++)i=a*n(l/c*g%360*r)*o(g*r)+u,s=a*n(l/c*g%360*r)*n(g*r)+d,t.lineTo(i,s)}},updateShape:function(t,e){var i=Number(t),n=this.shape,o=[];n.r.forEach(function(t){o.push(Number(t*i))}),e&&o.forEach(function(t){t=parseInt(t,10)}),this.setShape({r:o})}})},function(t,e,i){var n=Math.PI,o=Math.sin,r=Math.cos;t.exports=i(96).extend({type:"Isogon",shape:{x:0,y:0,r:0,n:0},buildPath:function(t,e){var i=e.n;if(i&&!(i<2)){var s=e.x,a=e.y,h=e.r,l=2*n/i,c=-n/2;t.moveTo(s+h*r(c),a+h*o(c));for(var u=0,d=i-1;u<d;u++)c+=l,t.lineTo(s+h*r(c),a+h*o(c));t.closePath()}},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i);e&&(o=parseInt(o,10)),this.setShape({r:o})}})},function(t,e,i){var n=i(53);t.exports=i(96).extend({type:"Polygon",shape:{points:null,smooth:!1,smoothConstraint:null},buildPath:function(t,e){n.buildPath(t,e,!0)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=[];n.points.forEach(function(t){o.push([Number(t[0]*i),Number(t[1]*i)])}),e&&o.forEach(function(t){t[0]=parseInt(t[0],10),t[1]=parseInt(t[1],10)}),this.setShape({points:o})}})},function(t,e,i){t.exports=i(96).extend({type:"Line",shape:{x1:0,y1:0,x2:0,y2:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.x1,n=e.y1,o=e.x2,r=e.y2,s=e.percent;0!==s&&(t.moveTo(i,n),s<1&&(o=i*(1-s)+o*s,r=n*(1-s)+r*s),t.lineTo(o,r))},pointAt:function(t){var e=this.shape;return[e.x1*(1-t)+e.x2*t,e.y1*(1-t)+e.y2*t]},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.x1*i),r=Number(n.x2*i),s=Number(n.y1*i),a=Number(n.y2*i);e&&(o=parseInt(o,10)),this.setShape({x1:o,y1:s,x2:r,y2:a})}})},function(t,e,i){"use strict";var n=i(53);t.exports=i(96).extend({type:"Polyline",shape:{points:null,smooth:!1,smoothConstraint:null},style:{stroke:"#000",fill:null},buildPath:function(t,e){n.buildPath(t,e,!1)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=[];n.points.forEach(function(t){o.push([Number(t[0]*i),Number(t[1]*i)])}),e&&o.forEach(function(t){t[0]=parseInt(t[0],10),t[1]=parseInt(t[1],10)}),this.setShape({points:o})}})},function(t,e,i){"use strict";function n(t,e,i){var n=t.cpx2,o=t.cpy2;return null===n||null===o?[(i?u:l)(t.x1,t.cpx1,t.cpx2,t.x2,e),(i?u:l)(t.y1,t.cpy1,t.cpy2,t.y2,e)]:[(i?c:h)(t.x1,t.cpx1,t.x2,e),(i?c:h)(t.y1,t.cpy1,t.y2,e)]}var o=i(31),r=i(15),s=o.quadraticSubdivide,a=o.cubicSubdivide,h=o.quadraticAt,l=o.cubicAt,c=o.quadraticDerivativeAt,u=o.cubicDerivativeAt,d=[];t.exports=i(96).extend({type:"BezierCurve",shape:{x1:0,y1:0,x2:0,y2:0,cpx1:0,cpy1:0,percent:1},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.x1,n=e.y1,o=e.x2,r=e.y2,h=e.cpx1,l=e.cpy1,c=e.cpx2,u=e.cpy2,p=e.percent;0!==p&&(t.moveTo(i,n),null==c||null==u?(p<1&&(s(i,h,o,p,d),h=d[1],o=d[2],s(n,l,r,p,d),l=d[1],r=d[2]),t.quadraticCurveTo(h,l,o,r)):(p<1&&(a(i,h,c,o,p,d),h=d[1],c=d[2],o=d[3],a(n,l,u,r,p,d),l=d[1],u=d[2],r=d[3]),t.bezierCurveTo(h,l,c,u,o,r)))},pointAt:function(t){return n(this.shape,t,!1)},tangentAt:function(t){var e=n(this.shape,t,!0);return r.normalize(e,e)},updateShape:function(t,e){
var i=Number(t),n=this.shape,o={};Object.keys(n).forEach(function(t){var e=n[t];"percent"!==t?o[t]=Number(e*i):o[t]=e}),e&&Object.keys(o).forEach(function(t){o[t]=parseInt(o[t],10)}),this.setShape(o)}})},function(t,e,i){"use strict";t.exports=i(96).extend({type:"Arc",shape:{cx:0,cy:0,r:0,startAngle:0,endAngle:2*Math.PI,clockwise:!0},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i=e.cx,n=e.cy,o=Math.max(e.r,0),r=e.startAngle,s=e.endAngle,a=e.clockwise,h=Math.cos(r),l=Math.sin(r);t.moveTo(h*o+i,l*o+n),t.arc(i,n,o,r,s,!a)},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i);e&&(o=parseInt(o,10)),this.setShape({r:o})}})},function(t,e,i){"use strict";var n=Math.PI,o=Math.cos,r=Math.sin;t.exports=i(96).extend({type:"Star",shape:{cx:0,cy:0,n:3,r0:null,r:0},buildPath:function(t,e){var i=e.n;if(i&&!(i<2)){var s=e.cx,a=e.cy,h=e.r,l=e.r0;null==l&&(l=i>4?h*o(2*n/i)/o(n/i):h/3);var c=n/i,u=-n/2,d=s+h*o(u),p=a+h*r(u);u+=c,t.moveTo(d,p);for(var f,g=0,v=2*i-1;g<v;g++)f=g%2===0?l:h,t.lineTo(s+f*o(u),a+f*r(u)),u+=c;t.closePath()}},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i);e&&(o=parseInt(o,10)),this.setShape({r:o})}})},function(t,e,i){"use strict";var n=Math.cos,o=Math.sin;t.exports=i(96).extend({type:"Trochoid",shape:{cx:0,cy:0,r:0,r0:0,d:0,location:"out"},style:{stroke:"#000",fill:null},buildPath:function(t,e){var i,r,s,a,h=e.r,l=e.r0,c=e.d,u=e.cx,d=e.cy,p="out"==e.location?1:-1;if(!(e.location&&h<=l)){var f,g=0,v=1;i=(h+p*l)*n(0)-p*c*n(0)+u,r=(h+p*l)*o(0)-c*o(0)+d,t.moveTo(i,r);do g++;while(l*g%(h+p*l)!==0);do f=Math.PI/180*v,s=(h+p*l)*n(f)-p*c*n((h/l+p)*f)+u,a=(h+p*l)*o(f)-c*o((h/l+p)*f)+d,t.lineTo(s,a),v++;while(v<=l*g/(h+p*l)*360)}},updateShape:function(t,e){var i=Number(t),n=this.shape,o=Number(n.r*i),r=Number(n.r0*i),s=Number(n.d*i);o=parseInt(o,10),r=parseInt(r,10),s=parseInt(s,10),this.setShape({r:o,r0:r,d:s})}})},function(t,e,i){function n(t){var e={style:{fill:"none",stroke:"#2c2c2c"},rect:{x:0,y:0,width:0,height:0},rectHover:!0},i=t.pathData,n=a.genModel("Path",t);delete t.pathData,this.options=s.merge(e,t,!0);var h=o.createFromString(i,this.options);h.model=n,r.call(h);var l=h.getBoundingRect(),c=this.options.rect,u=t.layout;if(c){var d=l.width/l.height;if("center"===u){var p,f=c.height*d;f<=c.width?p=c.height:(f=c.width,p=f/d);var g=c.x+c.width/2,v=c.y+c.height/2;c.x=g-f/2,c.y=v-p/2,c.width=f,c.height=p}this.resizePath(h,c)}return h.type="ZPath",h}var o=i(6),r=i(43),s=i(5),a=i(96);n.prototype={constructor:n,type:"ZPath",resizePath:function(t,e){if(t.applyTransform){var i=t.getBoundingRect(),n=i.calculateTransform(e);t.applyTransform(n)}},updateShape:function(t,e){var i=Number(t),n=this.rect,o=Number(n.width*i),r=Number(o*n.height/n.width);e&&(o=parseInt(o,10),r=parseInt(r,10)),n.width=o,n.height=r,this.attr("rect",n)}},s.inherits(n,r),t.exports=n},function(t,e,i){function n(t){var e={backgroundColor:"transparent",borderColor:"#ccc",draggable:!1,selectable:!1,borderWidth:0,itemSize:15,showTitle:!0,icon:"",iconStyle:{normal:{stroke:"#666",fill:"none"},emphasis:{stroke:"#3E98c5"}}};this.options=o.merge(e,t,!0),this.model=s.genModel("IconButton",this.options),r.Group.call(this,this.options),this.render()}var o=i(5),r=i(4),s=i(96);n.prototype={constructor:n,type:"IconButton",render:function(){var t=this.options.iconStyle.normal,e=this.options.iconStyle.emphasis,i=this.options.itemSize,n=this.options.icon,o={x:-i/2,y:-i/2,width:i,height:i},s=0===n.indexOf("image://")?(o.image=n.slice(8),new r.Image({style:o})):r.makePath(n.replace("path://",""),{style:t,hoverStyle:e,rectHover:!0},o,"center");r.setHoverStyle(s),this.options.showTitle&&(s.__title=this.options.title,s.on("mouseover",function(){s.setStyle({text:this.options.title,textPosition:e.textPosition||"bottom",textFill:e.fill||e.stroke||"#000",textAlign:e.textAlign||"center"})}.bind(this)).on("mouseout",function(){s.setStyle({textFill:null})})),s.trigger("normal"),this.add(s)}},o.inherits(n,r.Group),t.exports=n},function(t,e,i){"use strict";var n=i(118),o=i(120),r=i(121),s=i(122),a=i(82),h={};h.Link=h[a.TYPE_STRAIGHT]=n,h.Fold=h[a.TYPE_JAGGED]=o,h.Curve=h[a.TYPE_CURVE]=r,h.Chain=h[a.TYPE_CHAIN]=s,t.exports=h},function(t,e,i){function n(t,e,i){var n=r.translateLinkOptions(i),s=new o(n);return s.startNode=t,s.endNode=e,s}var o=i(82),r=i(119);n.createByPoint=function(t){var e=r.translateLinkOptions(t),i=new o(e);return i},t.exports=n},function(t,e,i){var n=i(93),o=i(95),r=i(65),s={FLOW_TYPE:"elementType",LINK:"connection",RECT:"Rect",Group:"Group",IMAGE:"Image",TEXT:"Text",CIRCLE:"Circle",SECTOR:"Sector",RING:"Ring",POLYGON:"Polygon",POLYLINE:"Polyline",LINE:"Line",BEZIERCURVE:"Beziercurve",ARC:"Arc",SCENE:"scene",setUserData:function(t,e){t.model.set(n.USERDATA,e)},getUserData:function(t){var e=t.model.get(n.USERDATA);return r.isUndefined(e)&&(e={}),e},isLink:function(t){var e=t.get(s.FLOW_TYPE);return e==s.LINK},isNode:function(t){var e,i=t.get(s.FLOW_TYPE);return e=i!=s.LINK&&i!=s.SCENE},isInGroup:function(t){return t.parent&&t.parent instanceof o},isGroupNode:function(t){return t instanceof o},isRect:function(t){var e=t.get(s.FLOW_TYPE);return e==s.RECT},isImage:function(t){var e=t.get(s.FLOW_TYPE);return e==s.IMAGE},isText:function(t){var e=t.get(s.FLOW_TYPE);return e==s.TEXT},isCircle:function(t){var e=t.get(s.FLOW_TYPE);return e==s.CIRCLE},getType:function(t){var e=t.get(s.FLOW_TYPE);return e},translateLinkOptions:function(t){if(t){if(t.pos){var e=t.pos.split(",");e.length>=2&&(t.position||(t.position={}),t.position.startPos=e[0],t.position.endPos=e[1])}t.text&&t.text.color&&(t.text.textFill=t.text.color)}return t}};t.exports=s},function(t,e,i){function n(t,e,i){var n=r.merge({style:{lineType:o.TYPE_JAGGED}},i,!0);n=s.translateLinkOptions(n);var a=new o(n);return a.startNode=t,a.endNode=e,a}var o=i(82),r=i(5),s=i(119);n.createByPoint=function(t){var e=r.merge({style:{lineType:o.TYPE_JAGGED}},t,!0);e=s.translateLinkOptions(e);var i=new o(e);return i},t.exports=n},function(t,e,i){function n(t,e,i){var n=r.merge({style:{lineType:o.TYPE_CURVE}},i,!0);n=s.translateLinkOptions(n);var a=new o(n);return a.startNode=t,a.endNode=e,a}var o=i(82),r=i(5),s=i(119);n.createByPoint=function(t){var e=r.merge({style:{lineType:o.TYPE_CURVE}},t,!0);e=s.translateLinkOptions(e);var i=new o(e);return i},t.exports=n},function(t,e,i){function n(t,e,i){i.style.lineType=o.TYPE_CHAIN;var n=r.translateLinkOptions(i),s=new o(n);return s.startNode=t,s.endNode=e,s}var o=i(82),r=i(119);n.createByPoint=function(t){var e=r.translateLinkOptions(t),i=new o(e);return i},t.exports=n},function(t,e,i){function n(t,e){this.lineOperations=[],this.isEdit=!0,this.connectionManager=t,this._api=e}var o=i(83),r=i(5),s=i(89);n.prototype.addIcon=function(t,e){var i=r.find(e.lineNode.icons,function(e){return e.key===t});if(i)return void this.bindOperation(e.lineNode);var n=this.creatOperation(t,e);return this._api._getParentZr().add(n),this.bindOperation(e.lineNode),n},n.prototype.creatOperation=function(t,e){var i=o.createSymbol(e.iconPath,0,0,e.width||15,e.height||15,0,e.color||"#aaaaac");return i.key=t,i._width=e.width||15,i._isLineOperationIcon=!0,i.hide(),e.lineNode.icons.push(i),this.lineOperations.push(i),i.on("click",function(t){if(e.callback)t.data=e,t.lineNode=e.lineNode,e.callback(t);else{var i={};i.event=t,i.type="click",i.elementType="LineOperationIcon",this._api.trigger(i.type,i)}}.bind(this)),i},n.prototype.bindOperation=function(t){function e(t){return t.parent&&"SubProcess"==t.parent.nodeType?t.position[0]+e(t.parent):t.position[0]}function i(t){return t.parent&&"SubProcess"==t.parent.nodeType?t.position[1]+i(t.parent):t.position[1]}if(0!=this.isEdit){var n,o,s=t.middle();t.parent&&"SubProcess"==t.parent.nodeType?(n=s[0]+e(t.parent),o=s[1]+i(t.parent)):(n=s[0],o=s[1]);var a=r.map(t.icons,function(t){return t._width}),h=r.reduce(a,function(t,e){return t+e+10},0);r.each(t.icons,function(e,i){for(var r=0,s=0;s<i;s++)r+=a[s]+10;e.attr("position",[n+r-h/2,o+5]),e.show(),e.attachLine=t})}},n.prototype.hideAllLineOperation=function(){r.each(this.lineOperations,function(t){t.hide()})},n.prototype.addDeleteIcon=function(t,e){var i=r.defaults({iconPath:"path://"+s.DEL_SVG,width:12,height:14,lineNode:t,callback:function(t){this._api.remove(t.target.attachLine)}.bind(this)},e,!0);this.addIcon("delete",i)},n.prototype.addChangeLineTypeIcon=function(t,e){var i=r.defaults({iconPath:"path://"+s.CHANGE_LINE_TYPE_SVG,width:15,height:15,lineNode:t,callback:function(){this._api.changeSelectConnectorType()}.bind(this)},e,!0);this.addIcon("change",i)},t.exports=n},function(t,e,i){"use strict";var n=i(27),o=i(5),r=i(94),s=i(125),a=i(126),h=i(127),l=i(130),c=r.parsePercent,u=i(128),d={};d.HLayout=s,d.VLayout=a,d.TreeLayout=h,d.ForceLayout=l,d.Tree=u,d.addCustomLayout=function(t){d.customLayout=t},d.getLayoutRect=function(t,e,i){i=r.normalizeCssArray(i||0);var o=e.width,s=e.height,a=c(t.left,o),h=c(t.top,s),l=c(t.right,o),u=c(t.bottom,s),d=c(t.width,o),p=c(t.height,s),f=i[2]+i[0],g=i[1]+i[3],v=t.aspect;switch(isNaN(d)&&(d=o-l-g-a),isNaN(p)&&(p=s-u-f-h),isNaN(d)&&isNaN(p)&&(v>o/s?d=.8*o:p=.8*s),null!=v&&(isNaN(d)&&(d=v*p),isNaN(p)&&(p=d/v)),isNaN(a)&&(a=o-l-d-g),isNaN(h)&&(h=s-u-p-f),t.left||t.right){case"center":a=o/2-d/2-i[3];break;case"right":a=o-d-g}switch(t.top||t.bottom){case"middle":case"center":h=s/2-p/2-i[0];break;case"bottom":h=s-p-f}a=a||0,h=h||0,isNaN(d)&&(d=o-a-(l||0)),isNaN(p)&&(p=s-h-(u||0));var y=new n(a+i[3],h+i[0],d,p);return y.margin=i,y},d.positionElement=function(t,e,i,r,s){var a=!s||!s.hv||s.hv[0],h=!s||!s.hv||s.hv[1],l=s&&s.boundingMode||"all";if(a||h){var c;if("raw"===l)c="group"===t.type||"GroupNode"===t.type?new n(0,0,+e.width||0,+e.height||0):t.getBoundingRect();else if(c=t.getBoundingRect(),t.needLocalTransform()){var u=t.getLocalTransform();c=c.clone(),c.applyTransform(u)}e=d.getLayoutRect(o.defaults({width:c.width,height:c.height},e),i,r);var p=t.position,f=a?e.x-c.x:0,g=h?e.y-c.y:0;t.attr("position","raw"===l?[f,g]:[p[0]+f,p[1]+g])}},t.exports=d},function(t,e,i){function n(t){var e={gap:5,maxWidth:1/0};this.options=o.merge(e,t,!0)}var o=i(5),r=i(82);n.prototype.run=function(t){var e=0,i=0,o=0;return t.each(function(n,s){if(!(n instanceof r)){var a,h=n.position,l=n.getBoundingRect(),c=t.childAt(s+1),u=c&&c.getBoundingRect(),d=l.width+(u?-u.x+l.x:0);a=e+d,a>this.options.maxWidth||n.newline?(e=0,a=d,i+=o+parseInt(this.options.gap,10),o=l.height):o=Math.max(o,l.height),n.newline||(h[0]=e,h[1]=i,e=a+this.options.gap)}},this),n},t.exports=n},function(t,e,i){function n(t){var e={gap:5,maxHeight:1/0};this.options=o.merge(e,t,!0)}var o=i(5),r=i(82);n.prototype.run=function(t){var e=0,i=0,o=0;return t.each(function(n,s){if(!(n instanceof r)){var a,h=n.position,l=n.getBoundingRect(),c=t.childAt(s+1),u=c&&c.getBoundingRect(),d=l.height+(u?-u.y+l.y:0);a=i+d,a>this.options.maxHeight||n.newline?(e+=o+parseInt(this.options.gap,10),i=0,a=d,o=l.width):o=Math.max(o,l.width),n.newline||(h[0]=e,h[1]=i,i=a+this.options.gap)}},this),n},t.exports=n},function(t,e,i){function n(t){var e={orient:"vertical",nodePadding:30,layerPadding:100,rootLocation:{x:100,y:230},animateTime:500,lineStyle:{pos:"bottom,top",symbol:{type:"none"}}};"horizontal"===t.orient&&(e.lineStyle.pos="right,left"),this.options=o.defaults(e,t,!0),this.nodePadding=this.options.nodePadding,this.layerPadding=this.options.layerPadding,this.fishTopo=this.options.fishTopo,this._layerOffsets=[],this._layers=[],this._hideNodes=[]}var o=i(5),r=i(27),s=i(94),a=s.parsePercent,h=i(128),l=i(129);n.prototype.layoutByRootNode=function(t){function e(t,n){var r=[],s=[];o.each(i,function(e){e.startNode===t&&(e.endNode.exclude||s.push(e.endNode))}),s.length>0&&o.each(s,function(t){var i={name:t.id,node:t};r.push(i),e(t,i)}),r.length>0&&(n.children=r)}var i=this.fishTopo.connectionManager.connectors,n={name:t.id,node:t};return e(t,n),this.doLayout({data:[n]},!0)},n.prototype.doLayout=function(t,e){var i=t.data[0];return this.treeData=t,this.tree=h.fromOptionData(i.name,i.children),this.tree.root.data=i,this._buildNode(t),this._setTreeShape(function(){this._buildAllLink(e)}.bind(this)),this.getBoundingRect()},n.prototype._buildAllLink=function(t){this.tree.traverse(function(e){e.children.length>0&&!t?this._buildLinkByParent(e,this.treeData.createLinkFunction):this.fishTopo.connectionManager.refreshLineByNode(e.data.node)},this)},n.prototype.getBoundingRect=function(){var t=null;return this.tree.traverse(function(e){var i=r.create({x:e.layout.position[0],y:e.layout.position[1],width:e.layout.width,height:e.layout.height});t||(t=i.clone()),t.union(i)},this),t},n.prototype._setTreeShape=function(t){var e=0,i=new l({nodePadding:this.nodePadding,layerPadding:this.layerPadding});this.tree.traverse(function(t){if(o.indexOf(this._hideNodes,t)==-1){var e=t.data.node.getBoundingRect();t.layout={width:t.data.node._width||e.width,height:t.data.node._height||e.height}}},this),i._hideNodes=this._hideNodes,i.run(this.tree);var n=this.options.orient,r=this.options.rootLocation.x,s=this.options.rootLocation.y,h=this.fishTopo.getWidth(),c=this.fishTopo.getHeight();r="center"===r?.5*h:a(r,h),s="center"===s?.5*c:a(s,c),s=a(s,c),"horizontal"===n?(r=isNaN(r)?10:r,s=isNaN(s)?.5*c:s):(r=isNaN(r)?.5*h:r,s=isNaN(s)?10:s);var u=this.tree.root.layout.position[0],d=i.count(this.tree)-this._hideNodes.length,p=1/0;this.tree.traverse(function(t){var e,i;o.indexOf(this._hideNodes,t)==-1&&("vertical"===n&&"inverse"===this.options.direction?(e=t.layout.position[0]-u+r,i=s-t.layout.position[1]):"vertical"===n?(e=t.layout.position[0]-u+r,i=t.layout.position[1]+s):"horizontal"===n&&"inverse"===this.options.direction?(i=t.layout.position[0]-u+s,e=r-t.layout.position[1]):"horizontal"===n&&(i=t.layout.position[0]-u+s,e=t.layout.position[1]+r),t.layout.__x=e,t.layout.__y=i,i<p&&(p=i))},this),this.tree.traverse(function(i){o.indexOf(this._hideNodes,i)==-1&&(p>0?(i.layout.position[0]=i.layout.__x,i.layout.position[1]=i.layout.__y):(i.layout.position[0]=i.layout.__x,i.layout.position[1]=i.layout.__y-p),i.data.node.animateTo({position:[i.layout.position[0],i.layout.position[1]]},this.options.animateTime,function(){++e===d&&t()}.bind(this)),0==this._hideNodes.length&&i.children.length>0&&i.data.node._toggleShrink&&i.data.node._toggleShrink(!0))},this)},n.prototype._buildNode=function(t){t.createNodeFunction||(t.createNodeFunction=this._defaultCreateNodeFunction),this.tree.traverse(function(e){if(!e.data.node){var i=e.data.createNodeFunction||t.createNodeFunction,n=i(e.data,this);n._childShow=!0,this.fishTopo.add(n),e.data.node=n}},this)},n.prototype._defaultCreateNodeFunction=function(t){var e=this.fishTopo.createNode("Circle",{shape:{r:15},style:{fill:"#4883b4"},name:t.lable||t.name});return e},n.prototype._buildLinkByParent=function(t,e){for(var i=0,n=t.children.length;i<n;i++)this._buildLink(t,t.children[i],e)},n.prototype._buildLink=function(t,e,i){var n=null,r=t.data.node,s=e.data.node;if(i){var a=e.data;a.startNode=r,a.endNode=s,n=i(a)}else{var h=this.options.lineStyle;e.data.lineStyle&&(h=o.merge(o.clone(h),e.data.lineStyle,!0)),n=this.fishTopo.createLink(r,s,h)}this.fishTopo.add(n)},n.prototype.addChild=function(t,e,i){var n=new h(e.name).root;n.data=e;var r=this.treeData.createNodeFunction(n.data,this);return r._childShow=!0,t.children.length>=1?r.attr("position",o.clone(t.children[t.children.length-1].layout.position)):r.attr("position",o.clone(t.layout.position)),this.fishTopo.add(r),n.data.node=r,setTimeout(function(){this._buildLink(t,n,this.treeData.createLinkFunction)}.bind(this),this.options.animateTime),t.add(n),this.refreshPositionAndLine(i),r},n.prototype.toggleChild=function(t){var e=this.findTreeNodeByNode(t);t._childShow?(e.traverse(function(e){e.data.node!==t&&(e.data.node.hide(),o.indexOf(this._hideNodes,e)==-1&&this._hideNodes.push(e),this.fishTopo.connectionManager.toggleLineByNode(e.data.node,!1),e.children.length>0&&(e.data.node._childShow=!1,e.data.node._toggleShrink&&e.data.node._toggleShrink(!1)))},this),t._childShow=!1,t._toggleShrink&&t._toggleShrink(!1),this.refreshPositionAndLine()):(e.traverse(function(e){e.data.node!==t&&(e.data.node.show(),this._hideNodes.splice(o.indexOf(this._hideNodes,e),1),this.fishTopo.connectionManager.toggleLineByNode(e.data.node,!0),e.children.length>0&&(e.data.node._childShow=!0,e.data.node._toggleShrink&&e.data.node._toggleShrink(!0)))},this),t._childShow=!0,t._toggleShrink&&t._toggleShrink(!0),this.refreshPositionAndLine())},n.prototype.findTreeNodeByNode=function(t){var e=null;return this.tree.traverse(function(i){i.data.node===t&&(e=i)}),e},n.prototype.removeNode=function(t){var e=this.findTreeNodeByNode(t),i=e.parent;return!!i&&(e.traverse(function(t){this.fishTopo.remove(t.data.node)},this),i.remove(e),0===i.children.length&&i.data.node._hideToggle&&i.data.node._hideToggle(),this.refreshPositionAndLine(),!0)},n.prototype.removeChildren=function(t){var e=this.findTreeNodeByNode(t);return e.traverse(function(t){t!==e&&this.fishTopo.remove(t.data.node)},this),e.removeAllChildren(),t._hideToggle&&t._hideToggle(),this.refreshPositionAndLine(),!0},n.prototype.refreshPositionAndLine=function(t){this.tree.root.updateDepthAndHeight(0),this._setTreeShape(function(){this.tree.traverse(function(t){this.fishTopo.connectionManager.refreshLineByNode(t.data.node)},this),t&&t()}.bind(this))},n.prototype.changePosition=function(t,e){var i,n=t.parent,r=o.indexOf(n.children,t);"next"==e?i=r+1:"prev"==e&&(i=r-1);var s=n.children[i];if(s){var a=s;n.children[i]=t,n.children[r]=a}this.refreshPositionAndLine(),this.fishTopo.trigger("treeLayout:changePosition",{node:t,parentNode:n,targetNode:s})},t.exports=n},function(t,e,i){function n(t,e){this.id=t,this.depth=0,this.height=0,this.children=[],this.parent=null,this.data=e||null}function o(t){this.root=new n(t)}var r=i(5);n.prototype.add=function(t){var e=this.children;t.parent!==this&&(e.push(t),t.parent=this)},n.prototype.remove=function(t){var e=this.children,i=r.indexOf(e,t);i>=0&&(e.splice(i,1),t.parent=null)},n.prototype.removeAllChildren=function(){for(var t=this.children,e=0;e<t.length;e++){var i=t[e];i.parent=null}this.children=[]},n.prototype.traverse=function(t,e){t.call(e,this);for(var i=0;i<this.children.length;i++)this.children[i].traverse(t,e)},n.prototype.count=function(){var t=0;return this.traverse(function(){t++}),t},n.prototype.updateDepthAndHeight=function(t){var e=0;this.depth=t;for(var i=0;i<this.children.length;i++){var n=this.children[i];n.updateDepthAndHeight(t+1),n.height>e&&(e=n.height)}this.height=e+1},n.prototype.getNodeById=function(t){if(this.id===t)return this;for(var e=0;e<this.children.length;e++){var i=this.children[e].getNodeById(t);if(i)return i}},o.prototype.traverse=function(t,e){this.root.traverse(t,e)},o.prototype.getSubTree=function(t){var e=this.getNodeById(t);if(e){var i=new o(e.id);return i.root=e,i}},o.prototype.getNodeById=function(t){return this.root.getNodeById(t)},o.fromOptionData=function(t,e){function i(t,e){var o=new n(t.name,t);e.add(o);var r=t.children;if(r)for(var s=0;s<r.length;s++)i(r[s],o)}var r=new o(t),s=r.root;s.data={name:t,children:e};for(var a=0;a<e.length;a++)i(e[a],s);return r.root.updateDepthAndHeight(0),r},o.fromDataSource=function(t,e){function i(e){return r.filter(t.link,function(t){if(t.from===e&&!t.pos)return t})}function s(t){for(var e=i(t.id),n=0;n<e.length;n++){var o=e[n],r=a[o.to];t.children.push(r),s(r)}}for(var a={},h=0;h<t.node.length;h++){var l=t.node[h],c=new n(l.name,l);a[l.name]=c}var u=new o(e.name),d=u.root;return d.data=e,s(u.root),u.root.updateDepthAndHeight(0),u},t.exports=o},function(t,e,i){function n(t){t=t||{},this.nodePadding=t.nodePadding||30,this.layerPadding=t.layerPadding||100,this._layerOffsets=[],this._layers=[],this._hideNodes=[]}var o=i(15),r=i(5);n.prototype.count=function(t){var e=0;return t.traverse(function(){e++}),e},n.prototype.run=function(t){this._layerOffsets.length=0;for(var e=0;e<t.root.height+1;e++)this._layerOffsets[e]=0,this._layers[e]=[];this._updateNodeXPosition(t.root);var i=t.root;this._updateNodeYPosition(i,0,i.layout.height)},n.prototype._updateNodeXPosition=function(t){var e=1/0,i=-(1/0);t.layout.position=t.layout.position||o.create();for(var n=0;n<t.children.length;n++){var s=t.children[n];if(r.indexOf(this._hideNodes,s)==-1){this._updateNodeXPosition(s);var a=s.layout.position[0];a<e&&(e=a),a>i&&(i=a)}}t.children.length>0&&r.indexOf(this._hideNodes,t.children[0])==-1?t.layout.position[0]=(e+i)/2:(t.layout.position[0]=0,t.height=0);var h=this._layerOffsets[t.depth]||0;if(h>t.layout.position[0]){var l=h-t.layout.position[0];this._shiftSubtree(t,l);for(var c=t.depth+1;c<t.height+t.depth;c++)this._layerOffsets[c]+=l}this._layerOffsets[t.depth]=t.layout.position[0]+t.layout.width+this.nodePadding,r.indexOf(this._layers[t.depth],t)==-1&&this._layers[t.depth].push(t)},n.prototype._shiftSubtree=function(t,e){t.layout.position[0]+=e;for(var i=0;i<t.children.length;i++)r.indexOf(this._hideNodes,t.children[i])==-1&&this._shiftSubtree(t.children[i],e)},n.prototype._updateNodeYPosition=function(t,e,i){if(r.indexOf(this._hideNodes,t)==-1){t.layout.position[1]=e;for(var n=0,o=0;o<t.children.length;o++)n=Math.max(t.children[o].layout.height,n);var s=this.layerPadding;"function"==typeof s&&(s=s(t.depth));for(var a=0;a<t.children.length;a++)this._updateNodeYPosition(t.children[a],e+s+i,n)}},t.exports=n},function(t,e,i){function n(t){this.fishTopo=t.fishTopo;var e={repulsion:100,gravity:.1,edgeLength:30,once:!0,layoutAnimation:!0,rect:{x:0,y:0,width:this.fishTopo.getWidth(),height:this.fishTopo.getHeight()},lineStyle:{symbol:{type:"none"}},preservedPoints:{}};this.options=s.defaults(e,t,!0)}var o=i(131),r=i(15),s=i(5);n.prototype.doLayout=function(t){var e=t.data[0];this.allNodes=this._buildNode(e.nodes,t.createNodeFunction),this.allLinks=this._buildLinks(e.links,t.createLinkFunction),this._forceIns(),this._startForceLayoutIteration()},n.prototype.autoLayout=function(){this.allNodes=this.fishTopo.allNodes,this.allLinks=this.fishTopo.connectionManager.connectors,this._forceIns(),this._startForceLayoutIteration()},n.prototype._buildNode=function(t,e){fish.isFunction(e)||(e=this._defaultCreateNodeFunction.bind(this));var i=[];return s.each(t,function(t,n){if(!t.node){var o=t.createNodeFunction||e,r=o(t);this.fishTopo.add(r),this._addNodeEvent(r,n),i.push(r)}},this),i},n.prototype._addNodeEvent=function(t,e){this.options.once||t.on("drag",function(){this.options.forceLayout&&(this.options.forceLayout.warmUp(),!this._layouting&&this._startForceLayoutIteration(),this.options.forceLayout.setFixed(e))},this).on("dragend",function(){this.options.forceLayout&&this.options.forceLayout.setUnfixed(e)},this)},n.prototype._defaultCreateNodeFunction=function(t){var e=this.fishTopo.createNode("Circle",{shape:{r:15},style:{fill:"#4883b4"},name:t.lable||t.name});return e},n.prototype._buildLinks=function(t,e){var i=[];return s.each(t,function(t){var n=this.fishTopo.childOfName(t.source),o=this.fishTopo.childOfName(t.target);if(n&&o){var r=null;if(e){var a=t;a.startNode=n,a.endNode=o,r=e(a)}else{var h=this.options.lineStyle;t.style&&(h=s.merge(s.clone(h),t.style,!0)),r=this.fishTopo.createLink(n,o,h)}this.fishTopo.add(r),i.push(r)}},this),i},n.prototype._forceIns=function(){var t=this.options.rect,e=this,i=this.options.preservedPoints,n=s.map(this.allNodes,function(t){var e=this.options.repulsion;return t.w=e,t.rep=e,t.p=null,{w:e,rep:e,p:null}},this);i&&s.each(this.allNodes,function(t,e){t.attr("position",i[e])}),s.each(this.allLinks,function(t){t.n1=t.startNode,t.n2=t.endNode,t.d=this.options.edgeLength,t.curveness=0},this);var a=o(this.allNodes,this.allLinks,{rect:t,gravity:this.options.gravity}),h=a.step;a.step=function(t){s.each(this.allNodes,function(t){n.fixed&&r.copy(n.p,n.position)}),h(function(n,o,r){for(var a=0,h=n.length;a<h;a++)n[a].fixed||n[a].attr("position",n[a].p),i[a]=n[a].p;s.each(o,function(t){e.fishTopo.connectionManager.refreshConnector(t,!0)}),t&&t(r)})},this.options.forceLayout=a,this.options.preservedPoints=i,a.step()},n.prototype._startForceLayoutIteration=function(){var t=this,e=this.options.layoutAnimation;!function i(){t.options.forceLayout.step(function(n){t._layouting=!n,t._layouting?e?t._layoutTimeout=setTimeout(i,16):i():t.fishTopo.trigger("forceLayoutEnd")})}()},t.exports=n},function(t,e,i){var n=i(15),o=n.scaleAndAdd;t.exports=function(t,e,i){for(var r=i.rect,s=r.width,a=r.height,h=[r.x+s/2,r.y+a/2],l=null==i.gravity?.1:i.gravity,c=0;c<t.length;c++){var u=t[c];u.p||(u.p=n.create(s*(Math.random()-.5)+h[0],a*(Math.random()-.5)+h[1])),u.pp=n.clone(u.p),u.edges=null}var d=.6;return{warmUp:function(){d=.5},setFixed:function(e){t[e].fixed=!0},setUnfixed:function(e){t[e].fixed=!1},step:function(i){for(var r=[],s=t.length,a=0;a<e.length;a++){var c=e[a],u=c.n1,p=c.n2;n.sub(r,p.p,u.p);var f=n.len(r)-c.d,g=p.w/(u.w+p.w);n.normalize(r,r),!u.fixed&&o(u.p,u.p,r,g*f*d),!p.fixed&&o(p.p,p.p,r,-(1-g)*f*d)}for(var a=0;a<s;a++){var v=t[a];v.fixed||(n.sub(r,h,v.p),n.scaleAndAdd(v.p,v.p,r,l*d))}for(var a=0;a<s;a++)for(var u=t[a],y=a+1;y<s;y++){var p=t[y];n.sub(r,p.p,u.p);var f=n.len(r);0===f&&(n.set(r,Math.random()-.5,Math.random()-.5),f=1);var m=(u.rep+p.rep)/f/f;!u.fixed&&o(u.pp,u.pp,r,m),!p.fixed&&o(p.pp,p.pp,r,-m)}for(var x=[],a=0;a<s;a++){var v=t[a];v.fixed||(n.sub(x,v.p,v.pp),n.scaleAndAdd(v.p,v.p,x,d),n.copy(v.pp,v.p))}d=.992*d,i&&i(t,e,d<.01)}}}},function(t,e){function i(t){this.max=t||o.thread,this.linkHead=null,this.linkNode=null,this.pool=[]}var n=function(){},o={thread:5,tries:2},r={setAttr:function(){var t=new Image;return t.dataset?function(t,e,i){return t.dataset[e]=i,i}:function(t,e,i){return t.setAttribute("data-"+e,i),i}}(),getAttr:function(){var t=new Image;return t.dataset?function(t,e){return t.dataset[e]?t.dataset[e]:t.getAttribute("data-"+e)}:function(t,e){return t.getAttribute("data-"+e)}}()};i.prototype.initPool=function(){var t,e,i,n;for(n=this,t=0;t<this.max;t++)i={},e=new Image,r.setAttr(e,"id",t),e.onload=function(){n.notice(n.getNode(this),"success",this),n.executeLink(this)},e.onerror=function(){var t=n.getNode(this);t.tries<o.tries?(t.tries=t.tries+1,n.appendNode(n.createNode(t.src,t.options,t.notice,t.group,t.tries))):n.notice(t,"error",this),n.executeLink(this)},i.img=e,i.free=!0,this.pool.push(i)},i.prototype.notice=function(t,e,i){t.notice(e,i)},i.prototype.executeLink=function(t){this.linkHead?(this.setSrc(t,this.linkHead),this.shiftNode()):this.status(t,!0)},i.prototype.getFree=function(){var t,e;for(e=0,t=this.pool.length;e<t;e++)if(this.pool[e].free)return this.pool[e];return null},i.prototype.setSrc=function(t,e){this.status(t,!1),this.setNode(t,e),t.src=e.src},i.prototype.status=function(t,e){var i=r.getAttr(t,"id");i&&(this.pool[i].free=e),e&&(this.pool[i].node=null)},i.prototype.setNode=function(t,e){var i=r.getAttr(t,"id");if(i)return this.pool[i].node=e,this.pool[i].node===e},i.prototype.getNode=function(t){var e=r.getAttr(t,"id");if(e)return this.pool[e].node},i.prototype._load=function(t,e){var i=[],o=null,r=0,s=0,a=function(){return e.once?function(t,e){var i=this.group,n=this.options;i[t].push(e),i.success.length+i.error.length===i.count&&setTimeout(function(){n.success.call(null,i.success,i.error,i.count)},1)}:function(t,e){var i=this.options;setTimeout(function(){i[t].call(null,e)},1)}}(),h={count:0,success:[],error:[]},l=null;for(e=e||{},e.success=e.success||n,e.error=e.error||n,i=i.concat(t),h.count=i.length,s=0,r=i.length;s<r;s++)l=this.createNode(i[s],e,a,h),o=this.getFree(),o?this.setSrc(o.img,l):this.appendNode(l)},i.prototype._info=function(){var t={},e=0,i=0,n=null;for(t.thread={},t.thread.count=this.pool.length,t.thread.free=0,t.task={},t.task.count=0,i=0,e=this.pool.length;i<e;i++)this.pool[i].free&&(t.thread.free=t.thread.free+1);if(n=this.linkHead)for(t.task.count=t.task.count+1;n.next;)t.task.count=t.task.count+1,n=n.next;return t},i.prototype.createNode=function(t,e,i,n,o){var r={};return r.src=t,r.options=e,r.notice=i,r.group=n,r.tries=o||0,r},i.prototype.appendNode=function(t){this.linkHead?(this.linkNode.next=t,this.linkNode=t):(this.linkHead=t,this.linkNode=t)},i.prototype.shiftNode=function(){this.linkHead&&(this.linkHead=this.linkHead.next||null)};var s=function(t){var e=new i(t);return e.initPool(),{load:function(){e._load.apply(e,arguments)},info:function(){return e._info.call(e)}}};t.exports={initImagePool:s}},function(t,e,i){function n(t,e){this._tooltipContent=new h(e.getDom(),e),this._api=e,this._tooltipModel=t,this._alwaysShowContent=t.get("alwaysShowContent"),this._initGloablListener()}function o(t,e,i){var n=i[0],o=i[1],r=5,s=0,a=0,h=e.width,l=e.height;switch(t){case"inside":s=e.x+h/2-n/2,a=e.y+l/2-o/2;break;case"top":s=e.x+h/2-n/2,a=e.y-o-r;break;case"bottom":s=e.x+h/2-n/2,a=e.y+l+r;break;case"left":s=e.x-n-r,a=e.y+l/2-o/2;break;case"right":s=e.x+h+r,a=e.y+l/2-o/2}return[s,a]}function r(t,e,i,n,o,r,s){var a=i.clientWidth,h=i.clientHeight;return t+a+r>n?t-=a+r:t+=r,e+h+s>o?e-=h+s:e+=s,[t,e]}function s(t){return"center"===t||"middle"===t}function a(t,e,i,n,o){var r=i.clientWidth,s=i.clientHeight;return t=Math.min(t+r,n)-r,e=Math.min(e+s,o)-s,t=Math.max(t,0),e=Math.max(e,0),[t,e]}var h=i(134),l=i(135),c=i(87),u=i(5),d=i(50),p=i(94),f=i(124);n.prototype._initGloablListener=function(){var t=this._tooltipModel.get("triggerOn");l.register("itemTooltip",this._api,function(e,i,n){"none"!==t&&(t.indexOf(e)>=0?this._tryShow(i,n):"leave"===e&&this._hide(n))}.bind(this))},n.prototype._tryShow=function(t,e){var i=t.target,n=this._tooltipModel;n&&(this._lastX=t.offsetX,this._lastY=t.offsetY,i&&i.tooltip?this._showComponentItemTooltip(t,i):this._hide(e))},n.prototype._hide=function(t){this._lastDataByCoordSys=null,t({type:"hideTip",from:this.uid}),this.manuallyHideTip()},n.prototype.dispose=function(){d.node||(this._tooltipContent.hide(),l.unregister("itemTooltip",this._api))},n.prototype.manuallyHideTip=function(){var t=this._tooltipContent;this._alwaysShowContent||t.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=null},n.prototype._showComponentItemTooltip=function(t,e){var i=e.tooltip;if("string"==typeof i){var n=i;i={content:n,formatter:n}}var o=new c(i,this._tooltipModel),r=o.get("content"),s=Math.random();this._showOrMove(o,function(){this._showTooltipContent(o,r,o.get("formatterParams")||{},s,t.offsetX,t.offsetY,t.position,e)})},n.prototype._showOrMove=function(t,e){var i=t.get("showDelay");e=u.bind(e,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(e,i):e()},n.prototype._showTooltipContent=function(t,e,i,n,o,r,s,a){if(this._ticket="",t.get("showContent")&&t.get("show")){var h=this._tooltipContent,l=t.get("formatter");s=s||t.get("position");var c=e;if(l&&"string"==typeof l)c=p.formatTpl(l,i,!0);else if("function"==typeof l){var u=function(e,n){e===this._ticket&&(h.setContent(n),this._updatePosition(t,s,o,r,h,i,a))}.bind(this);this._ticket=n,c=l(i,n,u)}h.setContent(c),h.show(t),this._updatePosition(t,s,o,r,h,i,a)}},n.prototype._updatePosition=function(t,e,i,n,h,l,c){var d=this._api.getWidth(),g=this._api.getHeight();e=e||t.get("position");var v=h.getSize(),y=t.get("align"),m=t.get("verticalAlign"),x=c&&c.getBoundingRect().clone();if(c&&x.applyTransform(c.transform),"function"==typeof e&&(e=e([i,n],l,h.el,x,{viewSize:[d,g],contentSize:v.slice()})),u.isArray(e))i=p.parsePercent(e[0],d),n=p.parsePercent(e[1],g);else if(u.isObject(e)){e.width=v[0],e.height=v[1];var _=f.getLayoutRect(e,{width:d,height:g});i=_.x,n=_.y,y=null,m=null}else if("string"==typeof e&&c){var b=o(e,x,v);i=b[0],n=b[1]}else{var w=r(i,n,h.el,d,g,y?0:20,m?0:20);i=w[0],n=w[1]}if(y&&(i-=s(y)?v[0]/2:"right"===y?v[0]:0),m&&(n-=s(m)?v[1]/2:"bottom"===m?v[1]:0),t.get("confine")){var P=a(i,n,h.el,d,g);i=P[0],n=P[1]}h.moveTo(i,n)},t.exports=n},function(t,e,i){function n(t){var e="cubic-bezier(0.23, 1, 0.32, 1)",i="left "+t+"s "+e+",top "+t+"s "+e;return a.map(g,function(t){return t+"transition:"+i}).join(";")}function o(t){var e=[],i=t.get("fontSize"),n=t.get("color");
n&&e.push("color:"+n);var o=t.get("font");return o&&e.push("font:"+o),i&&e.push("line-height:"+Math.round(3*i/2)+"px"),f(["decoration","align"],function(i){var n=t.get(i);n&&e.push("text-"+i+":"+n)}),e.join(";")}function r(t){var e=[],i=t.get("transitionDuration"),r=t.get("backgroundColor"),s=t.getModel("textStyle"),a=t.get("padding");return i&&e.push(n(i)),r&&(l.canvasSupported?e.push("background-Color:"+r):(e.push("background-Color:#"+h.toHex(r)),e.push("filter:alpha(opacity=70)"))),f(["width","color","radius"],function(i){var n="border-"+i,o=d(n),r=t.get(o);null!=r&&e.push(n+":"+r+("color"===i?"":"px"))}),e.push(o(s)),null!=a&&e.push("padding:"+p(a).join("px ")+"px"),e.join(";")+";"}function s(t,e){var i=document.createElement("div"),n=this._zr=e.getZr();this.el=i,this._x=e.getWidth()/2,this._y=e.getHeight()/2,t.appendChild(i),this._container=t,this._show=!1,this._hideTimeout;var o=this;i.onmouseenter=function(){o._enterable&&(clearTimeout(o._hideTimeout),o._show=!0),o._inContent=!0},i.onmousemove=function(e){if(e=e||window.event,!o._enterable){var i=n.handler;c.normalizeEvent(t,e,!0),i.dispatch("mousemove",e)}},i.onmouseleave=function(){o._enterable&&o._show&&o.hideLater(o._hideDelay),o._inContent=!1}}var a=i(5),h=i(20),l=i(50),c=i(77),u=i(94),d=u.toCamelCase,p=u.normalizeCssArray,f=a.each,g=["","-webkit-","-moz-","-o-"],v="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:999;";s.prototype={constructor:s,_enterable:!0,update:function(){var t=this._container,e=t.currentStyle||document.defaultView.getComputedStyle(t),i=t.style;"absolute"!==i.position&&"absolute"!==e.position&&(i.position="relative")},show:function(t){clearTimeout(this._hideTimeout);var e=this.el;e.style.cssText=v+r(t)+";left:"+this._x+"px;top:"+this._y+"px;"+(t.get("extraCssText")||""),e.style.display=e.innerHTML?"block":"none",this._show=!0},setContent:function(t){this.el.innerHTML=t},setEnterable:function(t){this._enterable=t},getSize:function(){var t=this.el;return[t.clientWidth,t.clientHeight]},moveTo:function(t,e){var i,n=this._zr;n&&n.painter&&(i=n.painter.getViewportRoot())&&(t+=i.offsetLeft||0,e+=i.offsetTop||0);var o=this.el.style;o.left=t+"px",o.top=e+"px",this._x=t,this._y=e},hide:function(){this.el.style.display="none",this._show=!1},hideLater:function(t){!this._show||this._inContent&&this._enterable||(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(a.bind(this.hide,this),t)):this.hide())},isShow:function(){return this._show}},t.exports=s},function(t,e,i){function n(t,e){function i(i,n){t.on(i,function(i){var r=a(e);u(c(t).records,function(t){t&&n(t,i,r.dispatchAction)}),o(r.pendings,e)})}c(t).initialized||(c(t).initialized=!0,i("click",l.curry(s,"click")),i("mousemove",l.curry(s,"mousemove")),i("globalout",r))}function o(t,e){var i,n=t.showTip.length,o=t.hideTip.length;n?i=t.showTip[n-1]:o&&(i=t.hideTip[o-1]),i&&(i.dispatchAction=null,e.dispatchAction(i))}function r(t,e,i){t.handler("leave",null,i)}function s(t,e,i,n){e.handler(t,i,n)}function a(t){var e={showTip:[],hideTip:[]},i=function(n){var o=e[n.type];o?o.push(n):(n.dispatchAction=i,t.dispatchAction(n))};return{dispatchAction:i,pendings:e}}var h=i(50),l=i(5),c=i(94).makeGetter(),u=l.each,d={};d.register=function(t,e,i){if(!h.node){var o=e.getZr();c(o).records||(c(o).records={}),n(o,e);var r=c(o).records[t]||(c(o).records[t]={});r.handler=i}},d.unregister=function(t,e){if(!h.node){var i=e.getZr(),n=(c(i).records||{})[t];n&&(c(i).records[t]=null)}},t.exports=d},function(t,e,i){var n=i(87);t.exports=n.extend({type:"tooltip",defaultOption:{zlevel:0,z:8,show:!0,showContent:!0,triggerOn:"mousemove",alwaysShowContent:!1,displayMode:"single",confine:!1,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"rgba(50,50,50,0.7)",borderColor:"#333",borderRadius:4,borderWidth:0,padding:5,extraCssText:"",textStyle:{color:"#fff",fontSize:14}}})},function(t,e,i){i(138);var n=i(69),o=n.registerPainter,r=i(140);o("vml",r)},function(t,e,i){var n=i(50),o=i(15),r=o.applyTransform,s=i(27),a=i(20),h=i(26),l=i(25),c=i(24),u=i(8),d=i(45),p=i(46),f=i(7),g=i(30),v=i(42),y=i(139),m=g.CMD,x=Math.round,_=Math.sqrt,b=Math.abs,w=Math.cos,P=Math.sin,C=Math.max;if(!n.canvasSupported){var T=",",N="progid:DXImageTransform.Microsoft",S=21600,M=S/2,A=1e5,E=1e3,R=function(t){t.style.cssText="position:absolute;left:0;top:0;width:1px;height:1px;",t.coordsize=S+","+S,t.coordorigin="0,0"},L=function(t){return String(t).replace(/&/g,"&amp;").replace(/"/g,"&quot;")},k=function(t,e,i){return"rgb("+[t,e,i].join(",")+")"},O=function(t,e){e&&t&&e.parentNode!==t&&t.appendChild(e)},I=function(t,e){e&&t&&e.parentNode===t&&t.removeChild(e)},z=function(t,e,i){return(parseFloat(t)||0)*A+(parseFloat(e)||0)*E+i},B=function(t,e){return"string"==typeof t?t.lastIndexOf("%")>=0?parseFloat(t)/100*e:parseFloat(t):t},D=function(t,e,i){var n=a.parse(e);i=+i,isNaN(i)&&(i=1),n&&(t.color=k(n[0],n[1],n[2]),t.opacity=i*n[3])},H=function(t){var e=a.parse(t);return[k(e[0],e[1],e[2]),e[3]]},F=function(t,e,i){var n=e.fill;if(null!=n)if(n instanceof v){var o,s=0,a=[0,0],h=0,l=1,c=i.getBoundingRect(),u=c.width,d=c.height;if("linear"===n.type){o="gradient";var p=i.transform,f=[n.x*u,n.y*d],g=[n.x2*u,n.y2*d];p&&(r(f,f,p),r(g,g,p));var y=g[0]-f[0],m=g[1]-f[1];s=180*Math.atan2(y,m)/Math.PI,s<0&&(s+=360),s<1e-6&&(s=0)}else{o="gradientradial";var f=[n.x*u,n.y*d],p=i.transform,x=i.scale,_=u,b=d;a=[(f[0]-c.x)/_,(f[1]-c.y)/b],p&&r(f,f,p),_/=x[0]*S,b/=x[1]*S;var w=C(_,b);h=0/w,l=2*n.r/w-h}var P=n.colorStops.slice();P.sort(function(t,e){return t.offset-e.offset});for(var T=P.length,N=[],M=[],A=0;A<T;A++){var E=P[A],R=H(E.color);M.push(E.offset*l+h+" "+R[0]),0!==A&&A!==T-1||N.push(R)}if(T>=2){var L=N[0][0],k=N[1][0],O=N[0][1]*e.opacity,I=N[1][1]*e.opacity;t.type=o,t.method="none",t.focus="100%",t.angle=s,t.color=L,t.color2=k,t.colors=M.join(","),t.opacity=I,t.opacity2=O}"radial"===o&&(t.focusposition=a.join(","))}else D(t,n,e.opacity)},G=function(t,e){null!=e.lineDash&&(t.dashstyle=e.lineDash.join(" ")),null==e.stroke||e.stroke instanceof v||D(t,e.stroke,e.opacity)},Y=function(t,e,i,n){var o="fill"==e,r=t.getElementsByTagName(e)[0];null!=i[e]&&"none"!==i[e]&&(o||!o&&i.lineWidth)?(t[o?"filled":"stroked"]="true",i[e]instanceof v&&I(t,r),r||(r=y.createNode(e)),o?F(r,i,n):G(r,i),O(t,r)):(t[o?"filled":"stroked"]="false",I(t,r))},W=[[],[],[]],V=function(t,e){var i,n,o,s,a,h,l=m.M,c=m.C,u=m.L,d=m.A,p=m.Q,f=[],g=t.data,v=t.len();for(s=0;s<v;){switch(o=g[s++],n="",i=0,o){case l:n=" m ",i=1,a=g[s++],h=g[s++],W[0][0]=a,W[0][1]=h;break;case u:n=" l ",i=1,a=g[s++],h=g[s++],W[0][0]=a,W[0][1]=h;break;case p:case c:n=" c ",i=3;var y,b,C=g[s++],N=g[s++],A=g[s++],E=g[s++];o===p?(y=A,b=E,A=(A+2*C)/3,E=(E+2*N)/3,C=(a+2*C)/3,N=(h+2*N)/3):(y=g[s++],b=g[s++]),W[0][0]=C,W[0][1]=N,W[1][0]=A,W[1][1]=E,W[2][0]=y,W[2][1]=b,a=y,h=b;break;case d:var R=0,L=0,k=1,O=1,I=0;e&&(R=e[4],L=e[5],k=_(e[0]*e[0]+e[1]*e[1]),O=_(e[2]*e[2]+e[3]*e[3]),I=Math.atan2(-e[1]/O,e[0]/k));var z=g[s++],B=g[s++],D=g[s++],H=g[s++],F=g[s++]+I,G=g[s++]+F+I;s++;var Y=g[s++],V=z+w(F)*D,U=B+P(F)*H,C=z+w(G)*D,N=B+P(G)*H,q=Y?" wa ":" at ";Math.abs(V-C)<1e-4&&(Math.abs(G-F)>.01?Y&&(V+=270/S):Math.abs(U-B)<1e-4?Y&&V<z||!Y&&V>z?N-=270/S:N+=270/S:Y&&U<B||!Y&&U>B?C+=270/S:C-=270/S),f.push(q,x(((z-D)*k+R)*S-M),T,x(((B-H)*O+L)*S-M),T,x(((z+D)*k+R)*S-M),T,x(((B+H)*O+L)*S-M),T,x((V*k+R)*S-M),T,x((U*O+L)*S-M),T,x((C*k+R)*S-M),T,x((N*O+L)*S-M)),a=C,h=N;break;case m.R:var j=W[0],Z=W[1];j[0]=g[s++],j[1]=g[s++],Z[0]=j[0]+g[s++],Z[1]=j[1]+g[s++],e&&(r(j,j,e),r(Z,Z,e)),j[0]=x(j[0]*S-M),Z[0]=x(Z[0]*S-M),j[1]=x(j[1]*S-M),Z[1]=x(Z[1]*S-M),f.push(" m ",j[0],T,j[1]," l ",Z[0],T,j[1]," l ",Z[0],T,Z[1]," l ",j[0],T,Z[1]);break;case m.Z:f.push(" x ")}if(i>0){f.push(n);for(var X=0;X<i;X++){var Q=W[X];e&&r(Q,Q,e),f.push(x(Q[0]*S-M),T,x(Q[1]*S-M),X<i-1?T:"")}}}return f.join("")};f.prototype.brushVML=function(t){var e=this.style,i=this._vmlEl;i||(i=y.createNode("shape"),R(i),this._vmlEl=i),Y(i,"fill",e,this),Y(i,"stroke",e,this);var n=this.transform,o=null!=n,r=i.getElementsByTagName("stroke")[0];if(r){var s=e.lineWidth;if(o&&!e.strokeNoScale){var a=n[0]*n[3]-n[1]*n[2];s*=_(b(a))}r.weight=s+"px"}var h=this.path||(this.path=new g);this.__dirtyPath&&(h.beginPath(),this.buildPath(h,this.shape),h.toStatic(),this.__dirtyPath=!1),i.path=V(h,this.transform),i.style.zIndex=z(this.zlevel,this.z,this.z2),O(t,i),null!=e.text?this.drawRectText(t,this.getBoundingRect()):this.removeRectText(t)},f.prototype.onRemove=function(t){I(t,this._vmlEl),this.removeRectText(t)},f.prototype.onAdd=function(t){O(t,this._vmlEl),this.appendRectText(t)};var U=function(t){return"object"==typeof t&&t.tagName&&"IMG"===t.tagName.toUpperCase()};d.prototype.brushVML=function(t){var e,i,n=this.style,o=n.image;if(U(o)){var s=o.src;if(s===this._imageSrc)e=this._imageWidth,i=this._imageHeight;else{var a=o.runtimeStyle,h=a.width,l=a.height;a.width="auto",a.height="auto",e=o.width,i=o.height,a.width=h,a.height=l,this._imageSrc=s,this._imageWidth=e,this._imageHeight=i}o=s}else o===this._imageSrc&&(e=this._imageWidth,i=this._imageHeight);if(o){var c=n.x||0,u=n.y||0,d=n.width,p=n.height,f=n.sWidth,g=n.sHeight,v=n.sx||0,m=n.sy||0,b=f&&g,w=this._vmlEl;w||(w=y.doc.createElement("div"),R(w),this._vmlEl=w);var P,S=w.style,M=!1,A=1,E=1;if(this.transform&&(P=this.transform,A=_(P[0]*P[0]+P[1]*P[1]),E=_(P[2]*P[2]+P[3]*P[3]),M=P[1]||P[2]),M){var L=[c,u],k=[c+d,u],I=[c,u+p],B=[c+d,u+p];r(L,L,P),r(k,k,P),r(I,I,P),r(B,B,P);var D=C(L[0],k[0],I[0],B[0]),H=C(L[1],k[1],I[1],B[1]),F=[];F.push("M11=",P[0]/A,T,"M12=",P[2]/E,T,"M21=",P[1]/A,T,"M22=",P[3]/E,T,"Dx=",x(c*A+P[4]),T,"Dy=",x(u*E+P[5])),S.padding="0 "+x(D)+"px "+x(H)+"px 0",S.filter=N+".Matrix("+F.join("")+", SizingMethod=clip)"}else P&&(c=c*A+P[4],u=u*E+P[5]),S.filter="",S.left=x(c)+"px",S.top=x(u)+"px";var G=this._imageEl,Y=this._cropEl;G||(G=y.doc.createElement("div"),this._imageEl=G);var W=G.style;if(b){if(e&&i)W.width=x(A*e*d/f)+"px",W.height=x(E*i*p/g)+"px";else{var V=new Image,q=this;V.onload=function(){V.onload=null,e=V.width,i=V.height,W.width=x(A*e*d/f)+"px",W.height=x(E*i*p/g)+"px",q._imageWidth=e,q._imageHeight=i,q._imageSrc=o},V.src=o}Y||(Y=y.doc.createElement("div"),Y.style.overflow="hidden",this._cropEl=Y);var j=Y.style;j.width=x((d+v*d/f)*A),j.height=x((p+m*p/g)*E),j.filter=N+".Matrix(Dx="+-v*d/f*A+",Dy="+-m*p/g*E+")",Y.parentNode||w.appendChild(Y),G.parentNode!=Y&&Y.appendChild(G)}else W.width=x(A*d)+"px",W.height=x(E*p)+"px",w.appendChild(G),Y&&Y.parentNode&&(w.removeChild(Y),this._cropEl=null);var Z="",X=n.opacity;X<1&&(Z+=".Alpha(opacity="+x(100*X)+") "),Z+=N+".AlphaImageLoader(src="+o+", SizingMethod=scale)",W.filter=Z,w.style.zIndex=z(this.zlevel,this.z,this.z2),O(t,w),null!=n.text&&this.drawRectText(t,this.getBoundingRect())}},d.prototype.onRemove=function(t){I(t,this._vmlEl),this._vmlEl=null,this._cropEl=null,this._imageEl=null,this.removeRectText(t)},d.prototype.onAdd=function(t){O(t,this._vmlEl),this.appendRectText(t)};var q,j="normal",Z={},X=0,Q=100,J=document.createElement("div"),K=function(t){var e=Z[t];if(!e){X>Q&&(X=0,Z={});var i,n=J.style;try{n.font=t,i=n.fontFamily.split(",")[0]}catch(o){}e={style:n.fontStyle||j,variant:n.fontVariant||j,weight:n.fontWeight||j,size:0|parseFloat(n.fontSize||12),family:i||"Microsoft YaHei"},Z[t]=e,X++}return e};h.$override("measureText",function(t,e){var i=y.doc;q||(q=i.createElement("div"),q.style.cssText="position:absolute;top:-20000px;left:0;padding:0;margin:0;border:none;white-space:pre;",y.doc.body.appendChild(q));try{q.style.font=e}catch(n){}return q.innerHTML="",q.appendChild(i.createTextNode(t)),{width:q.offsetWidth}});for(var $=new s,tt=function(t,e,i,n){var o=this.style;this.__dirty&&l.normalizeTextStyle(o,!0);var s=o.text;if(null!=s&&(s+=""),s){if(o.rich){var a=h.parseRichText(s,o);s=[];for(var c=0;c<a.lines.length;c++){for(var u=a.lines[c].tokens,d=[],p=0;p<u.length;p++)d.push(u[p].text);s.push(d.join(""))}s=s.join("\n")}var f,g,v=o.textAlign,m=o.textVerticalAlign,_=K(o.font),b=_.style+" "+_.variant+" "+_.weight+" "+_.size+'px "'+_.family+'"';i=i||h.getBoundingRect(s,b,v,m);var w=this.transform;if(w&&!n&&($.copy(e),$.applyTransform(w),e=$),n)f=e.x,g=e.y;else{var P=o.textPosition,C=o.textDistance;if(P instanceof Array)f=e.x+B(P[0],e.width),g=e.y+B(P[1],e.height),v=v||"left";else{var N=h.adjustTextPositionOnRect(P,e,C);f=N.x,g=N.y,v=v||N.textAlign,m=m||N.textVerticalAlign}}f=h.adjustTextX(f,i.width,v),g=h.adjustTextY(g,i.height,m),g+=i.height/2;var S,M,A,E=y.createNode,k=this._textVmlEl;k?(A=k.firstChild,S=A.nextSibling,M=S.nextSibling):(k=E("line"),S=E("path"),M=E("textpath"),A=E("skew"),M.style["v-text-align"]="left",R(k),S.textpathok=!0,M.on=!0,k.from="0 0",k.to="1000 0.05",O(k,A),O(k,S),O(k,M),this._textVmlEl=k);var I=[f,g],D=k.style;w&&n?(r(I,I,w),A.on=!0,A.matrix=w[0].toFixed(3)+T+w[2].toFixed(3)+T+w[1].toFixed(3)+T+w[3].toFixed(3)+",0,0",A.offset=(x(I[0])||0)+","+(x(I[1])||0),A.origin="0 0",D.left="0px",D.top="0px"):(A.on=!1,D.left=x(f)+"px",D.top=x(g)+"px"),M.string=L(s);try{M.style.font=b}catch(H){}Y(k,"fill",{fill:o.textFill,opacity:o.opacity},this),Y(k,"stroke",{stroke:o.textStroke,opacity:o.opacity,lineDash:o.lineDash},this),k.style.zIndex=z(this.zlevel,this.z,this.z2),O(t,k)}},et=function(t){I(t,this._textVmlEl),this._textVmlEl=null},it=function(t){O(t,this._textVmlEl)},nt=[c,u,d,f,p],ot=0;ot<nt.length;ot++){var rt=nt[ot].prototype;rt.drawRectText=tt,rt.removeRectText=et,rt.appendRectText=it}p.prototype.brushVML=function(t){var e=this.style;null!=e.text?this.drawRectText(t,{x:e.x||0,y:e.y||0,width:0,height:0},this.getBoundingRect(),!0):this.removeRectText(t)},p.prototype.onRemove=function(t){this.removeRectText(t)},p.prototype.onAdd=function(t){this.appendRectText(t)}}},function(t,e,i){function n(t){return r(t)}function o(){if(!l&&c){l=!0;var t=c.styleSheets;t.length<31?c.createStyleSheet().addRule(".zrvml","behavior:url(#default#VML)"):t[0].addRule(".zrvml","behavior:url(#default#VML)")}}var r,s=i(50),a="urn:schemas-microsoft-com:vml",h="undefined"==typeof window?null:window,l=!1,c=h&&h.document;if(c&&!s.canvasSupported)try{!c.namespaces.zrvml&&c.namespaces.add("zrvml",a),r=function(t){return c.createElement("<zrvml:"+t+' class="zrvml">')}}catch(u){r=function(t){return c.createElement("<"+t+' xmlns="'+a+'" class="zrvml">')}}e.doc=c,e.createNode=n,e.initVML=o},function(t,e,i){function n(t){return parseInt(t,10)}function o(t,e){a.initVML(),this.root=t,this.storage=e;var i=document.createElement("div"),n=document.createElement("div");i.style.cssText="display:inline-block;overflow:hidden;position:relative;width:300px;height:150px;",n.style.cssText="position:absolute;left:0;top:0;",t.appendChild(i),this._vmlRoot=n,this._vmlViewport=i,this.resize();var o=e.delFromStorage,r=e.addToStorage;e.delFromStorage=function(t){o.call(e,t),t&&t.onRemove&&t.onRemove(n)},e.addToStorage=function(t){t.onAdd&&t.onAdd(n),r.call(e,t)},this._firstPaint=!0}function r(t){return function(){s('In IE8.0 VML mode painter not support method "'+t+'"')}}var s=i(22),a=i(139),h=i(5),l=h.each;o.prototype={constructor:o,getType:function(){return"vml"},getViewportRoot:function(){return this._vmlViewport},getViewportRootOffset:function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},refresh:function(){var t=this.storage.getDisplayList(!0,!0);this._paintList(t)},_paintList:function(t){for(var e=this._vmlRoot,i=0;i<t.length;i++){var n=t[i];n.invisible||n.ignore?(n.__alreadyNotVisible||n.onRemove(e),n.__alreadyNotVisible=!0):(n.__alreadyNotVisible&&n.onAdd(e),n.__alreadyNotVisible=!1,n.__dirty&&(n.beforeBrush&&n.beforeBrush(),(n.brushVML||n.brush).call(n,e),n.afterBrush&&n.afterBrush())),n.__dirty=!1}this._firstPaint&&(this._vmlViewport.appendChild(e),this._firstPaint=!1)},resize:function(t,e){var t=null==t?this._getWidth():t,e=null==e?this._getHeight():e;if(this._width!=t||this._height!=e){this._width=t,this._height=e;var i=this._vmlViewport.style;i.width=t+"px",i.height=e+"px"}},dispose:function(){this.root.innerHTML="",this._vmlRoot=this._vmlViewport=this.storage=null},getWidth:function(){return this._width},getHeight:function(){return this._height},clear:function(){this._vmlViewport&&this.root.removeChild(this._vmlViewport)},_getWidth:function(){var t=this.root,e=t.currentStyle;return(t.clientWidth||n(e.width))-n(e.paddingLeft)-n(e.paddingRight)|0},_getHeight:function(){var t=this.root,e=t.currentStyle;return(t.clientHeight||n(e.height))-n(e.paddingTop)-n(e.paddingBottom)|0}},l(["getLayer","insertLayer","eachLayer","eachBuiltinLayer","eachOtherLayer","getLayers","modLayer","delLayer","clearLayer","toDataURL","pathToImage"],function(t){o.prototype[t]=r(t)});var c=o;t.exports=c}])});
//# sourceMappingURL=fish-topo-flow.min.js.map
